{"version":3,"mappings":"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","names":["round","value","precision","multiplier","Vector2","x","y","scalar","v","s","a","b","min2","max2","minVal","maxVal","min","max","length","angle","dx","dy","alpha","v1","v2","array","offset","center","c","throttleMap","throttle","fun","delay","scope","timerId","throttledFunction","args","callFun","latestArgs","Lock","NakedPromise","executor","capturedResolve","capturedReject","resolve","reject","URLParams","url","name","fallback","type","items","paramsString","paramsNumber","paramsBoolean","item","split","k","limitFPS","fps","Ticker","gsap","getPixiRunnerData","runner","Prioritiser","runners","getter","getItem","result","plugin","data","runnerName","priority","runner2","plugin1","index1","plugin2","index2","promiseRunner","promiseAllRunner","promises","AssetMonitor","sizes","acc","size","state","FPSMonitor","id","trackTail","clampedDelta","timeNow","frameFPS","ended","now","ch","chSample","fpsPercentile1","fpsPercentile5","fpsPercentile95","fpsPercentile99","stats","delta","delta2","raw","seg","count","r","frameTime","windowMs","fw","duration","samples","sorted","pick","p","rank","gpuTextureFormatSize","glTextureFormatSize","GPUMonitor","renderer","textureCount","totalSize","texture","sizeInMb","currentTextures","glTextures","textureSystem","gpuData","webTexture","res","ANALYTICS_TIMER","MAX_FRAME_DT","START_TRACKING_AFTER","PerformanceTrackerClass","trackFunction","addSelf","warningFunction","options","_a","key","event","gpu","segmentSnapshots","nowTs","sessionSnapshot","snap","session","perfData","MIN_DELTA","w","rAF","frameCount","startTime","SAMPLE_DURATION_MS","HARD_TIMEOUT_MS","finish","elapsed","estimate","step","t","best","diff","hz","d","cooldownMs","last","currentMb","used","limit","ratio","PerformanceTracker","Application","config","PluginClass","nameToRegister","classPlugins","pluginClass","pluginName","ticker","SystemRunner","Plugin","app","formatTextures","assets","_b","assetData","tags","baseTexture","loadTexturesWrapper","loadTextures","ExtensionType","loadAsset","loader","loadWebFontWrapper","loadWebFont","validWeights","weights","atlasResolver","extension","format","Resolver","spritesheetHash","firstLoad","originalLoad","Assets","originalBackgroundLoad","mainOverride","urls","manifest","bundle","asset","frameName","urlToSpritesheetMap","convertToList","spriteSheet","overrideAssetLoad","onProgress","originalResult","returnValue","Spritesheet","Cache","newUrls","progressSize","u","mappedRes","warnings","deprecation","version","message","ignoreDepth","stack","window","undefined","LIBVERSION","EMPTY","UNKNOWN","FUNC_TYPE","UNDEF_TYPE","OBJ_TYPE","STR_TYPE","MAJOR","MODEL","NAME","TYPE","VENDOR","VERSION","ARCHITECTURE","CONSOLE","MOBILE","TABLET","SMARTTV","WEARABLE","EMBEDDED","UA_MAX_LENGTH","AMAZON","APPLE","ASUS","BLACKBERRY","BROWSER","CHROME","EDGE","FIREFOX","GOOGLE","HONOR","HUAWEI","LENOVO","LG","MICROSOFT","MOTOROLA","NVIDIA","ONEPLUS","OPERA","OPPO","SAMSUNG","SHARP","SONY","XIAOMI","ZEBRA","FACEBOOK","CHROMIUM_OS","MAC_OS","SUFFIX_BROWSER","extend","regexes","extensions","mergedRegexes","i","enumerize","arr","enums","has","str1","str2","lowerize","str","majorize","trim","len","rgxMapper","ua","arrays","j","q","matches","match","regex","props","strMapper","map","oldSafariMap","windowsVersionMap","UAParser","_navigator","_ua","_uach","_rgxmap","_isSelfNav","_browser","_cpu","_device","_engine","_os","module","exports","$","parser","prop","this","StorageType","StorageType2","autoDetectStorage","storage","isIPhone6","query","Device","isGalaxyS5","isKindle","isSafari18Dot4","major","minor","isSafari18","DeviceClass","funcs","cachedRes","splitMatches","tests","isVersion","query2","cacheType","test","userAgent","isMacOS","touchCheck","ResourcePlugin","utils.supported","paths","path","aliases","KeyBindingCollection","binding","list","index","KeyboardPlugin","e","bindings","allDownBindings","bind","action","singleKey","allowHold","currentHoldTime","dt","element","isDown","key2","TouchInput","source","enabled","bubble","autoDetectResolution","autoDetectAntialias","autoDetectTransparency","canvas","gl","debugInfo","transparent","sub","StagePlugin","Container","autoDetectRenderer","resizeDefault","h","ResizePlugin","Signal","stageView","parent","width2","height2","width","height","stage","originalDisplay","needsHiding","EventSystem","point","resolutionMultiplier","canvasWidth","canvasHeight","canvasStyleWidth","canvasStyleHeight","isPortrait","transformPoint","force","newOrientation","isCorrectOrientation","rendererWidth","rendererHeight","EmptyScreen","History","Bar","bg","frame","bar","mask","Graphics","Sprite","LoaderScreen","TransitionManager","transitionData","defaults","cleanedData","from","to","both","transition","rest","mapping","currentId","nextId","checkAndReturn","AlphaTransition","_container","current","_current","next","ScreenGroup","screenData","Class","async","lastScreen","nextScreen","omitFromHistory","previousInstance","screenSessionData","skipNavigationEntry","transitionOptions","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","loadingScreenDelay","applyLoaderAsOverlay","loaderOptions","loaderScreenClass","loadBeforeTransition","autoManageContainers","currentData","nextData","firstRun","isEmptyScreen","shouldRemoveScreen","loadPromise","loadComplete","loadBefore","_a2","_b2","vs","screen","LoaderScreenClass","loadCompleteCallback","timeoutId","manifests","screenPromises","manifestProgress","assetProgress","promiseProgress","totalProgress","preloadData","progress","promise","ScreensPlugin","layers","config2","layer","screenId","isClass","screenClass","screenOptions","isAsync","resizer","group","screens","aspectResize","minWidth","minHeight","fixCanvasSize","aspectRatio","scaleX","scaleY","scale","URLParams$1","BaseScreen","_options","_dt","_w","_Runner","argsLength","func","src","Runner","ID32","q1","q2","q3","q4","idValue","UIDs","_Entity","components","component","signals","staticComp","comp","Entity","Pool$1","ClassType","initialSize","total","PoolGroupClass","Pool","pool","object","PoolGroup","ctors","DefineEntity","Constructor","curr","entityClass","createEntity","entity","_View2DComponent","View2DComponent","Entity2D","Signals","signalName","Time","SmoothTime","deltaTime","Group","children","f","generateQueries","systemClass","system","queryName","queryConfig","queryComponents","Query","world","callbackfn","entityId","matchesComponents","matchesNotComponents","matchesOrComponents","ids","QueryManager","componentID","notComponentID","orComponentIDs","orNames","setID","orId","component2","Scene","rKey","entitiesToRemove","_View2DSystem","opts","startHook","RenderContainer","endHook","camera","zoom","sx","sy","ent","view","newLayer","depth","view2d","layerName","View2DSystem","Scene2D","entities","extendStatics","d2","b2","d3","b3","__extends","__","__assign","s2","n2","input2","output2","symbols","symbol","math_random","EPSILON","isFinite","nextPowerOfTwo","x2","isPowerOfTwo","mod","num","clamp","random","math","math_abs$9","math_sqrt$5","math_max$8","math_min$8","Vec2","Vec22","obj","v3","o","a2","m","invLength","lengthSqr","math_max$7","math_min$7","AABB","AABB2","lower","upper","lowerA","upperA","lowerB","upperB","lowerX","lowerY","upperX","upperY","aabb","out","d1x","d2x","d1y","d2y","wD","hD","wA","hA","wB","hB","tmin","tmax","absD","normal3","inv_d","t1","t2","temp3","lx","ly","ux","uy","math_PI$6","Settings","Settings2","SettingsInternal","SettingsInternal2","Pool2","math_abs$8","math_max$6","TreeNode","TreeNode2","poolTreeNode","node","DynamicTree","DynamicTree2","Iterator","iterator","userData","leaf","leafAABB","child1","child2","area","combinedArea","cost","inheritanceCost","newArea1","cost1","oldArea","newArea2","cost2","sibling","oldParent","newParent","grandParent","iA","A","B","C","balance","F","G","D","E","root","rootArea","totalArea","it","height1","maxBalance","nodes","minCost","iMin","jMin","aabbi","aabbj","parent_1","newOrigin","queryCallback","proceed","rayCastCallback","p1","p2","abs_v","maxFraction","segmentAABB","subInput","c2","separation","Iterator2","math_max$5","math_min$6","BroadPhase","BroadPhase2","_this","proxyId","proxyIdA","proxyIdB","userDataA","userDataB","aabbA","aabbB","displacement2","changed","addPairCallback","fatAABB","math_sin$2","math_cos$2","math_sqrt$4","vec2","rotation","setVec2","copyVec2","zeroVec2","negVec2","plusVec2","addVec2","minusVec2","subVec2","mulVec2","scaleVec2","plusScaleVec2","minusScaleVec2","combine2Vec2","am","bm","combine3Vec2","cm","normalizeVec2Length","normalizeVec2","crossVec2Num","crossNumVec2","crossVec2Vec2","dotVec2","lengthSqrVec2","distVec2","distSqrVec2","setRotAngle","rotVec2","derotVec2","rerotVec2","before","after","x0","y0","transform","copyTransform","transform2","transformVec2","xf2","detransformVec2","px","py","retransformVec2","detransformTransform","math_sin$1","math_cos$1","math_atan2$1","Rot","Rot2","rot","qr","math_atan2","math_PI$5","temp$7","Sweep","Sweep2","localCenter2","beta","a0","that","Transform","Transform2","position","rotation2","Velocity","Velocity2","math_sin","math_cos","Position","Position2","getTransform","Shape","Shape2","synchronize_aabb1","synchronize_aabb2","displacement","FixtureDefDefault","FixtureProxy","FixtureProxy2","fixture","childIndex","Fixture","Fixture2","body","shape","def","childCount","broadPhase","restore","sensor","density","friction","restitution","massData","proxy","xf1","filter","groupIndex","categoryBits","maskBits","edge","contact","fixtureA","fixtureB","collideA","collideB","collide","STATIC","KINEMATIC","DYNAMIC","oldCenter","localCenter","shift","temp$6","xf$2","BodyDefDefault","Body","Body2","fixtures","ce","ce0","flag","worldPoint","localPoint","linearDamping","angularDamping","point2","wake","torque","impulse","jn","fixdef","localVector","worldVector","JointEdge","JointEdge2","Joint","Joint2","bodyA","bodyB","time","Timer","math_max$4","temp$5","normal$4","e12","e13","e23","temp1","temp2","DistanceInput","DistanceInput2","DistanceProxy","DistanceOutput","DistanceOutput2","SimplexCache","SimplexCache2","Distance","cache2","proxyA","proxyB","xfA2","xfB2","simplex","vertices","k_maxIters","saveA","saveB","saveCount","iter","vertex","duplicate","rA2","rB2","DistanceProxy2","bestIndex","bestValue","radius","SimplexVertex","SimplexVertex2","searchDirection_reuse","closestPoint_reuse","Simplex","Simplex2","transformA","transformB","wALocal","wBLocal","metric1","metric2","v13","v22","sgn","pA2","pB2","w1","w2","d12_2","d12_1","inv_d12","w3","w1e12","w2e12","w1e13","w3e13","d13_1","d13_2","w2e23","w3e23","d23_1","d23_2","n123","d123_1","d123_2","d123_3","inv_d13","inv_d23","inv_d123","input$1","cache$1","output$1","testOverlap","shapeA","indexA","shapeB","indexB","ShapeCastInput2","math_abs$7","math_max$3","TOIInput","TOIInput2","TOIOutputState","TOIOutputState2","TOIOutput","TOIOutput2","distanceInput","distanceOutput","cache","xfA$1","xfB$1","temp$4","pointA$2","pointB$2","normal$3","axisA","axisB","localPointA","localPointB","TimeOfImpact","timer","sweepA","sweepB","tMax","totalRadius","target","tolerance","k_maxIterations","separationFunction","done","pushBackIter","s1","rootIterCount","a1","s3","SeparationFunctionType","SeparationFunctionType2","SeparationFunction","SeparationFunction2","localPointA_1","localPointB_1","localPointB1","localPointB2","localPointA_2","pointA_1","localPointA1","localPointA2","localPointB_2","find","sep","math_abs$6","math_sqrt$3","math_min$5","TimeStep","TimeStep2","s_subStep","translation","input","output","backup","backup1","backup2","ContactImpulse","ContactImpulse2","normals","tangents","Solver","Solver2","joint","c_1","seed","sensorA","sensorB","other","je","gravity","allowSleep","translationLengthSqr","positionSolved","minSeparation","contactsOkay","jointsOkay","jointOkay","minSleepTime","linTolSqr","angTolSqr","c_2","minContact","minAlpha","c_3","fA_1","fB_1","bA_1","bB_1","activeA","activeB","alpha0","fA","fB","bA","bB","bodies","subStep","toiA","toiB","c_5","Mat22","Mat222","det","imx","mx","c1","mx1","mx2","math_sqrt$2","pointA$1","pointB$1","temp$3","cA$1","cB$1","dist","planePoint$2","clipPoint$1","ManifoldType","ManifoldType2","ContactFeatureType","ContactFeatureType2","PointState","PointState2","ClipVertex","ClipVertex2","ContactID","Manifold","Manifold2","ManifoldPoint","wm","radiusA","radiusB","WorldManifold","points","separations","manifoldPoint","length_1","clipSegmentToLine","getPointStates","ManifoldPoint2","ContactID2","typeA","typeB","WorldManifold2","state1","state2","manifold1","manifold2","vOut","vIn","vertexIndexA","numOut","distance0","distance1","interp","math_sqrt$1","math_max$2","math_min$4","contactPool","Contact","oldManifold","worldManifold","ContactEdge","ContactEdge2","mixFriction","friction1","friction2","mixRestitution","restitution1","restitution2","s_registers","VelocityConstraintPoint","VelocityConstraintPoint2","cA","vA","cB","vB","tangent$1","xfA","xfB","pointA","pointB","clipPoint","planePoint$1","rA","rB","P$1","normal$2","dv","dv1","dv2","P1","P2","temp$2","Contact2","evaluateFcn","point_1","point_2","manifold","pointCount","cp","vcp","worldManifold2","speed","listener","touching","wasTouching","nmp","omp","hasListener","toi","positionA","positionB","localCenterA","localCenterB","mA","mB","iB","aA","aB","baumgarte","linearSlop","maxLinearCorrection","rnA","rnB","K","velocityA","velocityB","wmp","kNormal","rtA","rtB","kTangent","vRel","vcp1","vcp2","rn1A","rn1B","rn2A","rn2B","k11","k22","k12","k_maxConditionNumber","a_1","b_1","d_1","vt","lambda","maxFriction","newImpulse","vn","vn1","vn2","type1","type2","callback","DEFAULTS$b","World","World2","joints","context","point1","hit","fraction","point3","arg1","arg2","je0","f0","timeStep","velocityIterations","positionIterations","next_c","overlap","listeners","arg3","l","oldManifold2","Vec3","Vec32","z","v1$2","v2$1","EdgeShape","_super","EdgeShape2","v122","clone","e3","numerator","denominator","rr","v1$1","ChainShape","ChainShape2","loop","prevVertex","nextVertex","edgeShape","math_max$1","math_min$3","temp$1","e$1","e1$1","e2$1","PolygonShape","PolygonShape2","ps","unique","i0","hull","ih","ie2","i1","i2","computeCentroid","hx","hy","center2","pLocal","dot","minX","minY","maxX","maxY","I","k_inv3","triangleArea","ex1","ey1","ex2","ey2","intx2","inty2","pRef","inv3","p3","e1_1","e2_1","math_sqrt","math_PI$4","temp","CircleShape","CircleShape2","sigma","math_abs$5","math_PI$3","DEFAULTS$a","DistanceJoint","DistanceJoint2","anchorA","anchorB","inv_dt","cA2","vA2","cB2","vB2","qA","qB","crAu","crBu","invMass","omega","P3","vpA","vpB","Cdot","DEFAULTS$9","FrictionJoint","FrictionJoint2","anchor","oldImpulse","maxImpulse","Mat33","Mat332","cross_x","cross_y","cross_z","a11","a12","a21","a22","M","a13","a23","a33","math_abs$4","LimitState$2","LimitState2","DEFAULTS$8","RevoluteJoint","RevoluteJoint2","fixedRotation","jointAngle","Cdot1","Cdot2","rhs","reduced","angularError","positionError","limitImpulse","math_abs$3","math_max","math_min$2","LimitState$1","DEFAULTS$7","PrismaticJoint","PrismaticJoint2","axis","translation2","k13","k23","k33","jointTranslation","LA","LB","f1","df","f2r","perp2","C1","linearError","active","C2","impulse1","DEFAULTS$6","GearJoint","GearJoint2","joint1","joint2","coordinateA","coordinateB","xfC","aC","revolute","prismatic","pC","xfD","aD","pD","L","vC","wC","vD","qC","qD","rC","rD","cC","cD","JvAC","JvBD","JwA","JwB","JwC","JwD","mass","DEFAULTS$5","MotorJoint","MotorJoint2","factor","linearOffset","angularOffset","inv_h","math_PI$2","DEFAULTS$4","MouseJoint","MouseJoint2","velocity","math_abs$2","DEFAULTS$3","PulleyJoint","PulleyJoint2","groundA","groundB","lengthA","lengthB","ruA","ruB","PA","PB","uA","uB","math_min$1","LimitState","DEFAULTS$2","RopeJoint","RopeJoint2","crA","crB","math_abs$1","math_PI$1","DEFAULTS$1","WeldJoint","WeldJoint2","invM","impulse2","math_abs","math_PI","DEFAULTS","WheelJoint","WheelJoint2","damp","ay","sAy","sBy","SID","SERIALIZE_REF_TYPES","DESERIALIZE_BY_REF_TYPE","DESERIALIZE_BY_TYPE_FIELD","DEFAULT_OPTIONS","Serializer","Serializer2","options2","preSerialize","postSerialize","json","refQueue","refMemoById","addToRefQueue","typeName","ref","serializeWithHooks","obj2","traverse","noRefType","newValue","preDeserialize","postDeserialize","rootClass","deserializedRefMemoByIndex","deserializeWithHooks","classHint","deserializer","classDeserializeFn","deserializeChild","dataOrRef","isRefObject","refIndex","worldSerializer","Testbed2","testbed2","BoxShape","BoxShape2","halfWidth","halfHeight","CircleCircleContact","CollideCircles","pA","pB","circleA","circleB","distSqr","EdgeCircleContact","ChainCircleContact","CollideEdgeCircle","chain","e1","e2","Q","P","n$2","edgeA","dd_1","A1","B1","u1","dd_2","B2","A2","den","dd","incidentEdge","clipPoints1$1","clipPoints2$1","clipSegmentToLineNormal","n$1","xf$1","v11","v12","localTangent","localNormal","planePoint","tangent","normal$1","normal1$1","PolygonContact","CollidePolygons","findMaxSeparation","poly1","poly2","count1","count2","n1s","v1s","v2s","maxSeparation2","si","sij","findIncidentEdge","clipVertex","edge12","normals1","vertices2","normals2","minDot","maxSeparation","polyA","polyB","separationA","edgeB","separationB","flip","k_tol","vertices1","iv1","iv2","frontOffset","sideOffset1","sideOffset2","np1","np2","PolygonCircleContact","CollidePolygonCircle","cLocal","faceCenter","polygonA","normalIndex","vertexCount","vertIndex1","vertIndex2","u2","separation_1","math_min","EdgePolygonContact","ChainPolygonContact","CollideEdgePolygon","edge_reuse","EPAxisType","EPAxisType2","VertexType","VertexType2","EPAxis","EPAxis2","TempPolygon","TempPolygon2","ReferenceFace","ReferenceFace2","clipPoints1","clipPoints2","ie","edgeAxis","polygonAxis","polygonBA","rf","centroidB","edge0","edge1","edge2","xf","normal","normal0","normal1","normal2","lowerLimit","upperLimit","perp","n","polygonB","v0","hasVertex0","hasVertex3","offset1","offset0","offset2","convex1","convex2","front","v4","s22","k_relativeTol","k_absoluteTol","primaryAxis","DataDriver2","PHYSICS_CONFIG","BOUNDARY_CATEGORY","ALL_PARTS_MASK","getLayerCategory","PhysicsWorldManager","gravityMeters","isStatic","dims","layerCategory","Box","entityUid","bodyId","deltaMs","pos","playArea","boundaryThickness","thickness","parts","registerPart","part","getPart","hasPart","simplePlate","slidingCover","boardWalnutSquare","boardOakHorizontal","boardOakVertical","boardBirchSquare","boardMahoganySquare","boardPineHorizontal","SCREW_RADIUS","isCircleInBox","box","isPointInPolygon","polygon","inside","pi","pj","isCircleInPolygon","isScrewInBounds","screwPosition","collision","PLAY_AREA","localToWorld","localPosition","isPartInPlayArea","leftEdge","rightEdge","topEdge","bottomEdge","getPartBoundsInfo","validateScrewPlacement","screw","partInstance","screwIndex","partIndex","partDef","boundsDesc","getPartDimensions","partId","xs","ys","formatExceededBounds","info","validatePartPlayAreaBounds","boundsInfo","exceeded","validatePartInstance","errors","boundsError","usedPositions","screwError","posKey","msg","validateTrayCapacities","level","tray","validateLevelParts","layerCounts","partResult","validateWinCondition","targetPartIndex","validateLevel","partsResult","appendLevelResults","levelResult","error","warning","validateRegionLevelContents","region","levelIds","validateRegion","levelContents","loadRegion","response","errorMessages","getLevelByIndex","ScrewColor","defineComponent","ComponentImpl","ScrewComponent","PartComponent","PhysicsBodyComponent","TrayComponent","BufferTrayComponent","GameStateComponent","ScrewEntity","PartEntity","TrayEntity","BufferTrayEntity","gameVisualRegistry","getGameVisual","SHORT_SCREW_ASSET_MAP","LONG_SCREW_ASSET_MAP","TRAY_ASSET_MAP","PLACEHOLDER_ASSET_MAP","TRAY_WIDTH","PLACEHOLDER_DISPLAY_WIDTH","PLACEHOLDER_SPACING","PLACEHOLDER_Y","placeholderRegistry","getTrayPlaceholders","createScrewEntity","assetAlias","sprite","createPartEntity","createPartEntityBase","setupPartSprite","attachPhysicsBody","createTrayEntity","capacity","displayOrder","trayTexture","placeholderTexture","loadTrayTextures","createTrayEntityWithComponent","setupTraySprite","setupPlaceholders","color","traySprite","placeholders","totalWidth","startX","placeholder","createBufferTrayEntity","GameStateEntity","BaseSystem","_typeHint","TRAY_FRAME_LAYOUT","getSlotWorldPosition","slotIndex","getCoverPositionForBucket","BUFFER_TRAY_LAYOUT","TRAY_DISPLAY_POSITIONS","_","TRAY_HIDDEN_Y","TRAY_SPAWN_X","SLOT_DISPLAY_WIDTH","COLORED_TRAY_SLOT_SPACING","COLORED_TRAY_Y_OFFSET","getTraySlotPosition","trayEntity","isBuffer","trayCapacity","slot","fallbackSlot","getTraySlotTargetPosition","trayPosition","GameEventBus","handler","handlers","gameEvents","animationLayer","coloredTrayLayer","registerAnimationLayer","registerColoredTrayLayer","getAnimationLayer","getColoredTrayLayer","clearLayerRegistry","GAME_LAYOUT","currentTick","loggingEnabled","gameTick","category","TrayManagementSystem","screwComponent","trayEntityId","trayComponent","inFlightToThisTray","trayUID","uid","fullTray","fullTrayComponent","sortedTrays","nextHiddenTray","traysToShift","aOrder","bOrder","trayComp","currentDisplayOrder","shiftPromises","revealPromise","allPromises","newOrder","nextComp","newDisplayOrder","eventName","_time","ScrewPlacementSystem","animating","busy","coloredTarget","bufferTarget","bufferTray","buffer","inBuffer","inFlight","bufferUid","matchingTray","screwEntity","coloredTrays","screws","trayUid","inFlightCount","ScrewInteractionSystem","placementSystem","bufferFull","traysAnimating","traysBusy","entity2d","trayColor","gameStateEntity","TRAY_SLOT_SCALE","BUFFER_SLOT_SCALE","POP_OUT_HEIGHT","POP_OUT_SCALE","REMOVAL_ARC_HEIGHT","TRANSFER_ARC_HEIGHT","bezierPosition","p0","invT","AnimatorBase","ctx","timeline","params","updatePosition","ScrewRemovalAnimator","targetTray","screwEntity2D","visual","startPos","targetPos","endScale","longTexture","start","end","arcHeight","flightStartY","expected","dX","dY","ScrewTransferAnimator","TrayHideAnimator","entity2D","screwsInTray","trayView","screwVisual","localX","localY","TrayShiftAnimator","deltaX","targetX","screw2D","TrayRevealAnimator","AnimationSystem","AutoTransferSystem","transferring","screwIds","screwId","screwUid","bufferIndex","WinConditionSystem","gameState","winType","setupErrorCapture","reason","getTestParams","seedParam","levelParam","isTestMode","SKIP_PROPERTIES","UID_REF_PROPERTIES","shouldSkipProperty","extractPropertyValue","nested","serializeObjectValue","include","extractUid","serializeComponent","extractComponents","getEntityBounds","serializeEntity","getAllEntities","sceneRef","getSystemNames","scene","createECSAccess","getEntities","getEntity","frameCounter","simpleHash","hash","char","entityToHashString","vis","componentsStr","createRenderSignatureGenerator","getSceneState","getSystems","timestamp","currentFrame","sortedEntities","aId","bId","hashInput","MAX_RECORDED_ACTIONS","recordedActions","recordAction","tick","entry","getRecordedActions","findEntity","targetId","getEntityComponent","componentName","executeSetPosition","executeSetComponent","executeSetVisible","visible","executeDestroyEntity","executePause","executeResume","executeTick","executePointerEvent","eventType","button","rect","screenX","screenY","executeKeyEvent","code","dispatchEntityAction","dispatchPointerAction","dispatchInputAction","pointerResult","dispatchAction","getScene","getCanvas","entityResult","inputResult","createActionExecutor","err","createPhysicsAccess","MAX_LOGS","capturedLogs","originalConsole","isInitialized","safeStringify","getCurrentTick","addLog","initConsoleCapture","getCapturedLogs","clearCapturedLogs","getOriginalConsole","getPixiRenderer","getApp","__vitePreload","bootstrap$1","getPixiStage","captureScreenshot","snapshotDisplayObject","displayObject","maxDepth","snapshot","tex","child","childSnapshot","countDisplayObjects","captureRenderState","displayTree","sceneState","sig","renderState","collectBugReport","description","screenshot","consoleLogs","userActions","report","submitBugReport","currentModal","createModalOverlay","overlay","createModalContent","content","createModalTitle","title","createDescriptionTextarea","textarea","createButton","text","isPrimary","createButtonContainer","container","createStatusMessage","status","showStatus","isError","closeModal","showBugReportModal","buttonContainer","cancelButton","submitButton","statusMessage","STORAGE_KEY","DEFAULT_WIDTH","DEFAULT_HEIGHT","HEADER_HEIGHT","FOOTER_HEIGHT","loadState","saved","saveState","createContainer","createHeader","header","createHeaderTitle","createHeaderButtons","buttons","createHeaderButton","onClick","createLogArea","logArea","createFooter","footer","createFooterButton","createLogLine","line","prefix","setupDragging","isDragging","dragOffsetX","dragOffsetY","startDrag","clientX","clientY","moveDrag","newX","newY","endDrag","touch","setupKeyboardShortcut","createLogDisplayManager","logLines","setupConsoleIntegration","logManager","original","prevLog","prevWarn","prevError","createDebugConsole","headerTitle","headerButtons","minimizeBtn","closeBtn","copyBtn","originalText","clearBtn","reportBtn","tickCounterRef","createTickAccess","registerTickCounter","createActionMethods","executeAction","act","actions","results","createSnapshotMethods","createLifecycleMethods","ecsAccess","sceneName","sceneInstance","defineStateGetters","harness","createInitialState","createHarness","initTestHarness","markGameReady","TickSystem","FALL_DELAY_MS","PartStateSystem","timeout","partEntity","FADE_DISTANCE","DESTROY_Y_THRESHOLD","PhysicsSystem","physicsBody","baseEntity","currentY","fadeStartY","fadeProgress","wasSleeping","isSleeping","GameScene","entityContainer","bgTexture","background","puzzleBase","coverTexture","coverPos","cover","frameTexture","trayConfigs","isVisible","displayPosition","regionPath","levelIndex","totalScrews","sum","sortedParts","partWorldPosition","partWidth","partHeight","screwWorldPosition","partIds","bundleName","_deltaTime","GameScreen","APP_CONFIG","bootstrap","configurePlugins","mountToDOM","showInitialScreen","application","debugConsole","main","appDiv"],"ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],"sources":["../../node_modules/@play-co/commons/dist/maths/Math.mjs","../../node_modules/@play-co/commons/dist/maths/vector/Vector2.mjs","../../node_modules/@play-co/commons/dist/time/throttle.mjs","../../node_modules/@play-co/commons/dist/utils/Lock.mjs","../../node_modules/@play-co/commons/dist/utils/NakedPromise.mjs","../../node_modules/@play-co/commons/dist/url/URLParams.mjs","../../node_modules/@play-co/astro/dist/utils/system/time/limitFPS.mjs","../../node_modules/@play-co/astro/dist/core/app/Prioritiser.mjs","../../node_modules/@play-co/astro/dist/utils/runners/promiseRunner.mjs","../../node_modules/@play-co/astro/dist/utils/system/monitor/AssetMonitor.mjs","../../node_modules/@play-co/astro/dist/utils/system/monitor/FPSMonitor.mjs","../../node_modules/@play-co/astro/dist/utils/system/monitor/GPUMonitor.mjs","../../node_modules/@play-co/astro/dist/utils/system/monitor/PerformanceTracker.mjs","../../node_modules/@play-co/astro/dist/core/app/Application.mjs","../../node_modules/@play-co/astro/dist/core/app/Plugin.mjs","../../node_modules/@play-co/astro/dist/core/asset/utils/formatTextures.mjs","../../node_modules/@play-co/astro/dist/core/asset/plugins/loadTexture.mjs","../../node_modules/@play-co/astro/dist/core/asset/plugins/loadWebFont.mjs","../../node_modules/@play-co/astro/dist/core/asset/plugins/spineParser.mjs","../../node_modules/@play-co/astro/dist/core/asset/overrideAssetLoad.mjs","../../node_modules/@play-co/astro/dist/utils/logging/deprecation.mjs","../../node_modules/ua-parser-js/src/ua-parser.js","../../node_modules/@play-co/astro/dist/utils/system/detections/autoDetectStorage.mjs","../../node_modules/@play-co/astro/dist/utils/system/devices/deviceQueries.mjs","../../node_modules/@play-co/astro/dist/utils/system/devices/Device.mjs","../../node_modules/@play-co/astro/dist/core/asset/ResourcePlugin.mjs","../../node_modules/@play-co/astro/dist/input/KeyboardPlugin.mjs","../../node_modules/@play-co/astro/dist/input/touch/TouchInput.mjs","../../node_modules/@play-co/astro/dist/utils/system/detections/autoDetectResolution.mjs","../../node_modules/@play-co/astro/dist/utils/system/detections/autoDetectAntialias.mjs","../../node_modules/@play-co/astro/dist/utils/system/detections/autoDetectTransparency.mjs","../../node_modules/@play-co/astro/dist/stage/StagePlugin.mjs","../../node_modules/@play-co/astro/dist/stage/resize/resizeDefault.mjs","../../node_modules/@play-co/astro/dist/stage/resize/ResizePlugin.mjs","../../node_modules/@play-co/astro/dist/screens/EmptyScreen.mjs","../../node_modules/@play-co/astro/dist/screens/History.mjs","../../node_modules/@play-co/astro/dist/screens/temp-ui/Bar.mjs","../../node_modules/@play-co/astro/dist/screens/loader/LoaderScreen.mjs","../../node_modules/@play-co/astro/dist/screens/TransitionManager.mjs","../../node_modules/@play-co/astro/dist/screens/transitions/AlphaTransition.mjs","../../node_modules/@play-co/astro/dist/screens/ScreenGroup.mjs","../../node_modules/@play-co/astro/dist/screens/ScreensPlugin.mjs","../../node_modules/@play-co/astro/dist/stage/resize/gameResize.mjs","../../node_modules/@play-co/astro/dist/index.mjs","../../src/ui/screens/BaseScreen.ts","../../node_modules/@play-co/odie/dist/utils/Runner.mjs","../../node_modules/@play-co/odie/dist/core/queries/ID32.mjs","../../node_modules/@play-co/odie/dist/core/Entity.mjs","../../node_modules/@play-co/odie/dist/core/pool/Pool.mjs","../../node_modules/@play-co/odie/dist/core/pool/PoolGroup.mjs","../../node_modules/@play-co/odie/dist/core/EntityUtils.mjs","../../node_modules/@play-co/odie/dist/2d/core/view/View2DComponent.mjs","../../node_modules/@play-co/odie/dist/2d/core/Entity2D.mjs","../../node_modules/@play-co/odie/dist/utils/Signals.mjs","../../node_modules/@play-co/odie/dist/utils/Time.mjs","../../node_modules/@play-co/odie/dist/utils/SmoothTime.mjs","../../node_modules/@play-co/odie/dist/core/groups/Group.mjs","../../node_modules/@play-co/odie/dist/core/queries/QueryHelpers.mjs","../../node_modules/@play-co/odie/dist/core/queries/Query.mjs","../../node_modules/@play-co/odie/dist/core/queries/QueryManager.mjs","../../node_modules/@play-co/odie/dist/core/Scene.mjs","../../node_modules/@play-co/odie/dist/2d/core/view/View2DSystem.mjs","../../node_modules/@play-co/odie/dist/2d/core/Scene2D.mjs","../../node_modules/planck/dist/planck.mjs","../../src/physics/PhysicsConfig.ts","../../src/physics/PhysicsWorldManager.ts","../../src/shared/parts/registry.ts","../../src/shared/parts/definitions/simple-plate.ts","../../src/shared/parts/definitions/sliding-cover.ts","../../src/shared/parts/definitions/board-walnut-square.ts","../../src/shared/parts/definitions/board-oak-horizontal.ts","../../src/shared/parts/definitions/board-oak-vertical.ts","../../src/shared/parts/definitions/board-birch-square.ts","../../src/shared/parts/definitions/board-mahogany-square.ts","../../src/shared/parts/definitions/board-pine-horizontal.ts","../../src/shared/utils/geometry.ts","../../src/shared/utils/playArea.ts","../../src/shared/levels/loader.ts","../../src/shared/types/parts.types.ts","../../src/shared/ecs/defineComponent.ts","../../src/scenes/game/components/ScrewComponent.ts","../../src/scenes/game/components/PartComponent.ts","../../src/scenes/game/components/PhysicsBodyComponent.ts","../../src/scenes/game/components/TrayComponent.ts","../../src/scenes/game/components/BufferTrayComponent.ts","../../src/scenes/game/components/GameStateComponent.ts","../../src/scenes/game/entities/ScrewEntity.ts","../../src/scenes/game/entities/PartEntity.ts","../../src/scenes/game/entities/TrayEntity.ts","../../src/scenes/game/entities/BufferTrayEntity.ts","../../src/scenes/game/factories/game-factories.ts","../../src/scenes/game/entities/GameStateEntity.ts","../../src/scenes/game/systems/BaseSystem.ts","../../src/scenes/game/utils/trayFrameLayout.ts","../../src/scenes/game/utils/bufferTrayLayout.ts","../../src/scenes/game/utils/trayPositions.ts","../../src/scenes/game/utils/GameEventBus.ts","../../src/scenes/game/utils/layerRegistry.ts","../../src/scenes/game/utils/gameLayout.ts","../../src/scenes/game/utils/GameTick.ts","../../src/scenes/game/systems/TrayManagementSystem.ts","../../src/scenes/game/systems/ScrewPlacementSystem.ts","../../src/scenes/game/systems/ScrewInteractionSystem.ts","../../src/scenes/game/systems/animation/types.ts","../../src/scenes/game/systems/animation/bezier.ts","../../src/scenes/game/systems/animation/AnimatorBase.ts","../../src/scenes/game/systems/animation/ScrewRemovalAnimator.ts","../../src/scenes/game/systems/animation/ScrewTransferAnimator.ts","../../src/scenes/game/systems/animation/TrayHideAnimator.ts","../../src/scenes/game/systems/animation/TrayShiftAnimator.ts","../../src/scenes/game/systems/animation/TrayRevealAnimator.ts","../../src/scenes/game/systems/AnimationSystem.ts","../../src/scenes/game/systems/AutoTransferSystem.ts","../../src/scenes/game/systems/WinConditionSystem.ts","../../src/shared/debug/errorCapture.ts","../../src/shared/debug/urlParams.ts","../../src/shared/debug/harness/ecsAccess.ts","../../src/shared/debug/harness/renderSignature.ts","../../src/shared/debug/harness/actionDsl.ts","../../src/shared/debug/harness/physicsAccess.ts","../../src/shared/debug/consoleCapture.ts","../../src/shared/debug/bugReport.ts","../../src/shared/debug/ui/debugConsole.ts","../../src/shared/debug/index.ts","../../src/scenes/game/systems/TickSystem.ts","../../src/scenes/game/systems/PartStateSystem.ts","../../src/scenes/game/systems/PhysicsSystem.ts","../../src/scenes/game/GameScene.ts","../../src/ui/screens/GameScreen.ts","../../src/app/config.ts","../../src/app/bootstrap.ts","../../src/main.ts"],"sourcesContent":["function clamp(value, min, max) {\n  return Math.max(min, Math.min(max, value));\n}\nfunction euclideanModulo(n, m) {\n  return (n % m + m) % m;\n}\nfunction mapLinear(x, a1, a2, b1, b2) {\n  return b1 + (x - a1) * (b2 - b1) / (a2 - a1);\n}\nfunction lerp(x, y, t) {\n  return (1 - t) * x + t * y;\n}\nfunction smoothstep(x, min, max) {\n  if (x <= min)\n    return 0;\n  if (x >= max)\n    return 1;\n  x = (x - min) / (max - min);\n  return x * x * (3 - 2 * x);\n}\nfunction smootherstep(x, min, max) {\n  if (x <= min)\n    return 0;\n  if (x >= max)\n    return 1;\n  x = (x - min) / (max - min);\n  return x * x * x * (x * (x * 6 - 15) + 10);\n}\nfunction smallestAngle(angle, targetAngle) {\n  angle %= Math.PI * 2;\n  if (angle < 0)\n    angle += Math.PI * 2;\n  const difference1 = targetAngle - angle;\n  const difference2 = targetAngle + Math.PI * 2 - angle;\n  const difference3 = targetAngle - Math.PI * 2 - angle;\n  const absDifference1 = Math.abs(difference1);\n  const absDifference2 = Math.abs(difference2);\n  const absDifference3 = Math.abs(difference3);\n  let difference = difference1;\n  if (absDifference2 < absDifference1 && absDifference2 < absDifference3) {\n    difference = difference2;\n  } else if (absDifference3 < absDifference1 && absDifference3 < absDifference2) {\n    difference = difference3;\n  }\n  return difference;\n}\nfunction round(value, precision) {\n  const multiplier = Math.pow(10, precision || 0);\n  return Math.round(value * multiplier) / multiplier;\n}\nfunction floor(value, precision) {\n  const multiplier = Math.pow(10, precision || 0);\n  return Math.floor(value * multiplier) / multiplier;\n}\nfunction containRange(value, bounds) {\n  if (value > bounds)\n    return value - bounds;\n  if (value < 0)\n    return value + bounds;\n  return value;\n}\nfunction containAngle(radians) {\n  return euclideanModulo(radians, Math.PI * 2);\n}\nfunction rotatePoint(point, angle) {\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  const x = cos * point.x - sin * point.y;\n  const y = cos * point.y + sin * point.x;\n  point.x = x;\n  point.y = y;\n}\nfunction aabbIntersect(rect1, rect2) {\n  return rect1.x < rect2.x + rect2.width && rect1.x + rect1.width > rect2.x && rect1.y < rect2.y + rect2.height && rect1.y + rect1.height > rect2.y;\n}\nfunction nextPow2(v) {\n  v += v === 0 ? 1 : 0;\n  --v;\n  v |= v >>> 1;\n  v |= v >>> 2;\n  v |= v >>> 4;\n  v |= v >>> 8;\n  v |= v >>> 16;\n  return v + 1;\n}\nfunction log2(v) {\n  let r = (v > 65535 ? 1 : 0) << 4;\n  v >>>= r;\n  let shift = (v > 255 ? 1 : 0) << 3;\n  v >>>= shift;\n  r |= shift;\n  shift = (v > 15 ? 1 : 0) << 2;\n  v >>>= shift;\n  r |= shift;\n  shift = (v > 3 ? 1 : 0) << 1;\n  v >>>= shift;\n  r |= shift;\n  return r | v >> 1;\n}\nexport {\n  aabbIntersect,\n  clamp,\n  containAngle,\n  containRange,\n  euclideanModulo,\n  floor,\n  lerp,\n  log2,\n  mapLinear,\n  nextPow2,\n  rotatePoint,\n  round,\n  smallestAngle,\n  smootherstep,\n  smoothstep\n};\n//# sourceMappingURL=Math.mjs.map\n","class Vector2 {\n  /**\n   * Constructs a new Vector2 with the given x and y coordinates. If no arguments are provided, the vector is initialized to (0, 0).\n   *\n   * @param x The x coordinate. Defaults to 0.\n   * @param y The y coordinate. Defaults to 0.\n   */\n  constructor(x, y) {\n    this.x = x || 0;\n    this.y = y || 0;\n  }\n  /**\n   * Gets the width component of the vector, which is equivalent to its x coordinate.\n   */\n  get width() {\n    return this.x;\n  }\n  /**\n   * Sets the width component of the vector, which is equivalent to its x coordinate.\n   */\n  set width(value) {\n    this.x = value;\n  }\n  /**\n   * Gets the height component of the vector, which is equivalent to its y coordinate.\n   */\n  get height() {\n    return this.y;\n  }\n  /**\n   * Sets the height component of the vector, which is equivalent to its y coordinate.\n   */\n  set height(value) {\n    this.y = value;\n  }\n  /**\n   * Sets both the x and y coordinates of the vector to the given scalar.\n   *\n   * @param scalar The scalar to set both coordinates to.\n   * @returns This vector after setting the new coordinates.\n   */\n  setScalar(scalar) {\n    this.x = scalar;\n    this.y = scalar;\n    return this;\n  }\n  /**\n   * Sets the x and y coordinates of the vector.\n   *\n   * @param x The new x coordinate.\n   * @param y The new y coordinate.\n   * @returns This vector after setting the new coordinates.\n   */\n  set(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  }\n  /**\n   * Creates a new Vector2 with the same x and y coordinates as this one.\n   *\n   * @returns A new Vector2 with the same coordinates as this one.\n   */\n  clone() {\n    return new Vector2(this.x, this.y);\n  }\n  /**\n   * Copies the x and y coordinates from another vector to this one.\n   *\n   * @param v The vector to copy coordinates from.\n   * @returns This vector after copying the coordinates.\n   */\n  copy(v) {\n    this.x = v.x;\n    this.y = v.y;\n    return this;\n  }\n  /**\n   * Adds the x and y coordinates of another vector to this one.\n   *\n   * @param v The vector to add to this one.\n   * @returns This vector after adding the other vector's coordinates.\n   */\n  add(v) {\n    this.x += v.x;\n    this.y += v.y;\n    return this;\n  }\n  /**\n   * Adds a scalar to both the x and y coordinates of this vector.\n   *\n   * @param scalar The scalar to add.\n   * @returns This vector after adding the scalar.\n   */\n  addScalar(s) {\n    this.x += s;\n    this.y += s;\n    return this;\n  }\n  /**\n   * Adds the x and y coordinates of two other vectors to this one.\n   *\n   * @param v1 The first vector to add.\n   * @param v2 The second vector to add.\n   * @returns This vector after adding the other vectors' coordinates.\n   */\n  addVectors(a, b) {\n    this.x = a.x + b.x;\n    this.y = a.y + b.y;\n    return this;\n  }\n  /**\n   * Adds a scaled version of another vector to this one.\n   *\n   * @param v The vector to scale and add.\n   * @param scale The amount to scale the other vector by.\n   * @returns This vector after adding the scaled vector.\n   */\n  addScaledVector(v, s) {\n    this.x += v.x * s;\n    this.y += v.y * s;\n    return this;\n  }\n  /**\n   * Subtracts the x and y coordinates of another vector from this one.\n   *\n   * @param v The vector to subtract.\n   * @returns This vector after subtracting the other vector's coordinates.\n   */\n  sub(v) {\n    this.x -= v.x;\n    this.y -= v.y;\n    return this;\n  }\n  /**\n   * Subtracts a scalar from both the x and y coordinates of this vector.\n   *\n   * @param scalar The scalar to subtract.\n   * @returns This vector after subtracting the scalar.\n   */\n  subScalar(s) {\n    this.x -= s;\n    this.y -= s;\n    return this;\n  }\n  /**\n   * Subtracts the x and y coordinates of the second vector from the first one and sets the result to this vector.\n   *\n   * @param a The vector to subtract from.\n   * @param b The vector to subtract.\n   * @returns This vector after subtracting the second vector's coordinates from the first one.\n   */\n  subVectors(a, b) {\n    this.x = a.x - b.x;\n    this.y = a.y - b.y;\n    return this;\n  }\n  /**\n   * Multiplies the x and y coordinates of this vector by the corresponding coordinates of another vector.\n   *\n   * @param v The vector to multiply by.\n   * @returns This vector after multiplying by the other vector's coordinates.\n   */\n  multiply(v) {\n    this.x *= v.x;\n    this.y *= v.y;\n    return this;\n  }\n  /**\n   * Multiplies the x and y coordinates of this vector by a scalar.\n   *\n   * @param scalar The scalar to multiply by.\n   * @returns This vector after multiplying by the scalar.\n   */\n  multiplyScalar(scalar) {\n    this.x *= scalar;\n    this.y *= scalar;\n    return this;\n  }\n  /**\n   * Divides the x and y coordinates of this vector by the corresponding coordinates of another vector.\n   *\n   * @param v The vector to divide by.\n   * @returns This vector after dividing by the other vector's coordinates.\n   */\n  divide(v) {\n    this.x /= v.x;\n    this.y /= v.y;\n    return this;\n  }\n  /**\n   * Divides the x and y coordinates of this vector by a scalar.\n   *\n   * @param scalar The scalar to divide by.\n   * @returns This vector after dividing by the scalar.\n   */\n  divideScalar(scalar) {\n    return this.multiplyScalar(1 / scalar);\n  }\n  /**\n   * Sets each component of this vector to be the minimum of its current value and the value of the same component in the given vector.\n   *\n   * @param v The vector to compare with.\n   * @returns This vector after applying the operation.\n   */\n  min(v) {\n    this.x = Math.min(this.x, v.x);\n    this.y = Math.min(this.y, v.y);\n    return this;\n  }\n  /**\n   * Sets each component of this vector to be the maximum of its current value and the value of the same component in the given vector.\n   *\n   * @param v The vector to compare with.\n   * @returns This vector after applying the operation.\n   */\n  max(v) {\n    this.x = Math.max(this.x, v.x);\n    this.y = Math.max(this.y, v.y);\n    return this;\n  }\n  /**\n   * Clamps this vector to be within the range of the min and max vectors.\n   *\n   * @param min The minimum vector.\n   * @param max The maximum vector.\n   * @returns This vector after applying the operation.\n   */\n  clamp(min2, max2) {\n    this.x = Math.max(min2.x, Math.min(max2.x, this.x));\n    this.y = Math.max(min2.y, Math.min(max2.y, this.y));\n    return this;\n  }\n  /**\n   * Clamps this vector to be within the range of the min and max scalars.\n   *\n   * @param min The minimum scalar.\n   * @param max The maximum scalar.\n   * @returns This vector after applying the operation.\n   */\n  clampScalar(minVal, maxVal) {\n    min.set(minVal, minVal);\n    max.set(maxVal, maxVal);\n    return this.clamp(min, max);\n  }\n  /**\n   * Clamps the length of this vector to be within the range of the min and max lengths.\n   *\n   * @param min The minimum length.\n   * @param max The maximum length.\n   * @returns This vector after applying the operation.\n   */\n  clampLength(min2, max2) {\n    const length = this.length();\n    return this.divideScalar(length || 1).multiplyScalar(Math.max(min2, Math.min(max2, length)));\n  }\n  /**\n   * Floors each component of this vector.\n   *\n   * @returns This vector after applying the operation.\n   */\n  floor() {\n    this.x = Math.floor(this.x);\n    this.y = Math.floor(this.y);\n    return this;\n  }\n  /**\n   * Ceils each component of this vector.\n   *\n   * @returns This vector after applying the operation.\n   */\n  ceil() {\n    this.x = Math.ceil(this.x);\n    this.y = Math.ceil(this.y);\n    return this;\n  }\n  /**\n   * Rounds each component of this vector.\n   *\n   * @returns This vector after applying the operation.\n   */\n  round() {\n    this.x = Math.round(this.x);\n    this.y = Math.round(this.y);\n    return this;\n  }\n  /**\n   * Rounds each component of this vector towards zero.\n   *\n   * @returns This vector after applying the operation.\n   */\n  roundToZero() {\n    this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x);\n    this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y);\n    return this;\n  }\n  /**\n   * Negates each component of this vector, effectively flipping its direction.\n   *\n   * @returns This vector after applying the operation.\n   */\n  negate() {\n    this.x = -this.x;\n    this.y = -this.y;\n    return this;\n  }\n  /**\n   * Calculates and returns the dot product of this vector and another one.\n   *\n   * @param v The other vector.\n   * @returns The dot product of the two vectors.\n   */\n  dot(v) {\n    return this.x * v.x + this.y * v.y;\n  }\n  /**\n   * Calculates and returns the cross product of this vector and another one.\n   *\n   * @param v The other vector.\n   * @returns The cross product of the two vectors.\n   */\n  cross(v) {\n    return this.x * v.y - this.y * v.x;\n  }\n  /**\n   * Calculates and returns the squared length (magnitude) of this vector.\n   *\n   * @returns The squared length of this vector.\n   */\n  lengthSq() {\n    return this.x * this.x + this.y * this.y;\n  }\n  /**\n   * Calculates and returns the length (magnitude) of this vector.\n   *\n   * @returns The length of this vector.\n   */\n  length() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n  /**\n   * Calculates and returns the Manhattan length (sum of the absolute values of its components) of this vector.\n   *\n   * @returns The Manhattan length of this vector.\n   */\n  manhattanLength() {\n    return Math.abs(this.x) + Math.abs(this.y);\n  }\n  /**\n   * Normalizes this vector (makes it have a length of 1) in-place.\n   *\n   * @returns This vector after normalization.\n   */\n  normalize() {\n    return this.divideScalar(this.length() || 1);\n  }\n  /**\n   * Calculates and returns the angle (in radians) between this vector and the x-axis.\n   *\n   * @returns The angle between this vector and the x-axis.\n   */\n  angle() {\n    let angle = Math.atan2(this.y, this.x);\n    if (angle < 0)\n      angle += 2 * Math.PI;\n    return angle;\n  }\n  /**\n   * Calculates and returns the Euclidean distance between this vector and another one.\n   *\n   * @param v The other vector.\n   * @returns The distance between this vector and the other one.\n   */\n  distanceTo(v) {\n    return Math.sqrt(this.distanceToSquared(v));\n  }\n  /**\n   * Calculates and returns the squared Euclidean distance between this vector and another one.\n   *\n   * @param v The other vector.\n   * @returns The squared distance between this vector and the other one.\n   */\n  distanceToSquared(v) {\n    const dx = this.x - v.x;\n    const dy = this.y - v.y;\n    return dx * dx + dy * dy;\n  }\n  /**\n   * Calculates and returns the Manhattan distance (sum of the absolute differences of their coordinates) between this vector and another one.\n   *\n   * @param v The other vector.\n   * @returns The Manhattan distance between this vector and the other one.\n   */\n  manhattanDistanceTo(v) {\n    return Math.abs(this.x - v.x) + Math.abs(this.y - v.y);\n  }\n  /**\n   * Sets the length (magnitude) of this vector to the given value, while preserving its direction.\n   *\n   * @param length The new length.\n   * @returns This vector after changing its length.\n   */\n  setLength(length) {\n    return this.normalize().multiplyScalar(length);\n  }\n  /**\n   * Linearly interpolates between this vector and another one.\n   *\n   * @param v The other vector.\n   * @param alpha The interpolation factor. 0 will leave the vector unchanged, and 1 will set the vector to be equal to the other vector.\n   * @returns This vector after the interpolation.\n   */\n  lerp(v, alpha) {\n    this.x += (v.x - this.x) * alpha;\n    this.y += (v.y - this.y) * alpha;\n    return this;\n  }\n  /**\n   * Linearly interpolates between two vectors and sets the result to this vector.\n   *\n   * @param v1 The first vector.\n   * @param v2 The second vector.\n   * @param alpha The interpolation factor. 0 will set the vector to be equal to the first vector, and 1 will set the vector to be equal to the second vector.\n   * @returns This vector after the interpolation.\n   */\n  lerpVectors(v1, v2, alpha) {\n    return this.subVectors(v2, v1).multiplyScalar(alpha).add(v1);\n  }\n  /**\n   * Checks if this vector is equal to another one.\n   *\n   * @param v The other vector.\n   * @returns True if the vectors are equal, false otherwise.\n   */\n  equals(v) {\n    return v.x === this.x && v.y === this.y;\n  }\n  /**\n   * Sets the components of this vector from an array.\n   *\n   * @param array The array containing the new values.\n   * @param offset (Optional) An offset into the array. The first component will be set to array[offset], and the second component will be set to array[offset + 1]. If the offset is not given, it is assumed to be 0.\n   * @returns This vector after setting the new values.\n   */\n  fromArray(array, offset) {\n    if (offset === void 0)\n      offset = 0;\n    this.x = array[offset];\n    this.y = array[offset + 1];\n    return this;\n  }\n  /**\n   * Returns an array containing the components of this vector.\n   *\n   * @param array (Optional) The array to put the values into. If this is not provided, a new array will be created.\n   * @param offset (Optional) An offset into the array. The first component will be stored in array[offset], and the second component will be stored in array[offset + 1]. If the offset is not given, it is assumed to be 0.\n   * @returns The array containing the components of this vector.\n   */\n  toArray(array, offset) {\n    if (array === void 0)\n      array = [];\n    if (offset === void 0)\n      offset = 0;\n    array[offset] = this.x;\n    array[offset + 1] = this.y;\n    return array;\n  }\n  /**\n   * Rotates this vector around a point in the counter-clockwise direction.\n   *\n   * @param center The point to rotate around.\n   * @param angle The angle to rotate by, in radians.\n   * @returns This vector after the rotation.\n   */\n  rotateAround(center, angle) {\n    const c = Math.cos(angle);\n    const s = Math.sin(angle);\n    const x = this.x - center.x;\n    const y = this.y - center.y;\n    this.x = x * c - y * s + center.x;\n    this.y = x * s + y * c + center.y;\n    return this;\n  }\n}\nconst min = new Vector2();\nconst max = new Vector2();\nexport {\n  Vector2\n};\n//# sourceMappingURL=Vector2.mjs.map\n","const throttleMap = /* @__PURE__ */ new Map();\nfunction throttle(fun, delay = 100, scope) {\n  if (!throttleMap.has(fun)) {\n    let timerId = null;\n    const throttledFunction = (...args) => {\n      throttleMap.get(fun).args = args;\n      if (timerId)\n        return;\n      const callFun = () => {\n        timerId = null;\n        const latestArgs = throttleMap.get(fun).args;\n        if (scope) {\n          fun.call(scope, ...latestArgs);\n        } else {\n          fun(...latestArgs);\n        }\n      };\n      if (delay === 0) {\n        callFun();\n      } else {\n        timerId = setTimeout(callFun, delay);\n      }\n    };\n    throttleMap.set(fun, { throttledFunction, args: null });\n  }\n  return throttleMap.get(fun).throttledFunction;\n}\nexport {\n  throttle\n};\n//# sourceMappingURL=throttle.mjs.map\n","class Lock {\n  constructor() {\n    this._locked = false;\n  }\n  /**\n   * Getter for the `_locked` property.\n   *\n   * @returns The current lock state.\n   */\n  get locked() {\n    return this._locked;\n  }\n  /**\n   * Tries to acquire the lock. If the lock is already acquired, it returns false.\n   * Otherwise, it acquires the lock and returns true.\n   *\n   * @returns True if the lock was successfully acquired, false otherwise.\n   */\n  lock() {\n    if (this._locked) {\n      return false;\n    }\n    this._locked = true;\n    return true;\n  }\n  /**\n   * Releases the lock.\n   */\n  unlock() {\n    this._locked = false;\n  }\n}\nexport {\n  Lock\n};\n//# sourceMappingURL=Lock.mjs.map\n","class NakedPromise extends Promise {\n  /**\n   * Creates a new NakedPromise.\n   *\n   * @param executor A callback used to initialize the promise. This callback is passed two arguments:\n   * a resolve callback used to resolve the promise with a value or the result of another promise,\n   * and a reject callback used to reject the promise with a reason.\n   */\n  constructor(executor) {\n    let capturedResolve = void 0;\n    let capturedReject = void 0;\n    super((resolve, reject) => {\n      capturedResolve = resolve;\n      capturedReject = reject;\n      executor == null ? void 0 : executor(resolve, reject);\n    });\n    this.resolve = capturedResolve;\n    this.reject = capturedReject;\n  }\n}\nexport {\n  NakedPromise\n};\n//# sourceMappingURL=NakedPromise.mjs.map\n","class URLParams {\n  constructor(url) {\n    this._params = this._getParams(url ?? location.search);\n  }\n  /**\n   * Gets a parameter by name returning the same type as the fallback type.\n   *\n   * @param key - Name of parameter to get\n   */\n  get(name, fallback) {\n    const type = typeof fallback;\n    if (type === \"number\")\n      return this.getNumber(name, fallback);\n    if (type === \"boolean\")\n      return this.getBoolean(name, fallback);\n    return this.getString(name, fallback);\n  }\n  /**\n   * Get URL parameter as string\n   *\n   * @param name - Name of the parameter\n   * @param fallback - Fallback if not found\n   */\n  getString(name, fallback) {\n    return this._params.paramsString.has(name) ? this._params.paramsString.get(name) : fallback;\n  }\n  /**\n   * Get URL parameter as number\n   *\n   * @param name - Name of the parameter\n   * @param fallback - Fallback if not found\n   */\n  getNumber(name, fallback) {\n    return this._params.paramsNumber.has(name) ? this._params.paramsNumber.get(name) : fallback;\n  }\n  /**\n   * Get URL parameter as boolean\n   *\n   * @param name - Name of the parameter\n   * @param fallback - Fallback if not found\n   */\n  getBoolean(name, fallback) {\n    return this._params.paramsBoolean.has(name) ? this._params.paramsBoolean.get(name) : fallback;\n  }\n  /**\n   * Gets all URL parameters as strings\n   *\n   * @returns An object containing all the params by name\n   */\n  getAll() {\n    return this._params.paramsString;\n  }\n  /**\n   * Get url params and converts all them to string, number and boolean\n   * Done this way to prevent a situation where a parameter is '01' and the app wants exactly like\n   * that as string, but if that gets automatically parsed to a number, then becomes '1'.\n   * That could be done at 'get' time, but is faster to pre-parse all of them at once.\n   *\n   * @returns An object containing all values parsed as string, number and boolean.\n   */\n  _getParams(url) {\n    const items = url.slice(url.indexOf(\"?\") + 1).split(\"&\");\n    const paramsString = /* @__PURE__ */ new Map();\n    const paramsNumber = /* @__PURE__ */ new Map();\n    const paramsBoolean = /* @__PURE__ */ new Map();\n    for (const item of items) {\n      const split = item.split(\"=\");\n      const k = split[0];\n      const v = split[1] ?? \"true\";\n      paramsString.set(k, v);\n      paramsNumber.set(k, Number(v));\n      paramsBoolean.set(k, v.toLowerCase() !== \"false\");\n    }\n    return { paramsString, paramsNumber, paramsBoolean };\n  }\n}\nexport {\n  URLParams\n};\n//# sourceMappingURL=URLParams.mjs.map\n","import { gsap } from \"gsap\";\nimport { Ticker } from \"pixi.js\";\nfunction limitFPS(fps = 60) {\n  Ticker.shared.maxFPS = fps;\n  Ticker.system.maxFPS = fps;\n  gsap.ticker.fps(fps);\n}\nexport {\n  limitFPS\n};\n//# sourceMappingURL=limitFPS.mjs.map\n","function getPixiRunnerData(runner) {\n  return { name: runner[\"_name\"], items: runner.items };\n}\nclass Prioritiser {\n  constructor(runners, getter, getItem) {\n    this._priorities = [];\n    this._result = {\n      priority: \"after\",\n      runner: \"start\",\n      plugin1: null,\n      plugin2: null\n    };\n    this._runners = runners;\n    this._getRunner = getter;\n    this._getItem = getItem || ((item) => item);\n  }\n  /** returns the chaining functions. */\n  get prioritise() {\n    if (!this._runnerChain) {\n      this._buildChain();\n    }\n    return this._runnerChain;\n  }\n  /** running this will apply the priorities to the runners */\n  applyPrioritise() {\n    this._priorities.forEach((result) => {\n      this._prioritise(result);\n    });\n  }\n  /** builds out the chaining functions that make prioritising easier. */\n  _buildChain() {\n    this._actionChain = {\n      before: (plugin, data) => {\n        this._result.priority = \"before\";\n        this._result.plugin2 = { item: plugin, data };\n        this._priorities.push({\n          ...this._result\n        });\n      },\n      after: (plugin, data) => {\n        this._result.priority = \"after\";\n        this._result.plugin2 = { item: plugin, data };\n        this._priorities.push({\n          ...this._result\n        });\n      },\n      first: () => {\n        this._result.priority = \"first\";\n        this._priorities.push({\n          ...this._result\n        });\n      },\n      last: () => {\n        this._result.priority = \"last\";\n        this._priorities.push({\n          ...this._result\n        });\n      }\n    };\n    const runners = this._runners;\n    this._runnerChain = this._runnerChain ?? runners.reduce(\n      (b, runner) => {\n        const runnerName = this._getRunner(runner).name;\n        b[runnerName] = (plugin, data) => {\n          this._result.plugin1 = { item: plugin, data };\n          this._result.runner = runnerName;\n          return this._actionChain;\n        };\n        return b;\n      },\n      {}\n    );\n  }\n  _prioritise(priority) {\n    const runner = this._runners.find((runner2) => this._getRunner(runner2).name === priority.runner);\n    if (!runner) return;\n    const plugin1 = this._getItem(priority.plugin1.item, priority.plugin1.data);\n    const items = this._getRunner(runner).items;\n    const index1 = items.indexOf(plugin1);\n    if (index1 === -1) return;\n    items.splice(index1, 1);\n    if (priority.priority === \"first\") {\n      items.unshift(plugin1);\n    } else if (priority.priority === \"last\") {\n      items.push(plugin1);\n    } else {\n      const plugin2 = this._getItem(priority.plugin2.item, priority.plugin2.data);\n      const index2 = items.indexOf(plugin2);\n      if (index2 === -1) return;\n      if (priority.priority === \"before\") {\n        items.splice(index2, 0, plugin1);\n      } else if (priority.priority === \"after\") {\n        items.splice(index2 + 1, 0, plugin1);\n      }\n    }\n  }\n}\nexport {\n  Prioritiser,\n  getPixiRunnerData\n};\n//# sourceMappingURL=Prioritiser.mjs.map\n","async function promiseRunner(runner) {\n  const { items, name } = runner;\n  for (const item of items) {\n    await item[name]();\n  }\n}\nasync function promiseAllRunner(runner) {\n  const promises = [];\n  const { items, name } = runner;\n  for (const item of items) {\n    promises.push(item[name]());\n  }\n  await Promise.all(promises);\n}\nexport {\n  promiseAllRunner,\n  promiseRunner\n};\n//# sourceMappingURL=promiseRunner.mjs.map\n","class AssetMonitor {\n  constructor() {\n    this.blockingAssetsTrackingState = {\n      state: \"blockingAssets\",\n      size: 0,\n      startTime: performance.now(),\n      endTime: 0,\n      count: 0\n    };\n    this.gameAssetsTrackingState = { state: \"gameAssets\", size: 0, count: 0 };\n    this.currentAssetState = \"blockingAssets\";\n  }\n  start() {\n    this.blockingAssetsTrackingState.startTime = performance.now();\n  }\n  getState() {\n    return {\n      blockingAssetsCount: this.blockingAssetsTrackingState.count,\n      blockingAssetsSize: this.blockingAssetsTrackingState.size,\n      blockingAssetsTime: this.blockingAssetsTrackingState.endTime && this.blockingAssetsTrackingState.startTime ? this.blockingAssetsTrackingState.endTime - this.blockingAssetsTrackingState.startTime : 0,\n      gameAssetsCount: this.gameAssetsTrackingState.count,\n      gameAssetsSize: this.gameAssetsTrackingState.size,\n      allAssetsSize: this.blockingAssetsTrackingState.size + this.gameAssetsTrackingState.size,\n      allAssetsCount: this.blockingAssetsTrackingState.count + this.gameAssetsTrackingState.count\n    };\n  }\n  /** Track asset loading progress */\n  trackAsset(sizes) {\n    if (this.currentAssetState === \"blockingAssets\") {\n      this.blockingAssetsTrackingState.count += sizes.length;\n      this.blockingAssetsTrackingState.size += sizes.reduce((acc, size) => acc + size, 0);\n    } else {\n      this.gameAssetsTrackingState.count += sizes.length;\n      this.gameAssetsTrackingState.size += sizes.reduce((acc, size) => acc + size, 0);\n    }\n  }\n  /** Switch the current asset state */\n  switchAssetState(state) {\n    if (this.currentAssetState === \"blockingAssets\" && state === \"gameAssets\") {\n      this.blockingAssetsTrackingState.endTime = performance.now();\n      this.gameAssetsTrackingState.startTime = this.blockingAssetsTrackingState.endTime;\n    }\n    this.currentAssetState = state;\n  }\n}\nexport {\n  AssetMonitor\n};\n//# sourceMappingURL=AssetMonitor.mjs.map\n","class FPSMonitor {\n  constructor(id, trackTail = true) {\n    this._TAIL_WINDOW_SECONDS = 3;\n    this._SESSION_FPS_SAMPLE_MAX = 5e3;\n    this._SEGMENT_FPS_SAMPLE_MAX = 1e3;\n    this._realtime = {\n      stdDevCount: 0,\n      stdDevMean: 0,\n      stdDevSquared: 0,\n      ticks: 0,\n      fpsTime: 0\n    };\n    this.id = id;\n    this.startTime = performance.now();\n    this.perf = { stdDevCount: 0, stdDevMean: 0, stdDevSquared: 0, ticks: 0, fpsTime: 0 };\n    this.fpsSamples = [];\n    this.fpsSampleCount = 0;\n    this.worstWindowFPS = Infinity;\n    this.trackTail = trackTail;\n    if (trackTail) this.frameWindow = [];\n  }\n  update(clampedDelta, timeNow) {\n    const frameFPS = Math.min(1e3 / clampedDelta, 60);\n    if (this.id === \"session\") {\n      this._updateVariance(clampedDelta, this._realtime);\n      this._updateFPS(clampedDelta, this._realtime);\n    }\n    this._updateVariance(clampedDelta, this.perf);\n    this._updateFPS(clampedDelta, this.perf);\n    this.addFPSSample(this, frameFPS);\n    if (this.trackTail && this.frameWindow) this.updateRollingWindow(timeNow, this);\n  }\n  getStats(ended, now = performance.now()) {\n    const fps = this._getFPS(this.perf);\n    const ch = this._getVariance(this.perf);\n    const chSample = this._getVarianceSample(this.perf);\n    const { fpsPercentile1, fpsPercentile5, fpsPercentile95, fpsPercentile99 } = this._computePercentiles(\n      this.fpsSamples\n    );\n    return {\n      id: this.id,\n      startTime: this.startTime,\n      endTime: ended ? now : void 0,\n      durationMs: now - this.startTime,\n      frames: this.perf.ticks,\n      fps,\n      choppiness: ch,\n      choppinessSample: chSample,\n      fpsPercentile1,\n      fpsPercentile5,\n      fpsPercentile95,\n      fpsPercentile99,\n      tailFPS: this.trackTail && isFinite(this.worstWindowFPS) ? this.worstWindowFPS : void 0,\n      active: !ended\n    };\n  }\n  resetRealTimeStats() {\n    this._realtime.fpsTime = 0;\n    this._realtime.stdDevCount = 0;\n    this._realtime.stdDevMean = 0;\n    this._realtime.stdDevSquared = 0;\n    this._realtime.ticks = 0;\n  }\n  /** The average FPS (frames per second) */\n  get fps() {\n    return this._getFPS(this.perf);\n  }\n  /** The realtime FPS (frames per second) */\n  get realtimeFPS() {\n    return this._getFPS(this._realtime);\n  }\n  /** The average DT variance */\n  get choppiness() {\n    return this._getVariance(this.perf);\n  }\n  /** The average DT sample variance */\n  get choppinessSample() {\n    return this._getVarianceSample(this.perf);\n  }\n  /** The realtime DT variance */\n  get realtimeChoppiness() {\n    return this._getVariance(this._realtime);\n  }\n  /** The realtime DT sample variance */\n  get realtimeChoppinessSample() {\n    return this._getVarianceSample(this._realtime);\n  }\n  /** The average tail FPS */\n  get tailFPS() {\n    return isFinite(this.worstWindowFPS) ? this.worstWindowFPS : void 0;\n  }\n  /** The average rolling window size in seconds */\n  get tailWindowSeconds() {\n    return this._TAIL_WINDOW_SECONDS;\n  }\n  // https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Welford's_online_algorithm\n  _updateVariance(value, stats) {\n    stats.stdDevCount++;\n    const delta = value - stats.stdDevMean;\n    stats.stdDevMean += delta / stats.stdDevCount;\n    const delta2 = value - stats.stdDevMean;\n    stats.stdDevSquared += delta * delta2;\n  }\n  _getVariance(stats) {\n    if (stats.stdDevCount === 0) return 0;\n    return stats.stdDevSquared / stats.stdDevCount;\n  }\n  _getVarianceSample(stats) {\n    if (stats.stdDevCount === 0) return 0;\n    return stats.stdDevSquared / (stats.stdDevCount - 1);\n  }\n  _updateFPS(delta, stats) {\n    stats.fpsTime += delta;\n    stats.ticks++;\n  }\n  _getFPS(stats) {\n    if (stats.ticks === 0) return 0;\n    const raw = 1e3 / (stats.fpsTime / stats.ticks);\n    return Math.min(raw, 60);\n  }\n  /** Reservoir sample add for a segment (Algorithm R) */\n  addFPSSample(seg, fps) {\n    seg.fpsSampleCount++;\n    const count = seg.fpsSampleCount;\n    const max = seg.id === \"session\" ? this._SESSION_FPS_SAMPLE_MAX : this._SEGMENT_FPS_SAMPLE_MAX;\n    if (seg.fpsSamples.length < max) {\n      seg.fpsSamples.push(fps);\n    } else {\n      const r = Math.floor(Math.random() * count);\n      if (r < max) seg.fpsSamples[r] = fps;\n    }\n  }\n  /** Update per-segment rolling window FPS (worst window) if tail tracking enabled. */\n  updateRollingWindow(frameTime, seg) {\n    const windowMs = this._TAIL_WINDOW_SECONDS * 1e3;\n    const fw = seg.frameWindow;\n    fw.push({ t: frameTime });\n    while (fw.length && frameTime - fw[0].t > windowMs) fw.shift();\n    if (fw.length > 1) {\n      const duration = frameTime - fw[0].t;\n      if (duration > 0) {\n        const fps = Math.min((fw.length - 1) / (duration / 1e3), 60);\n        if (fps < seg.worstWindowFPS) seg.worstWindowFPS = fps;\n      }\n    }\n  }\n  /** Compute percentile (1..99) using nearest-rank on a sorted copy of sample set */\n  _computePercentiles(samples) {\n    if (!samples.length) {\n      return { fpsPercentile1: 0, fpsPercentile5: 0, fpsPercentile95: 0, fpsPercentile99: 0 };\n    }\n    const sorted = [...samples].sort((a, b) => a - b);\n    const pick = (p) => {\n      const rank = Math.min(sorted.length, Math.max(1, Math.ceil(p / 100 * sorted.length)));\n      return sorted[rank - 1];\n    };\n    return {\n      fpsPercentile1: pick(1),\n      fpsPercentile5: pick(5),\n      fpsPercentile95: pick(95),\n      fpsPercentile99: pick(99)\n    };\n  }\n}\nexport {\n  FPSMonitor\n};\n//# sourceMappingURL=FPSMonitor.mjs.map\n","import { round } from \"@play-co/commons\";\nconst gpuTextureFormatSize = {\n  r8unorm: 1,\n  r8snorm: 1,\n  r8uint: 1,\n  r8sint: 1,\n  r16uint: 2,\n  r16sint: 2,\n  r16float: 2,\n  rg8unorm: 2,\n  rg8snorm: 2,\n  rg8uint: 2,\n  rg8sint: 2,\n  r32float: 4,\n  r32uint: 4,\n  r32sint: 4,\n  rg16uint: 4,\n  rg16sint: 4,\n  rg16float: 4,\n  rgba8unorm: 4,\n  \"rgba8unorm-srgb\": 4,\n  rgba8snorm: 4,\n  rgba8uint: 4,\n  rgba8sint: 4,\n  bgra8unorm: 4,\n  \"bgra8unorm-srgb\": 4,\n  rgb10a2unorm: 4,\n  rg11b10ufloat: 4,\n  rgb9e5ufloat: 4,\n  rg32float: 8,\n  rg32uint: 8,\n  rg32sint: 8,\n  rgba16uint: 8,\n  rgba16sint: 8,\n  rgba16float: 8,\n  rgba32float: 16,\n  rgba32uint: 16,\n  rgba32sint: 16,\n  depth16unorm: 2,\n  depth24plus: 3,\n  \"depth24plus-stencil8\": 4,\n  depth32float: 4,\n  stencil8: 1,\n  \"depth32float-stencil8\": 5\n};\nconst glTextureFormatSize = {\n  6408: 4,\n  6407: 3,\n  33319: 2,\n  6403: 1,\n  36249: 4,\n  36248: 3,\n  33320: 2,\n  36244: 1,\n  6406: 1,\n  6409: 1,\n  6410: 2,\n  6402: 1,\n  34041: 2\n};\nclass GPUMonitor {\n  constructor() {\n    this._gpuTextureSize = /* @__PURE__ */ new Map();\n  }\n  start(renderer) {\n    this._renderer = renderer;\n  }\n  update() {\n    if (!this._renderer) return { textureCount: 0, sizeInMb: 0 };\n    const data = this._get();\n    let textureCount = 0;\n    let totalSize = 0;\n    for (const texture of data) {\n      if (!texture.destroyed && texture.isLoaded) {\n        textureCount++;\n        totalSize += texture.gpuSize;\n      }\n    }\n    const sizeInMb = round(totalSize / 1024 / 1024, 1);\n    return {\n      textureCount,\n      sizeInMb\n    };\n  }\n  _get() {\n    const currentTextures = this._renderer.texture.managedTextures;\n    const glTextures = this._getWebTextures();\n    const data = [];\n    currentTextures.forEach((texture) => {\n      if (!(texture == null ? void 0 : texture.resource)) return;\n      if (!this._gpuTextureSize.has(texture.uid)) {\n        const size = this._getMemorySize(texture, glTextures[texture.uid]);\n        if (size) {\n          this._gpuTextureSize.set(texture.uid, size);\n        }\n      }\n      data.push({\n        gpuSize: this._gpuTextureSize.get(texture.uid) || 0,\n        destroyed: texture.destroyed,\n        isLoaded: !!glTextures[texture.uid]\n      });\n    });\n    return data;\n  }\n  _getWebTextures() {\n    const renderer = this._renderer;\n    let glTextures = {};\n    const textureSystem = renderer.texture;\n    if (\"_glTextures\" in textureSystem || \"_gpuSources\" in textureSystem) {\n      glTextures = \"_glTextures\" in textureSystem ? textureSystem._glTextures : textureSystem._gpuSources;\n    } else {\n      const managedTextures = textureSystem.managedTextures;\n      glTextures = managedTextures.reduce(\n        (acc, texture) => {\n          if (!texture) return acc;\n          const gpuData = texture._gpuData[this._renderer.uid];\n          if (!gpuData) return acc;\n          acc[texture.uid] = \"gpuTexture\" in gpuData ? gpuData.gpuTexture : gpuData;\n          return acc;\n        },\n        {}\n      );\n    }\n    return glTextures;\n  }\n  _getMemorySize(texture, webTexture) {\n    if (!webTexture) return null;\n    if (Array.isArray(texture.resource) && texture.resource[0] instanceof Uint8Array) {\n      return texture.resource.reduce((acc, res) => acc + res.byteLength, 0);\n    }\n    if (typeof webTexture.format === \"string\" && gpuTextureFormatSize[webTexture.format]) {\n      return webTexture.width * webTexture.height * gpuTextureFormatSize[webTexture.format];\n    } else if (typeof webTexture.format === \"number\" && glTextureFormatSize[webTexture.format]) {\n      return webTexture.width * webTexture.height * glTextureFormatSize[webTexture.format];\n    }\n    return null;\n  }\n}\nexport {\n  GPUMonitor\n};\n//# sourceMappingURL=GPUMonitor.mjs.map\n","import { Ticker } from \"pixi.js\";\nimport { AssetMonitor } from \"./AssetMonitor.mjs\";\nimport { FPSMonitor } from \"./FPSMonitor.mjs\";\nimport { GPUMonitor } from \"./GPUMonitor.mjs\";\nconst ANALYTICS_TIMER = 60 * 1e3;\nconst MAX_FRAME_DT = 2 * 1e3;\nconst START_TRACKING_AFTER = 20 * 1e3;\nclass PerformanceTrackerClass {\n  constructor() {\n    this.assetMonitor = new AssetMonitor();\n    this._paused = false;\n    this._isFirstEvent = true;\n    this._lastTickTime = 0;\n    this._systemThrottled = false;\n    this._peakSizeInMb = 0;\n    this._deviceScreenRefresh = 0;\n    this._LIKELY_HZ = [15, 30, 60, 90, 120];\n    this._rafSamplingStarted = false;\n    this._timeTo = {};\n    this._gpuMonitor = new GPUMonitor();\n    this._segments = /* @__PURE__ */ new Map();\n    this._warningLastEmit = /* @__PURE__ */ Object.create(null);\n    this._GPU_WARNING_THRESHOLD_MB = 200 * 0.9;\n  }\n  init(trackFunction, addSelf = true, warningFunction) {\n    this._trackFunction = trackFunction;\n    this._warningFunction = warningFunction;\n    this.startSegment(\"session\", { trackTail: true });\n    setInterval(() => this._trackAnalytics(), ANALYTICS_TIMER);\n    this._startDisplayHzSampling();\n    if (addSelf) Ticker.shared.add(this.update, this);\n  }\n  /**\n   * Start tracking a named performance segment (e.g., 'level-1').\n   * If the id is already active this is a no-op.\n   *\n   * @param id Unique segment identifier.\n   * @param options Segment options (e.g., enable per-segment tail FPS computation).\n   */\n  startSegment(id, options) {\n    if (this._segments.has(id)) return;\n    const trackTail = (options == null ? void 0 : options.trackTail) ?? true;\n    this._segments.set(id, new FPSMonitor(id, trackTail));\n  }\n  /**\n   * End a segment and return its final aggregated performance data snapshot.\n   * The ended segment is removed from active tracking and will no longer appear\n   * in subsequent analytics pulse snapshots.\n   *\n   * @param id Segment identifier.\n   * @returns Final `SegmentPerformanceData` or undefined if id not active.\n   */\n  endSegment(id) {\n    const seg = this._segments.get(id);\n    if (!seg) return void 0;\n    const data = this._buildSegmentData(seg, true);\n    this._segments.delete(id);\n    return data;\n  }\n  /**\n   * Get an array of currently active segment ids.\n   * Useful for debugging or UI overlays.\n   */\n  getActiveSegments() {\n    return Array.from(this._segments.keys());\n  }\n  /** The used JS heap size if available (undefined if not supported) */\n  get jsHeapSizeUsed() {\n    var _a;\n    return (_a = performance == null ? void 0 : performance.memory) == null ? void 0 : _a.usedJSHeapSize;\n  }\n  /** The total JS heap size if available (undefined if not supported) */\n  get jsHeapSizeTotal() {\n    var _a;\n    return (_a = performance == null ? void 0 : performance.memory) == null ? void 0 : _a.totalJSHeapSize;\n  }\n  /** The JS heap size limit if available (undefined if not supported) */\n  get jsHeapSizeLimit() {\n    var _a;\n    return (_a = performance == null ? void 0 : performance.memory) == null ? void 0 : _a.jsHeapSizeLimit;\n  }\n  /** The average FPS (frames per second) */\n  get fps() {\n    var _a;\n    return ((_a = this._segments.get(\"session\")) == null ? void 0 : _a.fps) ?? 0;\n  }\n  /** The realtime FPS (frames per second) */\n  get realtimeFPS() {\n    var _a;\n    return ((_a = this._segments.get(\"session\")) == null ? void 0 : _a.realtimeFPS) ?? 0;\n  }\n  /** The average DT variance */\n  get choppiness() {\n    var _a;\n    return ((_a = this._segments.get(\"session\")) == null ? void 0 : _a.choppiness) ?? 0;\n  }\n  /** The average DT sample variance */\n  get choppinessSample() {\n    var _a;\n    return ((_a = this._segments.get(\"session\")) == null ? void 0 : _a.choppinessSample) ?? 0;\n  }\n  /** The realtime DT variance */\n  get realtimeChoppiness() {\n    var _a;\n    return ((_a = this._segments.get(\"session\")) == null ? void 0 : _a.realtimeChoppiness) ?? 0;\n  }\n  /** The realtime DT sample variance */\n  get realtimeChoppinessSample() {\n    var _a;\n    return ((_a = this._segments.get(\"session\")) == null ? void 0 : _a.realtimeChoppinessSample) ?? 0;\n  }\n  /** The average tail FPS */\n  get tailFPS() {\n    var _a;\n    return ((_a = this._segments.get(\"session\")) == null ? void 0 : _a.tailFPS) ?? 0;\n  }\n  /** The average rolling window size in seconds */\n  get tailWindowSeconds() {\n    var _a;\n    return ((_a = this._segments.get(\"session\")) == null ? void 0 : _a.tailWindowSeconds) ?? 0;\n  }\n  /** The detected (approx) display refresh rate (Hz) */\n  get deviceScreenRefresh() {\n    return this._deviceScreenRefresh || void 0;\n  }\n  /** Peak VRAM usage (MB) across the whole session */\n  get peakSizeInMb() {\n    return this._peakSizeInMb;\n  }\n  /** True if VRAM peak exceeded the warning threshold */\n  get vramPeakExceeded() {\n    return this._peakSizeInMb >= 200;\n  }\n  /** True if low power mode is active (FPS calculations paused) */\n  get systemThrottled() {\n    return this._systemThrottled;\n  }\n  startGPUMonitoring(renderer) {\n    this._gpuMonitor.start(renderer);\n  }\n  /**\n   * Update performance tracking.\n   */\n  update() {\n    if (this._paused) return;\n    const timeNow = performance.now();\n    const delta = timeNow - this._lastTickTime;\n    if (this._lastTickTime !== 0 && delta < MAX_FRAME_DT && timeNow > START_TRACKING_AFTER) {\n      const clampedDelta = this._capDeltaFor60(delta);\n      if (this._segments.size) {\n        for (const seg of this._segments.values()) {\n          seg.update(clampedDelta, timeNow);\n        }\n      }\n    }\n    this._lastTickTime = timeNow;\n  }\n  /**\n   * Pause tracking performance data.\n   */\n  pause() {\n    this._paused = true;\n  }\n  /**\n   * Resume tracking performance data.\n   */\n  resume() {\n    this._paused = false;\n  }\n  /**\n   * Reset all performance tracking data and segments.\n   * This clears all accumulated statistics, segments, and tracking state.\n   * Useful for starting fresh measurements or between game sessions.\n   */\n  reset() {\n    this.assetMonitor.blockingAssetsTrackingState = {\n      state: \"blockingAssets\",\n      size: 0,\n      startTime: performance.now(),\n      endTime: 0,\n      count: 0\n    };\n    this.assetMonitor.gameAssetsTrackingState = { state: \"gameAssets\", size: 0, count: 0 };\n    this.assetMonitor.currentAssetState = \"blockingAssets\";\n    this._paused = false;\n    this._isFirstEvent = true;\n    this._lastTickTime = 0;\n    this._systemThrottled = false;\n    this._peakSizeInMb = 0;\n    this._deviceScreenRefresh = 0;\n    this._rafSamplingStarted = false;\n    this._timeTo = {};\n    this._segments.clear();\n    this._warningLastEmit = /* @__PURE__ */ Object.create(null);\n    this.startSegment(\"session\", { trackTail: true });\n    this._startDisplayHzSampling();\n    return this;\n  }\n  /**\n   * Track time when a specific 'timeTo' event occurs.\n   *\n   * @param key - The key of the 'timeTo' event to track\n   */\n  trackTimeTo(key) {\n    const event = `timeTo${key.charAt(0).toUpperCase() + key.slice(1)}`;\n    this._timeTo[event] = Math.round(window.performance.now()) / 1e3;\n  }\n  _trackAnalytics() {\n    if (this._paused) return;\n    const gpu = this._gpuMonitor.update();\n    if (gpu.sizeInMb > this._peakSizeInMb) this._peakSizeInMb = gpu.sizeInMb;\n    this._checkGpuWarning(gpu.sizeInMb);\n    this._checkSystemMemoryWarning();\n    const segmentSnapshots = [];\n    const nowTs = performance.now();\n    let sessionSnapshot;\n    if (this._segments.size) {\n      for (const seg of this._segments.values()) {\n        const snap = this._buildSegmentData(seg, false, nowTs);\n        if (seg.id === \"session\") sessionSnapshot = snap;\n        else segmentSnapshots.push(snap);\n      }\n    }\n    const session = this._segments.get(\"session\");\n    const perfData = {\n      ...sessionSnapshot,\n      isFirst: this._isFirstEvent,\n      realtimeFPS: session.realtimeFPS,\n      realtimeChoppiness: session.realtimeChoppiness,\n      realtimeChoppinessSample: session.realtimeChoppinessSample,\n      jsHeapSizeLimit: this.jsHeapSizeLimit,\n      jsHeapSizeTotal: this.jsHeapSizeTotal,\n      jsHeapSizeUsed: this.jsHeapSizeUsed,\n      tailWindowSeconds: session.tailWindowSeconds,\n      textureCount: gpu.textureCount,\n      sizeInMb: gpu.sizeInMb,\n      peakSizeInMb: this._peakSizeInMb,\n      vramPeakExceeded: this.vramPeakExceeded,\n      deviceScreenRefresh: this.deviceScreenRefresh,\n      ...this.assetMonitor.getState(),\n      ...this._timeTo\n    };\n    this._trackFunction(perfData, segmentSnapshots);\n    session.resetRealTimeStats();\n    this._isFirstEvent = false;\n  }\n  _capDeltaFor60(delta) {\n    const MIN_DELTA = 1e3 / 60;\n    return delta < MIN_DELTA ? MIN_DELTA : delta;\n  }\n  _startDisplayHzSampling() {\n    var _a;\n    if (this._deviceScreenRefresh || this._rafSamplingStarted) return;\n    const w = typeof window !== \"undefined\" ? window : void 0;\n    const rAF = (_a = w == null ? void 0 : w.requestAnimationFrame) == null ? void 0 : _a.bind(w);\n    if (!rAF) return;\n    this._rafSamplingStarted = true;\n    let frameCount = 0;\n    const startTime = performance.now();\n    const SAMPLE_DURATION_MS = 1e3;\n    const HARD_TIMEOUT_MS = 2500;\n    const finish = (now) => {\n      if (this._deviceScreenRefresh) return;\n      const elapsed = Math.max(1, now - startTime);\n      const estimate = frameCount / (elapsed / 1e3);\n      this._deviceScreenRefresh = this._snapHz(estimate);\n      if (this._deviceScreenRefresh <= 30) {\n        this._systemThrottled = true;\n      }\n    };\n    const step = (t) => {\n      if (this._deviceScreenRefresh) return;\n      frameCount++;\n      const elapsed = t - startTime;\n      if (elapsed >= SAMPLE_DURATION_MS || frameCount >= 300) {\n        finish(t);\n        return;\n      }\n      rAF(step);\n    };\n    rAF(step);\n    setTimeout(() => {\n      if (!this._deviceScreenRefresh) finish(performance.now());\n    }, HARD_TIMEOUT_MS);\n  }\n  _snapHz(fps) {\n    let best = fps;\n    let diff = Infinity;\n    for (const hz of this._LIKELY_HZ) {\n      const d = Math.abs(hz - fps);\n      if (d < diff) {\n        diff = d;\n        best = hz;\n      }\n    }\n    if (Math.abs(best - fps) / fps > 0.15) return Math.round(fps);\n    return Math.round(best);\n  }\n  /**\n   * Build an immutable snapshot for a segment (active or ended) computing derived metrics\n   * like percentiles on-demand. Sorting occurs only for the segment's bounded reservoir samples.\n   */\n  _buildSegmentData(seg, ended, now = performance.now()) {\n    return { ...seg.getStats(ended, now), systemThrottled: this._systemThrottled };\n  }\n  /**\n   * Emit a performance warning if its cooldown has elapsed.\n   * Built-in emitters: 'gpuMemoryHigh', 'systemMemoryHigh'.\n   * Custom callers can emit arbitrary types to integrate with quality scaling logic.\n   *\n   * @param type Arbitrary warning identifier.\n   * @param data Context object (type-specific) serialized to callback.\n   * @param cooldownMs Minimum ms between repeated warnings of this type (default 5m).\n   */\n  emitWarning(type, data, cooldownMs = 2 * 60 * 1e3) {\n    if (!this._warningFunction) return false;\n    const now = performance.now();\n    const last = this._warningLastEmit[type];\n    if (last !== void 0 && now - last < cooldownMs) return false;\n    this._warningLastEmit[type] = now;\n    this._warningFunction({ type, data, at: now });\n    return true;\n  }\n  // 90% of 200MB heuristic cap\n  /** Built-in GPU memory high watermark warning helper (uses generic emitWarning API). */\n  _checkGpuWarning(currentMb) {\n    if (currentMb >= this._GPU_WARNING_THRESHOLD_MB) {\n      this.emitWarning(\"gpuMemoryHigh\", {\n        sizeInMb: currentMb,\n        peakSizeInMb: this._peakSizeInMb,\n        thresholdMb: this._GPU_WARNING_THRESHOLD_MB\n      });\n    }\n  }\n  /** Built-in System memory high warning helper (>=90% of reported JS heap limit). */\n  _checkSystemMemoryWarning() {\n    const used = this.jsHeapSizeUsed;\n    const limit = this.jsHeapSizeLimit;\n    if (!used || !limit) return;\n    if (limit <= 0) return;\n    const ratio = used / limit;\n    if (ratio >= 0.9) {\n      this.emitWarning(\"systemMemoryHigh\", { jsHeapSizeUsed: used, jsHeapSizeLimit: limit, ratio });\n    }\n  }\n}\nconst PerformanceTracker = new PerformanceTrackerClass();\nexport {\n  PerformanceTracker\n};\n//# sourceMappingURL=PerformanceTracker.mjs.map\n","import { Ticker, SystemRunner } from \"pixi.js\";\nimport { limitFPS } from \"../../utils/system/time/limitFPS.mjs\";\nimport { Prioritiser, getPixiRunnerData } from \"./Prioritiser.mjs\";\nimport { promiseAllRunner, promiseRunner } from \"../../utils/runners/promiseRunner.mjs\";\nimport { PerformanceTracker } from \"../../utils/system/monitor/PerformanceTracker.mjs\";\nclass Application {\n  /**\n   * @param config - config for the application\n   */\n  constructor(config = {}) {\n    this._defaultPluginName = \"default\";\n    this.runners = [];\n    this.setupRunner = this.addRunner(\"setup\");\n    this.initRunner = this.addRunner(\"init\");\n    this.prepareRunner = this.addRunner(\"prepare\");\n    this.startRunner = this.addRunner(\"start\");\n    this.updateRunner = this.addRunner(\"update\");\n    this.config = config;\n    this.verbose = this.config.verbose ?? false;\n    this.plugins = /* @__PURE__ */ new Map();\n    this.pluginDefaults = /* @__PURE__ */ new Map();\n    this.config.limitFPS = this.config.limitFPS ?? 60;\n    if (this.config.limitFPS) {\n      limitFPS(this.config.limitFPS);\n    }\n    this._prioritiser = new Prioritiser(this.runners, getPixiRunnerData, (plugin, name) => this.get(plugin, name));\n  }\n  /**\n   * Add a plugin by class.\n   *\n   * @param type - Plugin class to be added.\n   * @param options - Options for the plugin. If a \"name\" is specified then options from the AppConfig will be applied.\n   * It is also used to differentiate between multiple plugins of the same class.\n   * @returns A plugin built from given class and options.\n   */\n  add(PluginClass, options) {\n    options = options || {};\n    const name = options.name;\n    const nameToRegister = name ?? this._defaultPluginName;\n    options = Object.assign(options, this.config[name] || {});\n    const plugin = new PluginClass(this, options);\n    const classPlugins = this.plugins.get(PluginClass) || {};\n    if (classPlugins[nameToRegister]) {\n      throw new Error(`app plugin ${nameToRegister} already exists`);\n    }\n    classPlugins[nameToRegister] = plugin;\n    if (!this.pluginDefaults.get(PluginClass)) {\n      this.pluginDefaults.set(PluginClass, nameToRegister);\n    }\n    this.runners.forEach((runner) => {\n      runner.add(plugin);\n    });\n    this.plugins.set(PluginClass, classPlugins);\n    return plugin;\n  }\n  /**\n   * Get a plugin by class. You can specify a name in order to get a certain plugin of a particular class.\n   *\n   * @param type - Plugin class to find.\n   * @param name - Used to get a specific plugin rather than the default.\n   * @returns A plugin found for given class.\n   */\n  get(pluginClass, name) {\n    const pluginName = name ?? this.pluginDefaults.get(pluginClass);\n    return this.plugins.get(pluginClass)[pluginName];\n  }\n  /**\n   * Calls the init, prepare, and starts runners in that order.\n   * Awaits each runners functions to ensure they are called in the correct order.\n   */\n  async init() {\n    this._prioritiser.applyPrioritise();\n    await promiseAllRunner(this.setupRunner);\n    await promiseRunner(this.initRunner);\n    Ticker.system.add(this.update, this);\n    await promiseRunner(this.prepareRunner);\n    await promiseRunner(this.startRunner);\n    PerformanceTracker.assetMonitor.switchAssetState(\"gameAssets\");\n  }\n  /**\n   * Calls the update runner\n   *\n   * @param ticker - pixi ticker.\n   */\n  update(ticker) {\n    this.updateRunner.emit(ticker.deltaTime);\n  }\n  /**\n   * Add a new runner for the application.\n   *\n   * @param name - The name of the new runner.\n   */\n  addRunner(name) {\n    const runner = new SystemRunner(name);\n    this.runners.push(runner);\n    return runner;\n  }\n  get prioritise() {\n    return this._prioritiser.prioritise;\n  }\n}\nexport {\n  Application\n};\n//# sourceMappingURL=Application.mjs.map\n","class Plugin {\n  constructor(app, options) {\n    this.app = app;\n    this.options = options || {};\n    this.verbose = (options == null ? void 0 : options.verbose) ?? app.verbose ?? false;\n  }\n}\nexport {\n  Plugin\n};\n//# sourceMappingURL=Plugin.mjs.map\n","function formatTextures(assets) {\n  var _a, _b;\n  for (const assetData of assets) {\n    const tags = (_a = assetData.data) == null ? void 0 : _a.tags;\n    const baseTexture = (_b = assetData.asset) == null ? void 0 : _b.source;\n    if (baseTexture) {\n      if (tags) {\n        if (tags.REPEAT) {\n          baseTexture.style.addressMode = \"repeat\";\n        }\n        if (tags.NEAREST) {\n          baseTexture.style.scaleMode = \"nearest\";\n        }\n      }\n    }\n  }\n}\nexport {\n  formatTextures\n};\n//# sourceMappingURL=formatTextures.mjs.map\n","import { ExtensionType, loadTextures } from \"pixi.js\";\nimport { formatTextures } from \"../utils/formatTextures.mjs\";\nconst loadTexturesWrapper = {\n  ...loadTextures,\n  extension: ExtensionType.LoadParser,\n  async load(url, loadAsset, loader) {\n    var _a, _b;\n    const res = await ((_b = (_a = loadTextures).load) == null ? void 0 : _b.call(_a, url, loadAsset, loader));\n    if (loadAsset) {\n      formatTextures([{ asset: res, data: loadAsset.data }]);\n    }\n    return res;\n  }\n};\nexport {\n  loadTexturesWrapper\n};\n//# sourceMappingURL=loadTexture.mjs.map\n","import { ExtensionType, loadWebFont } from \"pixi.js\";\nconst loadWebFontWrapper = {\n  ...loadWebFont,\n  extension: ExtensionType.LoadParser,\n  async load(url, loadAsset) {\n    var _a;\n    const validWeights = [\"normal\", \"bold\", \"100\", \"200\", \"300\", \"400\", \"500\", \"600\", \"700\", \"800\", \"900\"];\n    let weights = [];\n    const tags = ((_a = loadAsset == null ? void 0 : loadAsset.data) == null ? void 0 : _a.tags) || {};\n    if (tags.w) {\n      if (!Array.isArray(tags.w)) {\n        if (tags.w === \"all\") {\n          weights = validWeights;\n        } else {\n          weights.push(tags.w.toString());\n        }\n      } else {\n        weights.push(...tags.w.map((w) => w.toString()));\n      }\n    }\n    if (weights.length === 0) {\n      weights = [\"normal\"];\n    }\n    if (!weights.every((r) => validWeights.includes(r))) {\n      console.warn(`[loadWebFont] A font weight provided for ${url} is invalid`);\n    }\n    if (tags.w) {\n      loadAsset.data.weights = weights;\n    }\n    if (tags.family) {\n      loadAsset.data.family = tags.family;\n    }\n    return loadWebFont.load(url, loadAsset);\n  }\n};\nexport {\n  loadWebFontWrapper\n};\n//# sourceMappingURL=loadWebFont.mjs.map\n","import { ExtensionType, Resolver } from \"pixi.js\";\nconst atlasResolver = {\n  extension: {\n    type: ExtensionType.ResolveParser,\n    name: \"resolveSpineAtlas\"\n  },\n  test: (value) => {\n    const tempURL = value.split(\"?\")[0];\n    const split = tempURL.split(\".\");\n    const extension = split.pop();\n    const format = split.pop();\n    return extension === \"atlas\" && [\"png\", \"webp\", \"avif\"].includes(format);\n  },\n  parse: (value) => {\n    var _a;\n    const split = value.split(\".\");\n    return {\n      resolution: parseFloat(((_a = Resolver.RETINA_PREFIX.exec(value)) == null ? void 0 : _a[1]) ?? \"1\"),\n      format: split[split.length - 2],\n      src: value\n    };\n  }\n};\nexport {\n  atlasResolver\n};\n//# sourceMappingURL=spineParser.mjs.map\n","import { Assets, Spritesheet, Cache, convertToList } from \"pixi.js\";\nimport { PerformanceTracker } from \"../../utils/system/monitor/PerformanceTracker.mjs\";\nconst spritesheetHash = {};\nlet firstLoad = true;\nconst originalLoad = Assets.load;\nconst originalBackgroundLoad = Assets.backgroundLoad;\nconst mainOverride = (urls) => {\n  if (firstLoad) {\n    const manifest = Assets.resolver[\"_manifest\"];\n    if (manifest) {\n      manifest.bundles.forEach((bundle) => {\n        const assets = bundle.assets;\n        assets.forEach((asset) => {\n          if (asset.data.tags.tps && asset.data.frameNames) {\n            asset.data.frameNames.forEach((frameName) => {\n              spritesheetHash[frameName] = asset;\n            });\n          }\n        });\n      });\n      firstLoad = false;\n    }\n  }\n  const urlToSpritesheetMap = {};\n  const res = convertToList(urls, (url) => {\n    const spriteSheet = spritesheetHash[url];\n    if (spriteSheet) {\n      urlToSpritesheetMap[url] = spriteSheet;\n      return spriteSheet;\n    } else {\n      return url;\n    }\n  });\n  return { urlToSpritesheetMap, res };\n};\nfunction overrideAssetLoad() {\n  Assets.load = async (urls, onProgress) => {\n    const { res, urlToSpritesheetMap } = mainOverride(urls);\n    const originalResult = await originalLoad.bind(Assets)(res.length === 1 ? res[0] : res, onProgress);\n    let returnValue;\n    Object.entries(urlToSpritesheetMap).forEach(([key, _]) => {\n      const texture = originalResult[key];\n      if (!texture && !(originalResult instanceof Spritesheet)) {\n        originalResult[key] = Cache.get(key);\n        return;\n      }\n      returnValue = Cache.get(key);\n    });\n    const urlArray = Array.isArray(urls) ? urls : [urls];\n    const newUrls = urlArray.map((url) => typeof url === \"string\" ? url : url.alias[0]);\n    const progressSize = Object.values(Assets.resolver.resolve(newUrls)).map((u) => {\n      return u.progressSize ?? 1;\n    });\n    PerformanceTracker.assetMonitor.trackAsset(progressSize);\n    return returnValue ?? originalResult;\n  };\n  Assets.backgroundLoad = async (urls) => {\n    const { res } = mainOverride(urls);\n    const mappedRes = res.map((r) => {\n      return typeof r === \"string\" ? r : r.alias[0];\n    });\n    await originalBackgroundLoad.bind(Assets)(mappedRes);\n  };\n}\nexport {\n  overrideAssetLoad\n};\n//# sourceMappingURL=overrideAssetLoad.mjs.map\n","const warnings = {};\nfunction deprecation(version, message, ignoreDepth = 3) {\n  if (warnings[message]) {\n    return;\n  }\n  let stack = new Error().stack;\n  if (typeof stack === \"undefined\") {\n    console.warn(\"Astro Deprecation Warning: \", `${message}\nDeprecated since v${version}`);\n  } else {\n    stack = stack.split(\"\\n\").splice(ignoreDepth).join(\"\\n\");\n    if (console.groupCollapsed) {\n      console.groupCollapsed(\n        \"%cAstro Deprecation Warning: %c%s\",\n        \"color:#614108;background:#fffbe6\",\n        \"font-weight:normal;color:#614108;background:#fffbe6\",\n        `${message}\nDeprecated since v${version}`\n      );\n      console.warn(stack);\n      console.groupEnd();\n    } else {\n      console.warn(\"Astro Deprecation Warning: \", `${message}\nDeprecated since v${version}`);\n      console.warn(stack);\n    }\n  }\n  warnings[message] = true;\n}\nexport {\n  deprecation\n};\n//# sourceMappingURL=deprecation.mjs.map\n","/////////////////////////////////////////////////////////////////////////////////\n/* UAParser.js v1.0.41\n   Copyright  2012-2025 Faisal Salman <f@faisalman.com>\n   MIT License *//*\n   Detect Browser, Engine, OS, CPU, and Device type/model from User-Agent data.\n   Supports browser & node.js environment. \n   Demo   : https://faisalman.github.io/ua-parser-js\n   Source : https://github.com/faisalman/ua-parser-js */\n/////////////////////////////////////////////////////////////////////////////////\n\n(function (window, undefined) {\n\n    'use strict';\n\n    //////////////\n    // Constants\n    /////////////\n\n\n    var LIBVERSION  = '1.0.41',\n        EMPTY       = '',\n        UNKNOWN     = '?',\n        FUNC_TYPE   = 'function',\n        UNDEF_TYPE  = 'undefined',\n        OBJ_TYPE    = 'object',\n        STR_TYPE    = 'string',\n        MAJOR       = 'major',\n        MODEL       = 'model',\n        NAME        = 'name',\n        TYPE        = 'type',\n        VENDOR      = 'vendor',\n        VERSION     = 'version',\n        ARCHITECTURE= 'architecture',\n        CONSOLE     = 'console',\n        MOBILE      = 'mobile',\n        TABLET      = 'tablet',\n        SMARTTV     = 'smarttv',\n        WEARABLE    = 'wearable',\n        EMBEDDED    = 'embedded',\n        UA_MAX_LENGTH = 500;\n\n    var AMAZON  = 'Amazon',\n        APPLE   = 'Apple',\n        ASUS    = 'ASUS',\n        BLACKBERRY = 'BlackBerry',\n        BROWSER = 'Browser',\n        CHROME  = 'Chrome',\n        EDGE    = 'Edge',\n        FIREFOX = 'Firefox',\n        GOOGLE  = 'Google',\n        HONOR   = 'Honor',\n        HUAWEI  = 'Huawei',\n        LENOVO  = 'Lenovo',\n        LG      = 'LG',\n        MICROSOFT = 'Microsoft',\n        MOTOROLA  = 'Motorola',\n        NVIDIA  = 'Nvidia',\n        ONEPLUS = 'OnePlus',\n        OPERA   = 'Opera',\n        OPPO    = 'OPPO',\n        SAMSUNG = 'Samsung',\n        SHARP   = 'Sharp',\n        SONY    = 'Sony',\n        XIAOMI  = 'Xiaomi',\n        ZEBRA   = 'Zebra',\n        FACEBOOK    = 'Facebook',\n        CHROMIUM_OS = 'Chromium OS',\n        MAC_OS  = 'Mac OS',\n        SUFFIX_BROWSER = ' Browser';\n\n    ///////////\n    // Helper\n    //////////\n\n    var extend = function (regexes, extensions) {\n            var mergedRegexes = {};\n            for (var i in regexes) {\n                if (extensions[i] && extensions[i].length % 2 === 0) {\n                    mergedRegexes[i] = extensions[i].concat(regexes[i]);\n                } else {\n                    mergedRegexes[i] = regexes[i];\n                }\n            }\n            return mergedRegexes;\n        },\n        enumerize = function (arr) {\n            var enums = {};\n            for (var i=0; i<arr.length; i++) {\n                enums[arr[i].toUpperCase()] = arr[i];\n            }\n            return enums;\n        },\n        has = function (str1, str2) {\n            return typeof str1 === STR_TYPE ? lowerize(str2).indexOf(lowerize(str1)) !== -1 : false;\n        },\n        lowerize = function (str) {\n            return str.toLowerCase();\n        },\n        majorize = function (version) {\n            return typeof(version) === STR_TYPE ? version.replace(/[^\\d\\.]/g, EMPTY).split('.')[0] : undefined;\n        },\n        trim = function (str, len) {\n            if (typeof(str) === STR_TYPE) {\n                str = str.replace(/^\\s\\s*/, EMPTY);\n                return typeof(len) === UNDEF_TYPE ? str : str.substring(0, UA_MAX_LENGTH);\n            }\n    };\n\n    ///////////////\n    // Map helper\n    //////////////\n\n    var rgxMapper = function (ua, arrays) {\n\n            var i = 0, j, k, p, q, matches, match;\n\n            // loop through all regexes maps\n            while (i < arrays.length && !matches) {\n\n                var regex = arrays[i],       // even sequence (0,2,4,..)\n                    props = arrays[i + 1];   // odd sequence (1,3,5,..)\n                j = k = 0;\n\n                // try matching uastring with regexes\n                while (j < regex.length && !matches) {\n\n                    if (!regex[j]) { break; }\n                    matches = regex[j++].exec(ua);\n\n                    if (!!matches) {\n                        for (p = 0; p < props.length; p++) {\n                            match = matches[++k];\n                            q = props[p];\n                            // check if given property is actually array\n                            if (typeof q === OBJ_TYPE && q.length > 0) {\n                                if (q.length === 2) {\n                                    if (typeof q[1] == FUNC_TYPE) {\n                                        // assign modified match\n                                        this[q[0]] = q[1].call(this, match);\n                                    } else {\n                                        // assign given value, ignore regex match\n                                        this[q[0]] = q[1];\n                                    }\n                                } else if (q.length === 3) {\n                                    // check whether function or regex\n                                    if (typeof q[1] === FUNC_TYPE && !(q[1].exec && q[1].test)) {\n                                        // call function (usually string mapper)\n                                        this[q[0]] = match ? q[1].call(this, match, q[2]) : undefined;\n                                    } else {\n                                        // sanitize match using given regex\n                                        this[q[0]] = match ? match.replace(q[1], q[2]) : undefined;\n                                    }\n                                } else if (q.length === 4) {\n                                        this[q[0]] = match ? q[3].call(this, match.replace(q[1], q[2])) : undefined;\n                                }\n                            } else {\n                                this[q] = match ? match : undefined;\n                            }\n                        }\n                    }\n                }\n                i += 2;\n            }\n        },\n\n        strMapper = function (str, map) {\n\n            for (var i in map) {\n                // check if current value is array\n                if (typeof map[i] === OBJ_TYPE && map[i].length > 0) {\n                    for (var j = 0; j < map[i].length; j++) {\n                        if (has(map[i][j], str)) {\n                            return (i === UNKNOWN) ? undefined : i;\n                        }\n                    }\n                } else if (has(map[i], str)) {\n                    return (i === UNKNOWN) ? undefined : i;\n                }\n            }\n            return map.hasOwnProperty('*') ? map['*'] : str;\n    };\n\n    ///////////////\n    // String map\n    //////////////\n\n    // Safari < 3.0\n    var oldSafariMap = {\n            '1.0'   : '/8',\n            '1.2'   : '/1',\n            '1.3'   : '/3',\n            '2.0'   : '/412',\n            '2.0.2' : '/416',\n            '2.0.3' : '/417',\n            '2.0.4' : '/419',\n            '?'     : '/'\n        },\n        windowsVersionMap = {\n            'ME'        : '4.90',\n            'NT 3.11'   : 'NT3.51',\n            'NT 4.0'    : 'NT4.0',\n            '2000'      : 'NT 5.0',\n            'XP'        : ['NT 5.1', 'NT 5.2'],\n            'Vista'     : 'NT 6.0',\n            '7'         : 'NT 6.1',\n            '8'         : 'NT 6.2',\n            '8.1'       : 'NT 6.3',\n            '10'        : ['NT 6.4', 'NT 10.0'],\n            'RT'        : 'ARM'\n    };\n\n    //////////////\n    // Regex map\n    /////////////\n\n    var regexes = {\n\n        browser : [[\n\n            /\\b(?:crmo|crios)\\/([\\w\\.]+)/i                                      // Chrome for Android/iOS\n            ], [VERSION, [NAME, 'Chrome']], [\n            /edg(?:e|ios|a)?\\/([\\w\\.]+)/i                                       // Microsoft Edge\n            ], [VERSION, [NAME, 'Edge']], [\n\n            // Presto based\n            /(opera mini)\\/([-\\w\\.]+)/i,                                        // Opera Mini\n            /(opera [mobiletab]{3,6})\\b.+version\\/([-\\w\\.]+)/i,                 // Opera Mobi/Tablet\n            /(opera)(?:.+version\\/|[\\/ ]+)([\\w\\.]+)/i                           // Opera\n            ], [NAME, VERSION], [\n            /opios[\\/ ]+([\\w\\.]+)/i                                             // Opera mini on iphone >= 8.0\n            ], [VERSION, [NAME, OPERA+' Mini']], [\n            /\\bop(?:rg)?x\\/([\\w\\.]+)/i                                          // Opera GX\n            ], [VERSION, [NAME, OPERA+' GX']], [\n            /\\bopr\\/([\\w\\.]+)/i                                                 // Opera Webkit\n            ], [VERSION, [NAME, OPERA]], [\n\n            // Mixed\n            /\\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\\/ ]?([\\w\\.]+)/i            // Baidu\n            ], [VERSION, [NAME, 'Baidu']], [\n            /\\b(?:mxbrowser|mxios|myie2)\\/?([-\\w\\.]*)\\b/i                       // Maxthon\n            ], [VERSION, [NAME, 'Maxthon']], [\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\\/ ]?([\\w\\.]*)/i,      \n                                                                                // Lunascape/Maxthon/Netfront/Jasmine/Blazer/Sleipnir\n            // Trident based\n            /(avant|iemobile|slim(?:browser|boat|jet))[\\/ ]?([\\d\\.]*)/i,        // Avant/IEMobile/SlimBrowser/SlimBoat/Slimjet\n            /(?:ms|\\()(ie) ([\\w\\.]+)/i,                                         // Internet Explorer\n\n            // Blink/Webkit/KHTML based                                         // Flock/RockMelt/Midori/Epiphany/Silk/Skyfire/Bolt/Iron/Iridium/PhantomJS/Bowser/QupZilla/Falkon\n            /(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\\/([-\\w\\.]+)/i,\n                                                                                // Rekonq/Puffin/Brave/Whale/QQBrowserLite/QQ//Vivaldi/DuckDuckGo/Klar/Helio/Dragon\n            /(heytap|ovi|115)browser\\/([\\d\\.]+)/i,                              // HeyTap/Ovi/115\n            /(weibo)__([\\d\\.]+)/i                                               // Weibo\n            ], [NAME, VERSION], [\n            /quark(?:pc)?\\/([-\\w\\.]+)/i                                         // Quark\n            ], [VERSION, [NAME, 'Quark']], [\n            /\\bddg\\/([\\w\\.]+)/i                                                 // DuckDuckGo\n            ], [VERSION, [NAME, 'DuckDuckGo']], [\n            /(?:\\buc? ?browser|(?:juc.+)ucweb)[\\/ ]?([\\w\\.]+)/i                 // UCBrowser\n            ], [VERSION, [NAME, 'UC'+BROWSER]], [\n            /microm.+\\bqbcore\\/([\\w\\.]+)/i,                                     // WeChat Desktop for Windows Built-in Browser\n            /\\bqbcore\\/([\\w\\.]+).+microm/i,\n            /micromessenger\\/([\\w\\.]+)/i                                        // WeChat\n            ], [VERSION, [NAME, 'WeChat']], [\n            /konqueror\\/([\\w\\.]+)/i                                             // Konqueror\n            ], [VERSION, [NAME, 'Konqueror']], [\n            /trident.+rv[: ]([\\w\\.]{1,9})\\b.+like gecko/i                       // IE11\n            ], [VERSION, [NAME, 'IE']], [\n            /ya(?:search)?browser\\/([\\w\\.]+)/i                                  // Yandex\n            ], [VERSION, [NAME, 'Yandex']], [\n            /slbrowser\\/([\\w\\.]+)/i                                             // Smart Lenovo Browser\n            ], [VERSION, [NAME, 'Smart Lenovo '+BROWSER]], [\n            /(avast|avg)\\/([\\w\\.]+)/i                                           // Avast/AVG Secure Browser\n            ], [[NAME, /(.+)/, '$1 Secure '+BROWSER], VERSION], [\n            /\\bfocus\\/([\\w\\.]+)/i                                               // Firefox Focus\n            ], [VERSION, [NAME, FIREFOX+' Focus']], [\n            /\\bopt\\/([\\w\\.]+)/i                                                 // Opera Touch\n            ], [VERSION, [NAME, OPERA+' Touch']], [\n            /coc_coc\\w+\\/([\\w\\.]+)/i                                            // Coc Coc Browser\n            ], [VERSION, [NAME, 'Coc Coc']], [\n            /dolfin\\/([\\w\\.]+)/i                                                // Dolphin\n            ], [VERSION, [NAME, 'Dolphin']], [\n            /coast\\/([\\w\\.]+)/i                                                 // Opera Coast\n            ], [VERSION, [NAME, OPERA+' Coast']], [\n            /miuibrowser\\/([\\w\\.]+)/i                                           // MIUI Browser\n            ], [VERSION, [NAME, 'MIUI' + SUFFIX_BROWSER]], [\n            /fxios\\/([\\w\\.-]+)/i                                                // Firefox for iOS\n            ], [VERSION, [NAME, FIREFOX]], [\n            /\\bqihoobrowser\\/?([\\w\\.]*)/i                                       // 360\n            ], [VERSION, [NAME, '360']], [\n            /\\b(qq)\\/([\\w\\.]+)/i                                                // QQ\n            ], [[NAME, /(.+)/, '$1Browser'], VERSION], [\n            /(oculus|sailfish|huawei|vivo|pico)browser\\/([\\w\\.]+)/i\n            ], [[NAME, /(.+)/, '$1' + SUFFIX_BROWSER], VERSION], [              // Oculus/Sailfish/HuaweiBrowser/VivoBrowser/PicoBrowser\n            /samsungbrowser\\/([\\w\\.]+)/i                                        // Samsung Internet\n            ], [VERSION, [NAME, SAMSUNG + ' Internet']], [\n            /metasr[\\/ ]?([\\d\\.]+)/i                                            // Sogou Explorer\n            ], [VERSION, [NAME, 'Sogou Explorer']], [\n            /(sogou)mo\\w+\\/([\\d\\.]+)/i                                          // Sogou Mobile\n            ], [[NAME, 'Sogou Mobile'], VERSION], [\n            /(electron)\\/([\\w\\.]+) safari/i,                                    // Electron-based App\n            /(tesla)(?: qtcarbrowser|\\/(20\\d\\d\\.[-\\w\\.]+))/i,                   // Tesla\n            /m?(qqbrowser|2345(?=browser|chrome|explorer))\\w*[\\/ ]?v?([\\w\\.]+)/i   // QQ/2345\n            ], [NAME, VERSION], [\n            /(lbbrowser|rekonq)/i,                                              // LieBao Browser/Rekonq\n            /\\[(linkedin)app\\]/i                                                // LinkedIn App for iOS & Android\n            ], [NAME], [\n            /ome\\/([\\w\\.]+) \\w* ?(iron) saf/i,                                  // Iron\n            /ome\\/([\\w\\.]+).+qihu (360)[es]e/i                                  // 360\n            ], [VERSION, NAME], [\n\n            // WebView\n            /((?:fban\\/fbios|fb_iab\\/fb4a)(?!.+fbav)|;fbav\\/([\\w\\.]+);)/i       // Facebook App for iOS & Android\n            ], [[NAME, FACEBOOK], VERSION], [\n            /(Klarna)\\/([\\w\\.]+)/i,                                             // Klarna Shopping Browser for iOS & Android\n            /(kakao(?:talk|story))[\\/ ]([\\w\\.]+)/i,                             // Kakao App\n            /(naver)\\(.*?(\\d+\\.[\\w\\.]+).*\\)/i,                                  // Naver InApp\n            /(daum)apps[\\/ ]([\\w\\.]+)/i,                                        // Daum App\n            /safari (line)\\/([\\w\\.]+)/i,                                        // Line App for iOS\n            /\\b(line)\\/([\\w\\.]+)\\/iab/i,                                        // Line App for Android\n            /(alipay)client\\/([\\w\\.]+)/i,                                       // Alipay\n            /(twitter)(?:and| f.+e\\/([\\w\\.]+))/i,                               // Twitter\n            /(chromium|instagram|snapchat)[\\/ ]([-\\w\\.]+)/i                     // Chromium/Instagram/Snapchat\n            ], [NAME, VERSION], [\n            /\\bgsa\\/([\\w\\.]+) .*safari\\//i                                      // Google Search Appliance on iOS\n            ], [VERSION, [NAME, 'GSA']], [\n            /musical_ly(?:.+app_?version\\/|_)([\\w\\.]+)/i                        // TikTok\n            ], [VERSION, [NAME, 'TikTok']], [\n\n            /headlesschrome(?:\\/([\\w\\.]+)| )/i                                  // Chrome Headless\n            ], [VERSION, [NAME, CHROME+' Headless']], [\n\n            / wv\\).+(chrome)\\/([\\w\\.]+)/i                                       // Chrome WebView\n            ], [[NAME, CHROME+' WebView'], VERSION], [\n\n            /droid.+ version\\/([\\w\\.]+)\\b.+(?:mobile safari|safari)/i           // Android Browser\n            ], [VERSION, [NAME, 'Android '+BROWSER]], [\n\n            /(chrome|omniweb|arora|[tizenoka]{5} ?browser)\\/v?([\\w\\.]+)/i       // Chrome/OmniWeb/Arora/Tizen/Nokia\n            ], [NAME, VERSION], [\n\n            /version\\/([\\w\\.\\,]+) .*mobile\\/\\w+ (safari)/i                      // Mobile Safari\n            ], [VERSION, [NAME, 'Mobile Safari']], [\n            /version\\/([\\w(\\.|\\,)]+) .*(mobile ?safari|safari)/i                // Safari & Safari Mobile\n            ], [VERSION, NAME], [\n            /webkit.+?(mobile ?safari|safari)(\\/[\\w\\.]+)/i                      // Safari < 3.0\n            ], [NAME, [VERSION, strMapper, oldSafariMap]], [\n\n            /(webkit|khtml)\\/([\\w\\.]+)/i\n            ], [NAME, VERSION], [\n\n            // Gecko based\n            /(navigator|netscape\\d?)\\/([-\\w\\.]+)/i                              // Netscape\n            ], [[NAME, 'Netscape'], VERSION], [\n            /(wolvic|librewolf)\\/([\\w\\.]+)/i                                    // Wolvic/LibreWolf\n            ], [NAME, VERSION], [\n            /mobile vr; rv:([\\w\\.]+)\\).+firefox/i                               // Firefox Reality\n            ], [VERSION, [NAME, FIREFOX+' Reality']], [\n            /ekiohf.+(flow)\\/([\\w\\.]+)/i,                                       // Flow\n            /(swiftfox)/i,                                                      // Swiftfox\n            /(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\\/ ]?([\\w\\.\\+]+)/i,\n                                                                                // IceDragon/Iceweasel/Camino/Chimera/Fennec/Maemo/Minimo/Conkeror\n            /(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\\/([-\\w\\.]+)$/i,\n                                                                                // Firefox/SeaMonkey/K-Meleon/IceCat/IceApe/Firebird/Phoenix\n            /(firefox)\\/([\\w\\.]+)/i,                                            // Other Firefox-based\n            /(mozilla)\\/([\\w\\.]+) .+rv\\:.+gecko\\/\\d+/i,                         // Mozilla\n\n            // Other\n            /(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\\. ]?browser)[-\\/ ]?v?([\\w\\.]+)/i,\n                                                                                // Polaris/Lynx/Dillo/iCab/Doris/Amaya/w3m/NetSurf/Obigo/Mosaic/Go/ICE/UP.Browser/Ladybird\n            /\\b(links) \\(([\\w\\.]+)/i                                            // Links\n            ], [NAME, [VERSION, /_/g, '.']], [\n            \n            /(cobalt)\\/([\\w\\.]+)/i                                              // Cobalt\n            ], [NAME, [VERSION, /master.|lts./, \"\"]]\n        ],\n\n        cpu : [[\n\n            /\\b((amd|x|x86[-_]?|wow|win)64)\\b/i                                 // AMD64 (x64)\n            ], [[ARCHITECTURE, 'amd64']], [\n\n            /(ia32(?=;))/i,                                                     // IA32 (quicktime)\n            /\\b((i[346]|x)86)(pc)?\\b/i                                          // IA32 (x86)\n            ], [[ARCHITECTURE, 'ia32']], [\n\n            /\\b(aarch64|arm(v?[89]e?l?|_?64))\\b/i                               // ARM64\n            ], [[ARCHITECTURE, 'arm64']], [\n\n            /\\b(arm(v[67])?ht?n?[fl]p?)\\b/i                                     // ARMHF\n            ], [[ARCHITECTURE, 'armhf']], [\n\n            // PocketPC mistakenly identified as PowerPC\n            /( (ce|mobile); ppc;|\\/[\\w\\.]+arm\\b)/i\n            ], [[ARCHITECTURE, 'arm']], [\n\n            /((ppc|powerpc)(64)?)( mac|;|\\))/i                                  // PowerPC\n            ], [[ARCHITECTURE, /ower/, EMPTY, lowerize]], [\n\n            / sun4\\w[;\\)]/i                                                     // SPARC\n            ], [[ARCHITECTURE, 'sparc']], [\n\n            /\\b(avr32|ia64(?=;)|68k(?=\\))|\\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\\b|pa-risc)/i\n                                                                                // IA64, 68K, ARM/64, AVR/32, IRIX/64, MIPS/64, SPARC/64, PA-RISC\n            ], [[ARCHITECTURE, lowerize]]\n        ],\n\n        device : [[\n\n            //////////////////////////\n            // MOBILES & TABLETS\n            /////////////////////////\n\n            // Samsung\n            /\\b(sch-i[89]0\\d|shw-m380s|sm-[ptx]\\w{2,4}|gt-[pn]\\d{2,4}|sgh-t8[56]9|nexus 10)/i\n            ], [MODEL, [VENDOR, SAMSUNG], [TYPE, TABLET]], [\n            /\\b((?:s[cgp]h|gt|sm)-(?![lr])\\w+|sc[g-]?[\\d]+a?|galaxy nexus)/i,\n            /samsung[- ]((?!sm-[lr])[-\\w]+)/i,\n            /sec-(sgh\\w+)/i\n            ], [MODEL, [VENDOR, SAMSUNG], [TYPE, MOBILE]], [\n\n            // Apple\n            /(?:\\/|\\()(ip(?:hone|od)[\\w, ]*)(?:\\/|;)/i                          // iPod/iPhone\n            ], [MODEL, [VENDOR, APPLE], [TYPE, MOBILE]], [\n            /\\((ipad);[-\\w\\),; ]+apple/i,                                       // iPad\n            /applecoremedia\\/[\\w\\.]+ \\((ipad)/i,\n            /\\b(ipad)\\d\\d?,\\d\\d?[;\\]].+ios/i\n            ], [MODEL, [VENDOR, APPLE], [TYPE, TABLET]], [\n            /(macintosh);/i\n            ], [MODEL, [VENDOR, APPLE]], [\n\n            // Sharp\n            /\\b(sh-?[altvz]?\\d\\d[a-ekm]?)/i\n            ], [MODEL, [VENDOR, SHARP], [TYPE, MOBILE]], [\n\n            // Honor\n            /\\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\\)|;)/i\n            ], [MODEL, [VENDOR, HONOR], [TYPE, TABLET]], [\n            /honor([-\\w ]+)[;\\)]/i\n            ], [MODEL, [VENDOR, HONOR], [TYPE, MOBILE]], [\n\n            // Huawei\n            /\\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\\w\\. ]*(?= bui|\\)))\\b(?!.+d\\/s)/i\n            ], [MODEL, [VENDOR, HUAWEI], [TYPE, TABLET]], [\n            /(?:huawei)([-\\w ]+)[;\\)]/i,\n            /\\b(nexus 6p|\\w{2,4}e?-[atu]?[ln][\\dx][012359c][adn]?)\\b(?!.+d\\/s)/i\n            ], [MODEL, [VENDOR, HUAWEI], [TYPE, MOBILE]], [\n\n            // Xiaomi\n            /oid[^\\)]+; (2[\\dbc]{4}(182|283|rp\\w{2})[cgl]|m2105k81a?c)(?: bui|\\))/i,\n            /\\b((?:red)?mi[-_ ]?pad[\\w- ]*)(?: bui|\\))/i                                // Mi Pad tablets\n            ],[[MODEL, /_/g, ' '], [VENDOR, XIAOMI], [TYPE, TABLET]], [\n\n            /\\b(poco[\\w ]+|m2\\d{3}j\\d\\d[a-z]{2})(?: bui|\\))/i,                  // Xiaomi POCO\n            /\\b; (\\w+) build\\/hm\\1/i,                                           // Xiaomi Hongmi 'numeric' models\n            /\\b(hm[-_ ]?note?[_ ]?(?:\\d\\w)?) bui/i,                             // Xiaomi Hongmi\n            /\\b(redmi[\\-_ ]?(?:note|k)?[\\w_ ]+)(?: bui|\\))/i,                   // Xiaomi Redmi\n            /oid[^\\)]+; (m?[12][0-389][01]\\w{3,6}[c-y])( bui|; wv|\\))/i,        // Xiaomi Redmi 'numeric' models\n            /\\b(mi[-_ ]?(?:a\\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\\d?\\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\\))/i, // Xiaomi Mi\n            / ([\\w ]+) miui\\/v?\\d/i\n            ], [[MODEL, /_/g, ' '], [VENDOR, XIAOMI], [TYPE, MOBILE]], [\n\n            // OPPO\n            /; (\\w+) bui.+ oppo/i,\n            /\\b(cph[12]\\d{3}|p(?:af|c[al]|d\\w|e[ar])[mt]\\d0|x9007|a101op)\\b/i\n            ], [MODEL, [VENDOR, OPPO], [TYPE, MOBILE]], [\n            /\\b(opd2(\\d{3}a?))(?: bui|\\))/i\n            ], [MODEL, [VENDOR, strMapper, { 'OnePlus' : ['304', '403', '203'], '*' : OPPO }], [TYPE, TABLET]], [\n\n            // Vivo\n            /vivo (\\w+)(?: bui|\\))/i,\n            /\\b(v[12]\\d{3}\\w?[at])(?: bui|;)/i\n            ], [MODEL, [VENDOR, 'Vivo'], [TYPE, MOBILE]], [\n\n            // Realme\n            /\\b(rmx[1-3]\\d{3})(?: bui|;|\\))/i\n            ], [MODEL, [VENDOR, 'Realme'], [TYPE, MOBILE]], [\n\n            // Motorola\n            /\\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\\b[\\w ]+build\\//i,\n            /\\bmot(?:orola)?[- ](\\w*)/i,\n            /((?:moto(?! 360)[\\w\\(\\) ]+|xt\\d{3,4}|nexus 6)(?= bui|\\)))/i\n            ], [MODEL, [VENDOR, MOTOROLA], [TYPE, MOBILE]], [\n            /\\b(mz60\\d|xoom[2 ]{0,2}) build\\//i\n            ], [MODEL, [VENDOR, MOTOROLA], [TYPE, TABLET]], [\n\n            // LG\n            /((?=lg)?[vl]k\\-?\\d{3}) bui| 3\\.[-\\w; ]{10}lg?-([06cv9]{3,4})/i\n            ], [MODEL, [VENDOR, LG], [TYPE, TABLET]], [\n            /(lm(?:-?f100[nv]?|-[\\w\\.]+)(?= bui|\\))|nexus [45])/i,\n            /\\blg[-e;\\/ ]+((?!browser|netcast|android tv|watch)\\w+)/i,\n            /\\blg-?([\\d\\w]+) bui/i\n            ], [MODEL, [VENDOR, LG], [TYPE, MOBILE]], [\n\n            // Lenovo\n            /(ideatab[-\\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\\d{3,4}(?:f[cu]|xu|[av])|yt\\d?-[jx]?\\d+[lfmx])( bui|;|\\)|\\/)/i,\n            /lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\\w- ]+?)|tb[\\w-]{6,7})( bui|;|\\)|\\/)/i\n            ], [MODEL, [VENDOR, LENOVO], [TYPE, TABLET]], [\n\n            // Nokia\n            /(nokia) (t[12][01])/i\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n            /(?:maemo|nokia).*(n900|lumia \\d+|rm-\\d+)/i,\n            /nokia[-_ ]?(([-\\w\\. ]*))/i\n            ], [[MODEL, /_/g, ' '], [TYPE, MOBILE], [VENDOR, 'Nokia']], [\n\n            // Google\n            /(pixel (c|tablet))\\b/i                                             // Google Pixel C/Tablet\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, TABLET]], [\n            /droid.+; (pixel[\\daxl ]{0,6})(?: bui|\\))/i                         // Google Pixel\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, MOBILE]], [\n\n            // Sony\n            /droid.+; (a?\\d[0-2]{2}so|[c-g]\\d{4}|so[-gl]\\w+|xq-a\\w[4-7][12])(?= bui|\\).+chrome\\/(?![1-6]{0,1}\\d\\.))/i\n            ], [MODEL, [VENDOR, SONY], [TYPE, MOBILE]], [\n            /sony tablet [ps]/i,\n            /\\b(?:sony)?sgp\\w+(?: bui|\\))/i\n            ], [[MODEL, 'Xperia Tablet'], [VENDOR, SONY], [TYPE, TABLET]], [\n\n            // OnePlus\n            / (kb2005|in20[12]5|be20[12][59])\\b/i,\n            /(?:one)?(?:plus)? (a\\d0\\d\\d)(?: b|\\))/i\n            ], [MODEL, [VENDOR, ONEPLUS], [TYPE, MOBILE]], [\n\n            // Amazon\n            /(alexa)webm/i,\n            /(kf[a-z]{2}wi|aeo(?!bc)\\w\\w)( bui|\\))/i,                           // Kindle Fire without Silk / Echo Show\n            /(kf[a-z]+)( bui|\\)).+silk\\//i                                      // Kindle Fire HD\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, TABLET]], [\n            /((?:sd|kf)[0349hijorstuw]+)( bui|\\)).+silk\\//i                     // Fire Phone\n            ], [[MODEL, /(.+)/g, 'Fire Phone $1'], [VENDOR, AMAZON], [TYPE, MOBILE]], [\n\n            // BlackBerry\n            /(playbook);[-\\w\\),; ]+(rim)/i                                      // BlackBerry PlayBook\n            ], [MODEL, VENDOR, [TYPE, TABLET]], [\n            /\\b((?:bb[a-f]|st[hv])100-\\d)/i,\n            /\\(bb10; (\\w+)/i                                                    // BlackBerry 10\n            ], [MODEL, [VENDOR, BLACKBERRY], [TYPE, MOBILE]], [\n\n            // Asus\n            /(?:\\b|asus_)(transfo[prime ]{4,10} \\w+|eeepc|slider \\w+|nexus 7|padfone|p00[cj])/i\n            ], [MODEL, [VENDOR, ASUS], [TYPE, TABLET]], [\n            / (z[bes]6[027][012][km][ls]|zenfone \\d\\w?)\\b/i\n            ], [MODEL, [VENDOR, ASUS], [TYPE, MOBILE]], [\n\n            // HTC\n            /(nexus 9)/i                                                        // HTC Nexus 9\n            ], [MODEL, [VENDOR, 'HTC'], [TYPE, TABLET]], [\n            /(htc)[-;_ ]{1,2}([\\w ]+(?=\\)| bui)|\\w+)/i,                         // HTC\n\n            // ZTE\n            /(zte)[- ]([\\w ]+?)(?: bui|\\/|\\))/i,\n            /(alcatel|geeksphone|nexian|panasonic(?!(?:;|\\.))|sony(?!-bra))[-_ ]?([-\\w]*)/i         // Alcatel/GeeksPhone/Nexian/Panasonic/Sony\n            ], [VENDOR, [MODEL, /_/g, ' '], [TYPE, MOBILE]], [\n\n            // TCL\n            /droid [\\w\\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\\w*(\\)| bui)/i\n            ], [MODEL, [VENDOR, 'TCL'], [TYPE, TABLET]], [\n\n            // itel\n            /(itel) ((\\w+))/i\n            ], [[VENDOR, lowerize], MODEL, [TYPE, strMapper, { 'tablet' : ['p10001l', 'w7001'], '*' : 'mobile' }]], [\n\n            // Acer\n            /droid.+; ([ab][1-7]-?[0178a]\\d\\d?)/i\n            ], [MODEL, [VENDOR, 'Acer'], [TYPE, TABLET]], [\n\n            // Meizu\n            /droid.+; (m[1-5] note) bui/i,\n            /\\bmz-([-\\w]{2,})/i\n            ], [MODEL, [VENDOR, 'Meizu'], [TYPE, MOBILE]], [\n                \n            // Ulefone\n            /; ((?:power )?armor(?:[\\w ]{0,8}))(?: bui|\\))/i\n            ], [MODEL, [VENDOR, 'Ulefone'], [TYPE, MOBILE]], [\n\n            // Energizer\n            /; (energy ?\\w+)(?: bui|\\))/i,\n            /; energizer ([\\w ]+)(?: bui|\\))/i\n            ], [MODEL, [VENDOR, 'Energizer'], [TYPE, MOBILE]], [\n\n            // Cat\n            /; cat (b35);/i,\n            /; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\\))/i\n            ], [MODEL, [VENDOR, 'Cat'], [TYPE, MOBILE]], [\n\n            // Smartfren\n            /((?:new )?andromax[\\w- ]+)(?: bui|\\))/i\n            ], [MODEL, [VENDOR, 'Smartfren'], [TYPE, MOBILE]], [\n\n            // Nothing\n            /droid.+; (a(?:015|06[35]|142p?))/i\n            ], [MODEL, [VENDOR, 'Nothing'], [TYPE, MOBILE]], [\n\n            // Archos\n            /; (x67 5g|tikeasy \\w+|ac[1789]\\d\\w+)( b|\\))/i,\n            /archos ?(5|gamepad2?|([\\w ]*[t1789]|hello) ?\\d+[\\w ]*)( b|\\))/i\n            ], [MODEL, [VENDOR, 'Archos'], [TYPE, TABLET]], [\n            /archos ([\\w ]+)( b|\\))/i,\n            /; (ac[3-6]\\d\\w{2,8})( b|\\))/i \n            ], [MODEL, [VENDOR, 'Archos'], [TYPE, MOBILE]], [\n\n            // MIXED\n            /(imo) (tab \\w+)/i,                                                 // IMO\n            /(infinix) (x1101b?)/i                                              // Infinix XPad\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /(blackberry|benq|palm(?=\\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\\w]*)/i,\n                                                                                // BlackBerry/BenQ/Palm/Sony-Ericsson/Acer/Asus/Dell/Meizu/Motorola/Polytron/Infinix/Tecno/Micromax/Advan\n            /; (hmd|imo) ([\\w ]+?)(?: bui|\\))/i,                                // HMD/IMO\n            /(hp) ([\\w ]+\\w)/i,                                                 // HP iPAQ\n            /(microsoft); (lumia[\\w ]+)/i,                                      // Microsoft Lumia\n            /(lenovo)[-_ ]?([-\\w ]+?)(?: bui|\\)|\\/)/i,                          // Lenovo\n            /(oppo) ?([\\w ]+) bui/i                                             // OPPO\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n\n            /(kobo)\\s(ereader|touch)/i,                                         // Kobo\n            /(hp).+(touchpad(?!.+tablet)|tablet)/i,                             // HP TouchPad\n            /(kindle)\\/([\\w\\.]+)/i,                                             // Kindle\n            /(nook)[\\w ]+build\\/(\\w+)/i,                                        // Nook\n            /(dell) (strea[kpr\\d ]*[\\dko])/i,                                   // Dell Streak\n            /(le[- ]+pan)[- ]+(\\w{1,9}) bui/i,                                  // Le Pan Tablets\n            /(trinity)[- ]*(t\\d{3}) bui/i,                                      // Trinity Tablets\n            /(gigaset)[- ]+(q\\w{1,9}) bui/i,                                    // Gigaset Tablets\n            /(vodafone) ([\\w ]+)(?:\\)| bui)/i                                   // Vodafone\n            ], [VENDOR, MODEL, [TYPE, TABLET]], [\n\n            /(surface duo)/i                                                    // Surface Duo\n            ], [MODEL, [VENDOR, MICROSOFT], [TYPE, TABLET]], [\n            /droid [\\d\\.]+; (fp\\du?)(?: b|\\))/i                                 // Fairphone\n            ], [MODEL, [VENDOR, 'Fairphone'], [TYPE, MOBILE]], [\n            /(u304aa)/i                                                         // AT&T\n            ], [MODEL, [VENDOR, 'AT&T'], [TYPE, MOBILE]], [\n            /\\bsie-(\\w*)/i                                                      // Siemens\n            ], [MODEL, [VENDOR, 'Siemens'], [TYPE, MOBILE]], [\n            /\\b(rct\\w+) b/i                                                     // RCA Tablets\n            ], [MODEL, [VENDOR, 'RCA'], [TYPE, TABLET]], [\n            /\\b(venue[\\d ]{2,7}) b/i                                            // Dell Venue Tablets\n            ], [MODEL, [VENDOR, 'Dell'], [TYPE, TABLET]], [\n            /\\b(q(?:mv|ta)\\w+) b/i                                              // Verizon Tablet\n            ], [MODEL, [VENDOR, 'Verizon'], [TYPE, TABLET]], [\n            /\\b(?:barnes[& ]+noble |bn[rt])([\\w\\+ ]*) b/i                       // Barnes & Noble Tablet\n            ], [MODEL, [VENDOR, 'Barnes & Noble'], [TYPE, TABLET]], [\n            /\\b(tm\\d{3}\\w+) b/i\n            ], [MODEL, [VENDOR, 'NuVision'], [TYPE, TABLET]], [\n            /\\b(k88) b/i                                                        // ZTE K Series Tablet\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, TABLET]], [\n            /\\b(nx\\d{3}j) b/i                                                   // ZTE Nubia\n            ], [MODEL, [VENDOR, 'ZTE'], [TYPE, MOBILE]], [\n            /\\b(gen\\d{3}) b.+49h/i                                              // Swiss GEN Mobile\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, MOBILE]], [\n            /\\b(zur\\d{3}) b/i                                                   // Swiss ZUR Tablet\n            ], [MODEL, [VENDOR, 'Swiss'], [TYPE, TABLET]], [\n            /\\b((zeki)?tb.*\\b) b/i                                              // Zeki Tablets\n            ], [MODEL, [VENDOR, 'Zeki'], [TYPE, TABLET]], [\n            /\\b([yr]\\d{2}) b/i,\n            /\\b(dragon[- ]+touch |dt)(\\w{5}) b/i                                // Dragon Touch Tablet\n            ], [[VENDOR, 'Dragon Touch'], MODEL, [TYPE, TABLET]], [\n            /\\b(ns-?\\w{0,9}) b/i                                                // Insignia Tablets\n            ], [MODEL, [VENDOR, 'Insignia'], [TYPE, TABLET]], [\n            /\\b((nxa|next)-?\\w{0,9}) b/i                                        // NextBook Tablets\n            ], [MODEL, [VENDOR, 'NextBook'], [TYPE, TABLET]], [\n            /\\b(xtreme\\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i                  // Voice Xtreme Phones\n            ], [[VENDOR, 'Voice'], MODEL, [TYPE, MOBILE]], [\n            /\\b(lvtel\\-)?(v1[12]) b/i                                           // LvTel Phones\n            ], [[VENDOR, 'LvTel'], MODEL, [TYPE, MOBILE]], [\n            /\\b(ph-1) /i                                                        // Essential PH-1\n            ], [MODEL, [VENDOR, 'Essential'], [TYPE, MOBILE]], [\n            /\\b(v(100md|700na|7011|917g).*\\b) b/i                               // Envizen Tablets\n            ], [MODEL, [VENDOR, 'Envizen'], [TYPE, TABLET]], [\n            /\\b(trio[-\\w\\. ]+) b/i                                              // MachSpeed Tablets\n            ], [MODEL, [VENDOR, 'MachSpeed'], [TYPE, TABLET]], [\n            /\\btu_(1491) b/i                                                    // Rotor Tablets\n            ], [MODEL, [VENDOR, 'Rotor'], [TYPE, TABLET]], [\n            /((?:tegranote|shield t(?!.+d tv))[\\w- ]*?)(?: b|\\))/i              // Nvidia Tablets\n            ], [MODEL, [VENDOR, NVIDIA], [TYPE, TABLET]], [\n            /(sprint) (\\w+)/i                                                   // Sprint Phones\n            ], [VENDOR, MODEL, [TYPE, MOBILE]], [\n            /(kin\\.[onetw]{3})/i                                                // Microsoft Kin\n            ], [[MODEL, /\\./g, ' '], [VENDOR, MICROSOFT], [TYPE, MOBILE]], [\n            /droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\\)/i             // Zebra\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, TABLET]], [\n            /droid.+; (ec30|ps20|tc[2-8]\\d[kx])\\)/i\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, MOBILE]], [\n\n            ///////////////////\n            // SMARTTVS\n            ///////////////////\n\n            /smart-tv.+(samsung)/i                                              // Samsung\n            ], [VENDOR, [TYPE, SMARTTV]], [\n            /hbbtv.+maple;(\\d+)/i\n            ], [[MODEL, /^/, 'SmartTV'], [VENDOR, SAMSUNG], [TYPE, SMARTTV]], [\n            /(nux; netcast.+smarttv|lg (netcast\\.tv-201\\d|android tv))/i        // LG SmartTV\n            ], [[VENDOR, LG], [TYPE, SMARTTV]], [\n            /(apple) ?tv/i                                                      // Apple TV\n            ], [VENDOR, [MODEL, APPLE+' TV'], [TYPE, SMARTTV]], [\n            /crkey/i                                                            // Google Chromecast\n            ], [[MODEL, CHROME+'cast'], [VENDOR, GOOGLE], [TYPE, SMARTTV]], [\n            /droid.+aft(\\w+)( bui|\\))/i                                         // Fire TV\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, SMARTTV]], [\n            /(shield \\w+ tv)/i                                                  // Nvidia Shield TV\n            ], [MODEL, [VENDOR, NVIDIA], [TYPE, SMARTTV]], [\n            /\\(dtv[\\);].+(aquos)/i,\n            /(aquos-tv[\\w ]+)\\)/i                                               // Sharp\n            ], [MODEL, [VENDOR, SHARP], [TYPE, SMARTTV]],[\n            /(bravia[\\w ]+)( bui|\\))/i                                              // Sony\n            ], [MODEL, [VENDOR, SONY], [TYPE, SMARTTV]], [\n            /(mi(tv|box)-?\\w+) bui/i                                            // Xiaomi\n            ], [MODEL, [VENDOR, XIAOMI], [TYPE, SMARTTV]], [\n            /Hbbtv.*(technisat) (.*);/i                                         // TechniSAT\n            ], [VENDOR, MODEL, [TYPE, SMARTTV]], [\n            /\\b(roku)[\\dx]*[\\)\\/]((?:dvp-)?[\\d\\.]*)/i,                          // Roku\n            /hbbtv\\/\\d+\\.\\d+\\.\\d+ +\\([\\w\\+ ]*; *([\\w\\d][^;]*);([^;]*)/i         // HbbTV devices\n            ], [[VENDOR, trim], [MODEL, trim], [TYPE, SMARTTV]], [\n                                                                                // SmartTV from Unidentified Vendors\n            /droid.+; ([\\w- ]+) (?:android tv|smart[- ]?tv)/i\n            ], [MODEL, [TYPE, SMARTTV]], [\n            /\\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\\b/i\n            ], [[TYPE, SMARTTV]], [\n\n            ///////////////////\n            // CONSOLES\n            ///////////////////\n\n            /(ouya)/i,                                                          // Ouya\n            /(nintendo) ([wids3utch]+)/i                                        // Nintendo\n            ], [VENDOR, MODEL, [TYPE, CONSOLE]], [\n            /droid.+; (shield)( bui|\\))/i                                       // Nvidia Portable\n            ], [MODEL, [VENDOR, NVIDIA], [TYPE, CONSOLE]], [\n            /(playstation \\w+)/i                                                // Playstation\n            ], [MODEL, [VENDOR, SONY], [TYPE, CONSOLE]], [\n            /\\b(xbox(?: one)?(?!; xbox))[\\); ]/i                                // Microsoft Xbox\n            ], [MODEL, [VENDOR, MICROSOFT], [TYPE, CONSOLE]], [\n\n            ///////////////////\n            // WEARABLES\n            ///////////////////\n\n            /\\b(sm-[lr]\\d\\d[0156][fnuw]?s?|gear live)\\b/i                       // Samsung Galaxy Watch\n            ], [MODEL, [VENDOR, SAMSUNG], [TYPE, WEARABLE]], [\n            /((pebble))app/i,                                                   // Pebble\n            /(asus|google|lg|oppo) ((pixel |zen)?watch[\\w ]*)( bui|\\))/i        // Asus ZenWatch / LG Watch / Pixel Watch\n            ], [VENDOR, MODEL, [TYPE, WEARABLE]], [\n            /(ow(?:19|20)?we?[1-3]{1,3})/i                                      // Oppo Watch\n            ], [MODEL, [VENDOR, OPPO], [TYPE, WEARABLE]], [\n            /(watch)(?: ?os[,\\/]|\\d,\\d\\/)[\\d\\.]+/i                              // Apple Watch\n            ], [MODEL, [VENDOR, APPLE], [TYPE, WEARABLE]], [\n            /(opwwe\\d{3})/i                                                     // OnePlus Watch\n            ], [MODEL, [VENDOR, ONEPLUS], [TYPE, WEARABLE]], [\n            /(moto 360)/i                                                       // Motorola 360\n            ], [MODEL, [VENDOR, MOTOROLA], [TYPE, WEARABLE]], [\n            /(smartwatch 3)/i                                                   // Sony SmartWatch\n            ], [MODEL, [VENDOR, SONY], [TYPE, WEARABLE]], [\n            /(g watch r)/i                                                      // LG G Watch R\n            ], [MODEL, [VENDOR, LG], [TYPE, WEARABLE]], [\n            /droid.+; (wt63?0{2,3})\\)/i\n            ], [MODEL, [VENDOR, ZEBRA], [TYPE, WEARABLE]], [\n\n            ///////////////////\n            // XR\n            ///////////////////\n\n            /droid.+; (glass) \\d/i                                              // Google Glass\n            ], [MODEL, [VENDOR, GOOGLE], [TYPE, WEARABLE]], [\n            /(pico) (4|neo3(?: link|pro)?)/i                                    // Pico\n            ], [VENDOR, MODEL, [TYPE, WEARABLE]], [\n            /; (quest( \\d| pro)?)/i                                             // Oculus Quest\n            ], [MODEL, [VENDOR, FACEBOOK], [TYPE, WEARABLE]], [\n\n            ///////////////////\n            // EMBEDDED\n            ///////////////////\n\n            /(tesla)(?: qtcarbrowser|\\/[-\\w\\.]+)/i                              // Tesla\n            ], [VENDOR, [TYPE, EMBEDDED]], [\n            /(aeobc)\\b/i                                                        // Echo Dot\n            ], [MODEL, [VENDOR, AMAZON], [TYPE, EMBEDDED]], [\n            /(homepod).+mac os/i                                                // Apple HomePod\n            ], [MODEL, [VENDOR, APPLE], [TYPE, EMBEDDED]], [\n            /windows iot/i\n            ], [[TYPE, EMBEDDED]], [\n\n            ////////////////////\n            // MIXED (GENERIC)\n            ///////////////////\n\n            /droid .+?; ([^;]+?)(?: bui|; wv\\)|\\) applew).+? mobile safari/i    // Android Phones from Unidentified Vendors\n            ], [MODEL, [TYPE, MOBILE]], [\n            /droid .+?; ([^;]+?)(?: bui|\\) applew).+?(?! mobile) safari/i       // Android Tablets from Unidentified Vendors\n            ], [MODEL, [TYPE, TABLET]], [\n            /\\b((tablet|tab)[;\\/]|focus\\/\\d(?!.+mobile))/i                      // Unidentifiable Tablet\n            ], [[TYPE, TABLET]], [\n            /(phone|mobile(?:[;\\/]| [ \\w\\/\\.]*safari)|pda(?=.+windows ce))/i    // Unidentifiable Mobile\n            ], [[TYPE, MOBILE]], [\n            /droid .+?; ([\\w\\. -]+)( bui|\\))/i                                  // Generic Android Device\n            ], [MODEL, [VENDOR, 'Generic']]\n        ],\n\n        engine : [[\n\n            /windows.+ edge\\/([\\w\\.]+)/i                                       // EdgeHTML\n            ], [VERSION, [NAME, EDGE+'HTML']], [\n\n            /(arkweb)\\/([\\w\\.]+)/i                                              // ArkWeb\n            ], [NAME, VERSION], [\n\n            /webkit\\/537\\.36.+chrome\\/(?!27)([\\w\\.]+)/i                         // Blink\n            ], [VERSION, [NAME, 'Blink']], [\n\n            /(presto)\\/([\\w\\.]+)/i,                                             // Presto\n            /(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\\/([\\w\\.]+)/i, // WebKit/Trident/NetFront/NetSurf/Amaya/Lynx/w3m/Goanna/Servo\n            /ekioh(flow)\\/([\\w\\.]+)/i,                                          // Flow\n            /(khtml|tasman|links)[\\/ ]\\(?([\\w\\.]+)/i,                           // KHTML/Tasman/Links\n            /(icab)[\\/ ]([23]\\.[\\d\\.]+)/i,                                      // iCab\n\n            /\\b(libweb)/i                                                       // LibWeb\n            ], [NAME, VERSION], [\n            /ladybird\\//i\n            ], [[NAME, 'LibWeb']], [\n\n            /rv\\:([\\w\\.]{1,9})\\b.+(gecko)/i                                     // Gecko\n            ], [VERSION, NAME]\n        ],\n\n        os : [[\n\n            // Windows\n            /microsoft (windows) (vista|xp)/i                                   // Windows (iTunes)\n            ], [NAME, VERSION], [\n            /(windows (?:phone(?: os)?|mobile|iot))[\\/ ]?([\\d\\.\\w ]*)/i         // Windows Phone\n            ], [NAME, [VERSION, strMapper, windowsVersionMap]], [\n            /windows nt 6\\.2; (arm)/i,                                          // Windows RT\n            /windows[\\/ ]([ntce\\d\\. ]+\\w)(?!.+xbox)/i,\n            /(?:win(?=3|9|n)|win 9x )([nt\\d\\.]+)/i\n            ], [[VERSION, strMapper, windowsVersionMap], [NAME, 'Windows']], [\n\n            // iOS/macOS\n            /[adehimnop]{4,7}\\b(?:.*os ([\\w]+) like mac|; opera)/i,             // iOS\n            /(?:ios;fbsv\\/|iphone.+ios[\\/ ])([\\d\\.]+)/i,\n            /cfnetwork\\/.+darwin/i\n            ], [[VERSION, /_/g, '.'], [NAME, 'iOS']], [\n            /(mac os x) ?([\\w\\. ]*)/i,\n            /(macintosh|mac_powerpc\\b)(?!.+haiku)/i                             // Mac OS\n            ], [[NAME, MAC_OS], [VERSION, /_/g, '.']], [\n\n            // Mobile OSes\n            /droid ([\\w\\.]+)\\b.+(android[- ]x86|harmonyos)/i                    // Android-x86/HarmonyOS\n            ], [VERSION, NAME], [                                               \n            /(ubuntu) ([\\w\\.]+) like android/i                                  // Ubuntu Touch\n            ], [[NAME, /(.+)/, '$1 Touch'], VERSION], [\n                                                                                // Android/Blackberry/WebOS/QNX/Bada/RIM/KaiOS/Maemo/MeeGo/S40/Sailfish OS/OpenHarmony/Tizen\n            /(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\\w*[-\\/; ]?([\\d\\.]*)/i\n            ], [NAME, VERSION], [\n            /\\(bb(10);/i                                                        // BlackBerry 10\n            ], [VERSION, [NAME, BLACKBERRY]], [\n            /(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\\/ ]?([\\w\\.]*)/i       // Symbian\n            ], [VERSION, [NAME, 'Symbian']], [\n            /mozilla\\/[\\d\\.]+ \\((?:mobile|tablet|tv|mobile; [\\w ]+); rv:.+ gecko\\/([\\w\\.]+)/i // Firefox OS\n            ], [VERSION, [NAME, FIREFOX+' OS']], [\n            /web0s;.+rt(tv)/i,\n            /\\b(?:hp)?wos(?:browser)?\\/([\\w\\.]+)/i                              // WebOS\n            ], [VERSION, [NAME, 'webOS']], [\n            /watch(?: ?os[,\\/]|\\d,\\d\\/)([\\d\\.]+)/i                              // watchOS\n            ], [VERSION, [NAME, 'watchOS']], [\n\n            // Google Chromecast\n            /crkey\\/([\\d\\.]+)/i                                                 // Google Chromecast\n            ], [VERSION, [NAME, CHROME+'cast']], [\n            /(cros) [\\w]+(?:\\)| ([\\w\\.]+)\\b)/i                                  // Chromium OS\n            ], [[NAME, CHROMIUM_OS], VERSION],[\n\n            // Smart TVs\n            /panasonic;(viera)/i,                                               // Panasonic Viera\n            /(netrange)mmh/i,                                                   // Netrange\n            /(nettv)\\/(\\d+\\.[\\w\\.]+)/i,                                         // NetTV\n\n            // Console\n            /(nintendo|playstation) ([wids345portablevuch]+)/i,                 // Nintendo/Playstation\n            /(xbox); +xbox ([^\\);]+)/i,                                         // Microsoft Xbox (360, One, X, S, Series X, Series S)\n\n            // Other\n            /\\b(joli|palm)\\b ?(?:os)?\\/?([\\w\\.]*)/i,                            // Joli/Palm\n            /(mint)[\\/\\(\\) ]?(\\w*)/i,                                           // Mint\n            /(mageia|vectorlinux)[; ]/i,                                        // Mageia/VectorLinux\n            /([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\\/ ]?(?!chrom|package)([-\\w\\.]*)/i,\n                                                                                // Ubuntu/Debian/SUSE/Gentoo/Arch/Slackware/Fedora/Mandriva/CentOS/PCLinuxOS/RedHat/Zenwalk/Linpus/Raspbian/Plan9/Minix/RISCOS/Contiki/Deepin/Manjaro/elementary/Sabayon/Linspire\n            /(hurd|linux)(?: arm\\w*| x86\\w*| ?)([\\w\\.]*)/i,                     // Hurd/Linux\n            /(gnu) ?([\\w\\.]*)/i,                                                // GNU\n            /\\b([-frentopcghs]{0,5}bsd|dragonfly)[\\/ ]?(?!amd|[ix346]{1,2}86)([\\w\\.]*)/i, // FreeBSD/NetBSD/OpenBSD/PC-BSD/GhostBSD/DragonFly\n            /(haiku) (\\w+)/i                                                    // Haiku\n            ], [NAME, VERSION], [\n            /(sunos) ?([\\w\\.\\d]*)/i                                             // Solaris\n            ], [[NAME, 'Solaris'], VERSION], [\n            /((?:open)?solaris)[-\\/ ]?([\\w\\.]*)/i,                              // Solaris\n            /(aix) ((\\d)(?=\\.|\\)| )[\\w\\.])*/i,                                  // AIX\n            /\\b(beos|os\\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i, // BeOS/OS2/AmigaOS/MorphOS/OpenVMS/Fuchsia/HP-UX/SerenityOS\n            /(unix) ?([\\w\\.]*)/i                                                // UNIX\n            ], [NAME, VERSION]\n        ]\n    };\n\n    /////////////////\n    // Constructor\n    ////////////////\n\n    var UAParser = function (ua, extensions) {\n\n        if (typeof ua === OBJ_TYPE) {\n            extensions = ua;\n            ua = undefined;\n        }\n\n        if (!(this instanceof UAParser)) {\n            return new UAParser(ua, extensions).getResult();\n        }\n\n        var _navigator = (typeof window !== UNDEF_TYPE && window.navigator) ? window.navigator : undefined;\n        var _ua = ua || ((_navigator && _navigator.userAgent) ? _navigator.userAgent : EMPTY);\n        var _uach = (_navigator && _navigator.userAgentData) ? _navigator.userAgentData : undefined;\n        var _rgxmap = extensions ? extend(regexes, extensions) : regexes;\n        var _isSelfNav = _navigator && _navigator.userAgent == _ua;\n\n        this.getBrowser = function () {\n            var _browser = {};\n            _browser[NAME] = undefined;\n            _browser[VERSION] = undefined;\n            rgxMapper.call(_browser, _ua, _rgxmap.browser);\n            _browser[MAJOR] = majorize(_browser[VERSION]);\n            // Brave-specific detection\n            if (_isSelfNav && _navigator && _navigator.brave && typeof _navigator.brave.isBrave == FUNC_TYPE) {\n                _browser[NAME] = 'Brave';\n            }\n            return _browser;\n        };\n        this.getCPU = function () {\n            var _cpu = {};\n            _cpu[ARCHITECTURE] = undefined;\n            rgxMapper.call(_cpu, _ua, _rgxmap.cpu);\n            return _cpu;\n        };\n        this.getDevice = function () {\n            var _device = {};\n            _device[VENDOR] = undefined;\n            _device[MODEL] = undefined;\n            _device[TYPE] = undefined;\n            rgxMapper.call(_device, _ua, _rgxmap.device);\n            if (_isSelfNav && !_device[TYPE] && _uach && _uach.mobile) {\n                _device[TYPE] = MOBILE;\n            }\n            // iPadOS-specific detection: identified as Mac, but has some iOS-only properties\n            if (_isSelfNav && _device[MODEL] == 'Macintosh' && _navigator && typeof _navigator.standalone !== UNDEF_TYPE && _navigator.maxTouchPoints && _navigator.maxTouchPoints > 2) {\n                _device[MODEL] = 'iPad';\n                _device[TYPE] = TABLET;\n            }\n            return _device;\n        };\n        this.getEngine = function () {\n            var _engine = {};\n            _engine[NAME] = undefined;\n            _engine[VERSION] = undefined;\n            rgxMapper.call(_engine, _ua, _rgxmap.engine);\n            return _engine;\n        };\n        this.getOS = function () {\n            var _os = {};\n            _os[NAME] = undefined;\n            _os[VERSION] = undefined;\n            rgxMapper.call(_os, _ua, _rgxmap.os);\n            if (_isSelfNav && !_os[NAME] && _uach && _uach.platform && _uach.platform != 'Unknown') {\n                _os[NAME] = _uach.platform  \n                                    .replace(/chrome os/i, CHROMIUM_OS)\n                                    .replace(/macos/i, MAC_OS);           // backward compatibility\n            }\n            return _os;\n        };\n        this.getResult = function () {\n            return {\n                ua      : this.getUA(),\n                browser : this.getBrowser(),\n                engine  : this.getEngine(),\n                os      : this.getOS(),\n                device  : this.getDevice(),\n                cpu     : this.getCPU()\n            };\n        };\n        this.getUA = function () {\n            return _ua;\n        };\n        this.setUA = function (ua) {\n            _ua = (typeof ua === STR_TYPE && ua.length > UA_MAX_LENGTH) ? trim(ua, UA_MAX_LENGTH) : ua;\n            return this;\n        };\n        this.setUA(_ua);\n        return this;\n    };\n\n    UAParser.VERSION = LIBVERSION;\n    UAParser.BROWSER =  enumerize([NAME, VERSION, MAJOR]);\n    UAParser.CPU = enumerize([ARCHITECTURE]);\n    UAParser.DEVICE = enumerize([MODEL, VENDOR, TYPE, CONSOLE, MOBILE, SMARTTV, TABLET, WEARABLE, EMBEDDED]);\n    UAParser.ENGINE = UAParser.OS = enumerize([NAME, VERSION]);\n\n    ///////////\n    // Export\n    //////////\n\n    // check js environment\n    if (typeof(exports) !== UNDEF_TYPE) {\n        // nodejs env\n        if (typeof module !== UNDEF_TYPE && module.exports) {\n            exports = module.exports = UAParser;\n        }\n        exports.UAParser = UAParser;\n    } else {\n        // requirejs env (optional)\n        if (typeof(define) === FUNC_TYPE && define.amd) {\n            define(function () {\n                return UAParser;\n            });\n        } else if (typeof window !== UNDEF_TYPE) {\n            // browser env\n            window.UAParser = UAParser;\n        }\n    }\n\n    // jQuery/Zepto specific (optional)\n    // Note:\n    //   In AMD env the global scope should be kept clean, but jQuery is an exception.\n    //   jQuery always exports to global scope, unless jQuery.noConflict(true) is used,\n    //   and we should catch that.\n    var $ = typeof window !== UNDEF_TYPE && (window.jQuery || window.Zepto);\n    if ($ && !$.ua) {\n        var parser = new UAParser();\n        $.ua = parser.getResult();\n        $.ua.get = function () {\n            return parser.getUA();\n        };\n        $.ua.set = function (ua) {\n            parser.setUA(ua);\n            var result = parser.getResult();\n            for (var prop in result) {\n                $.ua[prop] = result[prop];\n            }\n        };\n    }\n\n})(typeof window === 'object' ? window : this);\n","var StorageType = /* @__PURE__ */ ((StorageType2) => {\n  StorageType2[\"LOCAL\"] = \"local\";\n  StorageType2[\"SESSION\"] = \"session\";\n  return StorageType2;\n})(StorageType || {});\nfunction autoDetectStorage(type) {\n  let storage;\n  try {\n    storage = type === \"local\" ? window.localStorage : window.sessionStorage;\n    const x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return e instanceof DOMException && // everything except Firefox\n    (e.code === 22 || // Firefox\n    e.code === 1014 || // test name field too, because code might not be present\n    // everything except Firefox\n    e.name === \"QuotaExceededError\" || // Firefox\n    e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") && // acknowledge QuotaExceededError only if there's something already stored\n    storage && storage.length !== 0;\n  }\n}\nexport {\n  StorageType,\n  autoDetectStorage\n};\n//# sourceMappingURL=autoDetectStorage.mjs.map\n","import { Device } from \"./Device.mjs\";\nfunction isIPhone6(query) {\n  if (!(query.type === \"device\" && query.value === \"iPhone6\")) return false;\n  if (Device.ios) {\n    if (window.outerHeight === 667 && window.outerWidth === 375 && window.devicePixelRatio === 3) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction isGalaxyS5(query) {\n  if (!(query.type === \"device\" && query.value === \"s5\")) return false;\n  if (Device.android) {\n    if (window.outerHeight === 560 && window.outerWidth === 360 && window.devicePixelRatio === 3) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction isKindle(query) {\n  if (!(query.type === \"device\" && query.value === \"kindle\")) return false;\n  const ua = navigator.userAgent;\n  return /Kindle|Silk|KFAPW|KFARWI|KFASWI|KFFOWI|KFJW|KFMEWI|KFOT|KFSAW|KFSOWI|KFTBW|KFTHW|KFTT|WFFOWI/i.test(ua);\n}\nfunction isSafari18Dot4(query) {\n  var _a, _b;\n  if (!(query.type === \"browser\" && query.value === \"safari-18.4\")) return false;\n  const ua = Device.uaData;\n  const version = (_a = ua == null ? void 0 : ua.browser) == null ? void 0 : _a.version;\n  const name = (_b = ua == null ? void 0 : ua.browser) == null ? void 0 : _b.name;\n  if (name === \"Mobile Safari\") {\n    if (!version) return false;\n    const [major, minor] = version.split(\".\").map(Number);\n    if (major === 18 && minor === 4) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction isSafari18(query) {\n  var _a, _b;\n  if (!(query.type === \"browser\" && query.value === \"safari-18\")) return false;\n  const ua = Device.uaData;\n  const version = (_a = ua == null ? void 0 : ua.browser) == null ? void 0 : _a.version;\n  const name = (_b = ua == null ? void 0 : ua.browser) == null ? void 0 : _b.name;\n  if (name === \"Mobile Safari\") {\n    if (!version) return false;\n    const [major] = version.split(\".\").map(Number);\n    if (major === 18) {\n      return true;\n    }\n  }\n  return false;\n}\nexport {\n  isGalaxyS5,\n  isIPhone6,\n  isKindle,\n  isSafari18,\n  isSafari18Dot4\n};\n//# sourceMappingURL=deviceQueries.mjs.map\n","import { UAParser } from \"ua-parser-js\";\nimport { autoDetectStorage, StorageType } from \"../detections/autoDetectStorage.mjs\";\nimport { isIPhone6, isGalaxyS5, isKindle, isSafari18Dot4, isSafari18 } from \"./deviceQueries.mjs\";\nvar GPU_TIER = /* @__PURE__ */ ((GPU_TIER2) => {\n  GPU_TIER2[GPU_TIER2[\"NONE\"] = 0] = \"NONE\";\n  GPU_TIER2[GPU_TIER2[\"LOW\"] = 1] = \"LOW\";\n  GPU_TIER2[GPU_TIER2[\"MEDIUM\"] = 2] = \"MEDIUM\";\n  GPU_TIER2[GPU_TIER2[\"HIGH\"] = 3] = \"HIGH\";\n  return GPU_TIER2;\n})(GPU_TIER || {});\nclass DeviceClass {\n  constructor() {\n    this.allowGPUData = true;\n    this.customQueries = [];\n    this.caches = {\n      query: {},\n      browser: {},\n      os: {},\n      device: {},\n      custom: {}\n    };\n    this.uaData = new UAParser().getResult();\n    this.isLocalStorageAllowed = autoDetectStorage(StorageType.LOCAL);\n    this.isSessionStorageAllowed = autoDetectStorage(StorageType.SESSION);\n    this._checkIPadPro();\n  }\n  get supportedFileFormats() {\n    console.warn(\"[Device] File format detection is no longer supported. Returning default values of false\");\n    return {\n      webp: false,\n      avif: false\n    };\n  }\n  get desktop() {\n    return !(this.uaData.device.type === \"tablet\" || this.uaData.device.type === \"mobile\");\n  }\n  get mobile() {\n    return this.isDevice(\"mobile\");\n  }\n  get phone() {\n    return this.isDevice(\"phone\");\n  }\n  get tablet() {\n    return this.isDevice(\"tablet\");\n  }\n  get android() {\n    return this.uaData.os.name === \"Android\";\n  }\n  get ios() {\n    return this.uaData.os.name === \"iOS\" || this.uaData.os.name === \"Mac OS\" && this.uaData.device.type === \"tablet\";\n  }\n  get kindle() {\n    return this.isDevice(\"kindle\");\n  }\n  get ie() {\n    return this.uaData.browser.name === \"IE\";\n  }\n  get gpu() {\n    console.warn(\"[Device] GPU data is no longer supported. Returning default value of 2\");\n    return 2;\n  }\n  /**\n   * Initialises async data about the device\n   */\n  async init() {\n    if (this.gpuData) return;\n    this.gpuData = {\n      tier: 2,\n      type: null\n    };\n  }\n  /**\n   * Adds a set of functions to the list to check against\n   *\n   * @param funcs - functions to check against\n   */\n  addQuery(...funcs) {\n    this.customQueries.push(...funcs);\n  }\n  /**\n   * Returns whether or not the query is true for this device\n   *\n   * @param query - query to be parsed\n   */\n  query(query) {\n    const cachedRes = this.checkCache(query, \"query\");\n    if (cachedRes !== null) return cachedRes;\n    const splitMatches = this.parseQuery(query);\n    let matches = true;\n    for (const match of splitMatches) {\n      const value = match;\n      switch (value.type) {\n        case \"browser\":\n          matches = this.isBrowser(value.value);\n          break;\n        case \"os\":\n          matches = this.isOS(value.value);\n          break;\n        case \"device\":\n          matches = this.isDevice(value.value);\n          break;\n        case \"gpu\":\n          console.warn(\"[Device] GPU data is no longer supported. Returning default value of 2\");\n          matches = this.isGPU(value.value);\n          break;\n        default:\n          matches = this.checkCustom(value);\n          break;\n      }\n      if (!matches) break;\n    }\n    this.addToCache(query, matches, \"query\");\n    return matches;\n  }\n  /**\n   * Returns whether or not the specified browser is being used\n   *\n   * @param value - value to test\n   */\n  isBrowser(value) {\n    const cachedRes = this.checkCache(value, \"browser\");\n    if (cachedRes !== null) return cachedRes;\n    const tests = [\n      () => this.checkCustom({ type: \"browser\", value }),\n      () => {\n        const isVersion = value.split(\":\");\n        if (isVersion.length > 1) {\n          return this.uaData.browser.version.split(\".\")[0] === isVersion[1];\n        }\n        return false;\n      },\n      () => this.uaData.browser.name.toLowerCase().replace(\" \", \"-\") === value\n    ];\n    return this.checkTests(tests, value, \"browser\");\n  }\n  /**\n   * Returns whether or not the specified OS is being used\n   *\n   * @param value - value to test\n   */\n  isOS(value) {\n    const cachedRes = this.checkCache(value, \"os\");\n    if (cachedRes !== null) return cachedRes;\n    const tests = [\n      () => this.checkCustom({ type: \"os\", value }),\n      () => {\n        const isVersion = value.split(\":\");\n        if (isVersion.length > 1) {\n          return this.uaData.os.version.split(\".\")[0] === isVersion[1];\n        }\n        return false;\n      },\n      () => {\n        if (value === \"mobile\" || value === \"desktop\") {\n          return value === \"mobile\" ? !this.desktop : this.desktop;\n        }\n        return false;\n      },\n      () => this.uaData.os.name.toLowerCase().replace(\" \", \"-\") === value\n    ];\n    return this.checkTests(tests, value, \"os\");\n  }\n  /**\n   * Returns whether or not the specified device is being used\n   *\n   * @param value - value to test\n   */\n  isDevice(value) {\n    const cachedRes = this.checkCache(value, \"device\");\n    if (cachedRes !== null) return cachedRes;\n    const tests = [\n      () => this.checkCustom({ type: \"device\", value }),\n      () => {\n        if (value === \"tablet\") return this.uaData.device.type === \"tablet\";\n        return false;\n      },\n      () => {\n        if (value === \"mobile\")\n          return this.uaData.device.type === \"tablet\" || this.uaData.device.type === \"mobile\";\n        return false;\n      },\n      () => {\n        if (value === \"phone\") {\n          return this.uaData.device.type === \"mobile\";\n        }\n        return false;\n      },\n      () => this.uaData.device.model === value\n    ];\n    return this.checkTests(tests, value, \"device\");\n  }\n  /**\n   * Returns whether or not the devices GPU is the correct tier\n   *\n   * @param value - value to test\n   */\n  isGPU(value) {\n    return this.gpu === Number(value);\n  }\n  /**\n   * Splits the query into its individual pieces ready to be processed\n   *\n   * @param query - query to be parsed\n   */\n  parseQuery(query) {\n    return query.split(\"--\").map((query2) => {\n      const split = query2.split(\":\").filter((value) => value !== \":\");\n      return {\n        type: split.shift(),\n        value: split.join(\":\")\n      };\n    });\n  }\n  /**\n   * Checks all the custom query functions to see if any of them match\n   *\n   * @param value - value to be checked\n   */\n  checkCustom(value) {\n    const cachedRes = this.checkCache(JSON.stringify(value), \"custom\");\n    if (cachedRes !== null) return cachedRes;\n    for (const query of this.customQueries) {\n      const queryTest = query;\n      if (queryTest(value)) {\n        this.addToCache(JSON.stringify(value), true, \"custom\");\n        return true;\n      }\n    }\n    this.addToCache(JSON.stringify(value), false, \"custom\");\n    return false;\n  }\n  checkCache(query, cacheType) {\n    if (this.caches[cacheType][query]) {\n      return this.caches[cacheType][query];\n    }\n    return null;\n  }\n  checkTests(tests, value, type) {\n    let res = false;\n    for (const test of tests) {\n      res = test();\n      if (res) break;\n    }\n    this.addToCache(value, res, type);\n    return res;\n  }\n  addToCache(query, result, cacheType) {\n    this.caches[cacheType][query] = result;\n  }\n  _checkIPadPro() {\n    const userAgent = this.uaData.ua;\n    const isMacOS = userAgent.includes(\"Mac OS\") && !userAgent.includes(\"like Mac OS\");\n    const touchCheck = \"ontouchstart\" in window;\n    if (isMacOS && touchCheck) {\n      this.uaData.device.type = \"tablet\";\n      this.uaData.device.vendor = \"apple\";\n      this.uaData.device.model = \"ipad-pro\";\n      console.warn(\"[Device]: OS cannot be determined on this device\");\n    }\n  }\n}\nconst Device = new DeviceClass();\nDevice.addQuery(isIPhone6, isGalaxyS5, isKindle, isSafari18Dot4, isSafari18);\nexport {\n  Device,\n  DeviceClass,\n  GPU_TIER\n};\n//# sourceMappingURL=Device.mjs.map\n","import { utils } from \"@pixi/sound\";\nimport { NakedPromise } from \"@play-co/commons\";\nimport { Assets, extensions, loadWebFont, loadTextures } from \"pixi.js\";\nimport { Plugin } from \"../app/Plugin.mjs\";\nimport { overrideAssetLoad } from \"./overrideAssetLoad.mjs\";\nimport { loadTexturesWrapper } from \"./plugins/loadTexture.mjs\";\nimport { loadWebFontWrapper } from \"./plugins/loadWebFont.mjs\";\nimport { atlasResolver } from \"./plugins/spineParser.mjs\";\nimport { deprecation } from \"../../utils/logging/deprecation.mjs\";\nimport { Device } from \"../../utils/system/devices/Device.mjs\";\noverrideAssetLoad();\nclass ResourcePlugin extends Plugin {\n  constructor() {\n    super(...arguments);\n    this.initialised = new NakedPromise();\n  }\n  /**\n   * Initializes PixiJS `Assets` class\n   */\n  async setup() {\n    if (Device.isBrowser(\"safari-18\")) {\n      utils.supported.ogg = false;\n      console.warn(\"iOS 18 has a bug with ogg support. Ogg files have been disabled.\");\n    }\n    await Assets.init(this.options);\n    this.initialised.resolve();\n  }\n  /**\n   * Loads assets from a path or a list of paths\n   *\n   * @param paths - The path or list of paths to load\n   * @deprecated since 8.4.0\n   */\n  async load(paths) {\n    deprecation(\"8.4.0\", \"Please use PixiJS Assets instead of ResourcePlugin. e.g Assets.load()\");\n    return typeof paths === \"string\" ? Assets.load(paths) : paths.map((path) => Assets.load(path));\n  }\n}\nextensions.remove(loadWebFont, loadTextures);\nextensions.add(loadWebFontWrapper, loadTexturesWrapper, atlasResolver);\nexport {\n  ResourcePlugin\n};\n//# sourceMappingURL=ResourcePlugin.mjs.map\n","import { Plugin } from \"../core/app/Plugin.mjs\";\nconst aliases = {\n  up: \"ArrowUp\",\n  down: \"ArrowDown\",\n  left: \"ArrowLeft\",\n  right: \"ArrowRight\",\n  space: \" \"\n};\nclass KeyBindingCollection {\n  constructor() {\n    this.map = {};\n  }\n  /**\n   *  Add a key binding\n   *\n   * @param binding - The key binding that will be added\n   */\n  add(binding) {\n    Object.entries(aliases).forEach(([key, value]) => {\n      if (key === binding.key) {\n        binding.key = value;\n      }\n    });\n    const list = this.map[binding.key] || [];\n    list.push(binding);\n    this.map[binding.key] = list;\n  }\n  /**\n   * Remove a key binding\n   *\n   * @param binding - The key binding that will be removed\n   */\n  remove(binding) {\n    const list = this.map[binding.key];\n    if (!list) return;\n    const index = list.indexOf(binding);\n    if (index < 0) return;\n    list.splice(index, 1);\n  }\n  /**\n   *  Retreive a key binding unsing its key id\n   *\n   * @param key - key binding id\n   * @returns key binding\n   */\n  bindingsByKey(key) {\n    return this.map[key] || [];\n  }\n}\nclass KeyboardPlugin extends Plugin {\n  /**\n   * @param app - Instance of the application\n   * @param options - Keyboard options\n   */\n  constructor(app, options) {\n    super(app, options);\n    this.enabled = true;\n    this._onKeyDown = (e) => {\n      if (!this.enabled || e.repeat) return;\n      const key = e.key;\n      const bindings = this._keyDownBindings.bindingsByKey(key);\n      for (const binding of bindings) {\n        if (binding.action) binding.action();\n        binding.isDown = true;\n      }\n    };\n    this._onBlur = () => {\n      if (!this.enabled) return;\n      const allDownBindings = this._keyDownBindings.map;\n      for (const key in allDownBindings) {\n        const bindings = allDownBindings[key];\n        for (const binding of bindings) {\n          if (binding.isDown) {\n            this._keyUpBindings.bindingsByKey(binding.key).forEach((bind) => {\n              var _a;\n              (_a = bind.action) == null ? void 0 : _a.call(bind);\n            });\n          }\n          binding.isDown = false;\n        }\n      }\n    };\n    this._onKeyUp = (e) => {\n      if (!this.enabled || e.repeat) return;\n      const key = e.key;\n      let bindings = this._keyUpBindings.bindingsByKey(key);\n      for (const binding of bindings) {\n        if (binding.action) binding.action();\n        binding.isDown = false;\n      }\n      bindings = this._keyDownBindings.bindingsByKey(key);\n      for (const binding of bindings) {\n        binding.isDown = false;\n      }\n    };\n    this._keyDownBindings = new KeyBindingCollection();\n    this._keyUpBindings = new KeyBindingCollection();\n    window.addEventListener(\"keydown\", this._onKeyDown);\n    window.addEventListener(\"keyup\", this._onKeyUp);\n    window.addEventListener(\"blur\", this._onBlur);\n  }\n  /** Empty key bindings for both key up and key down as well as remove event listeners*/\n  dispose() {\n    this._keyDownBindings.map = {};\n    this._keyUpBindings.map = {};\n    window.removeEventListener(\"keydown\", this._onKeyDown);\n    window.removeEventListener(\"keyup\", this._onKeyUp);\n    window.removeEventListener(\"blur\", this._onBlur);\n  }\n  bindKeyDown(key, action, options) {\n    if (typeof key === \"string\") {\n      return this._bindKeyDown(key, action, options);\n    }\n    return key.map((singleKey) => this._bindKeyDown(singleKey, action, options));\n  }\n  _bindKeyDown(key, action, options) {\n    const allowHold = (options == null ? void 0 : options.allowHold) || false;\n    const currentHoldTime = (options == null ? void 0 : options.holdTime) || 0.1;\n    const binding = { key, action, allowHold, currentHoldTime, holdTime: currentHoldTime };\n    this._keyDownBindings.add(binding);\n    return binding;\n  }\n  bindKeyUp(key, action) {\n    if (typeof key === \"string\") {\n      return this._bindKeyUp(key, action);\n    }\n    return key.map((singleKey) => this.bindKeyUp(singleKey, action));\n  }\n  _bindKeyUp(key, action) {\n    const binding = { key, action };\n    this._keyUpBindings.add(binding);\n    return binding;\n  }\n  /**\n   *  Unbind a key and its response\n   *\n   * @param binding - The key binding that will be removed\n   */\n  unbind(binding) {\n    this._keyDownBindings.remove(binding);\n    this._keyUpBindings.remove(binding);\n  }\n  /**\n   * Loop through bindings to see if keys are currently down and allowed to be held\n   *\n   * @param dt - delta time\n   */\n  update(dt) {\n    const bindings = this._keyDownBindings.map;\n    for (const key in bindings) {\n      const bind = bindings[key];\n      for (const b of bind) {\n        const element = b;\n        if (element.allowHold && element.isDown) {\n          if (element.currentHoldTime >= 0) {\n            element.currentHoldTime -= dt / 60;\n          } else {\n            element.currentHoldTime = element.holdTime;\n            if (element.action) element.action();\n          }\n        }\n      }\n    }\n  }\n  getBindings(key) {\n    return this._keyDownBindings.bindingsByKey(key);\n  }\n  isKeyDown(key) {\n    if (typeof key === \"string\") {\n      return this._isKeyDown(key);\n    }\n    const array = key.map((singleKey) => this._isKeyDown(singleKey));\n    for (const arr of array) {\n      const element = arr;\n      if (element === true) {\n        return true;\n      }\n    }\n    return false;\n  }\n  _isKeyDown(key) {\n    let isDown = false;\n    const bindings = this.getBindings(key);\n    if (!bindings) return false;\n    for (const key2 in bindings) {\n      const bind = bindings[key2];\n      if (bind.isDown) {\n        isDown = true;\n        break;\n      }\n    }\n    return isDown;\n  }\n}\nexport {\n  KeyBindingCollection,\n  KeyboardPlugin\n};\n//# sourceMappingURL=KeyboardPlugin.mjs.map\n","import { Lock, Vector2 } from \"@play-co/commons\";\nclass TouchInput {\n  // init\n  // -------------------------------------------------------------------------\n  constructor(source) {\n    this._enabled = true;\n    this._bubble = true;\n    this._down = false;\n    this._tapLock = new Lock();\n    this._source = source;\n    source == null ? void 0 : source.on(\"pointertap\", (event) => {\n      void this._onTap(event);\n    }).on(\"pointerdown\", (event) => {\n      this._onDown(event);\n    }).on(\"pointerup\", (event) => {\n      this._onUp(event);\n    }).on(\"pointerupoutside\", (event) => {\n      this._onUp(event);\n    }).on(\"pointerout\", (event) => {\n      var _a;\n      (_a = this.onOut) == null ? void 0 : _a.call(this, this._convertEvent(event));\n    }).on(\"pointermove\", (event) => {\n      var _a;\n      (_a = this.onMove) == null ? void 0 : _a.call(this, this._convertEvent(event));\n    });\n    this._updateEnabled();\n  }\n  // properties\n  // -------------------------------------------------------------------------\n  // enabled\n  get enabled() {\n    return this._enabled;\n  }\n  set enabled(enabled) {\n    this._enabled = enabled;\n    this._updateEnabled();\n  }\n  // bubble\n  get bubble() {\n    return this._bubble;\n  }\n  set bubble(bubble) {\n    this._bubble = bubble;\n  }\n  // api\n  // -------------------------------------------------------------------------\n  // emulate a tap\n  async triggerTap() {\n    this._down = true;\n    await this._onTap({\n      pointerId: 0,\n      global: { x: 0, y: 0 }\n    });\n  }\n  // private: updaters\n  // -------------------------------------------------------------------------\n  _updateEnabled() {\n    const source = this._source;\n    source.interactive = this.enabled;\n    source.cursor = this.enabled ? \"pointer\" : \"default\";\n  }\n  // private: event handlers\n  // -------------------------------------------------------------------------\n  async _onTap(event) {\n    var _a;\n    if (!this._bubble) event == null ? void 0 : event.stopImmediatePropagation();\n    if (this._down && this._tapLock.lock()) {\n      await ((_a = this.onTap) == null ? void 0 : _a.call(this, this._convertEvent(event)));\n      this._tapLock.unlock();\n    }\n    this._down = false;\n  }\n  _onDown(event) {\n    var _a;\n    if (!this._bubble) event == null ? void 0 : event.stopImmediatePropagation();\n    this._down = true;\n    (_a = this.onDown) == null ? void 0 : _a.call(this, this._convertEvent(event));\n  }\n  _onUp(event) {\n    var _a;\n    if ((_a = this.onUp) == null ? void 0 : _a.call(this, this._convertEvent(event))) {\n      this._down = false;\n    }\n  }\n  // private: support\n  // -------------------------------------------------------------------------\n  _convertEvent(event) {\n    return {\n      id: event.pointerId,\n      position: new Vector2(event.global.x, event.global.y)\n    };\n  }\n}\nexport {\n  TouchInput\n};\n//# sourceMappingURL=TouchInput.mjs.map\n","function autoDetectResolution() {\n  return Math.min(window.devicePixelRatio, 2);\n}\nexport {\n  autoDetectResolution\n};\n//# sourceMappingURL=autoDetectResolution.mjs.map\n","import { Device } from \"../devices/Device.mjs\";\nfunction autoDetectAntialias() {\n  return Device.desktop;\n}\nexport {\n  autoDetectAntialias\n};\n//# sourceMappingURL=autoDetectAntialias.mjs.map\n","function autoDetectTransparency() {\n  const canvas = document.createElement(\"canvas\");\n  let gl;\n  let debugInfo;\n  let renderer;\n  let transparent = false;\n  try {\n    gl = canvas.getContext(\"webgl\");\n    debugInfo = gl.getExtension(\"WEBGL_debug_renderer_info\");\n    renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);\n    const sub = renderer.substring(0, 8);\n    if (sub === \"Mali-400\" || sub === \"Mali-450\") {\n      transparent = true;\n    }\n  } catch (e) {\n    console.warn(\"WebGL or renderer info not supported!\");\n  }\n  return transparent;\n}\nexport {\n  autoDetectTransparency\n};\n//# sourceMappingURL=autoDetectTransparency.mjs.map\n","import { Container, autoDetectRenderer } from \"pixi.js\";\nimport { Plugin } from \"../core/app/Plugin.mjs\";\nimport { Device } from \"../utils/system/devices/Device.mjs\";\nimport { autoDetectResolution } from \"../utils/system/detections/autoDetectResolution.mjs\";\nimport { autoDetectAntialias } from \"../utils/system/detections/autoDetectAntialias.mjs\";\nimport { autoDetectTransparency } from \"../utils/system/detections/autoDetectTransparency.mjs\";\nif (Device.android) ;\nelse if (Device.ios) ;\nclass StagePlugin extends Plugin {\n  /**\n   *\n   * @param app - instance of the application\n   * @param options - stage options\n   */\n  constructor(app, options) {\n    super(app, options);\n    options.resolution = options.resolution ?? autoDetectResolution();\n    options.antialias = options.antialias ?? autoDetectAntialias();\n    options.powerPreference = options.powerPreference ?? \"high-performance\";\n    options.backgroundAlpha = options.backgroundAlpha ?? autoDetectTransparency() ? 0 : 1;\n    this.canvas = options.canvas = options.canvas || this._setupCanvas();\n    this.wrapper = document.createElement(\"div\");\n    this.wrapper.style.transformOrigin = \"0 0\";\n    this.wrapper.appendChild(options.canvas);\n    if (options.autoAddToDocument ?? true) {\n      document.body.appendChild(this.wrapper);\n    }\n    this.stage = new Container();\n    this.mainContainer = new Container();\n    this.overlayContainer = new Container();\n    this.stage.addChild(this.mainContainer);\n    this.stage.addChild(this.overlayContainer);\n    this.useHalfFPS = options.useHalfFPS ?? false;\n    this._halfTick = 0;\n    this.rendererPromise = autoDetectRenderer({ canvas: this.canvas, ...this.options });\n  }\n  async init() {\n    this.renderer = await this.rendererPromise;\n    if (this.renderer.accessibility) {\n      this.renderer.accessibility.debug = this.options.accessibilityDebug ?? false;\n      if (this.options.alwaysOnAccessibility ?? false) {\n        this.renderer.accessibility[\"_isMobileAccessibility\"] = true;\n        this.renderer.accessibility[\"_activate\"]();\n        this.renderer.accessibility[\"_destroyTouchHook\"]();\n      }\n    }\n  }\n  /**\n   * Creates a default canvas with some css styles applied.\n   */\n  _setupCanvas() {\n    const canvas = document.createElement(\"canvas\");\n    canvas.id = \"pixi-canvas\";\n    canvas.style.position = \"absolute\";\n    canvas.style.left = \"0px\";\n    canvas.style.right = \"0px\";\n    canvas.style.top = \"0px\";\n    canvas.style.bottom = \"0px\";\n    canvas.style.width = \"100%\";\n    canvas.style.height = \"100%\";\n    canvas.style.overflow = \"visible\";\n    canvas.style.display = \"block\";\n    canvas.style.margin = \"0 auto\";\n    return canvas;\n  }\n  /**\n   * Removes the update function from the apps update runner and adds it back again.\n   *\n   * This ensures that rendering is the last thing to happen. If it happens halfway it can introduce some jank where things fall\n   * out of sync\n   */\n  start() {\n    this.app.updateRunner.remove(this.update);\n    this.app.updateRunner.add(this.update);\n  }\n  /**\n   * Calls the renderer.render function. If halfTick is true then this function is called every other frame instead.\n   */\n  update(dt) {\n    if (!Device.ios || dt > 0.8) {\n      this._halfTick++;\n      if (!this.useHalfFPS || this._halfTick % 2) {\n        this.renderer.render(this.stage);\n      }\n    }\n  }\n  /**\n   * @returns the canvas element of the renderer\n   */\n  get view() {\n    return this.renderer.canvas;\n  }\n  get element() {\n    return this.renderer.canvas;\n  }\n  /**\n   * Sets the stage to be interactive... or not!\n   * This also covers affects accessibility too\n   */\n  set interactive(value) {\n    this.stage.interactive = value;\n    this.stage.interactiveChildren = value;\n  }\n  /**\n   * @returns whether the stage is interactive or not.\n   */\n  get interactive() {\n    return this.stage.interactive;\n  }\n}\nexport {\n  StagePlugin\n};\n//# sourceMappingURL=StagePlugin.mjs.map\n","function resizeDefault(w, h) {\n  return { rendererWidth: w, rendererHeight: h, canvasWidth: w, canvasHeight: h };\n}\nexport {\n  resizeDefault\n};\n//# sourceMappingURL=resizeDefault.mjs.map\n","import { throttle } from \"@play-co/commons\";\nimport { EventSystem } from \"pixi.js\";\nimport { Signal } from \"typed-signals\";\nimport { Plugin } from \"../../core/app/Plugin.mjs\";\nimport { StagePlugin } from \"../StagePlugin.mjs\";\nimport { resizeDefault } from \"./resizeDefault.mjs\";\nimport { Device } from \"../../utils/system/devices/Device.mjs\";\nclass ResizePlugin extends Plugin {\n  constructor(app, options) {\n    var _a;\n    super(app, options);\n    this.onResize = new Signal();\n    this._w = 0;\n    this._h = 0;\n    this._canvasWidth = 0;\n    this._canvasHeight = 0;\n    this.autoResize = options.autoResize ?? true;\n    this.resizeFunction = (options == null ? void 0 : options.resizeFunction) || resizeDefault;\n    this.fitToCanvasParent = options.fitToCanvasParent;\n    this.orientationLock = options.orientationLock ?? \"none\";\n    if (((_a = screen == null ? void 0 : screen.orientation) == null ? void 0 : _a.type) === void 0) {\n      this.orientationLock = \"none\";\n    }\n  }\n  /**\n   * begins to listen to the window resize event\n   */\n  prepare() {\n    var _a, _b;\n    if (this.orientationLock !== \"none\") {\n      this._overrideMapPositionToPoint();\n    }\n    if (this.autoResize) {\n      const stageView = (_b = (_a = this.app.get(StagePlugin)) == null ? void 0 : _a.view) == null ? void 0 : _b.parentElement;\n      const parent = this.fitToCanvasParent ? stageView : null;\n      window.addEventListener(\"resize\", () => {\n        const { width: width2, height: height2 } = this._getMeasurements(parent);\n        throttle(this.resize, Device.desktop ? 0 : 100, this)(width2, height2);\n      });\n      const { width, height } = this._getMeasurements(parent);\n      this.resize(width, height);\n    }\n  }\n  /**\n   * Get measurements from parent container, temporarily hiding canvas to avoid circular dependency\n   */\n  _getMeasurements(parent) {\n    if (!parent || !this.fitToCanvasParent) {\n      return {\n        width: (parent == null ? void 0 : parent.clientWidth) ?? window.innerWidth,\n        height: (parent == null ? void 0 : parent.clientHeight) ?? window.innerHeight\n      };\n    }\n    const stage = this.app.get(StagePlugin);\n    const canvas = stage == null ? void 0 : stage.canvas;\n    if (!(canvas == null ? void 0 : canvas.style)) {\n      return {\n        width: parent.clientWidth,\n        height: parent.clientHeight\n      };\n    }\n    const originalDisplay = canvas.style.display;\n    const needsHiding = originalDisplay !== \"none\";\n    try {\n      if (needsHiding) {\n        canvas.style.display = \"none\";\n      }\n      const width = parent.clientWidth;\n      const height = parent.clientHeight;\n      return { width, height };\n    } finally {\n      if (needsHiding) {\n        canvas.style.display = originalDisplay;\n      }\n    }\n  }\n  /**\n   * Override the mapPositionToPoint function to account for the manual transform of the canvas\n   */\n  _overrideMapPositionToPoint() {\n    EventSystem.prototype.mapPositionToPoint = (point, x, y) => {\n      const resolutionMultiplier = 1 / this.resolution;\n      const stage = this.app.get(StagePlugin);\n      const canvas = stage.canvas;\n      const canvasWidth = canvas.width;\n      const canvasHeight = canvas.height;\n      const canvasStyleWidth = parseFloat(canvas.style.width);\n      const canvasStyleHeight = parseFloat(canvas.style.height);\n      const isPortrait = this.orientationLock === \"portrait\";\n      const transformPoint = { x, y };\n      switch (screen.orientation.type) {\n        case \"portrait-primary\":\n          if (!isPortrait) {\n            transformPoint.x = y;\n            transformPoint.y = canvasStyleHeight - x;\n          }\n          break;\n        case \"landscape-primary\":\n          if (isPortrait) {\n            transformPoint.x = canvasStyleWidth - y;\n            transformPoint.y = x;\n          }\n          break;\n        case \"landscape-secondary\":\n          if (isPortrait) {\n            transformPoint.x = y;\n            transformPoint.y = canvasStyleHeight - x;\n          }\n          break;\n        case \"portrait-secondary\":\n          if (!isPortrait) {\n            transformPoint.y = canvasStyleWidth - y;\n          }\n          break;\n      }\n      point.x = transformPoint.x * (canvasWidth / canvasStyleWidth) * resolutionMultiplier;\n      point.y = transformPoint.y * (canvasHeight / canvasStyleHeight) * resolutionMultiplier;\n    };\n  }\n  /**\n   * adjust the resolution of the canvas on the fly!\n   */\n  set resolution(value) {\n    const renderer = this.app.get(StagePlugin).renderer;\n    renderer.resolution = value;\n    this.resize(this._w, this._h, true);\n  }\n  /**\n   * get the resolution of the renderer\n   */\n  get resolution() {\n    const renderer = this.app.get(StagePlugin).renderer;\n    return renderer.resolution;\n  }\n  /**\n   * resize function. called automatically if autoResize is true.\n   * if autoResize is false, its up to you to cal this.\n   *\n   * @param w - width of the window\n   * @param h - height of the window\n   * @param force - force the resize to happen even if the screen size remains the same\n   */\n  resize(w, h, force = false) {\n    var _a;\n    const stage = this.app.get(StagePlugin);\n    const renderer = stage.renderer;\n    const newOrientation = ((_a = screen == null ? void 0 : screen.orientation) == null ? void 0 : _a.type) ?? \"unknown\";\n    const isCorrectOrientation = this.orientationLock === \"none\" || newOrientation.includes(this.orientationLock);\n    const { canvasWidth, canvasHeight, rendererWidth, rendererHeight } = isCorrectOrientation ? this.resizeFunction(w, h) : this.resizeFunction(h, w);\n    if (force || this._w !== rendererWidth || this._h !== rendererHeight || this._canvasWidth !== canvasWidth || this._canvasHeight !== canvasHeight || this.currentOrientation !== newOrientation) {\n      this._w = rendererWidth;\n      this._h = rendererHeight;\n      this._canvasWidth = canvasWidth;\n      this._canvasHeight = canvasHeight;\n      this.currentOrientation = newOrientation;\n      const canvas = stage.canvas;\n      canvas.style.width = `${canvasWidth}px`;\n      canvas.style.height = `${canvasHeight}px`;\n      if (this.orientationLock !== \"none\" && this.currentOrientation !== \"unknown\") {\n        const isPortrait = this.orientationLock === \"portrait\";\n        switch (newOrientation) {\n          case \"portrait-primary\":\n            stage.wrapper.style.transform = isPortrait ? \"\" : `rotate(90deg) translate(0, -${canvasHeight}px)`;\n            break;\n          case \"landscape-primary\":\n            stage.wrapper.style.transform = isPortrait ? `rotate(-90deg) translate(-${canvasWidth}px, 0)` : \"\";\n            break;\n          case \"landscape-secondary\":\n            stage.wrapper.style.transform = isPortrait ? `rotate(90deg) translate(0, -${canvasHeight}px)` : \"\";\n            break;\n          case \"portrait-secondary\":\n            stage.wrapper.style.transform = isPortrait ? \"\" : `rotate(-90deg) translate(-${canvasWidth}px, 0)`;\n            break;\n        }\n      }\n      window.scrollTo(0, 0);\n      renderer.resize(this.w, this.h);\n      this.onResize.emit(this.w, this.h);\n    }\n  }\n  get w() {\n    return this._w;\n  }\n  get h() {\n    return this._h;\n  }\n  get width() {\n    return this._w;\n  }\n  get height() {\n    return this._h;\n  }\n  get canvasWidth() {\n    return this._canvasWidth;\n  }\n  get canvasHeight() {\n    return this._canvasHeight;\n  }\n  get isCorrectOrientation() {\n    return this.orientationLock === \"none\" || this.currentOrientation.includes(this.orientationLock);\n  }\n}\nexport {\n  ResizePlugin\n};\n//# sourceMappingURL=ResizePlugin.mjs.map\n","import { Container } from \"pixi.js\";\nclass EmptyScreen {\n  constructor(app) {\n    this.app = app;\n    this.view = new Container();\n  }\n  async init() {\n  }\n  async show() {\n  }\n  shown() {\n  }\n  async hide() {\n  }\n  async hidden() {\n  }\n  resize(w, h) {\n  }\n}\nexport {\n  EmptyScreen\n};\n//# sourceMappingURL=EmptyScreen.mjs.map\n","class History {\n  /**\n   * Create a history.\n   */\n  constructor() {\n    this.history = [];\n    this.currentIndex = -1;\n  }\n  /**\n   * Navigate to a new screen.\n   *\n   * @param id - The id of the screen.\n   * @param data - The data associated with the screen.\n   */\n  navigate(id, data) {\n    this.history = this.history.slice(0, this.currentIndex + 1);\n    this.history.push({ id, data });\n    this.currentIndex++;\n  }\n  /**\n   * Go back to the previous screen.\n   *\n   * @returns The previous screen object, or null if there is no previous screen.\n   */\n  back() {\n    if (this.canGoBack()) {\n      this.currentIndex--;\n      return this.currentScreen();\n    }\n    return null;\n  }\n  /**\n   * Go forward to the next screen.\n   *\n   * @returns The next screen object, or null if there is no next screen.\n   */\n  forward() {\n    if (this.canGoForward()) {\n      this.currentIndex++;\n      return this.currentScreen();\n    }\n    return null;\n  }\n  /**\n   * Check if it's possible to go back.\n   *\n   * @returns True if it's possible to go back, false otherwise.\n   */\n  canGoBack() {\n    return this.currentIndex > 0;\n  }\n  /**\n   * Check if it's possible to go forward.\n   *\n   * @returns True if it's possible to go forward, false otherwise.\n   */\n  canGoForward() {\n    return this.currentIndex < this.history.length - 1;\n  }\n  /**\n   * Get the current screen.\n   *\n   * @returns The current screen object.\n   */\n  currentScreen() {\n    return this.history[this.currentIndex];\n  }\n}\nexport {\n  History\n};\n//# sourceMappingURL=History.mjs.map\n","import { Container, Graphics, Sprite } from \"pixi.js\";\nclass Bar extends Container {\n  constructor(options = {}) {\n    super();\n    this.barWidth = options.width ?? 100;\n    const bg = this.getPixiObject(options.bg, this.barWidth);\n    const frame = this.getPixiObject(options.frame, this.barWidth);\n    const bar = this.getPixiObject(options.bar ?? 16711680, this.barWidth);\n    if (options.frameTint !== void 0) {\n      frame.tint = 4144959;\n    }\n    this._easing = options.easing ?? 1;\n    this._easeRatio = 0;\n    this._ratio = 0;\n    if (bg) {\n      this.bg = bg;\n      this.addChild(bg);\n    }\n    if (bar) {\n      this.addChild(bar);\n      this.bar = bar;\n    }\n    if (frame) {\n      if (frame.width > bar.width) {\n        frame.x = -(frame.width - bar.width) / 2;\n      }\n      if (frame.height > bar.height) {\n        frame.y = -(frame.height - bar.height) / 2;\n      }\n      this.addChild(frame);\n    }\n    const mask = this.getPixiObject(options.mask, this.barWidth);\n    if (mask) {\n      this._barMask = mask;\n      this.addChild(this._barMask);\n      this.bar.mask = this._barMask;\n      this._barMask.x -= this.bar.width;\n    }\n    this.onRender = this._updateTransform;\n  }\n  _updateTransform() {\n    this._easeRatio += (this._ratio - this._easeRatio) * this._easing;\n    if (this.bar && !this._barMask) {\n      this.bar.scale.x = this._easeRatio;\n    } else if (this._barMask) {\n      this._barMask.x = -this._barMask.width + this._barMask.width / 100 * (this._easeRatio * 100);\n    }\n  }\n  getPixiObject(id, width) {\n    let item = null;\n    if (typeof id === \"number\") {\n      item = new Graphics();\n      item.context.fill({\n        color: id\n      }).rect(0, 0, width, 40);\n    } else if (typeof id === \"string\") {\n      item = Sprite.from(id);\n    } else {\n      item = id;\n    }\n    return item;\n  }\n  set ratio(value) {\n    this._ratio = Math.max(Math.min(value, 1), 0);\n  }\n  get ratio() {\n    return this._ratio;\n  }\n}\nexport {\n  Bar\n};\n//# sourceMappingURL=Bar.mjs.map\n","import { gsap } from \"gsap\";\nimport { Container } from \"pixi.js\";\nimport { Bar } from \"../temp-ui/Bar.mjs\";\nclass LoaderScreen {\n  constructor() {\n    this.view = new Container();\n    this.bar = new Bar({ bg: 0, bar: 16711680, width: 300 });\n    this.view.addChild(this.bar);\n  }\n  updateProgress(value) {\n    this.bar.ratio = value;\n  }\n  show() {\n    this.view.alpha = 0;\n    gsap.to(this.view, 0.4, { alpha: 1 });\n  }\n  hide() {\n    return new Promise((resolve) => {\n      gsap.to(this.view, 0.4, { alpha: 0, onComplete: resolve });\n    });\n  }\n  resize(w, h) {\n    this.bar.x = w / 2 - this.bar.barWidth / 2;\n    this.bar.y = h / 2;\n  }\n}\nexport {\n  LoaderScreen\n};\n//# sourceMappingURL=LoaderScreen.mjs.map\n","class TransitionManager {\n  constructor() {\n    this._transitionMap = {};\n  }\n  get default() {\n    if (this._transitionMap.all) {\n      return this._transitionMap.all.all;\n    }\n    return null;\n  }\n  set default(value) {\n    if (\"transition\" in value) {\n      this.register(value);\n    } else {\n      this.register({ transition: value });\n    }\n  }\n  register(transitionData) {\n    const defaults = {\n      from: \"all\",\n      to: \"all\",\n      both: false\n    };\n    const cleanedData = Object.fromEntries(Object.entries(transitionData).filter(([_, value]) => value != null));\n    const { from, to, both, transition, ...rest } = { ...defaults, ...cleanedData };\n    let mapping = this._transitionMap[from];\n    if (!mapping) {\n      mapping = this._transitionMap[from] = {};\n    }\n    mapping[to] = { transition, ...rest };\n    if (both) {\n      this.register({ transition, from: to, to: from, ...rest });\n    }\n  }\n  get(currentId, nextId) {\n    const checkAndReturn = (from, to) => {\n      if (this._transitionMap[from]) {\n        return this._transitionMap[from][to] || this._transitionMap[from].all;\n      }\n      return null;\n    };\n    return checkAndReturn(currentId, nextId) || checkAndReturn(\"all\", nextId) || this.default;\n  }\n}\nexport {\n  TransitionManager\n};\n//# sourceMappingURL=TransitionManager.mjs.map\n","import { gsap } from \"gsap\";\nclass AlphaTransition {\n  constructor(data = {}) {\n    this.autoManageContainers = true;\n    this.duration = 0.4;\n    this.prepare(data);\n  }\n  prepare(data) {\n    this.duration = data.duration || this.duration;\n  }\n  /**\n   * Begins the transition to hide the current screen.\n   *\n   * @param _container - The container of the screen.\n   * @param current - The current screen.\n   * @returns A promise that resolves when the transition is complete.\n   */\n  hide(_container, current) {\n    return new Promise((resolve) => {\n      gsap.to(current.view, {\n        duration: this.duration,\n        alpha: 0,\n        onComplete: () => {\n          current.view.alpha = 1;\n          resolve();\n        }\n      });\n    });\n  }\n  /**\n   * Begins the transition to show the next screen.\n   *\n   * @param _container - The container of the screen.\n   * @param _current - The current screen.\n   * @param next - The next screen.\n   * @returns A promise that resolves when the transition is complete.\n   */\n  show(_container, _current, next) {\n    return new Promise((resolve) => {\n      next.view.alpha = 0;\n      gsap.to(next.view, {\n        duration: this.duration,\n        alpha: 1,\n        onComplete: () => {\n          resolve();\n        }\n      });\n    });\n  }\n}\nexport {\n  AlphaTransition\n};\n//# sourceMappingURL=AlphaTransition.mjs.map\n","import { Container, Assets } from \"pixi.js\";\nimport { Signal } from \"typed-signals\";\nimport { EmptyScreen } from \"./EmptyScreen.mjs\";\nimport { History } from \"./History.mjs\";\nimport { LoaderScreen } from \"./loader/LoaderScreen.mjs\";\nimport { TransitionManager } from \"./TransitionManager.mjs\";\nimport { AlphaTransition } from \"./transitions/AlphaTransition.mjs\";\nclass ScreenGroup {\n  constructor(app, options) {\n    this.onChange = new Signal();\n    this.onShown = new Signal();\n    this.w = 0;\n    this.h = 0;\n    this.history = new History();\n    this._loaderActive = false;\n    this._applyLoaderAsOverlay = false;\n    this._loadingScreenDelay = 1e3;\n    this.options = options;\n    this.app = app;\n    this.view = (options == null ? void 0 : options.view) || new Container();\n    this.transitionManager = new TransitionManager();\n    if (options == null ? void 0 : options.defaultTransitionClass) {\n      this.transitionManager.default = new options.defaultTransitionClass(options.defaultTransitionOptions);\n    } else {\n      this.transitionManager.default = new AlphaTransition(options == null ? void 0 : options.defaultTransitionOptions);\n    }\n    this.screens = {};\n    this.add(EmptyScreen, {}, \"empty\", true);\n    this.currentScreenId = \"empty\";\n    this.visibleScreens = [];\n    this._applyLoaderAsOverlay = (options == null ? void 0 : options.applyLoaderAsOverlay) ?? false;\n    this._loadingScreenDelay = (options == null ? void 0 : options.loadingScreenDelay) ?? 1e3;\n  }\n  /** Gets the currently visible screens. */\n  getVisibleScreens() {\n    return this.visibleScreens.map((screenData) => screenData.instance);\n  }\n  /** Get the instance of a screen by its id. */\n  get(id) {\n    var _a;\n    return (_a = this.screens[id]) == null ? void 0 : _a.instance;\n  }\n  /**\n   * @deprecated Use `get` instead.\n   */\n  getScreen(id) {\n    return this.get(id);\n  }\n  /**\n   * Add a screen to the group.\n   *\n   * @param Class - The class of the screen to add.\n   * @param options - The options to pass to the screen.\n   * @param id - The id of the screen.\n   * @param async - Whether the screen should be initialized right away.\n   */\n  add(Class, options, id, async = false) {\n    if (this.screens[id]) {\n      throw new Error(`Screen id ${id} has already been assigned`);\n    }\n    const screenData = { instance: null, class: Class, options, id };\n    if (async) {\n      screenData.instance = new Class(this.app, screenData.options);\n    }\n    this.screens[id] = screenData;\n  }\n  /**\n   * Go to the previous screen in the history.\n   */\n  async back() {\n    const lastScreen = this.history.back();\n    if (!lastScreen) return;\n    await this.show(lastScreen.id, { force: true, data: lastScreen.data }, true);\n  }\n  /**\n   * Go to the next screen in the history.\n   */\n  async forward() {\n    const nextScreen = this.history.forward();\n    if (!nextScreen) return;\n    await this.show(nextScreen.id, { force: true, data: nextScreen.data }, true);\n  }\n  /**\n   * Go to a screen by its id.\n   *\n   * @param id - The id of the screen to go to.\n   * @param data - The data to pass to the screen.\n   * @returns A promise that resolves when the screen has been navigated to.\n   */\n  async show(id, data = {}, omitFromHistory = false) {\n    if (this.currentScreenId === id && !data.force) return;\n    if (!this.screens[id]) {\n      throw new Error(`Screen id ${id} does not exist`);\n    }\n    this.nextScreenId = id;\n    this.nextData = data;\n    if (this.transitionPromise) {\n      if (this.nextScreenId === id) {\n        return;\n      }\n      await this.transitionPromise;\n      return;\n    } else if (this.currentScreenId === id && !data.force) {\n      return;\n    }\n    this.onChange.emit(id, data);\n    this.transitionPromise = this.createTransitionPromise(\n      this.nextData.data,\n      omitFromHistory,\n      this.nextData.transitionOptions\n    );\n    await this.transitionPromise;\n    this.transitionPromise = null;\n    this.onShown.emit(id, data);\n  }\n  /**\n   * @deprecated Use `show` instead.\n   */\n  async goto(id, data = {}) {\n    return this.show(id, data);\n  }\n  async hide() {\n    return this.show(\"empty\");\n  }\n  /**\n   * Preload a screen's assets without navigating to it.\n   * Creates the screen instance if it doesn't already exist.\n   *\n   * @param id - The id of the screen to preload.\n   * @param data - Optional data to pass to the screen's preload function.\n   * @returns A promise that resolves when preloading is complete.\n   */\n  async preloadScreen(id, data) {\n    var _a, _b;\n    const screenData = this.screens[id];\n    if (!screenData) {\n      throw new Error(`Screen id ${id} does not exist`);\n    }\n    const previousInstance = screenData.instance;\n    if (!screenData.instance) {\n      screenData.instance = new screenData.class(this.app, screenData.options);\n    }\n    await this._loadScreen(screenData, data == null ? void 0 : data.data);\n    if (!previousInstance) {\n      await ((_b = (_a = screenData.instance).init) == null ? void 0 : _b.call(_a, screenData.options));\n    }\n  }\n  createTransitionPromise(screenSessionData, skipNavigationEntry = false, transitionOptions) {\n    return new Promise(async (resolve) => {\n      var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l;\n      this.view.interactiveChildren = false;\n      const {\n        transition,\n        loadingScreenDelay,\n        applyLoaderAsOverlay,\n        loaderOptions,\n        loaderScreenClass,\n        loadBeforeTransition\n      } = transitionOptions ?? this.transitionManager.get(this.currentScreenId, this.nextScreenId);\n      const autoManageContainers = transition.autoManageContainers;\n      const currentData = this.screens[this.currentScreenId];\n      const nextData = this.screens[this.nextScreenId];\n      const firstRun = !nextData.instance;\n      const isEmptyScreen = this.currentScreenId === \"empty\" || (currentData == null ? void 0 : currentData.instance) instanceof EmptyScreen;\n      const shouldRemoveScreen = applyLoaderAsOverlay ?? this._applyLoaderAsOverlay;\n      if (firstRun) {\n        nextData.instance = new nextData.class(this.app, nextData.options);\n      }\n      let loadPromise = Promise.resolve();\n      let loadComplete = false;\n      let loader = this.loader;\n      const loadBefore = loadBeforeTransition ?? this.options.loadBeforeTransition;\n      loadPromise = this._loadScreen(nextData, screenSessionData).then(() => {\n        var _a2;\n        loadComplete = true;\n        (_a2 = loader == null ? void 0 : loader.complete) == null ? void 0 : _a2.call(loader);\n      });\n      if (loadBefore) {\n        loader = this._initLoader(loaderScreenClass, loaderOptions);\n        await this._awaitLoad(\n          loadPromise,\n          loadingScreenDelay ?? this._loadingScreenDelay,\n          loadComplete,\n          async () => {\n          }\n        );\n      }\n      await ((_a = transition.prepare) == null ? void 0 : _a.call(transition, (transitionOptions == null ? void 0 : transitionOptions.data) || {}));\n      (_b = transition.resize) == null ? void 0 : _b.call(transition, this.w, this.h);\n      if (currentData) {\n        await ((_d = (_c = currentData.instance).hide) == null ? void 0 : _d.call(_c));\n        const hideCurrentScreen = !isEmptyScreen || isEmptyScreen && transition.forceHideOnEmptyScreen;\n        if (hideCurrentScreen) await transition.hide(this.view, currentData.instance, nextData.instance);\n        if (!shouldRemoveScreen) {\n          this._hideScreen(currentData, autoManageContainers);\n        }\n      }\n      if (!loadBefore) {\n        loader = this._initLoader();\n        await this._awaitLoad(\n          loadPromise,\n          loadingScreenDelay ?? this._loadingScreenDelay,\n          loadComplete,\n          async () => {\n            var _a2, _b2;\n            if (firstRun) {\n              await ((_b2 = (_a2 = nextData.instance).init) == null ? void 0 : _b2.call(_a2, nextData.options));\n            }\n          }\n        );\n      } else {\n        if (firstRun) {\n          await ((_f = (_e = nextData.instance).init) == null ? void 0 : _f.call(_e, nextData.options));\n        }\n      }\n      this.currentScreenId = nextData.id;\n      if (!skipNavigationEntry) {\n        this.history.navigate(this.currentScreenId, screenSessionData);\n      }\n      if (shouldRemoveScreen) {\n        this._hideScreen(currentData, autoManageContainers);\n      }\n      await ((_h = (_g = nextData.instance).prepare) == null ? void 0 : _h.call(_g, screenSessionData));\n      nextData.instance.resize(this.w, this.h);\n      await ((_j = (_i = nextData.instance).show) == null ? void 0 : _j.call(_i));\n      this.view.interactiveChildren = true;\n      this.visibleScreens.push(nextData);\n      if (autoManageContainers) {\n        this.view.addChild(nextData.instance.view);\n      }\n      await transition.show(this.view, currentData == null ? void 0 : currentData.instance, nextData.instance);\n      (_l = (_k = nextData.instance).shown) == null ? void 0 : _l.call(_k);\n      const index = this.visibleScreens.indexOf(currentData);\n      if (index !== -1) {\n        this.visibleScreens.splice(index, 1);\n      }\n      if (this.currentScreenId !== this.nextScreenId) {\n        await this.createTransitionPromise(this.nextData.data, void 0, this.nextData.transitionOptions);\n      }\n      resolve();\n    });\n  }\n  resize(w, h) {\n    this.w = w;\n    this.h = h;\n    if (this.screens[this.currentScreenId]) {\n      this.screens[this.currentScreenId].instance.resize(w, h);\n    }\n    if (this.loader) this.loader.resize(w, h);\n  }\n  update(dt) {\n    var _a, _b;\n    const vs = this.visibleScreens;\n    for (const screen of vs) {\n      if (screen.instance.update) {\n        screen.instance.update(dt);\n      }\n    }\n    if (this._loaderActive) {\n      (_b = (_a = this.loader).update) == null ? void 0 : _b.call(_a, dt);\n    }\n  }\n  _initLoader(loaderScreenClass, loaderOptions) {\n    var _a, _b, _c, _d, _e;\n    if (!this.loader) {\n      const LoaderScreenClass = loaderScreenClass ?? (((_a = this.options) == null ? void 0 : _a.loaderScreenClass) || LoaderScreen);\n      this.loader = new LoaderScreenClass(this.app);\n      (_c = (_b = this.loader).prepare) == null ? void 0 : _c.call(_b, loaderOptions ?? this.options.loaderOptions ?? {});\n      this.loader.resize(this.w, this.h);\n    } else {\n      (_e = (_d = this.loader).prepare) == null ? void 0 : _e.call(_d, loaderOptions ?? this.options.loaderOptions ?? {});\n      this.loader.resize(this.w, this.h);\n    }\n    return this.loader;\n  }\n  async _awaitLoad(loadPromise, loadingScreenDelay, loadComplete, loadCompleteCallback) {\n    const timeoutId = setTimeout(() => {\n      var _a, _b;\n      if (!loadComplete) {\n        this.view.addChild(this.loader.view);\n        this.loader.show();\n        (_b = (_a = this.loader).start) == null ? void 0 : _b.call(_a);\n        this._loaderActive = true;\n      }\n    }, loadingScreenDelay);\n    await loadPromise;\n    await loadCompleteCallback();\n    if (this._loaderActive) {\n      await this.loader.hide();\n      this._loaderActive = false;\n      this.view.removeChild(this.loader.view);\n    } else {\n      clearTimeout(timeoutId);\n    }\n  }\n  _loadScreen(screenData, transitionData) {\n    return new Promise(async (resolve) => {\n      const screen = screenData.instance;\n      const manifests = [];\n      const assets = [];\n      const screenPromises = [];\n      let manifestProgress = 0;\n      let assetProgress = 0;\n      let promiseProgress = 0;\n      let totalProgress = 0;\n      if (screen.preload) {\n        if (screen.preload) {\n          const preloadData = await screen.preload(transitionData);\n          if (preloadData) {\n            manifests.push(...preloadData.manifests ?? []);\n            assets.push(...preloadData.assets ?? []);\n            screenPromises.push(...preloadData.promises ?? []);\n          }\n        }\n      }\n      if (screen.manifests || screen.assets) {\n        if (screen.manifests) manifests.push(...screen.manifests);\n        if (screen.assets) assets.push(...screen.assets);\n      }\n      if (manifests.length) ++totalProgress;\n      if (assets.length) ++totalProgress;\n      if (screenPromises.length) ++totalProgress;\n      await Promise.all([\n        Assets.loadBundle(manifests, (progress) => {\n          var _a, _b;\n          manifestProgress = progress;\n          (_b = (_a = this.loader) == null ? void 0 : _a.updateProgress) == null ? void 0 : _b.call(_a, (manifestProgress + assetProgress + promiseProgress) / totalProgress);\n        }),\n        Assets.load(assets, (progress) => {\n          var _a, _b;\n          assetProgress = progress;\n          (_b = (_a = this.loader) == null ? void 0 : _a.updateProgress) == null ? void 0 : _b.call(_a, (manifestProgress + assetProgress + promiseProgress) / totalProgress);\n        }),\n        ...screenPromises.map(async (promise) => {\n          var _a, _b;\n          await promise;\n          promiseProgress += 1 / screenPromises.length;\n          (_b = (_a = this.loader) == null ? void 0 : _a.updateProgress) == null ? void 0 : _b.call(_a, (manifestProgress + assetProgress + promiseProgress) / totalProgress);\n        })\n      ]);\n      resolve();\n    });\n  }\n  _hideScreen(currentData, autoManageContainers) {\n    if (autoManageContainers) {\n      this.view.removeChild(currentData == null ? void 0 : currentData.instance.view);\n    }\n    if (currentData == null ? void 0 : currentData.instance.hidden) {\n      void currentData.instance.hidden();\n    }\n  }\n}\nexport {\n  ScreenGroup\n};\n//# sourceMappingURL=ScreenGroup.mjs.map\n","import { Container } from \"pixi.js\";\nimport { Plugin } from \"../core/app/Plugin.mjs\";\nimport { ScreenGroup } from \"./ScreenGroup.mjs\";\nimport { ResizePlugin } from \"../stage/resize/ResizePlugin.mjs\";\nimport { StagePlugin } from \"../stage/StagePlugin.mjs\";\nclass ScreensPlugin extends Plugin {\n  constructor(app, options) {\n    super(app, options);\n    this.w = 0;\n    this.h = 0;\n    this.stack = [];\n    this.view = new Container();\n    const layers = {};\n    const config = (options == null ? void 0 : options.config) ? Object.entries(options.config) : [];\n    if (!config.find(([id]) => id === \"main\")) {\n      config.unshift([\"main\", { options: options.main }]);\n    }\n    if (!config.find(([id]) => id === \"overlay\")) {\n      const index = config.findIndex(([id]) => id === \"main\");\n      config.splice(index + 1, 0, [\"overlay\", { options: options.overlay }]);\n    }\n    config.forEach(([id, config2]) => {\n      var _a;\n      const layer = new ScreenGroup(this.app, config2.options);\n      this.view.addChild(layer.view);\n      layers[id] = layer;\n      this.stack.push(layer);\n      for (const screenId in config2.screens) {\n        const screenData = config2.screens[screenId];\n        const isClass = typeof screenData === \"function\";\n        const screenClass = isClass ? screenData : screenData.screen;\n        const screenOptions = isClass ? {} : screenData.options;\n        const isAsync = isClass ? false : screenData.async;\n        layer.add(screenClass, screenOptions, screenId, isAsync);\n        if (isClass) continue;\n        (_a = screenData.transitions) == null ? void 0 : _a.forEach((transition) => {\n          layer.transitionManager.register({\n            ...transition,\n            from: transition.from ?? screenId\n          });\n        });\n      }\n    });\n    this.layers = layers;\n  }\n  /**\n   * Getter for the main layer of screens.\n   *\n   * @returns The main `ScreenGroup`.\n   */\n  get main() {\n    return this.layers.main;\n  }\n  /**\n   * Getter for the overlay layer of screens.\n   *\n   * @returns The overlay `ScreenGroup`.\n   */\n  get overlay() {\n    return this.layers.overlay;\n  }\n  /** Prepare the plugin by adding the view to the stage and setting up the resize event. */\n  prepare() {\n    const resizer = this.app.get(ResizePlugin);\n    const stage = this.app.get(StagePlugin);\n    if (resizer) {\n      resizer.onResize.connect(this.resize.bind(this));\n      this.resize(resizer.w, resizer.h);\n    }\n    stage.mainContainer.addChild(this.view);\n  }\n  /**\n   * Add a screen to the main layer.\n   *\n   * @param screenClass - The class of the screen to add.\n   * @param options - The options to pass to the screen.\n   * @param id - The id of the screen.\n   * @param async - Whether the screen should be loaded asynchronously.\n   *\n   * @deprecated Use `screens.main.add` instead.\n   */\n  add(screenClass, options, id, async = false) {\n    this.addToLayer(\"main\", screenClass, options, id, async);\n  }\n  /**\n   * Add a screen to the specified layer.\n   *\n   * @param layer - The name of the layer to add the screen to.\n   * @param screenClass - The class of the screen to add.\n   * @param options - The options to pass to the screen.\n   * @param id - The id of the screen.\n   * @param async - Whether the screen should be loaded asynchronously.\n   *\n   * @deprecated Use `screens.layers.xxx.add` instead.\n   */\n  addToLayer(layer, screenClass, options, id, async = false) {\n    const group = this.layers[layer];\n    if (!group) {\n      throw new Error(`Layer ${layer} does not exist`);\n    }\n    group.add(screenClass, options, id, async);\n  }\n  /**\n   * Add multiple screens to the layers.\n   *\n   * @param screens - The screens to add.\n   *\n   * @deprecated Pass in a `ScreensConfigOptions` object that combines\n   * both layers data and screens data as a single `config` parameter\n   * on the plugin option instead.\n   */\n  addScreens(screens) {\n    screens.forEach((data) => {\n      var _a;\n      const layer = this.layers[data.layer];\n      layer.add(data.screen, data.options, data.id, data.async);\n      (_a = data.transitions) == null ? void 0 : _a.forEach((transition) => {\n        layer.transitionManager.register({\n          ...transition,\n          from: transition.from ?? data.id\n        });\n      });\n    });\n  }\n  /**\n   * Transitions to a screen on the main layer.\n   *\n   * @param id - The id of the screen to go to.\n   * @param data - The data to pass to the screen.\n   * @returns A promise that resolves when the screen has been navigated to.\n   *\n   * @deprecated Use `screens.main.show` instead.\n   */\n  async goto(id, data = {}) {\n    return this.main.goto(id, data);\n  }\n  /**\n   * Gets a layer by name.\n   *\n   * @deprecated Use `screens.layers.xxx` instead.\n   */\n  getLayer(layer) {\n    return this.layers[layer];\n  }\n  /**\n   * Transitions to a screen.\n   *\n   * @param layer - The name of the layer to add the screen to.\n   * @param id - The id of the screen to go to.\n   * @param data - The data to pass to the screen.\n   * @returns A promise that resolves when the screen has been navigated to.\n   *\n   * @deprecated Use `screens.layers.xxx.goto` instead.\n   */\n  gotoLayer(layer, id, data = {}) {\n    const group = this.layers[layer];\n    if (!group) {\n      throw new Error(`Layer '${layer}' does not exist`);\n    }\n    return group.goto(id, data);\n  }\n  /**\n   * Adds a new layer to the screen stack at the top.\n   *\n   * @param name - The name of the layer.\n   * @param options - The options for the screen group.\n   */\n  addLayer(name, options) {\n    this.addLayerAt(name, options, this.stack.length);\n  }\n  /**\n   * Removes a layer from the screen stack.\n   *\n   * @param name - The name of the layer to remove.\n   */\n  removeLayer(name) {\n    const group = this.layers[name];\n    if (!group) {\n      throw new Error(`Layer '${name}' does not exist`);\n    }\n    this.view.removeChild(group.view);\n    delete this.layers[name];\n    this.stack.splice(this.stack.indexOf(group), 1);\n  }\n  /**\n   * Adds a new layer to the screen stack at a specific index.\n   *\n   * @param name - The name of the layer.\n   * @param options - The options for the screen group.\n   * @param index - The index at which to add the new layer.\n   */\n  addLayerAt(name, options, index) {\n    if (index > this.stack.length || index < 0) {\n      throw new Error(`Layer index ${index}, is out of bound`);\n    }\n    if (this.layers[name]) {\n      throw new Error(`Layer '${name}' already exists`);\n    }\n    const group = new ScreenGroup(this.app, options);\n    this.view.addChildAt(group.view, index);\n    this.layers[name] = group;\n    this.stack.splice(index, 0, group);\n  }\n  /**\n   * Sets the index of a layer in the screen stack.\n   *\n   * @param name - The name of the layer.\n   * @param index - The new index for the layer.\n   */\n  setLayerIndex(name, index) {\n    if (index >= this.stack.length) {\n      throw new Error(`Layer index ${index}, is out of bound`);\n    }\n    const group = this.layers[name];\n    if (!group) {\n      throw new Error(`Layer '${name}' does not exist`);\n    }\n    this.view.setChildIndex(group.view, index);\n    this.stack.splice(this.stack.indexOf(group), 1);\n    this.stack.splice(index, 0, group);\n  }\n  /** Resizes all the screen groups. */\n  resize(w, h) {\n    this.w = w;\n    this.h = h;\n    this.stack.forEach((group) => {\n      group.resize(w, h);\n    });\n  }\n  /** Updates all the screen groups. */\n  update(dt) {\n    this.stack.forEach((group) => {\n      group.update(dt);\n    });\n  }\n}\nexport {\n  ScreensPlugin\n};\n//# sourceMappingURL=ScreensPlugin.mjs.map\n","function gameResize(logicalWidth, logicalHeight) {\n  return (w, h) => {\n    if (w > h) {\n      const ratioW2 = w / logicalWidth;\n      const ratioH2 = logicalHeight / h;\n      return {\n        rendererWidth: Math.round(Math.floor(logicalWidth * ratioW2 * ratioH2)),\n        rendererHeight: logicalHeight,\n        canvasWidth: w,\n        canvasHeight: h\n      };\n    }\n    const ratioW = logicalWidth / w;\n    const ratioH = h / logicalHeight;\n    return {\n      rendererWidth: logicalWidth,\n      rendererHeight: Math.round(Math.floor(logicalHeight * ratioH * ratioW)),\n      canvasWidth: w,\n      canvasHeight: h\n    };\n  };\n}\nfunction aspectResize(minWidth, minHeight, fixCanvasSize = false) {\n  const aspectRatio = minWidth / minHeight;\n  return (w, h) => {\n    let canvasWidth = w;\n    let canvasHeight = h;\n    if (fixCanvasSize) {\n      if (minWidth < minHeight) {\n        canvasHeight = h;\n        canvasWidth = Math.min(w, minWidth, canvasHeight * aspectRatio);\n      } else {\n        canvasWidth = w;\n        canvasHeight = Math.min(h, minHeight, canvasWidth / aspectRatio);\n      }\n    }\n    const scaleX = canvasWidth < minWidth ? minWidth / canvasWidth : 1;\n    const scaleY = canvasHeight < minHeight ? minHeight / canvasHeight : 1;\n    const scale = scaleX > scaleY ? scaleX : scaleY;\n    const width = Math.floor(canvasWidth * scale);\n    const height = Math.floor(canvasHeight * scale);\n    return {\n      rendererWidth: width,\n      rendererHeight: height,\n      canvasWidth,\n      canvasHeight\n    };\n  };\n}\nexport {\n  aspectResize,\n  gameResize\n};\n//# sourceMappingURL=gameResize.mjs.map\n","import { URLParams as URLParams$1 } from \"@play-co/commons\";\nimport { NakedPromise, PromiseQueue, Wait, throttle, waitAFrame, waitFor } from \"@play-co/commons\";\nimport { Application } from \"./core/app/Application.mjs\";\nimport { Plugin } from \"./core/app/Plugin.mjs\";\nimport { Prioritiser, getPixiRunnerData } from \"./core/app/Prioritiser.mjs\";\nimport { loadTexturesWrapper } from \"./core/asset/plugins/loadTexture.mjs\";\nimport { loadWebFontWrapper } from \"./core/asset/plugins/loadWebFont.mjs\";\nimport { atlasResolver } from \"./core/asset/plugins/spineParser.mjs\";\nimport { ResourcePlugin } from \"./core/asset/ResourcePlugin.mjs\";\nimport { formatTextures } from \"./core/asset/utils/formatTextures.mjs\";\nimport { I18n, defaultI18nEntry, i18n } from \"./i18n/I18n.mjs\";\nimport { I18nLabel } from \"./i18n/I18nLabel.mjs\";\nimport { I18nText } from \"./i18n/I18nText.mjs\";\nimport { I18nSprite } from \"./i18n/I18nSprite.mjs\";\nimport { I18nPlugin } from \"./i18n/I18nPlugin.mjs\";\nimport { MarkupI18nText } from \"./i18n/MarkupI18nText.mjs\";\nimport { BaseNavigation } from \"./input/BaseNavigation.mjs\";\nimport { KeyBindingCollection, KeyboardPlugin } from \"./input/KeyboardPlugin.mjs\";\nimport { FixedNavigationPlugin } from \"./input/navigation-types/FixedNavigationPlugin.mjs\";\nimport { SmartNavigationPlugin } from \"./input/navigation-types/SmartNavigationPlugin.mjs\";\nimport { NavigationPlugin } from \"./input/NavigationPlugin.mjs\";\nimport { GestureInput } from \"./input/touch/GestureInput.mjs\";\nimport { TouchInput } from \"./input/touch/TouchInput.mjs\";\nimport { BusyPlugin } from \"./misc/busy/BusyPlugin.mjs\";\nimport { Stats } from \"./misc/stats/Stats.mjs\";\nimport { StatsPlugin } from \"./misc/StatsPlugin.mjs\";\nimport { VersionPlugin } from \"./misc/VersionPlugin.mjs\";\nimport { PreventTouchDefaultPlugin } from \"./misc/PreventTouchDefaultPlugin.mjs\";\nimport { EmptyScreen } from \"./screens/EmptyScreen.mjs\";\nimport { History } from \"./screens/History.mjs\";\nimport { LoaderScreen } from \"./screens/loader/LoaderScreen.mjs\";\nimport { SpinnerLoaderScreen } from \"./screens/loader/SpinnerLoader.mjs\";\nimport { BaseScreen } from \"./screens/Screen.mjs\";\nimport { ScreenGroup } from \"./screens/ScreenGroup.mjs\";\nimport { ScreensPlugin } from \"./screens/ScreensPlugin.mjs\";\nimport { TransitionManager } from \"./screens/TransitionManager.mjs\";\nimport { PreloadPlugin } from \"./screens/preload/PreloadPlugin.mjs\";\nimport { SetupPlugin } from \"./screens/preload/SetupPlugin.mjs\";\nimport { Bar } from \"./screens/temp-ui/Bar.mjs\";\nimport { AlphaTransition } from \"./screens/transitions/AlphaTransition.mjs\";\nimport { BlankTransition } from \"./screens/transitions/BlankTransition.mjs\";\nimport { FadeTransition } from \"./screens/transitions/FadeTransition.mjs\";\nimport { SoundChannel } from \"./sound/SoundChannel.mjs\";\nimport { SoundPlugin, firstTapPromise } from \"./sound/SoundPlugin.mjs\";\nimport { Orientation, OrientationPlugin } from \"./stage/OrientationPlugin.mjs\";\nimport { aspectResize, gameResize } from \"./stage/resize/gameResize.mjs\";\nimport { resizeDefault } from \"./stage/resize/resizeDefault.mjs\";\nimport { ResizePlugin } from \"./stage/resize/ResizePlugin.mjs\";\nimport { StagePlugin } from \"./stage/StagePlugin.mjs\";\nimport { VignettePlugin } from \"./stage/VignettePlugin.mjs\";\nimport { VisibilityPlugin } from \"./stage/VisibilityPlugin.mjs\";\nimport { PixiDevtoolPlugin } from \"./utils/devtool/PixiDevtoolPlugin.mjs\";\nimport { deepClone, deepEqual, deepMerge } from \"./utils/helpers/jsHelpers.mjs\";\nimport { deprecation } from \"./utils/logging/deprecation.mjs\";\nimport { Observer } from \"./utils/observer/Observer.mjs\";\nimport { promiseAllRunner, promiseRunner } from \"./utils/runners/promiseRunner.mjs\";\nimport { AstroStorage } from \"./utils/storage/AstroStorage.mjs\";\nimport { autoDetectAntialias } from \"./utils/system/detections/autoDetectAntialias.mjs\";\nimport { autoDetectCacheBusting } from \"./utils/system/detections/autoDetectCacheBusting.mjs\";\nimport { autoDetectResolution } from \"./utils/system/detections/autoDetectResolution.mjs\";\nimport { StorageType, autoDetectStorage } from \"./utils/system/detections/autoDetectStorage.mjs\";\nimport { autoDetectTransparency } from \"./utils/system/detections/autoDetectTransparency.mjs\";\nimport { Device, DeviceClass, GPU_TIER } from \"./utils/system/devices/Device.mjs\";\nimport { DeviceConfigPlugin } from \"./utils/system/devices/DeviceConfigPlugin.mjs\";\nimport { isGalaxyS5, isIPhone6, isKindle, isSafari18, isSafari18Dot4 } from \"./utils/system/devices/deviceQueries.mjs\";\nimport { DeviceSettings } from \"./utils/system/devices/DeviceSettings.mjs\";\nimport { requestFullScreen } from \"./utils/system/devices/requestFullScreen.mjs\";\nimport { WakeLockPlugin } from \"./utils/system/devices/WakeLockPlugin.mjs\";\nimport { PerformanceMonitor } from \"./utils/system/monitor/PerformanceMonitor.mjs\";\nimport { PerformanceTracker } from \"./utils/system/monitor/PerformanceTracker.mjs\";\nimport { PerformanceTrackerPlugin } from \"./utils/system/monitor/PerformanceTrackerPlugin.mjs\";\nimport { limitFPS } from \"./utils/system/time/limitFPS.mjs\";\nimport { WaitPlugin } from \"./utils/system/time/WaitPlugin.mjs\";\nimport { DEFAULT_RETRY_VALUES, tripleFetch } from \"./utils/url/tripleFetch.mjs\";\nconst URLParams = new URLParams$1();\nexport {\n  AlphaTransition,\n  Application,\n  AstroStorage,\n  Bar,\n  BaseNavigation,\n  BaseScreen,\n  BlankTransition,\n  BusyPlugin,\n  DEFAULT_RETRY_VALUES,\n  Device,\n  DeviceClass,\n  DeviceConfigPlugin,\n  DeviceSettings,\n  EmptyScreen,\n  FadeTransition,\n  FixedNavigationPlugin,\n  GPU_TIER,\n  GestureInput,\n  History,\n  I18n,\n  I18nLabel,\n  I18nPlugin,\n  I18nSprite,\n  I18nText,\n  KeyBindingCollection,\n  KeyboardPlugin,\n  LoaderScreen,\n  MarkupI18nText,\n  NakedPromise,\n  NavigationPlugin,\n  Observer,\n  Orientation,\n  OrientationPlugin,\n  PerformanceMonitor,\n  PerformanceTracker,\n  PerformanceTrackerPlugin,\n  PixiDevtoolPlugin,\n  Plugin,\n  PreloadPlugin,\n  PreventTouchDefaultPlugin,\n  Prioritiser,\n  PromiseQueue,\n  ResizePlugin,\n  ResourcePlugin,\n  ScreenGroup,\n  ScreensPlugin,\n  SetupPlugin,\n  SmartNavigationPlugin,\n  SoundChannel,\n  SoundPlugin,\n  SpinnerLoaderScreen,\n  StagePlugin,\n  Stats,\n  StatsPlugin,\n  StorageType,\n  TouchInput,\n  TransitionManager,\n  URLParams,\n  VersionPlugin,\n  VignettePlugin,\n  VisibilityPlugin,\n  Wait,\n  WaitPlugin,\n  WakeLockPlugin,\n  aspectResize,\n  atlasResolver,\n  autoDetectAntialias,\n  autoDetectCacheBusting,\n  autoDetectResolution,\n  autoDetectStorage,\n  autoDetectTransparency,\n  deepClone,\n  deepEqual,\n  deepMerge,\n  defaultI18nEntry,\n  deprecation,\n  firstTapPromise,\n  formatTextures,\n  gameResize,\n  getPixiRunnerData,\n  i18n,\n  isGalaxyS5,\n  isIPhone6,\n  isKindle,\n  isSafari18,\n  isSafari18Dot4,\n  limitFPS,\n  loadTexturesWrapper,\n  loadWebFontWrapper,\n  promiseAllRunner,\n  promiseRunner,\n  requestFullScreen,\n  resizeDefault,\n  throttle,\n  tripleFetch,\n  waitAFrame,\n  waitFor\n};\n//# sourceMappingURL=index.mjs.map\n","import type { Screen, Application } from '@play-co/astro';\nimport { Container } from 'pixi.js';\n\n/**\n * Abstract base class for Astro screens with common lifecycle patterns.\n *\n * This class provides default implementations for all Screen interface methods\n * and exposes protected hook methods that subclasses can override. This reduces\n * boilerplate by only requiring subclasses to implement the hooks they need.\n *\n * Screen Lifecycle:\n * 1. `constructor` - Screen is instantiated\n * 2. `prepare()`  `onPrepare()` - Screen prepares before becoming visible\n * 3. `show()`  `onShow()` - Screen becomes visible\n * 4. `update()`  `onUpdate()` - Called each frame while visible\n * 5. `hide()`  `onHide()` - Screen starts hiding\n * 6. `hidden()`  `onHidden()` - Screen is fully hidden, cleanup\n *\n * Additional hooks:\n * - `onPause()` / `onResume()` - App visibility changes\n * - `onResize()` - Window resize events\n *\n * @example\n * // Simple screen with just prepare and cleanup\n * class MenuScreen extends BaseScreen {\n *   private menuUI: Container | null = null;\n *\n *   protected async onPrepare(): Promise<void> {\n *     this.menuUI = new Container();\n *     // Setup menu UI...\n *     this.view.addChild(this.menuUI);\n *   }\n *\n *   protected async onHidden(): Promise<void> {\n *     this.menuUI?.destroy();\n *     this.menuUI = null;\n *   }\n * }\n *\n * @example\n * // Screen with update loop and pause handling\n * class GameScreen extends BaseScreen {\n *   private gameScene: GameScene | null = null;\n *\n *   protected async onPrepare(): Promise<void> {\n *     this.gameScene = new GameScene({ stage: this.view });\n *     await this.gameScene.init();\n *   }\n *\n *   protected async onShow(): Promise<void> {\n *     this.gameScene?.start();\n *   }\n *\n *   protected onUpdate(dt: number): void {\n *     this.gameScene?.update(dt);\n *   }\n *\n *   protected onPause(): void {\n *     this.gameScene?.pause();\n *   }\n *\n *   protected onResume(): void {\n *     this.gameScene?.resume();\n *   }\n *\n *   protected async onHidden(): Promise<void> {\n *     this.gameScene?.destroy();\n *     this.gameScene = null;\n *   }\n * }\n *\n * @example\n * // Register and show the screen\n * import { ScreensPlugin } from '@play-co/astro';\n *\n * const screens = app.get(ScreensPlugin);\n * screens.main.add(MenuScreen, undefined, 'menu');\n * await screens.main.show('menu');\n */\nexport abstract class BaseScreen implements Screen {\n  /**\n   * The Astro application instance.\n   * @readonly\n   */\n  public readonly app: Application;\n\n  /**\n   * The root display container for this screen.\n   * Add visual elements as children of this container.\n   * @readonly\n   */\n  public readonly view: Container;\n\n  /**\n   * Creates a new screen instance.\n   *\n   * @param app - The Astro Application instance\n   * @param _options - Optional configuration (available for subclasses)\n   * @example\n   * const screen = new MenuScreen(app, { theme: 'dark' });\n   */\n  constructor(app: Application, _options?: Record<string, unknown>) {\n    this.app = app;\n    this.view = new Container();\n  }\n\n  // ============================================\n  // Protected hooks for subclasses to override\n  // ============================================\n\n  /**\n   * Called when the screen is preparing to become visible.\n   * Override to initialize resources, create UI, load assets.\n   *\n   * @returns Promise or void when preparation is complete\n   * @example\n   * protected async onPrepare(): Promise<void> {\n   *   this.ui = new Container();\n   *   this.view.addChild(this.ui);\n   * }\n   */\n  protected onPrepare(): Promise<void> | void {\n    // Override in subclass\n  }\n\n  /**\n   * Called when the screen becomes visible.\n   * Override to start animations, game loops, etc.\n   *\n   * @returns Promise or void when show is complete\n   * @example\n   * protected onShow(): void {\n   *   this.scene?.start();\n   * }\n   */\n  protected onShow(): Promise<void> | void {\n    // Override in subclass\n  }\n\n  /**\n   * Called each frame while the screen is visible.\n   * Override to update game logic, animations, etc.\n   *\n   * @param _dt - Delta time since last frame in seconds\n   * @example\n   * protected onUpdate(dt: number): void {\n   *   this.scene?.update(dt);\n   * }\n   */\n  protected onUpdate(_dt: number): void {\n    // Override in subclass\n  }\n\n  /**\n   * Called when the screen starts hiding.\n   * Override to stop animations, pause game loops, etc.\n   *\n   * @returns Promise or void when hide is complete\n   * @example\n   * protected onHide(): void {\n   *   this.scene?.pause();\n   * }\n   */\n  protected onHide(): Promise<void> | void {\n    // Override in subclass\n  }\n\n  /**\n   * Called when the screen is fully hidden.\n   * Override to cleanup resources, destroy objects.\n   *\n   * @returns Promise or void when cleanup is complete\n   * @example\n   * protected onHidden(): void {\n   *   this.scene?.destroy();\n   *   this.scene = null;\n   * }\n   */\n  protected onHidden(): Promise<void> | void {\n    // Override in subclass\n  }\n\n  /**\n   * Called when the app is paused (e.g., tab loses focus).\n   * Override to pause game, audio, etc.\n   *\n   * @example\n   * protected onPause(): void {\n   *   this.audio?.pause();\n   * }\n   */\n  protected onPause(): void {\n    // Override in subclass\n  }\n\n  /**\n   * Called when the app is resumed (e.g., tab gains focus).\n   * Override to resume game, audio, etc.\n   *\n   * @example\n   * protected onResume(): void {\n   *   this.audio?.resume();\n   * }\n   */\n  protected onResume(): void {\n    // Override in subclass\n  }\n\n  /**\n   * Called when the window is resized.\n   * Override to adjust layout, reposition elements.\n   *\n   * @param _w - New width in pixels\n   * @param _h - New height in pixels\n   * @example\n   * protected onResize(w: number, h: number): void {\n   *   this.background.width = w;\n   *   this.background.height = h;\n   * }\n   */\n  protected onResize(_w: number, _h: number): void {\n    // Override in subclass\n  }\n\n  // ============================================\n  // Screen interface implementation\n  // ============================================\n\n  /**\n   * Prepares the screen before showing.\n   * @internal\n   * @example screen.prepare();\n   */\n  public async prepare(): Promise<void> {\n    await this.onPrepare();\n  }\n\n  /**\n   * Shows the screen.\n   * @internal\n   * @example screen.show();\n   */\n  public async show(): Promise<void> {\n    await this.onShow();\n  }\n\n  /**\n   * Updates the screen each frame.\n   * @param dt - Delta time in seconds\n   * @internal\n   * @example screen.update(0.016);\n   */\n  public update(dt: number): void {\n    this.onUpdate(dt);\n  }\n\n  /**\n   * Starts hiding the screen.\n   * @internal\n   * @example screen.hide();\n   */\n  public async hide(): Promise<void> {\n    await this.onHide();\n  }\n\n  /**\n   * Called when screen is fully hidden.\n   * @internal\n   * @example screen.hidden();\n   */\n  public async hidden(): Promise<void> {\n    await this.onHidden();\n  }\n\n  /**\n   * Pauses the screen.\n   * @internal\n   * @example screen.pause();\n   */\n  public pause(): void {\n    this.onPause();\n  }\n\n  /**\n   * Resumes the screen.\n   * @internal\n   * @example screen.resume();\n   */\n  public resume(): void {\n    this.onResume();\n  }\n\n  /**\n   * Handles window resize.\n   * @param w - New width in pixels\n   * @param h - New height in pixels\n   * @internal\n   * @example screen.resize(1920, 1080);\n   */\n  public resize(w: number, h: number): void {\n    this.onResize(w, h);\n  }\n}\n","const _Runner = class _Runner {\n  /**\n   * @param name - the function name that will be executed on the listeners added to this MiniRunner.\n   * @param argsLength - total number of arguments that will be passed from the runner\n   */\n  constructor(name, argsLength = 0) {\n    this.items = [];\n    this._name = name;\n    this.running = false;\n    this.dispatch = _Runner._generateRun(name, argsLength);\n    this.run = this.dispatch;\n    this.emit = this.dispatch;\n    this._dummy = {};\n    this._dummy[name] = () => {\n    };\n  }\n  static _generateRun(name, argsLength) {\n    const key = `${name}|${argsLength}`;\n    let func = _Runner._hash[key];\n    if (!func) {\n      if (argsLength > 0) {\n        let args = \"arg0\";\n        for (let i = 1; i < argsLength; i++) {\n          args += `,arg${i}`;\n        }\n        const src = `this.running = true;\n                            var items = this.items;\n                            for(var i=0;i<items.length;i++)\n                            { items[i].${name}(${args});}\n                            this.running = false;\n                            if( this.needsTidy) this.tidy()`;\n        func = new Function(args, src);\n      } else {\n        func = new Function(`this.running = true;\n                                    var items = this.items;\n                                    for(var i=0;i<items.length;i++)\n                                    { items[i].${name}(); }\n                                    this.running = false;\n                                    if( this.needsTidy) this.tidy() `);\n      }\n      _Runner._hash[key] = func;\n    }\n    return func;\n  }\n  /**\n   * Add a listener to the MiniRunner\n   *\n   * MiniRunners do not need to have scope or functions passed to them.\n   * All that is required is to pass the listening object and ensure that it has contains a function that has the same name\n   * as the name provided to the MiniRunner when it was created.\n   *\n   * Eg A listener passed to this MiniRunner will require a 'complete' function.\n   *\n   * ```\n   * var complete = new MiniRunner('complete');\n   * ```\n   *\n   * The scope used will be the object itself.\n   *\n   * @param item - The object that will be listening.\n   */\n  add(item) {\n    if (item[this._name]) {\n      this.remove(item);\n      this.items.push(item);\n      this._toRemove = [];\n      this.needsTidy = false;\n    }\n    return this;\n  }\n  /**\n   * Remove a single listener from the dispatch queue.\n   *\n   * @param item - The listener that you would like to remove.\n   */\n  remove(item) {\n    const index = this.items.indexOf(item);\n    if (this.running) {\n      this.needsTidy = true;\n      this._toRemove.push(index);\n      this.items[index] = this._dummy;\n    } else if (index !== -1) {\n      this.items.splice(index, 1);\n    }\n    return this;\n  }\n  /**\n   * Check to see if the listener is already in the MiniRunner\n   *\n   * @param item - listener that you would like to check.\n   * @returns true if the Runner has the object\n   */\n  contains(item) {\n    return this.items.indexOf(item) !== -1;\n  }\n  /** Removes all listeners from the Runner */\n  removeAll() {\n    this.items.length = 0;\n  }\n  /** Remove all references, don't use after this. */\n  destroy() {\n    this.removeAll();\n    this.items = null;\n  }\n  tidy() {\n    for (let i = this._toRemove.length - 1; i >= 0; i--) {\n      const index = this._toRemove[i];\n      if (index !== -1) {\n        this.items.splice(index, 1);\n      }\n    }\n  }\n  /** true if the Runner is empty */\n  get empty() {\n    return this.items.length === 0;\n  }\n};\n_Runner._hash = {};\nlet Runner = _Runner;\nexport {\n  Runner\n};\n//# sourceMappingURL=Runner.mjs.map\n","class ID32 {\n  constructor() {\n    this.id = new Int32Array(4);\n  }\n  /**\n   * Sets an index in an id\n   *\n   * @param index - index to set in the id\n   */\n  setIndex(index) {\n    const id = index / 31 | 0;\n    this.id[id] = this.id[id] | 1 << index % 31;\n  }\n  /**\n   * Unsets an index in an id\n   *\n   * @param index - index to unset in the id\n   */\n  unsetIndex(index) {\n    const id = index / 31 | 0;\n    this.id[id] = this.id[id] & ~(1 << index % 31);\n  }\n  /**\n   * checks if idB contains the same bits as this id\n   *\n   * @param id - id to compare\n   */\n  matchIndex(id) {\n    const q1 = this.id[0];\n    const q2 = this.id[1];\n    const q3 = this.id[2];\n    const q4 = this.id[3];\n    const idValue = id.id;\n    return (idValue[0] & q1 ^ q1) + (idValue[1] & q2 ^ q2) + (idValue[2] & q3 ^ q3) + (idValue[3] & q4 ^ q4) === 0;\n  }\n  /**\n   * checks if any bits in idB match this id\n   *\n   * @param id - id to compare\n   */\n  matchAnyIndex(id) {\n    const q1 = this.id[0];\n    const q2 = this.id[1];\n    const q3 = this.id[2];\n    const q4 = this.id[3];\n    const idValue = id.id;\n    return (idValue[0] & q1) + (idValue[1] & q2) + (idValue[2] & q3) + (idValue[3] & q4) > 0;\n  }\n}\nexport {\n  ID32\n};\n//# sourceMappingURL=ID32.mjs.map\n","import { Runner } from \"../utils/Runner.mjs\";\nimport { ID32 } from \"./queries/ID32.mjs\";\nconst UIDs = {\n  _ENTITY: 0,\n  _COMPONENT: 0,\n  _ENTITY_CLASS: 0\n};\nconst _Entity = class _Entity {\n  constructor() {\n    this.c = {};\n    this.UID = UIDs._ENTITY++;\n    this.componentBitHash = new ID32();\n    this.queries = [];\n    this.name = `item${this.UID}`;\n    this.runners = {\n      /** A runner called when the entity is gathered from a pool. Calls `init()` on any registered objects. */\n      init: new Runner(\"init\", 1),\n      /** A runner called when the entity is returned to a pool. Calls `reset()` on any registered objects. */\n      reset: new Runner(\"reset\")\n    };\n    this._gc = false;\n    this._released = false;\n    this._pooled = false;\n    this._initialised = false;\n    this._staticComponents = this._staticComponents || /* @__PURE__ */ new Set();\n    this._addStaticComponents();\n  }\n  /**\n   * called when the entity is taken from the pool\n   *\n   * @param data - the init data for this entity\n   */\n  init(data) {\n    var _a;\n    if (this._initialised) return;\n    this._addStaticComponents();\n    const components = this.runners.init.items;\n    for (let i = 0; i < components.length; i++) {\n      const component = components[i];\n      (_a = component.init) == null ? void 0 : _a.call(component, (data == null ? void 0 : data[component.name]) || {});\n    }\n    this._initialised = true;\n  }\n  /** called when the entity is added back to the pool */\n  reset() {\n    this._gc = false;\n    this.runners.reset.run();\n    for (const key in this.c) {\n      const component = this.c[key];\n      if (component.signals) {\n        const signals = component.signals;\n        for (const i in signals) {\n          signals[i].disconnectAll();\n        }\n      }\n      if (component.dynamic) this._removeComponent(component.name, component.id);\n    }\n    this._initialised = false;\n  }\n  /**\n   * create and add a component. Init data is only passed if the entity is already part of a scene\n   *\n   * @param Class - the component class to create and add\n   * @param data - the data to pass to the component constructor if part of a scene\n   */\n  addComponent(Class, data, staticComp = false) {\n    var _a;\n    if (!Class.NAME) {\n      throw new Error(\"[Entity] cannot add component that does not have a name\");\n    }\n    if (this.c[Class.NAME]) {\n      return this.c[Class.NAME];\n    }\n    if (Class.ID === void 0) {\n      Class.ID = UIDs._COMPONENT++;\n    }\n    const component = new Class();\n    component.name = Class.NAME;\n    component.id = Class.ID;\n    component.entity = this;\n    this.c[Class.NAME] = component;\n    for (const i in this.runners) {\n      this.runners[i].add(component);\n    }\n    this.componentBitHash.setIndex(Class.ID);\n    if (this._initialised) (_a = component.init) == null ? void 0 : _a.call(component, data || {});\n    if (this.scene) {\n      this.scene.queryManager.onEntityComponentAdded(this);\n    }\n    if (staticComp && !this._staticComponents.has(Class)) this._staticComponents.add(Class);\n    if (!this._staticComponents.has(Class)) component.dynamic = true;\n    return component;\n  }\n  /**\n   * removes a component of specified type\n   *\n   * @param Class - the type of component to remove\n   * @param name - optional name used to register component\n   */\n  removeComponent(Class) {\n    this._removeComponent(Class.NAME, Class.ID);\n    return this;\n  }\n  /** removes all components from the entity */\n  removeAllComponents() {\n    for (const key in this.c) {\n      const comp = this.c[key];\n      this._removeComponent(comp.name, comp.id);\n    }\n    return this;\n  }\n  /**\n   * gets the instance of a component on the entity\n   *\n   * @param Class - component class to get instance of\n   * @returns the instance of the component\n   */\n  getComponent(Class) {\n    return this.c[Class.NAME];\n  }\n  /**\n   * Sets a component to be modified and lets the query manager dispatch the \"modified\" event\n   *\n   * @param Class - component to be set as modified\n   */\n  setModified(Class, data) {\n    for (let i = 0; i < this.queries.length; i++) {\n      this.queries[i].modifiedQuery(this, Class, data);\n    }\n  }\n  /** adds static components to the entity */\n  _addStaticComponents() {\n    for (const comp of this._staticComponents) {\n      this.addComponent(comp, void 0, true);\n    }\n    return this;\n  }\n  /**\n   * Internally removes a component from the entity\n   *\n   * @param name - name of component to remove\n   * @param id - id of component to remove\n   */\n  _removeComponent(name, id) {\n    var _a;\n    const component = this.c[name];\n    if (!component) {\n      return;\n    }\n    for (const i in this.runners) {\n      this.runners[i].remove(component);\n    }\n    this.componentBitHash.unsetIndex(id);\n    if (this.scene) {\n      this.scene.queryManager.onEntityComponentRemoved(this);\n    }\n    (_a = component.reset) == null ? void 0 : _a.call(component);\n    delete this.c[name];\n    return;\n  }\n};\n_Entity.POOL = true;\nlet Entity = _Entity;\nexport {\n  Entity,\n  UIDs\n};\n//# sourceMappingURL=Entity.mjs.map\n","class Pool {\n  /**\n   * a pool of reusable instances of a class\n   *\n   * @param ClassType -\n   */\n  constructor(ClassType, initialSize) {\n    this._pool = [];\n    this._count = 0;\n    this._debug = false;\n    this._classType = ClassType;\n    if (initialSize) {\n      this.prepopulate(initialSize);\n    }\n  }\n  /**\n   * create items to populate pool\n   *\n   * @param total - the number of items to add to the pool\n   */\n  prepopulate(total) {\n    for (let i = 0; i < total; i++) {\n      this._pool.push(new this._classType());\n    }\n    this._count += total;\n  }\n  /** get an item from the pool, or create a new one if the pool is empty */\n  get() {\n    if (this._pool.length <= 0) {\n      this.prepopulate(Math.round(this._count * 0.2) + 1);\n    }\n    let item = this._pool.pop();\n    if (!item) {\n      item = new this._classType();\n    }\n    return item;\n  }\n  /**\n   * add an object into the pool\n   *\n   * @param item - the itm to add to the pool\n   */\n  return(item) {\n    if (this._pool.indexOf(item) !== -1) {\n      if (this._debug) console.warn(\"Object already in pool\", item);\n      return;\n    }\n    this._pool.push(item);\n  }\n  get totalSize() {\n    return this._count;\n  }\n  get totalFree() {\n    return this._pool.length;\n  }\n  get totalUsed() {\n    return this._count - this._pool.length;\n  }\n}\nexport {\n  Pool\n};\n//# sourceMappingURL=Pool.mjs.map\n","import { Pool } from \"./Pool.mjs\";\nclass PoolGroupClass {\n  constructor() {\n    this._poolsByClass = /* @__PURE__ */ new Map();\n  }\n  /**\n   * populates the pool with the specified number of instances\n   *\n   * @param Class - Class type to prepopulate\n   * @param total - number of instances to create\n   */\n  prepopulate(Class, total) {\n    const classPool = this.getPool(Class);\n    classPool.prepopulate(total);\n  }\n  /**\n   * return an entity of the specified class type, initialised with the supplied data object.\n   * Entity will be automatically returned to the pool when it is destroyed.\n   *\n   * @param Class - the class of entity required\n   * @param data - data object to initialise entity from\n   */\n  get(Class, data) {\n    var _a;\n    const pool = this.getPool(Class);\n    const item = pool.get();\n    item._pooled = true;\n    (_a = item.init) == null ? void 0 : _a.call(item, data);\n    return item;\n  }\n  /**\n   * puts an entity back into its pool. The entity will be reset and all signal listeners removed\n   *\n   * @param entity - the entity to return to the pool\n   */\n  return(item) {\n    var _a;\n    (_a = item.reset) == null ? void 0 : _a.call(item);\n    item._pooled = false;\n    this._returnToPool(item);\n  }\n  /** returns a pool for a specific class */\n  getPool(ClassType) {\n    if (!this._poolsByClass.has(ClassType)) {\n      this._poolsByClass.set(ClassType, new Pool(ClassType));\n    }\n    return this._poolsByClass.get(ClassType);\n  }\n  /** gets the usage stats of each pool in the system */\n  stats() {\n    const stats = {};\n    this._poolsByClass.forEach((pool) => {\n      const name = stats[pool._classType.name] ? pool._classType.name + pool._classType.ID : pool._classType.name;\n      stats[name] = {\n        free: pool.totalFree,\n        used: pool.totalUsed,\n        size: pool.totalSize\n      };\n    });\n    return stats;\n  }\n  /**\n   * Return an object to the pool\n   *\n   * @param object -\n   */\n  _returnToPool(object) {\n    this.getPool(object.constructor).return(object);\n  }\n}\nconst PoolGroup = new PoolGroupClass();\nexport {\n  PoolGroup,\n  PoolGroupClass\n};\n//# sourceMappingURL=PoolGroup.mjs.map\n","import { PoolGroup } from \"./pool/PoolGroup.mjs\";\nimport { UIDs } from \"./Entity.mjs\";\nconst ctors = /* @__PURE__ */ new Map();\nfunction DefineEntity(Constructor, ...components) {\n  const curr = ctors.get(Constructor.ID) ?? /* @__PURE__ */ new Set();\n  const entityClass = class extends Constructor {\n  };\n  const value = /* @__PURE__ */ new Set([...curr, ...components]);\n  entityClass.ID = UIDs._ENTITY_CLASS++;\n  ctors.set(entityClass.ID, value);\n  Object.defineProperty(entityClass.prototype, \"_staticComponents\", {\n    value,\n    writable: true\n  });\n  return entityClass;\n}\nfunction createEntity(Class, data) {\n  if (!Class.POOL) {\n    const entity = new Class();\n    entity.init(data);\n    return entity;\n  }\n  return PoolGroup.get(Class, data);\n}\nfunction releaseEntity(entity, releaseChildren = true) {\n  const scene = entity.scene;\n  const release = (ent) => {\n    if (releaseChildren && ent.c.container) {\n      ent.c.container.traverse((child) => {\n        if (child === ent) return;\n        if (!child.scene) quickRemove(child);\n        else {\n          child._released = true;\n          scene.removeFromScene(child);\n        }\n      });\n    }\n  };\n  const quickRemove = (ent) => {\n    var _a;\n    release(ent);\n    ent._pooled ? PoolGroup.return(ent) : (_a = ent.reset) == null ? void 0 : _a.call(ent);\n    ent._gc = false;\n    ent._released = false;\n  };\n  if (!scene) quickRemove(entity);\n  else {\n    entity._released = true;\n    scene.removeFromScene(entity);\n    release(entity);\n  }\n}\nexport {\n  DefineEntity,\n  createEntity,\n  releaseEntity\n};\n//# sourceMappingURL=EntityUtils.mjs.map\n","import { Container } from \"pixi.js\";\nconst _View2DComponent = class _View2DComponent {\n  init(options = {}) {\n    this.layer = options.layer || \"default\";\n    this.view = options.view || new Container();\n  }\n};\n_View2DComponent.NAME = \"view2d\";\nlet View2DComponent = _View2DComponent;\nexport {\n  View2DComponent\n};\n//# sourceMappingURL=View2DComponent.mjs.map\n","import { Entity } from \"../../core/Entity.mjs\";\nimport { DefineEntity } from \"../../core/EntityUtils.mjs\";\nimport { View2DComponent } from \"./view/View2DComponent.mjs\";\nclass Entity2D extends DefineEntity(Entity, View2DComponent) {\n  get view() {\n    return this.c.view2d.view;\n  }\n  get transform() {\n    return this.c.view2d.view.transform;\n  }\n  get position() {\n    return this.view.position;\n  }\n  get scale() {\n    return this.view.scale;\n  }\n  get rotation() {\n    return this.view.rotation;\n  }\n  get x() {\n    return this.view.position.x;\n  }\n  set x(value) {\n    this.view.position.x = value;\n  }\n  get y() {\n    return this.view.position.y;\n  }\n  set y(value) {\n    this.view.position.y = value;\n  }\n  get scaleX() {\n    return this.view.scale.x;\n  }\n  set scaleX(value) {\n    this.view.scale.x = value;\n  }\n  get scaleY() {\n    return this.view.scale.y;\n  }\n  set scaleY(value) {\n    this.view.scale.y = value;\n  }\n}\nexport {\n  Entity2D\n};\n//# sourceMappingURL=Entity2D.mjs.map\n","import { Signal } from \"typed-signals\";\nclass Signals {\n  constructor() {\n    this.signals = {};\n  }\n  /**\n   * Add some signals to the item. This exists as we are lazy devs..\n   * Instead of:\n   *\n   * var Signal = require('Signals')\n   * signals.onSomething = new Signal();\n   * signals.onSomethingElse = new Signal();\n   *\n   * we can now simply do this:\n   * this.registerSignals('onSomething', 'onSomethingElse')\n   *\n   * @param signalName - the name of the signal to to create.\n   */\n  register(...args) {\n    for (let i = 0; i < args.length; i++) {\n      const signalName = args[i];\n      if (!this.signals[signalName]) {\n        this.signals[signalName] = new Signal();\n      }\n    }\n  }\n  /** Because everything should be pooled - its good to have a way to reset all signals */\n  resetSignals() {\n    for (const i in this.signals) {\n      this.signals[i].disconnectAll();\n    }\n  }\n}\nexport {\n  Signals\n};\n//# sourceMappingURL=Signals.mjs.map\n","class Time {\n  constructor(options = {}) {\n    this.timeScale = 1;\n    this.maxDeltaTime = 1e3 / 20;\n    this._fps = 60;\n    this._deltaTime = 0;\n    this._frameTime = 0;\n    this.timeScale = options.timeScale ?? 1;\n    this._lastTime = performance.now();\n    this.fps = options.fps ?? 60;\n  }\n  /** call at the start of the game update loop in the scene */\n  nextUpdate() {\n    const now = performance.now();\n    this._deltaTime = Math.min(now - this._lastTime, this.maxDeltaTime);\n    this._frameTime = this._deltaTime / this._frameDuration;\n    this._lastTime = now;\n  }\n  /** the time elapsed from the previous frame in milliseconds */\n  get deltaTime() {\n    return this._deltaTime * this.timeScale;\n  }\n  /**\n   * the time elapsed from the previous frame in milliseconds\n   * does not take into account the time scale\n   */\n  get unscaledDeltaTime() {\n    return this._deltaTime;\n  }\n  /**\n   * the time elapsed from the previous frame in frames.\n   * a value around one indicates we are matching the frame rate\n   */\n  get frameTime() {\n    return this._frameTime * this.timeScale;\n  }\n  /**\n   * the time elapsed from the previous frame in frames.\n   * a value around one indicates we are matching the frame rate\n   * does not take into account the time scale\n   */\n  get unscaledFrameTime() {\n    return this._frameTime;\n  }\n  /** Get the target frame rate (frame per second) to used to calculate frameTime */\n  get fps() {\n    return this._fps;\n  }\n  /** Set the target frame rate (frame per second) to used to calculate frameTime */\n  set fps(v) {\n    this._fps = v;\n    this._frameDuration = 1e3 / this._fps;\n  }\n}\nexport {\n  Time\n};\n//# sourceMappingURL=Time.mjs.map\n","import { Time } from \"./Time.mjs\";\nclass SmoothTime extends Time {\n  constructor(options = {}) {\n    super(options);\n    this.smooth = options.smooth ?? 0.2;\n  }\n  nextUpdate() {\n    const now = performance.now();\n    const deltaTime = Math.min(now - this._lastTime, this.maxDeltaTime);\n    if (this.smooth > 0 && this.smooth < 1) {\n      this._deltaTime -= (this._deltaTime - deltaTime) * this.smooth;\n    } else {\n      this._deltaTime = deltaTime;\n    }\n    this._frameTime = this._deltaTime / this._frameDuration;\n    this._lastTime = now;\n  }\n}\nexport {\n  SmoothTime\n};\n//# sourceMappingURL=SmoothTime.mjs.map\n","import { Signal } from \"typed-signals\";\nclass Group {\n  constructor(children = []) {\n    this.onAdded = new Signal();\n    this.onRemoved = new Signal();\n    this.children = children;\n  }\n  add(item) {\n    const index = this.children.indexOf(item);\n    if (index !== -1) return;\n    this.children.push(item);\n    this.onAdded.emit(item);\n  }\n  remove(item) {\n    const index = this.children.indexOf(item);\n    if (index === -1) return false;\n    this.children.splice(index, 1);\n    this.onRemoved.emit(item);\n    return true;\n  }\n  contains(item) {\n    return this.children.indexOf(item) !== -1;\n  }\n  getIndex(item) {\n    return this.children.indexOf(item);\n  }\n  getItem(index) {\n    return this.children[index];\n  }\n  run(f, scope) {\n    let i;\n    if (scope) {\n      for (i = 0; i < this.children.length; i++) {\n        f.call(scope, this.children[i]);\n      }\n    } else {\n      for (i = 0; i < this.children.length; i++) {\n        f(this.children[i]);\n      }\n    }\n  }\n  empty() {\n    this.children.length = 0;\n    this.onAdded.disconnectAll();\n    this.onRemoved.disconnectAll();\n  }\n  get length() {\n    return this.children.length;\n  }\n}\nexport {\n  Group\n};\n//# sourceMappingURL=Group.mjs.map\n","function Not(componentClass) {\n  return {\n    operator: \"not\",\n    component: componentClass\n  };\n}\nfunction Or(...componentClass) {\n  return {\n    operator: \"or\",\n    components: componentClass\n  };\n}\nfunction generateQueries(systemClass, system) {\n  if (systemClass.Queries) {\n    for (const queryName in systemClass.Queries) {\n      const queryConfig = systemClass.Queries[queryName];\n      const queryComponents = queryConfig.components;\n      if (!queryComponents || queryComponents.length === 0) {\n        throw new Error(\"'components' attribute can't be empty in a query\");\n      }\n      const query = system.scene.queryManager.getQuery(queryComponents, queryName);\n      if (!system.queries) system.queries = {};\n      system.queries[queryName] = query;\n      if (queryConfig.modified) {\n        query.reactive = true;\n        query.runners.modified.add(system);\n      }\n      if (queryConfig.added) {\n        query.reactive = true;\n        query.runners.added.add(system);\n      }\n      if (queryConfig.removed) {\n        query.reactive = true;\n        query.runners.removed.add(system);\n      }\n    }\n  }\n}\nexport {\n  Not,\n  Or,\n  generateQueries\n};\n//# sourceMappingURL=QueryHelpers.mjs.map\n","import { Runner } from \"../../utils/Runner.mjs\";\nimport { ID32 } from \"./ID32.mjs\";\nvar QueryEvents = /* @__PURE__ */ ((QueryEvents2) => {\n  QueryEvents2[\"MODIFIED\"] = \"modified\";\n  QueryEvents2[\"ADDED\"] = \"added\";\n  QueryEvents2[\"REMOVED\"] = \"removed\";\n  return QueryEvents2;\n})(QueryEvents || {});\nclass Query {\n  constructor(world, key, name) {\n    this.reactive = false;\n    this.runners = {\n      added: new Runner(\"addedToQuery\", 2),\n      removed: new Runner(\"removedFromQuery\", 2),\n      modified: new Runner(\"modifiedQuery\", 5)\n    };\n    this.componentID = new ID32();\n    this.notComponentID = new ID32();\n    this.orComponentIDs = [];\n    this.entities = [];\n    this.key = key.name;\n    this.componentID = key.componentID;\n    this.notComponentID = key.notComponentID;\n    this.orComponentIDs = key.orComponentIDs;\n    this.name = name;\n    for (let i = 0; i < world.allEntities.children.length; i++) {\n      const entity = world.allEntities.children[i];\n      if (this.match(entity.componentBitHash)) {\n        this.entities.push(entity);\n      }\n    }\n  }\n  /** Gets the first entity in the query. */\n  get first() {\n    return this.entities[0];\n  }\n  /**\n   * Loops through all entities in the query backwards\n   *\n   * @param callbackfn - callback on interaction\n   */\n  forEach(callbackfn) {\n    for (let e = this.entities.length - 1; e >= 0; --e) {\n      const entity = this.entities[e];\n      callbackfn(entity, e, this.entities);\n    }\n  }\n  /**\n   * Add entity to this query\n   *\n   * @param entity - entity to be added\n   */\n  addEntity(entity) {\n    const index = this.entities.indexOf(entity);\n    if (!~index) {\n      entity.queries.push(this);\n      this.entities.push(entity);\n      this.runners.added.run(entity, this);\n    }\n  }\n  /**\n   * Remove entity from this query\n   *\n   * @param entity - entity to be removed\n   */\n  removeEntity(entity) {\n    let index = this.entities.indexOf(entity);\n    if (~index) {\n      this.entities.splice(index, 1);\n      index = entity.queries.indexOf(this);\n      entity.queries.splice(index, 1);\n      this.runners.removed.run(entity, this);\n    }\n  }\n  modifiedQuery(entity, Class, data) {\n    this.runners.modified.run(entity, entity.c[Class.NAME], data, this, Class);\n  }\n  /**\n   * checks if an entity exists in this query\n   *\n   * @param entity - entity to be checked\n   */\n  hasEntity(entity) {\n    return !!~this.entities.indexOf(entity);\n  }\n  /**\n   * Checks if an entity id matches the query id.\n   *\n   * @param entityId - id of the entity to check\n   */\n  match(entityId) {\n    const matchesComponents = this.componentID.matchIndex(entityId);\n    const matchesNotComponents = this.notComponentID.matchAnyIndex(entityId);\n    let matchesOrComponents = true;\n    if (this.orComponentIDs.length > 0) {\n      matchesOrComponents = this.orComponentIDs.every((ids) => ids.matchAnyIndex(entityId));\n    }\n    return matchesComponents && !matchesNotComponents && matchesOrComponents;\n  }\n}\nexport {\n  Query,\n  QueryEvents\n};\n//# sourceMappingURL=Query.mjs.map\n","import { UIDs } from \"../Entity.mjs\";\nimport { ID32 } from \"./ID32.mjs\";\nimport { Query } from \"./Query.mjs\";\nclass QueryManager {\n  constructor(world) {\n    this._scene = world;\n    this._queries = {};\n  }\n  /**\n   * Adds/removes an entity from a query after a component has been added\n   *\n   * @param entity - entity to be added/removed\n   */\n  onEntityComponentAdded(entity) {\n    for (const queryName in this._queries) {\n      const query = this._queries[queryName];\n      query.match(entity.componentBitHash) ? query.addEntity(entity) : query.removeEntity(entity);\n    }\n  }\n  /**\n   * Adds/removes an entity from a query after a component has been removed\n   *\n   * @param entity - entity to be added/removed\n   */\n  onEntityComponentRemoved(entity) {\n    for (const queryName in this._queries) {\n      const query = this._queries[queryName];\n      query.match(entity.componentBitHash) ? query.addEntity(entity) : query.removeEntity(entity);\n    }\n  }\n  /**\n   * Adds an entity to any matching queries\n   *\n   * @param entity - entity to be added\n   */\n  onEntityAdded(entity) {\n    this.onEntityComponentAdded(entity);\n  }\n  /**\n   * Removed an entity from any matching queries\n   *\n   * @param entity - entity to be removed\n   */\n  onEntityRemoved(entity) {\n    for (const queryName in this._queries) {\n      this._queries[queryName].removeEntity(entity);\n    }\n  }\n  /**\n   * Returns a query based off of the components provided\n   *\n   * @param components - components to check\n   * @param name - name of the query\n   */\n  getQuery(components, name) {\n    if (components.length === 0) {\n      throw Error(\"[QueryManager] cannot create empty query\");\n    }\n    const key = this.generateQueryKey(components);\n    let query = this._queries[key.name];\n    if (!query) {\n      this._queries[key.name] = query = new Query(this._scene, key, name);\n    }\n    return query;\n  }\n  /**\n   * Generate a query key using component ids\n   *\n   * @param components - components to generate key\n   */\n  generateQueryKey(components) {\n    const componentID = new ID32();\n    const notComponentID = new ID32();\n    const orComponentIDs = [];\n    let orNames = \"\";\n    const setID = (component) => {\n      if (component.ID === void 0) {\n        component.ID = UIDs._COMPONENT++;\n      }\n    };\n    components.forEach((component) => {\n      if (typeof component === \"object\") {\n        if (component.operator === \"not\") {\n          component = component.component;\n          setID(component);\n          notComponentID.setIndex(component.ID);\n        } else {\n          const orId = new ID32();\n          component.components.forEach((component2) => {\n            setID(component2);\n            orId.setIndex(component2.ID);\n          });\n          orComponentIDs.push(orId);\n          orNames += `${orId.id.toString()}||`;\n        }\n      } else {\n        setID(component);\n        componentID.setIndex(component.ID);\n      }\n    });\n    return {\n      name: `${componentID.id.toString()}!${notComponentID.id.toString()}||${orNames}`,\n      componentID,\n      notComponentID,\n      orComponentIDs\n    };\n  }\n}\nexport {\n  QueryManager\n};\n//# sourceMappingURL=QueryManager.mjs.map\n","import { Runner } from \"../utils/Runner.mjs\";\nimport { Signals } from \"../utils/Signals.mjs\";\nimport { SmoothTime } from \"../utils/SmoothTime.mjs\";\nimport { Time } from \"../utils/Time.mjs\";\nimport { Group } from \"./groups/Group.mjs\";\nimport { PoolGroup } from \"./pool/PoolGroup.mjs\";\nimport { generateQueries } from \"./queries/QueryHelpers.mjs\";\nimport { QueryManager } from \"./queries/QueryManager.mjs\";\nclass Scene extends Signals {\n  /**\n   * @param data - Options to use for your game\n   * updateAndRender - True if you want the update and render to be\n   * called simultaneously. This can be handy if you want to render and update the game at different rates\n   * smoothTime - If is set, the scene will use SmoothTime instead of Time, that can potentially\n   * help to prevent some small hiccups caused by frame rate oscilation.\n   */\n  constructor(data = {}) {\n    super();\n    this.allSystems = /* @__PURE__ */ new Map();\n    this.allEntities = new Group();\n    this.queryManager = new QueryManager(this);\n    this.paused = false;\n    this.runners = {\n      /** A runner called when the scene is resized. Calls `resize()` on any registered objects. */\n      resize: new Runner(\"resize\", 2),\n      /** A runner called before a scene update happens. Calls `preupdate()` on any registered objects. */\n      preupdate: new Runner(\"preupdate\", 1),\n      /** A runner called before a scene update happens. Calls `update()` on any registered objects. */\n      update: new Runner(\"update\", 1),\n      /** A runner called after the scene has updated. Calls `postupdate()` on any registered objects. */\n      postupdate: new Runner(\"postupdate\", 1),\n      /** A runner called before a scene render happens. Calls `prerender()` on any registered objects. */\n      prerender: new Runner(\"prerender\", 1),\n      /** A runner called before a scene render happens. Calls `render()` on any registered objects. */\n      render: new Runner(\"render\", 1),\n      /** A runner called after the scene has render. Calls `postrender()` on any registered objects. */\n      postrender: new Runner(\"postrender\", 1),\n      /** A runner called when a scene is about to be emptied. Calls `reset()` on any registered objects. */\n      reset: new Runner(\"reset\", 1)\n    };\n    this._enabled = false;\n    this._width = 100;\n    this._height = 100;\n    this._entitiesToRemove = [];\n    this._systemsToStart = [];\n    this.time = data.smoothTime ? new SmoothTime({ smooth: data.smoothTime }) : new Time();\n    this._updateAndRender = data.updateAndRender ?? true;\n    data.autoStart = data.autoStart ?? false;\n    data.autoStart && this.start();\n  }\n  start() {\n    if (this._enabled) return;\n    this.allSystems.forEach((system) => {\n      var _a;\n      (_a = system.awake) == null ? void 0 : _a.call(system);\n    });\n    this._enabled = true;\n  }\n  /**\n   * Adds a system to the scene, passing data to the `init` function of the system if implemented.\n   *\n   * @param Class - A class to create an instance of.\n   * @param data - A list of options passed to the System when it is initialized.\n   */\n  addSystem(Class, data) {\n    var _a, _b;\n    const name = Class.NAME;\n    if (!name) throw new Error(\"[SystemManager]: cannot add System without name\");\n    if (this.allSystems.has(name)) {\n      return this.allSystems.get(name);\n    }\n    const system = new Class();\n    system.scene = this;\n    system.queries = {};\n    generateQueries(Class, system);\n    (_a = system.init) == null ? void 0 : _a.call(system, data);\n    this._enabled && ((_b = system.awake) == null ? void 0 : _b.call(system));\n    const { runners } = this;\n    for (const key in runners)\n      runners[key].add(system);\n    this._systemsToStart.push(system);\n    this.allSystems.set(Class.NAME, system);\n    return system;\n  }\n  /**\n   * return the system of the specified type\n   *\n   * @param Class - instance of class to get\n   */\n  getSystem(Class) {\n    return this.allSystems.get(Class.NAME);\n  }\n  /**\n   * Directly adds an entity to the game.\n   *\n   * @param entity - the entity to add to the game\n   */\n  addToScene(entity) {\n    if (entity._gc) {\n      const index = this._entitiesToRemove.indexOf(entity);\n      this._entitiesToRemove.splice(index, 1);\n      entity._gc = false;\n    }\n    if (entity.scene) {\n      if (entity.scene === this) {\n        return;\n      }\n      this._removeEntity(entity);\n    }\n    entity.scene = this;\n    this.allEntities.add(entity);\n    this.queryManager.onEntityAdded(entity);\n  }\n  /**\n   * Directly removes an entity from the game\n   *\n   * @param entity - the entity to remove\n   */\n  removeFromScene(entity) {\n    if (entity._gc || !entity.scene) return;\n    entity._gc = true;\n    this._entitiesToRemove.push(entity);\n  }\n  /** Called before the game is rendered. Called by a render system before it is about to draw to the screen */\n  renderStart() {\n    if (this._updateAndRender) {\n      this.update();\n    }\n    this.runners.prerender.run(this.time);\n    this.runners.render.run(this.time);\n  }\n  /** called by a render system when it has finished rendering */\n  renderFinish() {\n    this.runners.postrender.run(this.time);\n  }\n  /** Called automatically by View2DSystem/View3DSystem before each render if `updateAndRender` is true. Otherwise you must call this manually */\n  update() {\n    if (this.paused || !this._enabled) return;\n    this.time.nextUpdate();\n    this._startSystems();\n    this._removeEntities();\n    this.runners.preupdate.run(this.time);\n    this._removeEntities();\n    this.runners.update.run(this.time);\n    this._removeEntities();\n    this.runners.postupdate.run(this.time);\n  }\n  /** Restarts the scene by calling `scene.reset` and `scene.start` */\n  restart() {\n    this.reset();\n    this.start();\n  }\n  /**\n   * This is called when you want to essentially clean out the game. Its like wiping the slate clean\n   * All systems will be notified and all entities will be removed.\n   */\n  reset() {\n    this._removeEntities();\n    this.runners.reset.run();\n    for (let i = this.allEntities.children.length - 1; i >= 0; --i) {\n      const entity = this.allEntities.children[i];\n      entity._released = true;\n      this._removeEntity(entity);\n    }\n    this.allEntities.empty();\n    for (const key in this.runners) {\n      this.runners[key].removeAll();\n    }\n    this._entitiesToRemove.length = 0;\n    this.allSystems.forEach((system) => {\n      for (const rKey in this.runners) {\n        this.runners[rKey].add(system);\n      }\n      this._systemsToStart.push(system);\n    });\n    this._enabled = false;\n  }\n  /**\n   * Calls resize on all systems subscribed to the resize runner\n   *\n   * @param w - the width to make the game\n   * @param h - the height to make the game\n   */\n  resize(w, h) {\n    this._width = w;\n    this._height = h;\n    this.runners.resize.run(w, h);\n  }\n  /** removes all entities that need to be removed from the scene */\n  _removeEntities() {\n    const entitiesToRemove = this._entitiesToRemove;\n    if (!entitiesToRemove.length) return;\n    for (let i = 0; i < entitiesToRemove.length; i++) {\n      const entity = entitiesToRemove[i];\n      this._removeEntity(entity);\n    }\n    entitiesToRemove.length = 0;\n  }\n  /** removes an entity from the scene */\n  _removeEntity(entity) {\n    var _a;\n    if (entity._released) {\n      entity._pooled ? PoolGroup.return(entity) : (_a = entity.reset) == null ? void 0 : _a.call(entity);\n    }\n    this.queryManager.onEntityRemoved(entity);\n    this.allEntities.remove(entity);\n    entity._gc = false;\n    entity.scene = null;\n    entity._released = false;\n  }\n  /** calls the start function on systems */\n  _startSystems() {\n    var _a;\n    for (let i = 0; i < this._systemsToStart.length; i++) {\n      const system = this._systemsToStart[i];\n      (_a = system.start) == null ? void 0 : _a.call(system);\n    }\n    this._systemsToStart.length = 0;\n  }\n  /** the width of the game. to modify this its best to call `game.resize(w, h)` */\n  get width() {\n    return this._width;\n  }\n  /** the height of the game. to modify this its best to call `game.resize(w, h)` */\n  get height() {\n    return this._height;\n  }\n}\nexport {\n  Scene\n};\n//# sourceMappingURL=Scene.mjs.map\n","import { Container, RenderContainer } from \"pixi.js\";\nimport { View2DComponent } from \"./View2DComponent.mjs\";\nconst _View2DSystem = class _View2DSystem {\n  constructor() {\n    this.w = -1;\n    this.h = -1;\n    this.camera = { x: 0, y: 0, zoom: 1, offset: { x: 0, y: 0 } };\n    this._activeItemsContainer = new Container();\n    this._layers = {};\n    this._innerContainer = new Container();\n  }\n  init(opts = {}) {\n    this.stage = opts.stage || new Container();\n    const startHook = new RenderContainer({\n      render: () => {\n        this.scene.renderStart();\n      }\n    });\n    const endHook = new RenderContainer({\n      render: () => {\n        this.scene.renderFinish();\n      }\n    });\n    this.stage.isRenderGroup = true;\n    this.stage.addChild(startHook);\n    this.stage.addChild(this._innerContainer);\n    this._innerContainer.addChild(this._activeItemsContainer);\n    this.stage.addChild(endHook);\n    this.addLayer(\"back\");\n    this.addLayer(\"default\");\n    this.addLayer(\"front\");\n    this.resize(1, 1);\n  }\n  setCamera(camera) {\n    this.camera = camera;\n    this.resize(this.w, this.h);\n  }\n  render() {\n    const zoom = this.camera.zoom;\n    const stage = this.stage;\n    stage.scale.set(zoom);\n    stage.position.x = this.w / 2 - this.w / 2 * zoom + this.camera.offset.x * 2;\n    stage.position.y = this.h / 2 - this.h / 2 * zoom + this.camera.offset.y;\n    const sx = this._innerContainer.scale.x;\n    const sy = this._innerContainer.scale.y;\n    this._innerContainer.x = -this.camera.x * sx + this.w / 2;\n    this._innerContainer.y = -this.camera.y * sy + this.h / 2;\n  }\n  addedToQuery(ent) {\n    const entity = ent;\n    const view = entity.c.view2d.view;\n    const layer = this._layers[entity.c.view2d.layer];\n    layer.addChild(view);\n  }\n  removedFromQuery(ent) {\n    const entity = ent;\n    const view = entity.c.view2d.view;\n    const layer = this._layers[entity.c.view2d.layer];\n    layer.removeChild(view);\n  }\n  reset() {\n  }\n  addLayer(id, index = -1) {\n    this._layers[id] = new Container();\n    if (index === -1) {\n      index = this._activeItemsContainer.children.length;\n    }\n    this._activeItemsContainer.addChildAt(this._layers[id], index);\n  }\n  /**\n   * Changes an entities layer\n   *\n   * @param entity - entity to swap layer\n   * @param newLayer - id of layer to swap too\n   * @param depth - depth to add the entity at\n   */\n  setEntityLayer(entity, newLayer, depth = -1) {\n    if (!this._layers[newLayer]) {\n      throw new Error(`Layer doesn't exist: ${newLayer}`);\n    }\n    const view2d = entity.getComponent(View2DComponent);\n    if (view2d) {\n      const view = view2d.view;\n      const layer = this._layers[view2d.layer];\n      const index = layer.children.indexOf(view);\n      if (index !== -1) {\n        layer.removeChild(view);\n      }\n      if (depth === -1) {\n        depth = this._layers[newLayer].children.length;\n      }\n      this._layers[newLayer].addChildAt(view, depth);\n      view2d.layer = newLayer;\n    }\n  }\n  /**\n   * Sets a layer to a specific index\n   *\n   * @param layerName - name of the layer\n   * @param index - index to add the layer at\n   */\n  setLayerAt(layerName, index) {\n    const layer = this.layers[layerName];\n    if (!layer) return;\n    this.activeItemsContainer.addChildAt(layer, index);\n  }\n  resize(w, h) {\n    if (this.w === w && this.h === h) return;\n    this.w = w;\n    this.h = h;\n  }\n  get layers() {\n    return this._layers;\n  }\n  get activeItemsContainer() {\n    return this._activeItemsContainer;\n  }\n  get innerContainer() {\n    return this._innerContainer;\n  }\n};\n_View2DSystem.NAME = \"view2d\";\n_View2DSystem.Queries = {\n  view2d: {\n    components: [View2DComponent],\n    added: true,\n    removed: true\n  }\n};\nlet View2DSystem = _View2DSystem;\nexport {\n  View2DSystem\n};\n//# sourceMappingURL=View2DSystem.mjs.map\n","import { Scene } from \"../../core/Scene.mjs\";\nimport { View2DSystem } from \"./view/View2DSystem.mjs\";\nclass Scene2D extends Scene {\n  constructor(options) {\n    super(options);\n    this.register(\"onGameover\");\n    this.register(\"onGameComplete\");\n    this.view2d = this.addSystem(View2DSystem, { stage: options.stage });\n  }\n  addChild(...entities) {\n    if (entities.length > 1) {\n      for (let i = 0; i < entities.length; i++) {\n        this.addToScene(entities[i]);\n      }\n    } else {\n      this.addToScene(entities[0]);\n    }\n  }\n  removeChild(...entities) {\n    if (entities.length > 1) {\n      for (let i = 0; i < entities.length; i++) {\n        this.removeFromScene(entities[i]);\n      }\n    } else {\n      this.removeFromScene(entities[0]);\n    }\n  }\n}\nexport {\n  Scene2D\n};\n//# sourceMappingURL=Scene2D.mjs.map\n","/**\n * Planck.js v1.4.2\n * @license The MIT license\n * @copyright Copyright (c) 2025 Erin Catto, Ali Shakiba\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\nvar extendStatics = function(d2, b2) {\n  extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(d3, b3) {\n    d3.__proto__ = b3;\n  } || function(d3, b3) {\n    for (var p in b3) if (Object.prototype.hasOwnProperty.call(b3, p)) d3[p] = b3[p];\n  };\n  return extendStatics(d2, b2);\n};\nfunction __extends(d2, b2) {\n  if (typeof b2 !== \"function\" && b2 !== null)\n    throw new TypeError(\"Class extends value \" + String(b2) + \" is not a constructor or null\");\n  extendStatics(d2, b2);\n  function __() {\n    this.constructor = d2;\n  }\n  d2.prototype = b2 === null ? Object.create(b2) : (__.prototype = b2.prototype, new __());\n}\nvar __assign = function() {\n  __assign = Object.assign || function __assign2(t) {\n    for (var s2, i = 1, n2 = arguments.length; i < n2; i++) {\n      s2 = arguments[i];\n      for (var p in s2) if (Object.prototype.hasOwnProperty.call(s2, p)) t[p] = s2[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar options = function(input2, defaults) {\n  if (input2 === null || typeof input2 === \"undefined\") {\n    input2 = {};\n  }\n  var output2 = __assign({}, input2);\n  for (var key in defaults) {\n    if (defaults.hasOwnProperty(key) && typeof input2[key] === \"undefined\") {\n      output2[key] = defaults[key];\n    }\n  }\n  if (typeof Object.getOwnPropertySymbols === \"function\") {\n    var symbols = Object.getOwnPropertySymbols(defaults);\n    for (var i = 0; i < symbols.length; i++) {\n      var symbol = symbols[i];\n      if (defaults.propertyIsEnumerable(symbol) && typeof input2[symbol] === \"undefined\") {\n        output2[symbol] = defaults[symbol];\n      }\n    }\n  }\n  return output2;\n};\nvar math_random = Math.random;\nvar EPSILON = 1e-9;\nvar isFinite = Number.isFinite;\nfunction nextPowerOfTwo(x2) {\n  x2 |= x2 >> 1;\n  x2 |= x2 >> 2;\n  x2 |= x2 >> 4;\n  x2 |= x2 >> 8;\n  x2 |= x2 >> 16;\n  return x2 + 1;\n}\nfunction isPowerOfTwo(x2) {\n  return x2 > 0 && (x2 & x2 - 1) === 0;\n}\nfunction mod(num, min, max) {\n  if (typeof min === \"undefined\") {\n    max = 1;\n    min = 0;\n  } else if (typeof max === \"undefined\") {\n    max = min;\n    min = 0;\n  }\n  if (max > min) {\n    num = (num - min) % (max - min);\n    return num + (num < 0 ? max : min);\n  } else {\n    num = (num - max) % (min - max);\n    return num + (num <= 0 ? min : max);\n  }\n}\nfunction clamp(num, min, max) {\n  if (num < min) {\n    return min;\n  } else if (num > max) {\n    return max;\n  } else {\n    return num;\n  }\n}\nfunction random(min, max) {\n  if (typeof min === \"undefined\") {\n    max = 1;\n    min = 0;\n  } else if (typeof max === \"undefined\") {\n    max = min;\n    min = 0;\n  }\n  return min === max ? min : math_random() * (max - min) + min;\n}\nvar math = Object.create(Math);\nmath.EPSILON = EPSILON;\nmath.isFinite = isFinite;\nmath.nextPowerOfTwo = nextPowerOfTwo;\nmath.isPowerOfTwo = isPowerOfTwo;\nmath.mod = mod;\nmath.clamp = clamp;\nmath.random = random;\nvar math_abs$9 = Math.abs;\nvar math_sqrt$5 = Math.sqrt;\nvar math_max$8 = Math.max;\nvar math_min$8 = Math.min;\nvar Vec2 = (\n  /** @class */\n  function() {\n    function Vec22(x2, y) {\n      if (!(this instanceof Vec22)) {\n        return new Vec22(x2, y);\n      }\n      if (typeof x2 === \"undefined\") {\n        this.x = 0;\n        this.y = 0;\n      } else if (typeof x2 === \"object\") {\n        this.x = x2.x;\n        this.y = x2.y;\n      } else {\n        this.x = x2;\n        this.y = y;\n      }\n    }\n    Vec22.prototype._serialize = function() {\n      return {\n        x: this.x,\n        y: this.y\n      };\n    };\n    Vec22._deserialize = function(data) {\n      var obj = Object.create(Vec22.prototype);\n      obj.x = data.x;\n      obj.y = data.y;\n      return obj;\n    };\n    Vec22.zero = function() {\n      var obj = Object.create(Vec22.prototype);\n      obj.x = 0;\n      obj.y = 0;\n      return obj;\n    };\n    Vec22.neo = function(x2, y) {\n      var obj = Object.create(Vec22.prototype);\n      obj.x = x2;\n      obj.y = y;\n      return obj;\n    };\n    Vec22.clone = function(v3) {\n      return Vec22.neo(v3.x, v3.y);\n    };\n    Vec22.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    Vec22.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Number.isFinite(obj.x) && Number.isFinite(obj.y);\n    };\n    Vec22.assert = function(o) {\n    };\n    Vec22.prototype.clone = function() {\n      return Vec22.clone(this);\n    };\n    Vec22.prototype.setZero = function() {\n      this.x = 0;\n      this.y = 0;\n      return this;\n    };\n    Vec22.prototype.set = function(x2, y) {\n      if (typeof x2 === \"object\") {\n        this.x = x2.x;\n        this.y = x2.y;\n      } else {\n        this.x = x2;\n        this.y = y;\n      }\n      return this;\n    };\n    Vec22.prototype.setNum = function(x2, y) {\n      this.x = x2;\n      this.y = y;\n      return this;\n    };\n    Vec22.prototype.setVec2 = function(value) {\n      this.x = value.x;\n      this.y = value.y;\n      return this;\n    };\n    Vec22.prototype.wSet = function(a2, v3, b2, w) {\n      if (typeof b2 !== \"undefined\" || typeof w !== \"undefined\") {\n        return this.setCombine(a2, v3, b2, w);\n      } else {\n        return this.setMul(a2, v3);\n      }\n    };\n    Vec22.prototype.setCombine = function(a2, v3, b2, w) {\n      var x2 = a2 * v3.x + b2 * w.x;\n      var y = a2 * v3.y + b2 * w.y;\n      this.x = x2;\n      this.y = y;\n      return this;\n    };\n    Vec22.prototype.setMul = function(a2, v3) {\n      var x2 = a2 * v3.x;\n      var y = a2 * v3.y;\n      this.x = x2;\n      this.y = y;\n      return this;\n    };\n    Vec22.prototype.add = function(w) {\n      this.x += w.x;\n      this.y += w.y;\n      return this;\n    };\n    Vec22.prototype.wAdd = function(a2, v3, b2, w) {\n      if (typeof b2 !== \"undefined\" || typeof w !== \"undefined\") {\n        return this.addCombine(a2, v3, b2, w);\n      } else {\n        return this.addMul(a2, v3);\n      }\n    };\n    Vec22.prototype.addCombine = function(a2, v3, b2, w) {\n      var x2 = a2 * v3.x + b2 * w.x;\n      var y = a2 * v3.y + b2 * w.y;\n      this.x += x2;\n      this.y += y;\n      return this;\n    };\n    Vec22.prototype.addMul = function(a2, v3) {\n      var x2 = a2 * v3.x;\n      var y = a2 * v3.y;\n      this.x += x2;\n      this.y += y;\n      return this;\n    };\n    Vec22.prototype.wSub = function(a2, v3, b2, w) {\n      if (typeof b2 !== \"undefined\" || typeof w !== \"undefined\") {\n        return this.subCombine(a2, v3, b2, w);\n      } else {\n        return this.subMul(a2, v3);\n      }\n    };\n    Vec22.prototype.subCombine = function(a2, v3, b2, w) {\n      var x2 = a2 * v3.x + b2 * w.x;\n      var y = a2 * v3.y + b2 * w.y;\n      this.x -= x2;\n      this.y -= y;\n      return this;\n    };\n    Vec22.prototype.subMul = function(a2, v3) {\n      var x2 = a2 * v3.x;\n      var y = a2 * v3.y;\n      this.x -= x2;\n      this.y -= y;\n      return this;\n    };\n    Vec22.prototype.sub = function(w) {\n      this.x -= w.x;\n      this.y -= w.y;\n      return this;\n    };\n    Vec22.prototype.mul = function(m) {\n      this.x *= m;\n      this.y *= m;\n      return this;\n    };\n    Vec22.prototype.length = function() {\n      return Vec22.lengthOf(this);\n    };\n    Vec22.prototype.lengthSquared = function() {\n      return Vec22.lengthSquared(this);\n    };\n    Vec22.prototype.normalize = function() {\n      var length = this.length();\n      if (length < EPSILON) {\n        return 0;\n      }\n      var invLength = 1 / length;\n      this.x *= invLength;\n      this.y *= invLength;\n      return length;\n    };\n    Vec22.normalize = function(v3) {\n      var length = Vec22.lengthOf(v3);\n      if (length < EPSILON) {\n        return Vec22.zero();\n      }\n      var invLength = 1 / length;\n      return Vec22.neo(v3.x * invLength, v3.y * invLength);\n    };\n    Vec22.lengthOf = function(v3) {\n      return math_sqrt$5(v3.x * v3.x + v3.y * v3.y);\n    };\n    Vec22.lengthSquared = function(v3) {\n      return v3.x * v3.x + v3.y * v3.y;\n    };\n    Vec22.distance = function(v3, w) {\n      var dx = v3.x - w.x;\n      var dy = v3.y - w.y;\n      return math_sqrt$5(dx * dx + dy * dy);\n    };\n    Vec22.distanceSquared = function(v3, w) {\n      var dx = v3.x - w.x;\n      var dy = v3.y - w.y;\n      return dx * dx + dy * dy;\n    };\n    Vec22.areEqual = function(v3, w) {\n      return v3 === w || typeof w === \"object\" && w !== null && v3.x === w.x && v3.y === w.y;\n    };\n    Vec22.skew = function(v3) {\n      return Vec22.neo(-v3.y, v3.x);\n    };\n    Vec22.dot = function(v3, w) {\n      return v3.x * w.x + v3.y * w.y;\n    };\n    Vec22.cross = function(v3, w) {\n      if (typeof w === \"number\") {\n        return Vec22.neo(w * v3.y, -w * v3.x);\n      } else if (typeof v3 === \"number\") {\n        return Vec22.neo(-v3 * w.y, v3 * w.x);\n      } else {\n        return v3.x * w.y - v3.y * w.x;\n      }\n    };\n    Vec22.crossVec2Vec2 = function(v3, w) {\n      return v3.x * w.y - v3.y * w.x;\n    };\n    Vec22.crossVec2Num = function(v3, w) {\n      return Vec22.neo(w * v3.y, -w * v3.x);\n    };\n    Vec22.crossNumVec2 = function(v3, w) {\n      return Vec22.neo(-v3 * w.y, v3 * w.x);\n    };\n    Vec22.addCross = function(a2, v3, w) {\n      if (typeof w === \"number\") {\n        return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);\n      } else if (typeof v3 === \"number\") {\n        return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);\n      }\n    };\n    Vec22.addCrossVec2Num = function(a2, v3, w) {\n      return Vec22.neo(w * v3.y + a2.x, -w * v3.x + a2.y);\n    };\n    Vec22.addCrossNumVec2 = function(a2, v3, w) {\n      return Vec22.neo(-v3 * w.y + a2.x, v3 * w.x + a2.y);\n    };\n    Vec22.add = function(v3, w) {\n      return Vec22.neo(v3.x + w.x, v3.y + w.y);\n    };\n    Vec22.wAdd = function(a2, v3, b2, w) {\n      if (typeof b2 !== \"undefined\" || typeof w !== \"undefined\") {\n        return Vec22.combine(a2, v3, b2, w);\n      } else {\n        return Vec22.mulNumVec2(a2, v3);\n      }\n    };\n    Vec22.combine = function(a2, v3, b2, w) {\n      return Vec22.zero().setCombine(a2, v3, b2, w);\n    };\n    Vec22.sub = function(v3, w) {\n      return Vec22.neo(v3.x - w.x, v3.y - w.y);\n    };\n    Vec22.mul = function(a2, b2) {\n      if (typeof a2 === \"object\") {\n        return Vec22.neo(a2.x * b2, a2.y * b2);\n      } else if (typeof b2 === \"object\") {\n        return Vec22.neo(a2 * b2.x, a2 * b2.y);\n      }\n    };\n    Vec22.mulVec2Num = function(a2, b2) {\n      return Vec22.neo(a2.x * b2, a2.y * b2);\n    };\n    Vec22.mulNumVec2 = function(a2, b2) {\n      return Vec22.neo(a2 * b2.x, a2 * b2.y);\n    };\n    Vec22.prototype.neg = function() {\n      this.x = -this.x;\n      this.y = -this.y;\n      return this;\n    };\n    Vec22.neg = function(v3) {\n      return Vec22.neo(-v3.x, -v3.y);\n    };\n    Vec22.abs = function(v3) {\n      return Vec22.neo(math_abs$9(v3.x), math_abs$9(v3.y));\n    };\n    Vec22.mid = function(v3, w) {\n      return Vec22.neo((v3.x + w.x) * 0.5, (v3.y + w.y) * 0.5);\n    };\n    Vec22.upper = function(v3, w) {\n      return Vec22.neo(math_max$8(v3.x, w.x), math_max$8(v3.y, w.y));\n    };\n    Vec22.lower = function(v3, w) {\n      return Vec22.neo(math_min$8(v3.x, w.x), math_min$8(v3.y, w.y));\n    };\n    Vec22.prototype.clamp = function(max) {\n      var lengthSqr = this.x * this.x + this.y * this.y;\n      if (lengthSqr > max * max) {\n        var scale = max / math_sqrt$5(lengthSqr);\n        this.x *= scale;\n        this.y *= scale;\n      }\n      return this;\n    };\n    Vec22.clamp = function(v3, max) {\n      var r = Vec22.neo(v3.x, v3.y);\n      r.clamp(max);\n      return r;\n    };\n    Vec22.clampVec2 = function(v3, min, max) {\n      return {\n        x: clamp(v3.x, min === null || min === void 0 ? void 0 : min.x, max === null || max === void 0 ? void 0 : max.x),\n        y: clamp(v3.y, min === null || min === void 0 ? void 0 : min.y, max === null || max === void 0 ? void 0 : max.y)\n      };\n    };\n    Vec22.scaleFn = function(x2, y) {\n      return function(v3) {\n        return Vec22.neo(v3.x * x2, v3.y * y);\n      };\n    };\n    Vec22.translateFn = function(x2, y) {\n      return function(v3) {\n        return Vec22.neo(v3.x + x2, v3.y + y);\n      };\n    };\n    return Vec22;\n  }()\n);\nvar math_max$7 = Math.max;\nvar math_min$7 = Math.min;\nvar AABB = (\n  /** @class */\n  function() {\n    function AABB2(lower, upper) {\n      if (!(this instanceof AABB2)) {\n        return new AABB2(lower, upper);\n      }\n      this.lowerBound = Vec2.zero();\n      this.upperBound = Vec2.zero();\n      if (typeof lower === \"object\") {\n        this.lowerBound.setVec2(lower);\n      }\n      if (typeof upper === \"object\") {\n        this.upperBound.setVec2(upper);\n      } else if (typeof lower === \"object\") {\n        this.upperBound.setVec2(lower);\n      }\n    }\n    AABB2.prototype.isValid = function() {\n      return AABB2.isValid(this);\n    };\n    AABB2.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Vec2.isValid(obj.lowerBound) && Vec2.isValid(obj.upperBound) && Vec2.sub(obj.upperBound, obj.lowerBound).lengthSquared() >= 0;\n    };\n    AABB2.assert = function(o) {\n    };\n    AABB2.prototype.getCenter = function() {\n      return Vec2.neo((this.lowerBound.x + this.upperBound.x) * 0.5, (this.lowerBound.y + this.upperBound.y) * 0.5);\n    };\n    AABB2.prototype.getExtents = function() {\n      return Vec2.neo((this.upperBound.x - this.lowerBound.x) * 0.5, (this.upperBound.y - this.lowerBound.y) * 0.5);\n    };\n    AABB2.prototype.getPerimeter = function() {\n      return 2 * (this.upperBound.x - this.lowerBound.x + this.upperBound.y - this.lowerBound.y);\n    };\n    AABB2.prototype.combine = function(a2, b2) {\n      b2 = b2 || this;\n      var lowerA = a2.lowerBound;\n      var upperA = a2.upperBound;\n      var lowerB = b2.lowerBound;\n      var upperB = b2.upperBound;\n      var lowerX = math_min$7(lowerA.x, lowerB.x);\n      var lowerY = math_min$7(lowerA.y, lowerB.y);\n      var upperX = math_max$7(upperB.x, upperA.x);\n      var upperY = math_max$7(upperB.y, upperA.y);\n      this.lowerBound.setNum(lowerX, lowerY);\n      this.upperBound.setNum(upperX, upperY);\n    };\n    AABB2.prototype.combinePoints = function(a2, b2) {\n      this.lowerBound.setNum(math_min$7(a2.x, b2.x), math_min$7(a2.y, b2.y));\n      this.upperBound.setNum(math_max$7(a2.x, b2.x), math_max$7(a2.y, b2.y));\n    };\n    AABB2.prototype.set = function(aabb) {\n      this.lowerBound.setNum(aabb.lowerBound.x, aabb.lowerBound.y);\n      this.upperBound.setNum(aabb.upperBound.x, aabb.upperBound.y);\n    };\n    AABB2.prototype.contains = function(aabb) {\n      var result = true;\n      result = result && this.lowerBound.x <= aabb.lowerBound.x;\n      result = result && this.lowerBound.y <= aabb.lowerBound.y;\n      result = result && aabb.upperBound.x <= this.upperBound.x;\n      result = result && aabb.upperBound.y <= this.upperBound.y;\n      return result;\n    };\n    AABB2.prototype.extend = function(value) {\n      AABB2.extend(this, value);\n      return this;\n    };\n    AABB2.extend = function(out, value) {\n      out.lowerBound.x -= value;\n      out.lowerBound.y -= value;\n      out.upperBound.x += value;\n      out.upperBound.y += value;\n      return out;\n    };\n    AABB2.testOverlap = function(a2, b2) {\n      var d1x = b2.lowerBound.x - a2.upperBound.x;\n      var d2x = a2.lowerBound.x - b2.upperBound.x;\n      var d1y = b2.lowerBound.y - a2.upperBound.y;\n      var d2y = a2.lowerBound.y - b2.upperBound.y;\n      if (d1x > 0 || d1y > 0 || d2x > 0 || d2y > 0) {\n        return false;\n      }\n      return true;\n    };\n    AABB2.areEqual = function(a2, b2) {\n      return Vec2.areEqual(a2.lowerBound, b2.lowerBound) && Vec2.areEqual(a2.upperBound, b2.upperBound);\n    };\n    AABB2.diff = function(a2, b2) {\n      var wD = math_max$7(0, math_min$7(a2.upperBound.x, b2.upperBound.x) - math_max$7(b2.lowerBound.x, a2.lowerBound.x));\n      var hD = math_max$7(0, math_min$7(a2.upperBound.y, b2.upperBound.y) - math_max$7(b2.lowerBound.y, a2.lowerBound.y));\n      var wA = a2.upperBound.x - a2.lowerBound.x;\n      var hA = a2.upperBound.y - a2.lowerBound.y;\n      var wB = b2.upperBound.x - b2.lowerBound.x;\n      var hB = b2.upperBound.y - b2.lowerBound.y;\n      return wA * hA + wB * hB - wD * hD;\n    };\n    AABB2.prototype.rayCast = function(output2, input2) {\n      var tmin = -Infinity;\n      var tmax = Infinity;\n      var p = input2.p1;\n      var d2 = Vec2.sub(input2.p2, input2.p1);\n      var absD = Vec2.abs(d2);\n      var normal3 = Vec2.zero();\n      {\n        if (absD.x < EPSILON) {\n          if (p.x < this.lowerBound.x || this.upperBound.x < p.x) {\n            return false;\n          }\n        } else {\n          var inv_d = 1 / d2.x;\n          var t1 = (this.lowerBound.x - p.x) * inv_d;\n          var t2 = (this.upperBound.x - p.x) * inv_d;\n          var s2 = -1;\n          if (t1 > t2) {\n            var temp3 = t1;\n            t1 = t2;\n            t2 = temp3;\n            s2 = 1;\n          }\n          if (t1 > tmin) {\n            normal3.setZero();\n            normal3.x = s2;\n            tmin = t1;\n          }\n          tmax = math_min$7(tmax, t2);\n          if (tmin > tmax) {\n            return false;\n          }\n        }\n      }\n      {\n        if (absD.y < EPSILON) {\n          if (p.y < this.lowerBound.y || this.upperBound.y < p.y) {\n            return false;\n          }\n        } else {\n          var inv_d = 1 / d2.y;\n          var t1 = (this.lowerBound.y - p.y) * inv_d;\n          var t2 = (this.upperBound.y - p.y) * inv_d;\n          var s2 = -1;\n          if (t1 > t2) {\n            var temp3 = t1;\n            t1 = t2;\n            t2 = temp3;\n            s2 = 1;\n          }\n          if (t1 > tmin) {\n            normal3.setZero();\n            normal3.y = s2;\n            tmin = t1;\n          }\n          tmax = math_min$7(tmax, t2);\n          if (tmin > tmax) {\n            return false;\n          }\n        }\n      }\n      if (tmin < 0 || input2.maxFraction < tmin) {\n        return false;\n      }\n      output2.fraction = tmin;\n      output2.normal = normal3;\n      return true;\n    };\n    AABB2.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    AABB2.combinePoints = function(out, a2, b2) {\n      out.lowerBound.x = math_min$7(a2.x, b2.x);\n      out.lowerBound.y = math_min$7(a2.y, b2.y);\n      out.upperBound.x = math_max$7(a2.x, b2.x);\n      out.upperBound.y = math_max$7(a2.y, b2.y);\n      return out;\n    };\n    AABB2.combinedPerimeter = function(a2, b2) {\n      var lx = math_min$7(a2.lowerBound.x, b2.lowerBound.x);\n      var ly = math_min$7(a2.lowerBound.y, b2.lowerBound.y);\n      var ux = math_max$7(a2.upperBound.x, b2.upperBound.x);\n      var uy = math_max$7(a2.upperBound.y, b2.upperBound.y);\n      return 2 * (ux - lx + uy - ly);\n    };\n    return AABB2;\n  }()\n);\nvar math_PI$6 = Math.PI;\nvar Settings = (\n  /** @class */\n  function() {\n    function Settings2() {\n    }\n    Object.defineProperty(Settings2, \"polygonRadius\", {\n      /**\n       * The radius of the polygon/edge shape skin. This should not be modified.\n       * Making this smaller means polygons will have an insufficient buffer for\n       * continuous collision. Making it larger may create artifacts for vertex\n       * collision.\n       */\n      get: function() {\n        return 2 * Settings2.linearSlop;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Settings2.lengthUnitsPerMeter = 1;\n    Settings2.maxManifoldPoints = 2;\n    Settings2.maxPolygonVertices = 12;\n    Settings2.aabbExtension = 0.1;\n    Settings2.aabbMultiplier = 2;\n    Settings2.linearSlop = 5e-3;\n    Settings2.angularSlop = 2 / 180 * math_PI$6;\n    Settings2.maxSubSteps = 8;\n    Settings2.maxTOIContacts = 32;\n    Settings2.maxTOIIterations = 20;\n    Settings2.maxDistanceIterations = 20;\n    Settings2.velocityThreshold = 1;\n    Settings2.maxLinearCorrection = 0.2;\n    Settings2.maxAngularCorrection = 8 / 180 * math_PI$6;\n    Settings2.maxTranslation = 2;\n    Settings2.maxRotation = 0.5 * math_PI$6;\n    Settings2.baumgarte = 0.2;\n    Settings2.toiBaugarte = 0.75;\n    Settings2.timeToSleep = 0.5;\n    Settings2.linearSleepTolerance = 0.01;\n    Settings2.angularSleepTolerance = 2 / 180 * math_PI$6;\n    return Settings2;\n  }()\n);\nvar SettingsInternal = (\n  /** @class */\n  function() {\n    function SettingsInternal2() {\n    }\n    Object.defineProperty(SettingsInternal2, \"maxManifoldPoints\", {\n      get: function() {\n        return Settings.maxManifoldPoints;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxPolygonVertices\", {\n      get: function() {\n        return Settings.maxPolygonVertices;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"aabbExtension\", {\n      get: function() {\n        return Settings.aabbExtension * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"aabbMultiplier\", {\n      get: function() {\n        return Settings.aabbMultiplier;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"linearSlop\", {\n      get: function() {\n        return Settings.linearSlop * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"linearSlopSquared\", {\n      get: function() {\n        return Settings.linearSlop * Settings.lengthUnitsPerMeter * Settings.linearSlop * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"angularSlop\", {\n      get: function() {\n        return Settings.angularSlop;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"polygonRadius\", {\n      get: function() {\n        return 2 * Settings.linearSlop;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxSubSteps\", {\n      get: function() {\n        return Settings.maxSubSteps;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxTOIContacts\", {\n      get: function() {\n        return Settings.maxTOIContacts;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxTOIIterations\", {\n      get: function() {\n        return Settings.maxTOIIterations;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxDistanceIterations\", {\n      get: function() {\n        return Settings.maxDistanceIterations;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"velocityThreshold\", {\n      get: function() {\n        return Settings.velocityThreshold * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxLinearCorrection\", {\n      get: function() {\n        return Settings.maxLinearCorrection * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxAngularCorrection\", {\n      get: function() {\n        return Settings.maxAngularCorrection;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxTranslation\", {\n      get: function() {\n        return Settings.maxTranslation * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxTranslationSquared\", {\n      get: function() {\n        return Settings.maxTranslation * Settings.lengthUnitsPerMeter * Settings.maxTranslation * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxRotation\", {\n      get: function() {\n        return Settings.maxRotation;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"maxRotationSquared\", {\n      get: function() {\n        return Settings.maxRotation * Settings.maxRotation;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"baumgarte\", {\n      get: function() {\n        return Settings.baumgarte;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"toiBaugarte\", {\n      get: function() {\n        return Settings.toiBaugarte;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"timeToSleep\", {\n      get: function() {\n        return Settings.timeToSleep;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"linearSleepTolerance\", {\n      get: function() {\n        return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"linearSleepToleranceSqr\", {\n      get: function() {\n        return Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter * Settings.linearSleepTolerance * Settings.lengthUnitsPerMeter;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"angularSleepTolerance\", {\n      get: function() {\n        return Settings.angularSleepTolerance;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(SettingsInternal2, \"angularSleepToleranceSqr\", {\n      get: function() {\n        return Settings.angularSleepTolerance * Settings.angularSleepTolerance;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    return SettingsInternal2;\n  }()\n);\nvar Pool = (\n  /** @class */\n  function() {\n    function Pool2(opts) {\n      this._list = [];\n      this._max = Infinity;\n      this._hasCreateFn = false;\n      this._createCount = 0;\n      this._hasAllocateFn = false;\n      this._allocateCount = 0;\n      this._hasReleaseFn = false;\n      this._releaseCount = 0;\n      this._hasDisposeFn = false;\n      this._disposeCount = 0;\n      this._list = [];\n      this._max = opts.max || this._max;\n      this._createFn = opts.create;\n      this._hasCreateFn = typeof this._createFn === \"function\";\n      this._allocateFn = opts.allocate;\n      this._hasAllocateFn = typeof this._allocateFn === \"function\";\n      this._releaseFn = opts.release;\n      this._hasReleaseFn = typeof this._releaseFn === \"function\";\n      this._disposeFn = opts.dispose;\n      this._hasDisposeFn = typeof this._disposeFn === \"function\";\n    }\n    Pool2.prototype.max = function(n2) {\n      if (typeof n2 === \"number\") {\n        this._max = n2;\n        return this;\n      }\n      return this._max;\n    };\n    Pool2.prototype.size = function() {\n      return this._list.length;\n    };\n    Pool2.prototype.allocate = function() {\n      var item;\n      if (this._list.length > 0) {\n        item = this._list.shift();\n      } else {\n        this._createCount++;\n        if (this._hasCreateFn) {\n          item = this._createFn();\n        } else {\n          item = {};\n        }\n      }\n      this._allocateCount++;\n      if (this._hasAllocateFn) {\n        this._allocateFn(item);\n      }\n      return item;\n    };\n    Pool2.prototype.release = function(item) {\n      if (this._list.length < this._max) {\n        this._releaseCount++;\n        if (this._hasReleaseFn) {\n          this._releaseFn(item);\n        }\n        this._list.push(item);\n      } else {\n        this._disposeCount++;\n        if (this._hasDisposeFn) {\n          item = this._disposeFn(item);\n        }\n      }\n    };\n    Pool2.prototype.toString = function() {\n      return \" +\" + this._createCount + \" >\" + this._allocateCount + \" <\" + this._releaseCount + \" -\" + this._disposeCount + \" =\" + this._list.length + \"/\" + this._max;\n    };\n    return Pool2;\n  }()\n);\nvar math_abs$8 = Math.abs;\nvar math_max$6 = Math.max;\nvar TreeNode = (\n  /** @class */\n  function() {\n    function TreeNode2(id) {\n      this.aabb = new AABB();\n      this.userData = null;\n      this.parent = null;\n      this.child1 = null;\n      this.child2 = null;\n      this.height = -1;\n      this.id = id;\n    }\n    TreeNode2.prototype.toString = function() {\n      return this.id + \": \" + this.userData;\n    };\n    TreeNode2.prototype.isLeaf = function() {\n      return this.child1 == null;\n    };\n    return TreeNode2;\n  }()\n);\nvar poolTreeNode = new Pool({\n  create: function() {\n    return new TreeNode();\n  },\n  release: function(node) {\n    node.userData = null;\n    node.parent = null;\n    node.child1 = null;\n    node.child2 = null;\n    node.height = -1;\n    node.id = void 0;\n  }\n});\nvar DynamicTree = (\n  /** @class */\n  function() {\n    function DynamicTree2() {\n      this.inputPool = new Pool({\n        create: function() {\n          return {};\n        },\n        release: function(stack) {\n        }\n      });\n      this.stackPool = new Pool({\n        create: function() {\n          return [];\n        },\n        release: function(stack) {\n          stack.length = 0;\n        }\n      });\n      this.iteratorPool = new Pool({\n        create: function() {\n          return new Iterator();\n        },\n        release: function(iterator) {\n          iterator.close();\n        }\n      });\n      this.m_root = null;\n      this.m_nodes = {};\n      this.m_lastProxyId = 0;\n    }\n    DynamicTree2.prototype.getUserData = function(id) {\n      var node = this.m_nodes[id];\n      return node.userData;\n    };\n    DynamicTree2.prototype.getFatAABB = function(id) {\n      var node = this.m_nodes[id];\n      return node.aabb;\n    };\n    DynamicTree2.prototype.allocateNode = function() {\n      var node = poolTreeNode.allocate();\n      node.id = ++this.m_lastProxyId;\n      this.m_nodes[node.id] = node;\n      return node;\n    };\n    DynamicTree2.prototype.freeNode = function(node) {\n      delete this.m_nodes[node.id];\n      poolTreeNode.release(node);\n    };\n    DynamicTree2.prototype.createProxy = function(aabb, userData) {\n      var node = this.allocateNode();\n      node.aabb.set(aabb);\n      AABB.extend(node.aabb, SettingsInternal.aabbExtension);\n      node.userData = userData;\n      node.height = 0;\n      this.insertLeaf(node);\n      return node.id;\n    };\n    DynamicTree2.prototype.destroyProxy = function(id) {\n      var node = this.m_nodes[id];\n      this.removeLeaf(node);\n      this.freeNode(node);\n    };\n    DynamicTree2.prototype.moveProxy = function(id, aabb, d2) {\n      var node = this.m_nodes[id];\n      if (node.aabb.contains(aabb)) {\n        return false;\n      }\n      this.removeLeaf(node);\n      node.aabb.set(aabb);\n      aabb = node.aabb;\n      AABB.extend(aabb, SettingsInternal.aabbExtension);\n      if (d2.x < 0) {\n        aabb.lowerBound.x += d2.x * SettingsInternal.aabbMultiplier;\n      } else {\n        aabb.upperBound.x += d2.x * SettingsInternal.aabbMultiplier;\n      }\n      if (d2.y < 0) {\n        aabb.lowerBound.y += d2.y * SettingsInternal.aabbMultiplier;\n      } else {\n        aabb.upperBound.y += d2.y * SettingsInternal.aabbMultiplier;\n      }\n      this.insertLeaf(node);\n      return true;\n    };\n    DynamicTree2.prototype.insertLeaf = function(leaf) {\n      if (this.m_root == null) {\n        this.m_root = leaf;\n        this.m_root.parent = null;\n        return;\n      }\n      var leafAABB = leaf.aabb;\n      var index = this.m_root;\n      while (!index.isLeaf()) {\n        var child1 = index.child1;\n        var child2 = index.child2;\n        var area = index.aabb.getPerimeter();\n        var combinedArea = AABB.combinedPerimeter(index.aabb, leafAABB);\n        var cost = 2 * combinedArea;\n        var inheritanceCost = 2 * (combinedArea - area);\n        var newArea1 = AABB.combinedPerimeter(leafAABB, child1.aabb);\n        var cost1 = newArea1 + inheritanceCost;\n        if (!child1.isLeaf()) {\n          var oldArea = child1.aabb.getPerimeter();\n          cost1 -= oldArea;\n        }\n        var newArea2 = AABB.combinedPerimeter(leafAABB, child2.aabb);\n        var cost2 = newArea2 + inheritanceCost;\n        if (!child2.isLeaf()) {\n          var oldArea = child2.aabb.getPerimeter();\n          cost2 -= oldArea;\n        }\n        if (cost < cost1 && cost < cost2) {\n          break;\n        }\n        if (cost1 < cost2) {\n          index = child1;\n        } else {\n          index = child2;\n        }\n      }\n      var sibling = index;\n      var oldParent = sibling.parent;\n      var newParent = this.allocateNode();\n      newParent.parent = oldParent;\n      newParent.userData = null;\n      newParent.aabb.combine(leafAABB, sibling.aabb);\n      newParent.height = sibling.height + 1;\n      if (oldParent != null) {\n        if (oldParent.child1 === sibling) {\n          oldParent.child1 = newParent;\n        } else {\n          oldParent.child2 = newParent;\n        }\n        newParent.child1 = sibling;\n        newParent.child2 = leaf;\n        sibling.parent = newParent;\n        leaf.parent = newParent;\n      } else {\n        newParent.child1 = sibling;\n        newParent.child2 = leaf;\n        sibling.parent = newParent;\n        leaf.parent = newParent;\n        this.m_root = newParent;\n      }\n      index = leaf.parent;\n      while (index != null) {\n        index = this.balance(index);\n        var child1 = index.child1;\n        var child2 = index.child2;\n        index.height = 1 + math_max$6(child1.height, child2.height);\n        index.aabb.combine(child1.aabb, child2.aabb);\n        index = index.parent;\n      }\n    };\n    DynamicTree2.prototype.removeLeaf = function(leaf) {\n      if (leaf === this.m_root) {\n        this.m_root = null;\n        return;\n      }\n      var parent = leaf.parent;\n      var grandParent = parent.parent;\n      var sibling;\n      if (parent.child1 === leaf) {\n        sibling = parent.child2;\n      } else {\n        sibling = parent.child1;\n      }\n      if (grandParent != null) {\n        if (grandParent.child1 === parent) {\n          grandParent.child1 = sibling;\n        } else {\n          grandParent.child2 = sibling;\n        }\n        sibling.parent = grandParent;\n        this.freeNode(parent);\n        var index = grandParent;\n        while (index != null) {\n          index = this.balance(index);\n          var child1 = index.child1;\n          var child2 = index.child2;\n          index.aabb.combine(child1.aabb, child2.aabb);\n          index.height = 1 + math_max$6(child1.height, child2.height);\n          index = index.parent;\n        }\n      } else {\n        this.m_root = sibling;\n        sibling.parent = null;\n        this.freeNode(parent);\n      }\n    };\n    DynamicTree2.prototype.balance = function(iA) {\n      var A = iA;\n      if (A.isLeaf() || A.height < 2) {\n        return iA;\n      }\n      var B = A.child1;\n      var C = A.child2;\n      var balance = C.height - B.height;\n      if (balance > 1) {\n        var F = C.child1;\n        var G = C.child2;\n        C.child1 = A;\n        C.parent = A.parent;\n        A.parent = C;\n        if (C.parent != null) {\n          if (C.parent.child1 === iA) {\n            C.parent.child1 = C;\n          } else {\n            C.parent.child2 = C;\n          }\n        } else {\n          this.m_root = C;\n        }\n        if (F.height > G.height) {\n          C.child2 = F;\n          A.child2 = G;\n          G.parent = A;\n          A.aabb.combine(B.aabb, G.aabb);\n          C.aabb.combine(A.aabb, F.aabb);\n          A.height = 1 + math_max$6(B.height, G.height);\n          C.height = 1 + math_max$6(A.height, F.height);\n        } else {\n          C.child2 = G;\n          A.child2 = F;\n          F.parent = A;\n          A.aabb.combine(B.aabb, F.aabb);\n          C.aabb.combine(A.aabb, G.aabb);\n          A.height = 1 + math_max$6(B.height, F.height);\n          C.height = 1 + math_max$6(A.height, G.height);\n        }\n        return C;\n      }\n      if (balance < -1) {\n        var D = B.child1;\n        var E = B.child2;\n        B.child1 = A;\n        B.parent = A.parent;\n        A.parent = B;\n        if (B.parent != null) {\n          if (B.parent.child1 === A) {\n            B.parent.child1 = B;\n          } else {\n            B.parent.child2 = B;\n          }\n        } else {\n          this.m_root = B;\n        }\n        if (D.height > E.height) {\n          B.child2 = D;\n          A.child1 = E;\n          E.parent = A;\n          A.aabb.combine(C.aabb, E.aabb);\n          B.aabb.combine(A.aabb, D.aabb);\n          A.height = 1 + math_max$6(C.height, E.height);\n          B.height = 1 + math_max$6(A.height, D.height);\n        } else {\n          B.child2 = E;\n          A.child1 = D;\n          D.parent = A;\n          A.aabb.combine(C.aabb, D.aabb);\n          B.aabb.combine(A.aabb, E.aabb);\n          A.height = 1 + math_max$6(C.height, D.height);\n          B.height = 1 + math_max$6(A.height, E.height);\n        }\n        return B;\n      }\n      return A;\n    };\n    DynamicTree2.prototype.getHeight = function() {\n      if (this.m_root == null) {\n        return 0;\n      }\n      return this.m_root.height;\n    };\n    DynamicTree2.prototype.getAreaRatio = function() {\n      if (this.m_root == null) {\n        return 0;\n      }\n      var root = this.m_root;\n      var rootArea = root.aabb.getPerimeter();\n      var totalArea = 0;\n      var node;\n      var it = this.iteratorPool.allocate().preorder(this.m_root);\n      while (node = it.next()) {\n        if (node.height < 0) {\n          continue;\n        }\n        totalArea += node.aabb.getPerimeter();\n      }\n      this.iteratorPool.release(it);\n      return totalArea / rootArea;\n    };\n    DynamicTree2.prototype.computeHeight = function(id) {\n      var node;\n      if (typeof id !== \"undefined\") {\n        node = this.m_nodes[id];\n      } else {\n        node = this.m_root;\n      }\n      if (node.isLeaf()) {\n        return 0;\n      }\n      var height1 = this.computeHeight(node.child1.id);\n      var height2 = this.computeHeight(node.child2.id);\n      return 1 + math_max$6(height1, height2);\n    };\n    DynamicTree2.prototype.validateStructure = function(node) {\n      if (node == null) {\n        return;\n      }\n      if (node === this.m_root) ;\n      var child1 = node.child1;\n      var child2 = node.child2;\n      if (node.isLeaf()) {\n        return;\n      }\n      this.validateStructure(child1);\n      this.validateStructure(child2);\n    };\n    DynamicTree2.prototype.validateMetrics = function(node) {\n      if (node == null) {\n        return;\n      }\n      var child1 = node.child1;\n      var child2 = node.child2;\n      if (node.isLeaf()) {\n        return;\n      }\n      this.validateMetrics(child1);\n      this.validateMetrics(child2);\n    };\n    DynamicTree2.prototype.validate = function() {\n      return;\n    };\n    DynamicTree2.prototype.getMaxBalance = function() {\n      var maxBalance = 0;\n      var node;\n      var it = this.iteratorPool.allocate().preorder(this.m_root);\n      while (node = it.next()) {\n        if (node.height <= 1) {\n          continue;\n        }\n        var balance = math_abs$8(node.child2.height - node.child1.height);\n        maxBalance = math_max$6(maxBalance, balance);\n      }\n      this.iteratorPool.release(it);\n      return maxBalance;\n    };\n    DynamicTree2.prototype.rebuildBottomUp = function() {\n      var nodes = [];\n      var count = 0;\n      var node;\n      var it = this.iteratorPool.allocate().preorder(this.m_root);\n      while (node = it.next()) {\n        if (node.height < 0) {\n          continue;\n        }\n        if (node.isLeaf()) {\n          node.parent = null;\n          nodes[count] = node;\n          ++count;\n        } else {\n          this.freeNode(node);\n        }\n      }\n      this.iteratorPool.release(it);\n      while (count > 1) {\n        var minCost = Infinity;\n        var iMin = -1;\n        var jMin = -1;\n        for (var i = 0; i < count; ++i) {\n          var aabbi = nodes[i].aabb;\n          for (var j = i + 1; j < count; ++j) {\n            var aabbj = nodes[j].aabb;\n            var cost = AABB.combinedPerimeter(aabbi, aabbj);\n            if (cost < minCost) {\n              iMin = i;\n              jMin = j;\n              minCost = cost;\n            }\n          }\n        }\n        var child1 = nodes[iMin];\n        var child2 = nodes[jMin];\n        var parent_1 = this.allocateNode();\n        parent_1.child1 = child1;\n        parent_1.child2 = child2;\n        parent_1.height = 1 + math_max$6(child1.height, child2.height);\n        parent_1.aabb.combine(child1.aabb, child2.aabb);\n        parent_1.parent = null;\n        child1.parent = parent_1;\n        child2.parent = parent_1;\n        nodes[jMin] = nodes[count - 1];\n        nodes[iMin] = parent_1;\n        --count;\n      }\n      this.m_root = nodes[0];\n    };\n    DynamicTree2.prototype.shiftOrigin = function(newOrigin) {\n      var node;\n      var it = this.iteratorPool.allocate().preorder(this.m_root);\n      while (node = it.next()) {\n        var aabb = node.aabb;\n        aabb.lowerBound.x -= newOrigin.x;\n        aabb.lowerBound.y -= newOrigin.y;\n        aabb.upperBound.x -= newOrigin.x;\n        aabb.upperBound.y -= newOrigin.y;\n      }\n      this.iteratorPool.release(it);\n    };\n    DynamicTree2.prototype.query = function(aabb, queryCallback) {\n      var stack = this.stackPool.allocate();\n      stack.push(this.m_root);\n      while (stack.length > 0) {\n        var node = stack.pop();\n        if (node == null) {\n          continue;\n        }\n        if (AABB.testOverlap(node.aabb, aabb)) {\n          if (node.isLeaf()) {\n            var proceed = queryCallback(node.id);\n            if (proceed === false) {\n              return;\n            }\n          } else {\n            stack.push(node.child1);\n            stack.push(node.child2);\n          }\n        }\n      }\n      this.stackPool.release(stack);\n    };\n    DynamicTree2.prototype.rayCast = function(input2, rayCastCallback) {\n      var p1 = input2.p1;\n      var p2 = input2.p2;\n      var r = Vec2.sub(p2, p1);\n      r.normalize();\n      var v3 = Vec2.crossNumVec2(1, r);\n      var abs_v = Vec2.abs(v3);\n      var maxFraction = input2.maxFraction;\n      var segmentAABB = new AABB();\n      var t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);\n      segmentAABB.combinePoints(p1, t);\n      var stack = this.stackPool.allocate();\n      var subInput = this.inputPool.allocate();\n      stack.push(this.m_root);\n      while (stack.length > 0) {\n        var node = stack.pop();\n        if (node == null) {\n          continue;\n        }\n        if (AABB.testOverlap(node.aabb, segmentAABB) === false) {\n          continue;\n        }\n        var c2 = node.aabb.getCenter();\n        var h = node.aabb.getExtents();\n        var separation = math_abs$8(Vec2.dot(v3, Vec2.sub(p1, c2))) - Vec2.dot(abs_v, h);\n        if (separation > 0) {\n          continue;\n        }\n        if (node.isLeaf()) {\n          subInput.p1 = Vec2.clone(input2.p1);\n          subInput.p2 = Vec2.clone(input2.p2);\n          subInput.maxFraction = maxFraction;\n          var value = rayCastCallback(subInput, node.id);\n          if (value === 0) {\n            break;\n          } else if (value > 0) {\n            maxFraction = value;\n            t = Vec2.combine(1 - maxFraction, p1, maxFraction, p2);\n            segmentAABB.combinePoints(p1, t);\n          }\n        } else {\n          stack.push(node.child1);\n          stack.push(node.child2);\n        }\n      }\n      this.stackPool.release(stack);\n      this.inputPool.release(subInput);\n    };\n    return DynamicTree2;\n  }()\n);\nvar Iterator = (\n  /** @class */\n  function() {\n    function Iterator2() {\n      this.parents = [];\n      this.states = [];\n    }\n    Iterator2.prototype.preorder = function(root) {\n      this.parents.length = 0;\n      this.parents.push(root);\n      this.states.length = 0;\n      this.states.push(0);\n      return this;\n    };\n    Iterator2.prototype.next = function() {\n      while (this.parents.length > 0) {\n        var i = this.parents.length - 1;\n        var node = this.parents[i];\n        if (this.states[i] === 0) {\n          this.states[i] = 1;\n          return node;\n        }\n        if (this.states[i] === 1) {\n          this.states[i] = 2;\n          if (node.child1) {\n            this.parents.push(node.child1);\n            this.states.push(1);\n            return node.child1;\n          }\n        }\n        if (this.states[i] === 2) {\n          this.states[i] = 3;\n          if (node.child2) {\n            this.parents.push(node.child2);\n            this.states.push(1);\n            return node.child2;\n          }\n        }\n        this.parents.pop();\n        this.states.pop();\n      }\n    };\n    Iterator2.prototype.close = function() {\n      this.parents.length = 0;\n    };\n    return Iterator2;\n  }()\n);\nvar math_max$5 = Math.max;\nvar math_min$6 = Math.min;\nvar BroadPhase = (\n  /** @class */\n  function() {\n    function BroadPhase2() {\n      var _this = this;\n      this.m_tree = new DynamicTree();\n      this.m_moveBuffer = [];\n      this.query = function(aabb, queryCallback) {\n        _this.m_tree.query(aabb, queryCallback);\n      };\n      this.queryCallback = function(proxyId) {\n        if (proxyId === _this.m_queryProxyId) {\n          return true;\n        }\n        var proxyIdA = math_min$6(proxyId, _this.m_queryProxyId);\n        var proxyIdB = math_max$5(proxyId, _this.m_queryProxyId);\n        var userDataA = _this.m_tree.getUserData(proxyIdA);\n        var userDataB = _this.m_tree.getUserData(proxyIdB);\n        _this.m_callback(userDataA, userDataB);\n        return true;\n      };\n    }\n    BroadPhase2.prototype.getUserData = function(proxyId) {\n      return this.m_tree.getUserData(proxyId);\n    };\n    BroadPhase2.prototype.testOverlap = function(proxyIdA, proxyIdB) {\n      var aabbA = this.m_tree.getFatAABB(proxyIdA);\n      var aabbB = this.m_tree.getFatAABB(proxyIdB);\n      return AABB.testOverlap(aabbA, aabbB);\n    };\n    BroadPhase2.prototype.getFatAABB = function(proxyId) {\n      return this.m_tree.getFatAABB(proxyId);\n    };\n    BroadPhase2.prototype.getProxyCount = function() {\n      return this.m_moveBuffer.length;\n    };\n    BroadPhase2.prototype.getTreeHeight = function() {\n      return this.m_tree.getHeight();\n    };\n    BroadPhase2.prototype.getTreeBalance = function() {\n      return this.m_tree.getMaxBalance();\n    };\n    BroadPhase2.prototype.getTreeQuality = function() {\n      return this.m_tree.getAreaRatio();\n    };\n    BroadPhase2.prototype.rayCast = function(input2, rayCastCallback) {\n      this.m_tree.rayCast(input2, rayCastCallback);\n    };\n    BroadPhase2.prototype.shiftOrigin = function(newOrigin) {\n      this.m_tree.shiftOrigin(newOrigin);\n    };\n    BroadPhase2.prototype.createProxy = function(aabb, userData) {\n      var proxyId = this.m_tree.createProxy(aabb, userData);\n      this.bufferMove(proxyId);\n      return proxyId;\n    };\n    BroadPhase2.prototype.destroyProxy = function(proxyId) {\n      this.unbufferMove(proxyId);\n      this.m_tree.destroyProxy(proxyId);\n    };\n    BroadPhase2.prototype.moveProxy = function(proxyId, aabb, displacement2) {\n      var changed = this.m_tree.moveProxy(proxyId, aabb, displacement2);\n      if (changed) {\n        this.bufferMove(proxyId);\n      }\n    };\n    BroadPhase2.prototype.touchProxy = function(proxyId) {\n      this.bufferMove(proxyId);\n    };\n    BroadPhase2.prototype.bufferMove = function(proxyId) {\n      this.m_moveBuffer.push(proxyId);\n    };\n    BroadPhase2.prototype.unbufferMove = function(proxyId) {\n      for (var i = 0; i < this.m_moveBuffer.length; ++i) {\n        if (this.m_moveBuffer[i] === proxyId) {\n          this.m_moveBuffer[i] = null;\n        }\n      }\n    };\n    BroadPhase2.prototype.updatePairs = function(addPairCallback) {\n      this.m_callback = addPairCallback;\n      while (this.m_moveBuffer.length > 0) {\n        this.m_queryProxyId = this.m_moveBuffer.pop();\n        if (this.m_queryProxyId === null) {\n          continue;\n        }\n        var fatAABB = this.m_tree.getFatAABB(this.m_queryProxyId);\n        this.m_tree.query(fatAABB, this.queryCallback);\n      }\n    };\n    return BroadPhase2;\n  }()\n);\nvar math_sin$2 = Math.sin;\nvar math_cos$2 = Math.cos;\nvar math_sqrt$4 = Math.sqrt;\nfunction vec2(x2, y) {\n  return { x: x2, y };\n}\nfunction rotation(angle) {\n  return { s: math_sin$2(angle), c: math_cos$2(angle) };\n}\nfunction setVec2(out, x2, y) {\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction copyVec2(out, w) {\n  out.x = w.x;\n  out.y = w.y;\n  return out;\n}\nfunction zeroVec2(out) {\n  out.x = 0;\n  out.y = 0;\n  return out;\n}\nfunction negVec2(out) {\n  out.x = -out.x;\n  out.y = -out.y;\n  return out;\n}\nfunction plusVec2(out, w) {\n  out.x += w.x;\n  out.y += w.y;\n  return out;\n}\nfunction addVec2(out, v3, w) {\n  out.x = v3.x + w.x;\n  out.y = v3.x + w.y;\n  return out;\n}\nfunction minusVec2(out, w) {\n  out.x -= w.x;\n  out.y -= w.y;\n  return out;\n}\nfunction subVec2(out, v3, w) {\n  out.x = v3.x - w.x;\n  out.y = v3.y - w.y;\n  return out;\n}\nfunction mulVec2(out, m) {\n  out.x *= m;\n  out.y *= m;\n  return out;\n}\nfunction scaleVec2(out, m, w) {\n  out.x = m * w.x;\n  out.y = m * w.y;\n  return out;\n}\nfunction plusScaleVec2(out, m, w) {\n  out.x += m * w.x;\n  out.y += m * w.y;\n  return out;\n}\nfunction minusScaleVec2(out, m, w) {\n  out.x -= m * w.x;\n  out.y -= m * w.y;\n  return out;\n}\nfunction combine2Vec2(out, am, a2, bm, b2) {\n  out.x = am * a2.x + bm * b2.x;\n  out.y = am * a2.y + bm * b2.y;\n  return out;\n}\nfunction combine3Vec2(out, am, a2, bm, b2, cm, c2) {\n  out.x = am * a2.x + bm * b2.x + cm * c2.x;\n  out.y = am * a2.y + bm * b2.y + cm * c2.y;\n  return out;\n}\nfunction normalizeVec2Length(out) {\n  var length = math_sqrt$4(out.x * out.x + out.y * out.y);\n  if (length !== 0) {\n    var invLength = 1 / length;\n    out.x *= invLength;\n    out.y *= invLength;\n  }\n  return length;\n}\nfunction normalizeVec2(out) {\n  var length = math_sqrt$4(out.x * out.x + out.y * out.y);\n  if (length > 0) {\n    var invLength = 1 / length;\n    out.x *= invLength;\n    out.y *= invLength;\n  }\n  return out;\n}\nfunction crossVec2Num(out, v3, w) {\n  var x2 = w * v3.y;\n  var y = -w * v3.x;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction crossNumVec2(out, w, v3) {\n  var x2 = -w * v3.y;\n  var y = w * v3.x;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction crossVec2Vec2(a2, b2) {\n  return a2.x * b2.y - a2.y * b2.x;\n}\nfunction dotVec2(a2, b2) {\n  return a2.x * b2.x + a2.y * b2.y;\n}\nfunction lengthSqrVec2(a2) {\n  return a2.x * a2.x + a2.y * a2.y;\n}\nfunction distVec2(a2, b2) {\n  var dx = a2.x - b2.x;\n  var dy = a2.y - b2.y;\n  return math_sqrt$4(dx * dx + dy * dy);\n}\nfunction distSqrVec2(a2, b2) {\n  var dx = a2.x - b2.x;\n  var dy = a2.y - b2.y;\n  return dx * dx + dy * dy;\n}\nfunction setRotAngle(out, a2) {\n  out.c = math_cos$2(a2);\n  out.s = math_sin$2(a2);\n  return out;\n}\nfunction rotVec2(out, q, v3) {\n  out.x = q.c * v3.x - q.s * v3.y;\n  out.y = q.s * v3.x + q.c * v3.y;\n  return out;\n}\nfunction derotVec2(out, q, v3) {\n  var x2 = q.c * v3.x + q.s * v3.y;\n  var y = -q.s * v3.x + q.c * v3.y;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction rerotVec2(out, before, after, v3) {\n  var x0 = before.c * v3.x + before.s * v3.y;\n  var y0 = -before.s * v3.x + before.c * v3.y;\n  var x2 = after.c * x0 - after.s * y0;\n  var y = after.s * x0 + after.c * y0;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction transform(x2, y, a2) {\n  return { p: vec2(x2, y), q: rotation(a2) };\n}\nfunction copyTransform(out, transform2) {\n  out.p.x = transform2.p.x;\n  out.p.y = transform2.p.y;\n  out.q.s = transform2.q.s;\n  out.q.c = transform2.q.c;\n  return out;\n}\nfunction transformVec2(out, xf2, v3) {\n  var x2 = xf2.q.c * v3.x - xf2.q.s * v3.y + xf2.p.x;\n  var y = xf2.q.s * v3.x + xf2.q.c * v3.y + xf2.p.y;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction detransformVec2(out, xf2, v3) {\n  var px = v3.x - xf2.p.x;\n  var py = v3.y - xf2.p.y;\n  var x2 = xf2.q.c * px + xf2.q.s * py;\n  var y = -xf2.q.s * px + xf2.q.c * py;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction retransformVec2(out, from, to, v3) {\n  var x0 = from.q.c * v3.x - from.q.s * v3.y + from.p.x;\n  var y0 = from.q.s * v3.x + from.q.c * v3.y + from.p.y;\n  var px = x0 - to.p.x;\n  var py = y0 - to.p.y;\n  var x2 = to.q.c * px + to.q.s * py;\n  var y = -to.q.s * px + to.q.c * py;\n  out.x = x2;\n  out.y = y;\n  return out;\n}\nfunction detransformTransform(out, a2, b2) {\n  var c2 = a2.q.c * b2.q.c + a2.q.s * b2.q.s;\n  var s2 = a2.q.c * b2.q.s - a2.q.s * b2.q.c;\n  var x2 = a2.q.c * (b2.p.x - a2.p.x) + a2.q.s * (b2.p.y - a2.p.y);\n  var y = -a2.q.s * (b2.p.x - a2.p.x) + a2.q.c * (b2.p.y - a2.p.y);\n  out.q.c = c2;\n  out.q.s = s2;\n  out.p.x = x2;\n  out.p.y = y;\n  return out;\n}\nvar math_sin$1 = Math.sin;\nvar math_cos$1 = Math.cos;\nvar math_atan2$1 = Math.atan2;\nvar Rot = (\n  /** @class */\n  function() {\n    function Rot2(angle) {\n      if (!(this instanceof Rot2)) {\n        return new Rot2(angle);\n      }\n      if (typeof angle === \"number\") {\n        this.setAngle(angle);\n      } else if (typeof angle === \"object\") {\n        this.setRot(angle);\n      } else {\n        this.setIdentity();\n      }\n    }\n    Rot2.neo = function(angle) {\n      var obj = Object.create(Rot2.prototype);\n      obj.setAngle(angle);\n      return obj;\n    };\n    Rot2.clone = function(rot) {\n      var obj = Object.create(Rot2.prototype);\n      obj.s = rot.s;\n      obj.c = rot.c;\n      return obj;\n    };\n    Rot2.identity = function() {\n      var obj = Object.create(Rot2.prototype);\n      obj.s = 0;\n      obj.c = 1;\n      return obj;\n    };\n    Rot2.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Number.isFinite(obj.s) && Number.isFinite(obj.c);\n    };\n    Rot2.assert = function(o) {\n    };\n    Rot2.prototype.setIdentity = function() {\n      this.s = 0;\n      this.c = 1;\n    };\n    Rot2.prototype.set = function(angle) {\n      if (typeof angle === \"object\") {\n        this.s = angle.s;\n        this.c = angle.c;\n      } else {\n        this.s = math_sin$1(angle);\n        this.c = math_cos$1(angle);\n      }\n    };\n    Rot2.prototype.setRot = function(angle) {\n      this.s = angle.s;\n      this.c = angle.c;\n    };\n    Rot2.prototype.setAngle = function(angle) {\n      this.s = math_sin$1(angle);\n      this.c = math_cos$1(angle);\n    };\n    Rot2.prototype.getAngle = function() {\n      return math_atan2$1(this.s, this.c);\n    };\n    Rot2.prototype.getXAxis = function() {\n      return Vec2.neo(this.c, this.s);\n    };\n    Rot2.prototype.getYAxis = function() {\n      return Vec2.neo(-this.s, this.c);\n    };\n    Rot2.mul = function(rot, m) {\n      if (\"c\" in m && \"s\" in m) {\n        var qr = Rot2.identity();\n        qr.s = rot.s * m.c + rot.c * m.s;\n        qr.c = rot.c * m.c - rot.s * m.s;\n        return qr;\n      } else if (\"x\" in m && \"y\" in m) {\n        return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);\n      }\n    };\n    Rot2.mulRot = function(rot, m) {\n      var qr = Rot2.identity();\n      qr.s = rot.s * m.c + rot.c * m.s;\n      qr.c = rot.c * m.c - rot.s * m.s;\n      return qr;\n    };\n    Rot2.mulVec2 = function(rot, m) {\n      return Vec2.neo(rot.c * m.x - rot.s * m.y, rot.s * m.x + rot.c * m.y);\n    };\n    Rot2.mulSub = function(rot, v3, w) {\n      var x2 = rot.c * (v3.x - w.x) - rot.s * (v3.y - w.y);\n      var y = rot.s * (v3.x - w.x) + rot.c * (v3.y - w.y);\n      return Vec2.neo(x2, y);\n    };\n    Rot2.mulT = function(rot, m) {\n      if (\"c\" in m && \"s\" in m) {\n        var qr = Rot2.identity();\n        qr.s = rot.c * m.s - rot.s * m.c;\n        qr.c = rot.c * m.c + rot.s * m.s;\n        return qr;\n      } else if (\"x\" in m && \"y\" in m) {\n        return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);\n      }\n    };\n    Rot2.mulTRot = function(rot, m) {\n      var qr = Rot2.identity();\n      qr.s = rot.c * m.s - rot.s * m.c;\n      qr.c = rot.c * m.c + rot.s * m.s;\n      return qr;\n    };\n    Rot2.mulTVec2 = function(rot, m) {\n      return Vec2.neo(rot.c * m.x + rot.s * m.y, -rot.s * m.x + rot.c * m.y);\n    };\n    return Rot2;\n  }()\n);\nvar math_atan2 = Math.atan2;\nvar math_PI$5 = Math.PI;\nvar temp$7 = vec2(0, 0);\nvar Sweep = (\n  /** @class */\n  function() {\n    function Sweep2() {\n      this.localCenter = Vec2.zero();\n      this.c = Vec2.zero();\n      this.a = 0;\n      this.alpha0 = 0;\n      this.c0 = Vec2.zero();\n      this.a0 = 0;\n    }\n    Sweep2.prototype.recycle = function() {\n      zeroVec2(this.localCenter);\n      zeroVec2(this.c);\n      this.a = 0;\n      this.alpha0 = 0;\n      zeroVec2(this.c0);\n      this.a0 = 0;\n    };\n    Sweep2.prototype.setTransform = function(xf2) {\n      transformVec2(temp$7, xf2, this.localCenter);\n      copyVec2(this.c, temp$7);\n      copyVec2(this.c0, temp$7);\n      this.a = this.a0 = math_atan2(xf2.q.s, xf2.q.c);\n    };\n    Sweep2.prototype.setLocalCenter = function(localCenter2, xf2) {\n      copyVec2(this.localCenter, localCenter2);\n      transformVec2(temp$7, xf2, this.localCenter);\n      copyVec2(this.c, temp$7);\n      copyVec2(this.c0, temp$7);\n    };\n    Sweep2.prototype.getTransform = function(xf2, beta) {\n      if (beta === void 0) {\n        beta = 0;\n      }\n      setRotAngle(xf2.q, (1 - beta) * this.a0 + beta * this.a);\n      combine2Vec2(xf2.p, 1 - beta, this.c0, beta, this.c);\n      minusVec2(xf2.p, rotVec2(temp$7, xf2.q, this.localCenter));\n    };\n    Sweep2.prototype.advance = function(alpha) {\n      var beta = (alpha - this.alpha0) / (1 - this.alpha0);\n      combine2Vec2(this.c0, beta, this.c, 1 - beta, this.c0);\n      this.a0 = beta * this.a + (1 - beta) * this.a0;\n      this.alpha0 = alpha;\n    };\n    Sweep2.prototype.forward = function() {\n      this.a0 = this.a;\n      copyVec2(this.c0, this.c);\n    };\n    Sweep2.prototype.normalize = function() {\n      var a0 = mod(this.a0, -math_PI$5, +math_PI$5);\n      this.a -= this.a0 - a0;\n      this.a0 = a0;\n    };\n    Sweep2.prototype.set = function(that) {\n      copyVec2(this.localCenter, that.localCenter);\n      copyVec2(this.c, that.c);\n      this.a = that.a;\n      this.alpha0 = that.alpha0;\n      copyVec2(this.c0, that.c0);\n      this.a0 = that.a0;\n    };\n    return Sweep2;\n  }()\n);\nvar Transform = (\n  /** @class */\n  function() {\n    function Transform2(position, rotation2) {\n      if (!(this instanceof Transform2)) {\n        return new Transform2(position, rotation2);\n      }\n      this.p = Vec2.zero();\n      this.q = Rot.identity();\n      if (typeof position !== \"undefined\") {\n        this.p.setVec2(position);\n      }\n      if (typeof rotation2 !== \"undefined\") {\n        this.q.setAngle(rotation2);\n      }\n    }\n    Transform2.clone = function(xf2) {\n      var obj = Object.create(Transform2.prototype);\n      obj.p = Vec2.clone(xf2.p);\n      obj.q = Rot.clone(xf2.q);\n      return obj;\n    };\n    Transform2.neo = function(position, rotation2) {\n      var obj = Object.create(Transform2.prototype);\n      obj.p = Vec2.clone(position);\n      obj.q = Rot.clone(rotation2);\n      return obj;\n    };\n    Transform2.identity = function() {\n      var obj = Object.create(Transform2.prototype);\n      obj.p = Vec2.zero();\n      obj.q = Rot.identity();\n      return obj;\n    };\n    Transform2.prototype.setIdentity = function() {\n      this.p.setZero();\n      this.q.setIdentity();\n    };\n    Transform2.prototype.set = function(a2, b2) {\n      if (typeof b2 === \"undefined\") {\n        this.p.set(a2.p);\n        this.q.set(a2.q);\n      } else {\n        this.p.set(a2);\n        this.q.set(b2);\n      }\n    };\n    Transform2.prototype.setNum = function(position, rotation2) {\n      this.p.setVec2(position);\n      this.q.setAngle(rotation2);\n    };\n    Transform2.prototype.setTransform = function(xf2) {\n      this.p.setVec2(xf2.p);\n      this.q.setRot(xf2.q);\n    };\n    Transform2.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Vec2.isValid(obj.p) && Rot.isValid(obj.q);\n    };\n    Transform2.assert = function(o) {\n    };\n    Transform2.mul = function(a2, b2) {\n      if (Array.isArray(b2)) {\n        var arr = [];\n        for (var i = 0; i < b2.length; i++) {\n          arr[i] = Transform2.mul(a2, b2[i]);\n        }\n        return arr;\n      } else if (\"x\" in b2 && \"y\" in b2) {\n        return Transform2.mulVec2(a2, b2);\n      } else if (\"p\" in b2 && \"q\" in b2) {\n        return Transform2.mulXf(a2, b2);\n      }\n    };\n    Transform2.mulAll = function(a2, b2) {\n      var arr = [];\n      for (var i = 0; i < b2.length; i++) {\n        arr[i] = Transform2.mul(a2, b2[i]);\n      }\n      return arr;\n    };\n    Transform2.mulFn = function(a2) {\n      return function(b2) {\n        return Transform2.mul(a2, b2);\n      };\n    };\n    Transform2.mulVec2 = function(a2, b2) {\n      var x2 = a2.q.c * b2.x - a2.q.s * b2.y + a2.p.x;\n      var y = a2.q.s * b2.x + a2.q.c * b2.y + a2.p.y;\n      return Vec2.neo(x2, y);\n    };\n    Transform2.mulXf = function(a2, b2) {\n      var xf2 = Transform2.identity();\n      xf2.q = Rot.mulRot(a2.q, b2.q);\n      xf2.p = Vec2.add(Rot.mulVec2(a2.q, b2.p), a2.p);\n      return xf2;\n    };\n    Transform2.mulT = function(a2, b2) {\n      if (\"x\" in b2 && \"y\" in b2) {\n        return Transform2.mulTVec2(a2, b2);\n      } else if (\"p\" in b2 && \"q\" in b2) {\n        return Transform2.mulTXf(a2, b2);\n      }\n    };\n    Transform2.mulTVec2 = function(a2, b2) {\n      var px = b2.x - a2.p.x;\n      var py = b2.y - a2.p.y;\n      var x2 = a2.q.c * px + a2.q.s * py;\n      var y = -a2.q.s * px + a2.q.c * py;\n      return Vec2.neo(x2, y);\n    };\n    Transform2.mulTXf = function(a2, b2) {\n      var xf2 = Transform2.identity();\n      xf2.q.setRot(Rot.mulTRot(a2.q, b2.q));\n      xf2.p.setVec2(Rot.mulTVec2(a2.q, Vec2.sub(b2.p, a2.p)));\n      return xf2;\n    };\n    return Transform2;\n  }()\n);\nvar Velocity = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function Velocity2() {\n      this.v = Vec2.zero();\n      this.w = 0;\n    }\n    return Velocity2;\n  }()\n);\nvar math_sin = Math.sin;\nvar math_cos = Math.cos;\nvar Position = (\n  /** @class */\n  function() {\n    function Position2() {\n      this.c = Vec2.zero();\n      this.a = 0;\n    }\n    Position2.prototype.getTransform = function(xf2, p) {\n      xf2.q.c = math_cos(this.a);\n      xf2.q.s = math_sin(this.a);\n      xf2.p.x = this.c.x - (xf2.q.c * p.x - xf2.q.s * p.y);\n      xf2.p.y = this.c.y - (xf2.q.s * p.x + xf2.q.c * p.y);\n      return xf2;\n    };\n    return Position2;\n  }()\n);\nfunction getTransform(xf2, p, c2, a2) {\n  xf2.q.c = math_cos(a2);\n  xf2.q.s = math_sin(a2);\n  xf2.p.x = c2.x - (xf2.q.c * p.x - xf2.q.s * p.y);\n  xf2.p.y = c2.y - (xf2.q.s * p.x + xf2.q.c * p.y);\n  return xf2;\n}\nvar Shape = (\n  /** @class */\n  function() {\n    function Shape2() {\n      this.style = {};\n      this.appData = {};\n    }\n    Shape2.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return typeof obj.m_type === \"string\" && typeof obj.m_radius === \"number\";\n    };\n    return Shape2;\n  }()\n);\nvar synchronize_aabb1 = new AABB();\nvar synchronize_aabb2 = new AABB();\nvar displacement = vec2(0, 0);\nvar FixtureDefDefault = {\n  userData: null,\n  friction: 0.2,\n  restitution: 0,\n  density: 0,\n  isSensor: false,\n  filterGroupIndex: 0,\n  filterCategoryBits: 1,\n  filterMaskBits: 65535\n};\nvar FixtureProxy = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function FixtureProxy2(fixture, childIndex) {\n      this.aabb = new AABB();\n      this.fixture = fixture;\n      this.childIndex = childIndex;\n    }\n    return FixtureProxy2;\n  }()\n);\nvar Fixture = (\n  /** @class */\n  function() {\n    function Fixture2(body, shape, def) {\n      this.style = {};\n      this.appData = {};\n      if (shape.shape) {\n        def = shape;\n        shape = shape.shape;\n      } else if (typeof def === \"number\") {\n        def = { density: def };\n      }\n      def = options(def, FixtureDefDefault);\n      this.m_body = body;\n      this.m_friction = def.friction;\n      this.m_restitution = def.restitution;\n      this.m_density = def.density;\n      this.m_isSensor = def.isSensor;\n      this.m_filterGroupIndex = def.filterGroupIndex;\n      this.m_filterCategoryBits = def.filterCategoryBits;\n      this.m_filterMaskBits = def.filterMaskBits;\n      this.m_shape = shape;\n      this.m_next = null;\n      this.m_proxies = [];\n      this.m_proxyCount = 0;\n      var childCount = this.m_shape.getChildCount();\n      for (var i = 0; i < childCount; ++i) {\n        this.m_proxies[i] = new FixtureProxy(this, i);\n      }\n      this.m_userData = def.userData;\n      if (typeof def.style === \"object\" && def.style !== null) {\n        this.style = def.style;\n      }\n    }\n    Fixture2.prototype._reset = function() {\n      var body = this.getBody();\n      var broadPhase = body.m_world.m_broadPhase;\n      this.destroyProxies(broadPhase);\n      if (this.m_shape._reset) {\n        this.m_shape._reset();\n      }\n      var childCount = this.m_shape.getChildCount();\n      for (var i = 0; i < childCount; ++i) {\n        this.m_proxies[i] = new FixtureProxy(this, i);\n      }\n      this.createProxies(broadPhase, body.m_xf);\n      body.resetMassData();\n    };\n    Fixture2.prototype._serialize = function() {\n      return {\n        friction: this.m_friction,\n        restitution: this.m_restitution,\n        density: this.m_density,\n        isSensor: this.m_isSensor,\n        filterGroupIndex: this.m_filterGroupIndex,\n        filterCategoryBits: this.m_filterCategoryBits,\n        filterMaskBits: this.m_filterMaskBits,\n        shape: this.m_shape\n      };\n    };\n    Fixture2._deserialize = function(data, body, restore) {\n      var shape = restore(Shape, data.shape);\n      var fixture = shape && new Fixture2(body, shape, data);\n      return fixture;\n    };\n    Fixture2.prototype.getType = function() {\n      return this.m_shape.m_type;\n    };\n    Fixture2.prototype.getShape = function() {\n      return this.m_shape;\n    };\n    Fixture2.prototype.isSensor = function() {\n      return this.m_isSensor;\n    };\n    Fixture2.prototype.setSensor = function(sensor) {\n      if (sensor != this.m_isSensor) {\n        this.m_body.setAwake(true);\n        this.m_isSensor = sensor;\n      }\n    };\n    Fixture2.prototype.getUserData = function() {\n      return this.m_userData;\n    };\n    Fixture2.prototype.setUserData = function(data) {\n      this.m_userData = data;\n    };\n    Fixture2.prototype.getBody = function() {\n      return this.m_body;\n    };\n    Fixture2.prototype.getNext = function() {\n      return this.m_next;\n    };\n    Fixture2.prototype.getDensity = function() {\n      return this.m_density;\n    };\n    Fixture2.prototype.setDensity = function(density) {\n      this.m_density = density;\n    };\n    Fixture2.prototype.getFriction = function() {\n      return this.m_friction;\n    };\n    Fixture2.prototype.setFriction = function(friction) {\n      this.m_friction = friction;\n    };\n    Fixture2.prototype.getRestitution = function() {\n      return this.m_restitution;\n    };\n    Fixture2.prototype.setRestitution = function(restitution) {\n      this.m_restitution = restitution;\n    };\n    Fixture2.prototype.testPoint = function(p) {\n      return this.m_shape.testPoint(this.m_body.getTransform(), p);\n    };\n    Fixture2.prototype.rayCast = function(output2, input2, childIndex) {\n      return this.m_shape.rayCast(output2, input2, this.m_body.getTransform(), childIndex);\n    };\n    Fixture2.prototype.getMassData = function(massData) {\n      this.m_shape.computeMass(massData, this.m_density);\n    };\n    Fixture2.prototype.getAABB = function(childIndex) {\n      return this.m_proxies[childIndex].aabb;\n    };\n    Fixture2.prototype.createProxies = function(broadPhase, xf2) {\n      this.m_proxyCount = this.m_shape.getChildCount();\n      for (var i = 0; i < this.m_proxyCount; ++i) {\n        var proxy = this.m_proxies[i];\n        this.m_shape.computeAABB(proxy.aabb, xf2, i);\n        proxy.proxyId = broadPhase.createProxy(proxy.aabb, proxy);\n      }\n    };\n    Fixture2.prototype.destroyProxies = function(broadPhase) {\n      for (var i = 0; i < this.m_proxyCount; ++i) {\n        var proxy = this.m_proxies[i];\n        broadPhase.destroyProxy(proxy.proxyId);\n        proxy.proxyId = null;\n      }\n      this.m_proxyCount = 0;\n    };\n    Fixture2.prototype.synchronize = function(broadPhase, xf1, xf2) {\n      for (var i = 0; i < this.m_proxyCount; ++i) {\n        var proxy = this.m_proxies[i];\n        this.m_shape.computeAABB(synchronize_aabb1, xf1, proxy.childIndex);\n        this.m_shape.computeAABB(synchronize_aabb2, xf2, proxy.childIndex);\n        proxy.aabb.combine(synchronize_aabb1, synchronize_aabb2);\n        subVec2(displacement, xf2.p, xf1.p);\n        broadPhase.moveProxy(proxy.proxyId, proxy.aabb, displacement);\n      }\n    };\n    Fixture2.prototype.setFilterData = function(filter) {\n      this.m_filterGroupIndex = filter.groupIndex;\n      this.m_filterCategoryBits = filter.categoryBits;\n      this.m_filterMaskBits = filter.maskBits;\n      this.refilter();\n    };\n    Fixture2.prototype.getFilterGroupIndex = function() {\n      return this.m_filterGroupIndex;\n    };\n    Fixture2.prototype.setFilterGroupIndex = function(groupIndex) {\n      this.m_filterGroupIndex = groupIndex;\n      this.refilter();\n    };\n    Fixture2.prototype.getFilterCategoryBits = function() {\n      return this.m_filterCategoryBits;\n    };\n    Fixture2.prototype.setFilterCategoryBits = function(categoryBits) {\n      this.m_filterCategoryBits = categoryBits;\n      this.refilter();\n    };\n    Fixture2.prototype.getFilterMaskBits = function() {\n      return this.m_filterMaskBits;\n    };\n    Fixture2.prototype.setFilterMaskBits = function(maskBits) {\n      this.m_filterMaskBits = maskBits;\n      this.refilter();\n    };\n    Fixture2.prototype.refilter = function() {\n      if (this.m_body == null) {\n        return;\n      }\n      var edge = this.m_body.getContactList();\n      while (edge) {\n        var contact = edge.contact;\n        var fixtureA = contact.getFixtureA();\n        var fixtureB = contact.getFixtureB();\n        if (fixtureA == this || fixtureB == this) {\n          contact.flagForFiltering();\n        }\n        edge = edge.next;\n      }\n      var world = this.m_body.getWorld();\n      if (world == null) {\n        return;\n      }\n      var broadPhase = world.m_broadPhase;\n      for (var i = 0; i < this.m_proxyCount; ++i) {\n        broadPhase.touchProxy(this.m_proxies[i].proxyId);\n      }\n    };\n    Fixture2.prototype.shouldCollide = function(that) {\n      if (that.m_filterGroupIndex === this.m_filterGroupIndex && that.m_filterGroupIndex !== 0) {\n        return that.m_filterGroupIndex > 0;\n      }\n      var collideA = (that.m_filterMaskBits & this.m_filterCategoryBits) !== 0;\n      var collideB = (that.m_filterCategoryBits & this.m_filterMaskBits) !== 0;\n      var collide = collideA && collideB;\n      return collide;\n    };\n    return Fixture2;\n  }()\n);\nvar STATIC = \"static\";\nvar KINEMATIC = \"kinematic\";\nvar DYNAMIC = \"dynamic\";\nvar oldCenter = vec2(0, 0);\nvar localCenter = vec2(0, 0);\nvar shift = vec2(0, 0);\nvar temp$6 = vec2(0, 0);\nvar xf$2 = transform(0, 0, 0);\nvar BodyDefDefault = {\n  type: STATIC,\n  position: Vec2.zero(),\n  angle: 0,\n  linearVelocity: Vec2.zero(),\n  angularVelocity: 0,\n  linearDamping: 0,\n  angularDamping: 0,\n  fixedRotation: false,\n  bullet: false,\n  gravityScale: 1,\n  allowSleep: true,\n  awake: true,\n  active: true,\n  userData: null\n};\nvar Body = (\n  /** @class */\n  function() {\n    function Body2(world, def) {\n      this.style = {};\n      this.appData = {};\n      def = options(def, BodyDefDefault);\n      this.m_world = world;\n      this.m_awakeFlag = def.awake;\n      this.m_autoSleepFlag = def.allowSleep;\n      this.m_bulletFlag = def.bullet;\n      this.m_fixedRotationFlag = def.fixedRotation;\n      this.m_activeFlag = def.active;\n      this.m_islandFlag = false;\n      this.m_toiFlag = false;\n      this.m_userData = def.userData;\n      this.m_type = def.type;\n      if (this.m_type == DYNAMIC) {\n        this.m_mass = 1;\n        this.m_invMass = 1;\n      } else {\n        this.m_mass = 0;\n        this.m_invMass = 0;\n      }\n      this.m_I = 0;\n      this.m_invI = 0;\n      this.m_xf = Transform.identity();\n      this.m_xf.p.setVec2(def.position);\n      this.m_xf.q.setAngle(def.angle);\n      this.m_sweep = new Sweep();\n      this.m_sweep.setTransform(this.m_xf);\n      this.c_velocity = new Velocity();\n      this.c_position = new Position();\n      this.m_force = Vec2.zero();\n      this.m_torque = 0;\n      this.m_linearVelocity = Vec2.clone(def.linearVelocity);\n      this.m_angularVelocity = def.angularVelocity;\n      this.m_linearDamping = def.linearDamping;\n      this.m_angularDamping = def.angularDamping;\n      this.m_gravityScale = def.gravityScale;\n      this.m_sleepTime = 0;\n      this.m_jointList = null;\n      this.m_contactList = null;\n      this.m_fixtureList = null;\n      this.m_prev = null;\n      this.m_next = null;\n      this.m_destroyed = false;\n      if (typeof def.style === \"object\" && def.style !== null) {\n        this.style = def.style;\n      }\n    }\n    Body2.prototype._serialize = function() {\n      var fixtures = [];\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        fixtures.push(f);\n      }\n      return {\n        type: this.m_type,\n        bullet: this.m_bulletFlag,\n        position: this.m_xf.p,\n        angle: this.m_xf.q.getAngle(),\n        linearVelocity: this.m_linearVelocity,\n        angularVelocity: this.m_angularVelocity,\n        fixtures\n      };\n    };\n    Body2._deserialize = function(data, world, restore) {\n      var body = new Body2(world, data);\n      if (data.fixtures) {\n        for (var i = data.fixtures.length - 1; i >= 0; i--) {\n          var fixture = restore(Fixture, data.fixtures[i], body);\n          body._addFixture(fixture);\n        }\n      }\n      return body;\n    };\n    Body2.prototype.isWorldLocked = function() {\n      return this.m_world && this.m_world.isLocked() ? true : false;\n    };\n    Body2.prototype.getWorld = function() {\n      return this.m_world;\n    };\n    Body2.prototype.getNext = function() {\n      return this.m_next;\n    };\n    Body2.prototype.setUserData = function(data) {\n      this.m_userData = data;\n    };\n    Body2.prototype.getUserData = function() {\n      return this.m_userData;\n    };\n    Body2.prototype.getFixtureList = function() {\n      return this.m_fixtureList;\n    };\n    Body2.prototype.getJointList = function() {\n      return this.m_jointList;\n    };\n    Body2.prototype.getContactList = function() {\n      return this.m_contactList;\n    };\n    Body2.prototype.isStatic = function() {\n      return this.m_type == STATIC;\n    };\n    Body2.prototype.isDynamic = function() {\n      return this.m_type == DYNAMIC;\n    };\n    Body2.prototype.isKinematic = function() {\n      return this.m_type == KINEMATIC;\n    };\n    Body2.prototype.setStatic = function() {\n      this.setType(STATIC);\n      return this;\n    };\n    Body2.prototype.setDynamic = function() {\n      this.setType(DYNAMIC);\n      return this;\n    };\n    Body2.prototype.setKinematic = function() {\n      this.setType(KINEMATIC);\n      return this;\n    };\n    Body2.prototype.getType = function() {\n      return this.m_type;\n    };\n    Body2.prototype.setType = function(type) {\n      if (this.isWorldLocked() == true) {\n        return;\n      }\n      if (this.m_type == type) {\n        return;\n      }\n      this.m_type = type;\n      this.resetMassData();\n      if (this.m_type == STATIC) {\n        this.m_linearVelocity.setZero();\n        this.m_angularVelocity = 0;\n        this.m_sweep.forward();\n        this.synchronizeFixtures();\n      }\n      this.setAwake(true);\n      this.m_force.setZero();\n      this.m_torque = 0;\n      var ce = this.m_contactList;\n      while (ce) {\n        var ce0 = ce;\n        ce = ce.next;\n        this.m_world.destroyContact(ce0.contact);\n      }\n      this.m_contactList = null;\n      var broadPhase = this.m_world.m_broadPhase;\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        for (var i = 0; i < f.m_proxyCount; ++i) {\n          broadPhase.touchProxy(f.m_proxies[i].proxyId);\n        }\n      }\n    };\n    Body2.prototype.isBullet = function() {\n      return this.m_bulletFlag;\n    };\n    Body2.prototype.setBullet = function(flag) {\n      this.m_bulletFlag = !!flag;\n    };\n    Body2.prototype.isSleepingAllowed = function() {\n      return this.m_autoSleepFlag;\n    };\n    Body2.prototype.setSleepingAllowed = function(flag) {\n      this.m_autoSleepFlag = !!flag;\n      if (this.m_autoSleepFlag == false) {\n        this.setAwake(true);\n      }\n    };\n    Body2.prototype.isAwake = function() {\n      return this.m_awakeFlag;\n    };\n    Body2.prototype.setAwake = function(flag) {\n      if (flag) {\n        this.m_awakeFlag = true;\n        this.m_sleepTime = 0;\n      } else {\n        this.m_awakeFlag = false;\n        this.m_sleepTime = 0;\n        this.m_linearVelocity.setZero();\n        this.m_angularVelocity = 0;\n        this.m_force.setZero();\n        this.m_torque = 0;\n      }\n    };\n    Body2.prototype.isActive = function() {\n      return this.m_activeFlag;\n    };\n    Body2.prototype.setActive = function(flag) {\n      if (flag == this.m_activeFlag) {\n        return;\n      }\n      this.m_activeFlag = !!flag;\n      if (this.m_activeFlag) {\n        var broadPhase = this.m_world.m_broadPhase;\n        for (var f = this.m_fixtureList; f; f = f.m_next) {\n          f.createProxies(broadPhase, this.m_xf);\n        }\n        this.m_world.m_newFixture = true;\n      } else {\n        var broadPhase = this.m_world.m_broadPhase;\n        for (var f = this.m_fixtureList; f; f = f.m_next) {\n          f.destroyProxies(broadPhase);\n        }\n        var ce = this.m_contactList;\n        while (ce) {\n          var ce0 = ce;\n          ce = ce.next;\n          this.m_world.destroyContact(ce0.contact);\n        }\n        this.m_contactList = null;\n      }\n    };\n    Body2.prototype.isFixedRotation = function() {\n      return this.m_fixedRotationFlag;\n    };\n    Body2.prototype.setFixedRotation = function(flag) {\n      if (this.m_fixedRotationFlag == flag) {\n        return;\n      }\n      this.m_fixedRotationFlag = !!flag;\n      this.m_angularVelocity = 0;\n      this.resetMassData();\n    };\n    Body2.prototype.getTransform = function() {\n      return this.m_xf;\n    };\n    Body2.prototype.setTransform = function(a2, b2) {\n      if (this.isWorldLocked() == true) {\n        return;\n      }\n      if (typeof b2 === \"number\") {\n        this.m_xf.setNum(a2, b2);\n      } else {\n        this.m_xf.setTransform(a2);\n      }\n      this.m_sweep.setTransform(this.m_xf);\n      var broadPhase = this.m_world.m_broadPhase;\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        f.synchronize(broadPhase, this.m_xf, this.m_xf);\n      }\n      this.setAwake(true);\n    };\n    Body2.prototype.synchronizeTransform = function() {\n      this.m_sweep.getTransform(this.m_xf, 1);\n    };\n    Body2.prototype.synchronizeFixtures = function() {\n      this.m_sweep.getTransform(xf$2, 0);\n      var broadPhase = this.m_world.m_broadPhase;\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        f.synchronize(broadPhase, xf$2, this.m_xf);\n      }\n    };\n    Body2.prototype.advance = function(alpha) {\n      this.m_sweep.advance(alpha);\n      copyVec2(this.m_sweep.c, this.m_sweep.c0);\n      this.m_sweep.a = this.m_sweep.a0;\n      this.m_sweep.getTransform(this.m_xf, 1);\n    };\n    Body2.prototype.getPosition = function() {\n      return this.m_xf.p;\n    };\n    Body2.prototype.setPosition = function(p) {\n      this.setTransform(p, this.m_sweep.a);\n    };\n    Body2.prototype.getAngle = function() {\n      return this.m_sweep.a;\n    };\n    Body2.prototype.setAngle = function(angle) {\n      this.setTransform(this.m_xf.p, angle);\n    };\n    Body2.prototype.getWorldCenter = function() {\n      return this.m_sweep.c;\n    };\n    Body2.prototype.getLocalCenter = function() {\n      return this.m_sweep.localCenter;\n    };\n    Body2.prototype.getLinearVelocity = function() {\n      return this.m_linearVelocity;\n    };\n    Body2.prototype.getLinearVelocityFromWorldPoint = function(worldPoint) {\n      var localCenter2 = Vec2.sub(worldPoint, this.m_sweep.c);\n      return Vec2.add(this.m_linearVelocity, Vec2.crossNumVec2(this.m_angularVelocity, localCenter2));\n    };\n    Body2.prototype.getLinearVelocityFromLocalPoint = function(localPoint) {\n      return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(localPoint));\n    };\n    Body2.prototype.setLinearVelocity = function(v3) {\n      if (this.m_type == STATIC) {\n        return;\n      }\n      if (Vec2.dot(v3, v3) > 0) {\n        this.setAwake(true);\n      }\n      this.m_linearVelocity.setVec2(v3);\n    };\n    Body2.prototype.getAngularVelocity = function() {\n      return this.m_angularVelocity;\n    };\n    Body2.prototype.setAngularVelocity = function(w) {\n      if (this.m_type == STATIC) {\n        return;\n      }\n      if (w * w > 0) {\n        this.setAwake(true);\n      }\n      this.m_angularVelocity = w;\n    };\n    Body2.prototype.getLinearDamping = function() {\n      return this.m_linearDamping;\n    };\n    Body2.prototype.setLinearDamping = function(linearDamping) {\n      this.m_linearDamping = linearDamping;\n    };\n    Body2.prototype.getAngularDamping = function() {\n      return this.m_angularDamping;\n    };\n    Body2.prototype.setAngularDamping = function(angularDamping) {\n      this.m_angularDamping = angularDamping;\n    };\n    Body2.prototype.getGravityScale = function() {\n      return this.m_gravityScale;\n    };\n    Body2.prototype.setGravityScale = function(scale) {\n      this.m_gravityScale = scale;\n    };\n    Body2.prototype.getMass = function() {\n      return this.m_mass;\n    };\n    Body2.prototype.getInertia = function() {\n      return this.m_I + this.m_mass * Vec2.dot(this.m_sweep.localCenter, this.m_sweep.localCenter);\n    };\n    Body2.prototype.getMassData = function(data) {\n      data.mass = this.m_mass;\n      data.I = this.getInertia();\n      copyVec2(data.center, this.m_sweep.localCenter);\n    };\n    Body2.prototype.resetMassData = function() {\n      this.m_mass = 0;\n      this.m_invMass = 0;\n      this.m_I = 0;\n      this.m_invI = 0;\n      zeroVec2(this.m_sweep.localCenter);\n      if (this.isStatic() || this.isKinematic()) {\n        copyVec2(this.m_sweep.c0, this.m_xf.p);\n        copyVec2(this.m_sweep.c, this.m_xf.p);\n        this.m_sweep.a0 = this.m_sweep.a;\n        return;\n      }\n      zeroVec2(localCenter);\n      for (var f = this.m_fixtureList; f; f = f.m_next) {\n        if (f.m_density == 0) {\n          continue;\n        }\n        var massData = {\n          mass: 0,\n          center: vec2(0, 0),\n          I: 0\n        };\n        f.getMassData(massData);\n        this.m_mass += massData.mass;\n        plusScaleVec2(localCenter, massData.mass, massData.center);\n        this.m_I += massData.I;\n      }\n      if (this.m_mass > 0) {\n        this.m_invMass = 1 / this.m_mass;\n        scaleVec2(localCenter, this.m_invMass, localCenter);\n      } else {\n        this.m_mass = 1;\n        this.m_invMass = 1;\n      }\n      if (this.m_I > 0 && this.m_fixedRotationFlag == false) {\n        this.m_I -= this.m_mass * dotVec2(localCenter, localCenter);\n        this.m_invI = 1 / this.m_I;\n      } else {\n        this.m_I = 0;\n        this.m_invI = 0;\n      }\n      copyVec2(oldCenter, this.m_sweep.c);\n      this.m_sweep.setLocalCenter(localCenter, this.m_xf);\n      subVec2(shift, this.m_sweep.c, oldCenter);\n      crossNumVec2(temp$6, this.m_angularVelocity, shift);\n      plusVec2(this.m_linearVelocity, temp$6);\n    };\n    Body2.prototype.setMassData = function(massData) {\n      if (this.isWorldLocked() == true) {\n        return;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      this.m_invMass = 0;\n      this.m_I = 0;\n      this.m_invI = 0;\n      this.m_mass = massData.mass;\n      if (this.m_mass <= 0) {\n        this.m_mass = 1;\n      }\n      this.m_invMass = 1 / this.m_mass;\n      if (massData.I > 0 && this.m_fixedRotationFlag == false) {\n        this.m_I = massData.I - this.m_mass * dotVec2(massData.center, massData.center);\n        this.m_invI = 1 / this.m_I;\n      }\n      copyVec2(oldCenter, this.m_sweep.c);\n      this.m_sweep.setLocalCenter(massData.center, this.m_xf);\n      subVec2(shift, this.m_sweep.c, oldCenter);\n      crossNumVec2(temp$6, this.m_angularVelocity, shift);\n      plusVec2(this.m_linearVelocity, temp$6);\n    };\n    Body2.prototype.applyForce = function(force, point2, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_force.add(force);\n        this.m_torque += Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), force);\n      }\n    };\n    Body2.prototype.applyForceToCenter = function(force, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_force.add(force);\n      }\n    };\n    Body2.prototype.applyTorque = function(torque, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_torque += torque;\n      }\n    };\n    Body2.prototype.applyLinearImpulse = function(impulse, point2, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_linearVelocity.addMul(this.m_invMass, impulse);\n        this.m_angularVelocity += this.m_invI * Vec2.crossVec2Vec2(Vec2.sub(point2, this.m_sweep.c), impulse);\n      }\n    };\n    Body2.prototype.applyAngularImpulse = function(impulse, wake) {\n      if (wake === void 0) {\n        wake = true;\n      }\n      if (this.m_type != DYNAMIC) {\n        return;\n      }\n      if (wake && this.m_awakeFlag == false) {\n        this.setAwake(true);\n      }\n      if (this.m_awakeFlag) {\n        this.m_angularVelocity += this.m_invI * impulse;\n      }\n    };\n    Body2.prototype.shouldCollide = function(that) {\n      if (this.m_type != DYNAMIC && that.m_type != DYNAMIC) {\n        return false;\n      }\n      for (var jn = this.m_jointList; jn; jn = jn.next) {\n        if (jn.other == that) {\n          if (jn.joint.m_collideConnected == false) {\n            return false;\n          }\n        }\n      }\n      return true;\n    };\n    Body2.prototype._addFixture = function(fixture) {\n      if (this.isWorldLocked() == true) {\n        return null;\n      }\n      if (this.m_activeFlag) {\n        var broadPhase = this.m_world.m_broadPhase;\n        fixture.createProxies(broadPhase, this.m_xf);\n      }\n      fixture.m_next = this.m_fixtureList;\n      this.m_fixtureList = fixture;\n      if (fixture.m_density > 0) {\n        this.resetMassData();\n      }\n      this.m_world.m_newFixture = true;\n      return fixture;\n    };\n    Body2.prototype.createFixture = function(shape, fixdef) {\n      if (this.isWorldLocked() == true) {\n        return null;\n      }\n      var fixture = new Fixture(this, shape, fixdef);\n      this._addFixture(fixture);\n      return fixture;\n    };\n    Body2.prototype.destroyFixture = function(fixture) {\n      if (this.isWorldLocked() == true) {\n        return;\n      }\n      if (this.m_fixtureList === fixture) {\n        this.m_fixtureList = fixture.m_next;\n      } else {\n        var node = this.m_fixtureList;\n        while (node != null) {\n          if (node.m_next === fixture) {\n            node.m_next = fixture.m_next;\n            break;\n          }\n          node = node.m_next;\n        }\n      }\n      var edge = this.m_contactList;\n      while (edge) {\n        var c2 = edge.contact;\n        edge = edge.next;\n        var fixtureA = c2.getFixtureA();\n        var fixtureB = c2.getFixtureB();\n        if (fixture == fixtureA || fixture == fixtureB) {\n          this.m_world.destroyContact(c2);\n        }\n      }\n      if (this.m_activeFlag) {\n        var broadPhase = this.m_world.m_broadPhase;\n        fixture.destroyProxies(broadPhase);\n      }\n      fixture.m_body = null;\n      fixture.m_next = null;\n      this.m_world.publish(\"remove-fixture\", fixture);\n      this.resetMassData();\n    };\n    Body2.prototype.getWorldPoint = function(localPoint) {\n      return Transform.mulVec2(this.m_xf, localPoint);\n    };\n    Body2.prototype.getWorldVector = function(localVector) {\n      return Rot.mulVec2(this.m_xf.q, localVector);\n    };\n    Body2.prototype.getLocalPoint = function(worldPoint) {\n      return Transform.mulTVec2(this.m_xf, worldPoint);\n    };\n    Body2.prototype.getLocalVector = function(worldVector) {\n      return Rot.mulTVec2(this.m_xf.q, worldVector);\n    };\n    Body2.STATIC = \"static\";\n    Body2.KINEMATIC = \"kinematic\";\n    Body2.DYNAMIC = \"dynamic\";\n    return Body2;\n  }()\n);\nvar JointEdge = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function JointEdge2() {\n      this.other = null;\n      this.joint = null;\n      this.prev = null;\n      this.next = null;\n    }\n    return JointEdge2;\n  }()\n);\nvar Joint = (\n  /** @class */\n  function() {\n    function Joint2(def, bodyA, bodyB) {\n      this.m_type = \"unknown-joint\";\n      this.m_prev = null;\n      this.m_next = null;\n      this.m_edgeA = new JointEdge();\n      this.m_edgeB = new JointEdge();\n      this.m_islandFlag = false;\n      this.style = {};\n      this.appData = {};\n      bodyA = \"bodyA\" in def ? def.bodyA : bodyA;\n      bodyB = \"bodyB\" in def ? def.bodyB : bodyB;\n      this.m_bodyA = bodyA;\n      this.m_bodyB = bodyB;\n      this.m_collideConnected = !!def.collideConnected;\n      this.m_userData = def.userData;\n      if (typeof def.style === \"object\" && def.style !== null) {\n        this.style = def.style;\n      }\n    }\n    Joint2.prototype.isActive = function() {\n      return this.m_bodyA.isActive() && this.m_bodyB.isActive();\n    };\n    Joint2.prototype.getType = function() {\n      return this.m_type;\n    };\n    Joint2.prototype.getBodyA = function() {\n      return this.m_bodyA;\n    };\n    Joint2.prototype.getBodyB = function() {\n      return this.m_bodyB;\n    };\n    Joint2.prototype.getNext = function() {\n      return this.m_next;\n    };\n    Joint2.prototype.getUserData = function() {\n      return this.m_userData;\n    };\n    Joint2.prototype.setUserData = function(data) {\n      this.m_userData = data;\n    };\n    Joint2.prototype.getCollideConnected = function() {\n      return this.m_collideConnected;\n    };\n    Joint2.prototype.shiftOrigin = function(newOrigin) {\n    };\n    Joint2.prototype._resetAnchors = function(def) {\n      return this._reset(def);\n    };\n    return Joint2;\n  }()\n);\nvar stats = {\n  gjkCalls: 0,\n  gjkIters: 0,\n  gjkMaxIters: 0,\n  toiTime: 0,\n  toiMaxTime: 0,\n  toiCalls: 0,\n  toiIters: 0,\n  toiMaxIters: 0,\n  toiRootIters: 0,\n  toiMaxRootIters: 0,\n  toString: function(newline) {\n    newline = typeof newline === \"string\" ? newline : \"\\n\";\n    var string = \"\";\n    for (var name_1 in this) {\n      if (typeof this[name_1] !== \"function\" && typeof this[name_1] !== \"object\") {\n        string += name_1 + \": \" + this[name_1] + newline;\n      }\n    }\n    return string;\n  }\n};\nvar now = function() {\n  return Date.now();\n};\nvar diff = function(time) {\n  return Date.now() - time;\n};\nconst Timer = {\n  now,\n  diff\n};\nvar math_max$4 = Math.max;\nvar temp$5 = vec2(0, 0);\nvar normal$4 = vec2(0, 0);\nvar e12 = vec2(0, 0);\nvar e13 = vec2(0, 0);\nvar e23 = vec2(0, 0);\nvar temp1 = vec2(0, 0);\nvar temp2 = vec2(0, 0);\nstats.gjkCalls = 0;\nstats.gjkIters = 0;\nstats.gjkMaxIters = 0;\nvar DistanceInput = (\n  /** @class */\n  function() {\n    function DistanceInput2() {\n      this.proxyA = new DistanceProxy();\n      this.proxyB = new DistanceProxy();\n      this.transformA = Transform.identity();\n      this.transformB = Transform.identity();\n      this.useRadii = false;\n    }\n    DistanceInput2.prototype.recycle = function() {\n      this.proxyA.recycle();\n      this.proxyB.recycle();\n      this.transformA.setIdentity();\n      this.transformB.setIdentity();\n      this.useRadii = false;\n    };\n    return DistanceInput2;\n  }()\n);\nvar DistanceOutput = (\n  /** @class */\n  function() {\n    function DistanceOutput2() {\n      this.pointA = vec2(0, 0);\n      this.pointB = vec2(0, 0);\n      this.distance = 0;\n      this.iterations = 0;\n    }\n    DistanceOutput2.prototype.recycle = function() {\n      zeroVec2(this.pointA);\n      zeroVec2(this.pointB);\n      this.distance = 0;\n      this.iterations = 0;\n    };\n    return DistanceOutput2;\n  }()\n);\nvar SimplexCache = (\n  /** @class */\n  function() {\n    function SimplexCache2() {\n      this.metric = 0;\n      this.indexA = [];\n      this.indexB = [];\n      this.count = 0;\n    }\n    SimplexCache2.prototype.recycle = function() {\n      this.metric = 0;\n      this.indexA.length = 0;\n      this.indexB.length = 0;\n      this.count = 0;\n    };\n    return SimplexCache2;\n  }()\n);\nvar Distance = function(output2, cache2, input2) {\n  ++stats.gjkCalls;\n  var proxyA = input2.proxyA;\n  var proxyB = input2.proxyB;\n  var xfA2 = input2.transformA;\n  var xfB2 = input2.transformB;\n  simplex.recycle();\n  simplex.readCache(cache2, proxyA, xfA2, proxyB, xfB2);\n  var vertices = simplex.m_v;\n  var k_maxIters = SettingsInternal.maxDistanceIterations;\n  var saveA = [];\n  var saveB = [];\n  var saveCount = 0;\n  var iter = 0;\n  while (iter < k_maxIters) {\n    saveCount = simplex.m_count;\n    for (var i = 0; i < saveCount; ++i) {\n      saveA[i] = vertices[i].indexA;\n      saveB[i] = vertices[i].indexB;\n    }\n    simplex.solve();\n    if (simplex.m_count === 3) {\n      break;\n    }\n    var d2 = simplex.getSearchDirection();\n    if (lengthSqrVec2(d2) < EPSILON * EPSILON) {\n      break;\n    }\n    var vertex = vertices[simplex.m_count];\n    vertex.indexA = proxyA.getSupport(derotVec2(temp$5, xfA2.q, scaleVec2(temp$5, -1, d2)));\n    transformVec2(vertex.wA, xfA2, proxyA.getVertex(vertex.indexA));\n    vertex.indexB = proxyB.getSupport(derotVec2(temp$5, xfB2.q, d2));\n    transformVec2(vertex.wB, xfB2, proxyB.getVertex(vertex.indexB));\n    subVec2(vertex.w, vertex.wB, vertex.wA);\n    ++iter;\n    ++stats.gjkIters;\n    var duplicate = false;\n    for (var i = 0; i < saveCount; ++i) {\n      if (vertex.indexA === saveA[i] && vertex.indexB === saveB[i]) {\n        duplicate = true;\n        break;\n      }\n    }\n    if (duplicate) {\n      break;\n    }\n    ++simplex.m_count;\n  }\n  stats.gjkMaxIters = math_max$4(stats.gjkMaxIters, iter);\n  simplex.getWitnessPoints(output2.pointA, output2.pointB);\n  output2.distance = distVec2(output2.pointA, output2.pointB);\n  output2.iterations = iter;\n  simplex.writeCache(cache2);\n  if (input2.useRadii) {\n    var rA2 = proxyA.m_radius;\n    var rB2 = proxyB.m_radius;\n    if (output2.distance > rA2 + rB2 && output2.distance > EPSILON) {\n      output2.distance -= rA2 + rB2;\n      subVec2(normal$4, output2.pointB, output2.pointA);\n      normalizeVec2(normal$4);\n      plusScaleVec2(output2.pointA, rA2, normal$4);\n      minusScaleVec2(output2.pointB, rB2, normal$4);\n    } else {\n      var p = subVec2(temp$5, output2.pointA, output2.pointB);\n      copyVec2(output2.pointA, p);\n      copyVec2(output2.pointB, p);\n      output2.distance = 0;\n    }\n  }\n};\nvar DistanceProxy = (\n  /** @class */\n  function() {\n    function DistanceProxy2() {\n      this.m_vertices = [];\n      this.m_count = 0;\n      this.m_radius = 0;\n    }\n    DistanceProxy2.prototype.recycle = function() {\n      this.m_vertices.length = 0;\n      this.m_count = 0;\n      this.m_radius = 0;\n    };\n    DistanceProxy2.prototype.getVertexCount = function() {\n      return this.m_count;\n    };\n    DistanceProxy2.prototype.getVertex = function(index) {\n      return this.m_vertices[index];\n    };\n    DistanceProxy2.prototype.getSupport = function(d2) {\n      var bestIndex = -1;\n      var bestValue = -Infinity;\n      for (var i = 0; i < this.m_count; ++i) {\n        var value = dotVec2(this.m_vertices[i], d2);\n        if (value > bestValue) {\n          bestIndex = i;\n          bestValue = value;\n        }\n      }\n      return bestIndex;\n    };\n    DistanceProxy2.prototype.getSupportVertex = function(d2) {\n      return this.m_vertices[this.getSupport(d2)];\n    };\n    DistanceProxy2.prototype.set = function(shape, index) {\n      shape.computeDistanceProxy(this, index);\n    };\n    DistanceProxy2.prototype.setVertices = function(vertices, count, radius) {\n      this.m_vertices = vertices;\n      this.m_count = count;\n      this.m_radius = radius;\n    };\n    return DistanceProxy2;\n  }()\n);\nvar SimplexVertex = (\n  /** @class */\n  function() {\n    function SimplexVertex2() {\n      this.wA = vec2(0, 0);\n      this.indexA = 0;\n      this.wB = vec2(0, 0);\n      this.indexB = 0;\n      this.w = vec2(0, 0);\n      this.a = 0;\n    }\n    SimplexVertex2.prototype.recycle = function() {\n      this.indexA = 0;\n      this.indexB = 0;\n      zeroVec2(this.wA);\n      zeroVec2(this.wB);\n      zeroVec2(this.w);\n      this.a = 0;\n    };\n    SimplexVertex2.prototype.set = function(v3) {\n      this.indexA = v3.indexA;\n      this.indexB = v3.indexB;\n      copyVec2(this.wA, v3.wA);\n      copyVec2(this.wB, v3.wB);\n      copyVec2(this.w, v3.w);\n      this.a = v3.a;\n    };\n    return SimplexVertex2;\n  }()\n);\nvar searchDirection_reuse = vec2(0, 0);\nvar closestPoint_reuse = vec2(0, 0);\nvar Simplex = (\n  /** @class */\n  function() {\n    function Simplex2() {\n      this.m_v1 = new SimplexVertex();\n      this.m_v2 = new SimplexVertex();\n      this.m_v3 = new SimplexVertex();\n      this.m_v = [this.m_v1, this.m_v2, this.m_v3];\n    }\n    Simplex2.prototype.recycle = function() {\n      this.m_v1.recycle();\n      this.m_v2.recycle();\n      this.m_v3.recycle();\n      this.m_count = 0;\n    };\n    Simplex2.prototype.toString = function() {\n      if (this.m_count === 3) {\n        return [\n          \"+\" + this.m_count,\n          this.m_v1.a,\n          this.m_v1.wA.x,\n          this.m_v1.wA.y,\n          this.m_v1.wB.x,\n          this.m_v1.wB.y,\n          this.m_v2.a,\n          this.m_v2.wA.x,\n          this.m_v2.wA.y,\n          this.m_v2.wB.x,\n          this.m_v2.wB.y,\n          this.m_v3.a,\n          this.m_v3.wA.x,\n          this.m_v3.wA.y,\n          this.m_v3.wB.x,\n          this.m_v3.wB.y\n        ].toString();\n      } else if (this.m_count === 2) {\n        return [\n          \"+\" + this.m_count,\n          this.m_v1.a,\n          this.m_v1.wA.x,\n          this.m_v1.wA.y,\n          this.m_v1.wB.x,\n          this.m_v1.wB.y,\n          this.m_v2.a,\n          this.m_v2.wA.x,\n          this.m_v2.wA.y,\n          this.m_v2.wB.x,\n          this.m_v2.wB.y\n        ].toString();\n      } else if (this.m_count === 1) {\n        return [\n          \"+\" + this.m_count,\n          this.m_v1.a,\n          this.m_v1.wA.x,\n          this.m_v1.wA.y,\n          this.m_v1.wB.x,\n          this.m_v1.wB.y\n        ].toString();\n      } else {\n        return \"+\" + this.m_count;\n      }\n    };\n    Simplex2.prototype.readCache = function(cache2, proxyA, transformA, proxyB, transformB) {\n      this.m_count = cache2.count;\n      for (var i = 0; i < this.m_count; ++i) {\n        var v3 = this.m_v[i];\n        v3.indexA = cache2.indexA[i];\n        v3.indexB = cache2.indexB[i];\n        var wALocal = proxyA.getVertex(v3.indexA);\n        var wBLocal = proxyB.getVertex(v3.indexB);\n        transformVec2(v3.wA, transformA, wALocal);\n        transformVec2(v3.wB, transformB, wBLocal);\n        subVec2(v3.w, v3.wB, v3.wA);\n        v3.a = 0;\n      }\n      if (this.m_count > 1) {\n        var metric1 = cache2.metric;\n        var metric2 = this.getMetric();\n        if (metric2 < 0.5 * metric1 || 2 * metric1 < metric2 || metric2 < EPSILON) {\n          this.m_count = 0;\n        }\n      }\n      if (this.m_count === 0) {\n        var v3 = this.m_v[0];\n        v3.indexA = 0;\n        v3.indexB = 0;\n        var wALocal = proxyA.getVertex(0);\n        var wBLocal = proxyB.getVertex(0);\n        transformVec2(v3.wA, transformA, wALocal);\n        transformVec2(v3.wB, transformB, wBLocal);\n        subVec2(v3.w, v3.wB, v3.wA);\n        v3.a = 1;\n        this.m_count = 1;\n      }\n    };\n    Simplex2.prototype.writeCache = function(cache2) {\n      cache2.metric = this.getMetric();\n      cache2.count = this.m_count;\n      for (var i = 0; i < this.m_count; ++i) {\n        cache2.indexA[i] = this.m_v[i].indexA;\n        cache2.indexB[i] = this.m_v[i].indexB;\n      }\n    };\n    Simplex2.prototype.getSearchDirection = function() {\n      var v13 = this.m_v1;\n      var v22 = this.m_v2;\n      switch (this.m_count) {\n        case 1:\n          return setVec2(searchDirection_reuse, -v13.w.x, -v13.w.y);\n        case 2: {\n          subVec2(e12, v22.w, v13.w);\n          var sgn = -crossVec2Vec2(e12, v13.w);\n          if (sgn > 0) {\n            return setVec2(searchDirection_reuse, -e12.y, e12.x);\n          } else {\n            return setVec2(searchDirection_reuse, e12.y, -e12.x);\n          }\n        }\n        default:\n          return zeroVec2(searchDirection_reuse);\n      }\n    };\n    Simplex2.prototype.getClosestPoint = function() {\n      var v13 = this.m_v1;\n      var v22 = this.m_v2;\n      switch (this.m_count) {\n        case 0:\n          return zeroVec2(closestPoint_reuse);\n        case 1:\n          return copyVec2(closestPoint_reuse, v13.w);\n        case 2:\n          return combine2Vec2(closestPoint_reuse, v13.a, v13.w, v22.a, v22.w);\n        case 3:\n          return zeroVec2(closestPoint_reuse);\n        default:\n          return zeroVec2(closestPoint_reuse);\n      }\n    };\n    Simplex2.prototype.getWitnessPoints = function(pA2, pB2) {\n      var v13 = this.m_v1;\n      var v22 = this.m_v2;\n      var v3 = this.m_v3;\n      switch (this.m_count) {\n        case 0:\n          break;\n        case 1:\n          copyVec2(pA2, v13.wA);\n          copyVec2(pB2, v13.wB);\n          break;\n        case 2:\n          combine2Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA);\n          combine2Vec2(pB2, v13.a, v13.wB, v22.a, v22.wB);\n          break;\n        case 3:\n          combine3Vec2(pA2, v13.a, v13.wA, v22.a, v22.wA, v3.a, v3.wA);\n          copyVec2(pB2, pA2);\n          break;\n      }\n    };\n    Simplex2.prototype.getMetric = function() {\n      switch (this.m_count) {\n        case 0:\n          return 0;\n        case 1:\n          return 0;\n        case 2:\n          return distVec2(this.m_v1.w, this.m_v2.w);\n        case 3:\n          return crossVec2Vec2(subVec2(temp1, this.m_v2.w, this.m_v1.w), subVec2(temp2, this.m_v3.w, this.m_v1.w));\n        default:\n          return 0;\n      }\n    };\n    Simplex2.prototype.solve = function() {\n      switch (this.m_count) {\n        case 1:\n          break;\n        case 2:\n          this.solve2();\n          break;\n        case 3:\n          this.solve3();\n          break;\n      }\n    };\n    Simplex2.prototype.solve2 = function() {\n      var w1 = this.m_v1.w;\n      var w2 = this.m_v2.w;\n      subVec2(e12, w2, w1);\n      var d12_2 = -dotVec2(w1, e12);\n      if (d12_2 <= 0) {\n        this.m_v1.a = 1;\n        this.m_count = 1;\n        return;\n      }\n      var d12_1 = dotVec2(w2, e12);\n      if (d12_1 <= 0) {\n        this.m_v2.a = 1;\n        this.m_count = 1;\n        this.m_v1.set(this.m_v2);\n        return;\n      }\n      var inv_d12 = 1 / (d12_1 + d12_2);\n      this.m_v1.a = d12_1 * inv_d12;\n      this.m_v2.a = d12_2 * inv_d12;\n      this.m_count = 2;\n    };\n    Simplex2.prototype.solve3 = function() {\n      var w1 = this.m_v1.w;\n      var w2 = this.m_v2.w;\n      var w3 = this.m_v3.w;\n      subVec2(e12, w2, w1);\n      var w1e12 = dotVec2(w1, e12);\n      var w2e12 = dotVec2(w2, e12);\n      var d12_1 = w2e12;\n      var d12_2 = -w1e12;\n      subVec2(e13, w3, w1);\n      var w1e13 = dotVec2(w1, e13);\n      var w3e13 = dotVec2(w3, e13);\n      var d13_1 = w3e13;\n      var d13_2 = -w1e13;\n      subVec2(e23, w3, w2);\n      var w2e23 = dotVec2(w2, e23);\n      var w3e23 = dotVec2(w3, e23);\n      var d23_1 = w3e23;\n      var d23_2 = -w2e23;\n      var n123 = crossVec2Vec2(e12, e13);\n      var d123_1 = n123 * crossVec2Vec2(w2, w3);\n      var d123_2 = n123 * crossVec2Vec2(w3, w1);\n      var d123_3 = n123 * crossVec2Vec2(w1, w2);\n      if (d12_2 <= 0 && d13_2 <= 0) {\n        this.m_v1.a = 1;\n        this.m_count = 1;\n        return;\n      }\n      if (d12_1 > 0 && d12_2 > 0 && d123_3 <= 0) {\n        var inv_d12 = 1 / (d12_1 + d12_2);\n        this.m_v1.a = d12_1 * inv_d12;\n        this.m_v2.a = d12_2 * inv_d12;\n        this.m_count = 2;\n        return;\n      }\n      if (d13_1 > 0 && d13_2 > 0 && d123_2 <= 0) {\n        var inv_d13 = 1 / (d13_1 + d13_2);\n        this.m_v1.a = d13_1 * inv_d13;\n        this.m_v3.a = d13_2 * inv_d13;\n        this.m_count = 2;\n        this.m_v2.set(this.m_v3);\n        return;\n      }\n      if (d12_1 <= 0 && d23_2 <= 0) {\n        this.m_v2.a = 1;\n        this.m_count = 1;\n        this.m_v1.set(this.m_v2);\n        return;\n      }\n      if (d13_1 <= 0 && d23_1 <= 0) {\n        this.m_v3.a = 1;\n        this.m_count = 1;\n        this.m_v1.set(this.m_v3);\n        return;\n      }\n      if (d23_1 > 0 && d23_2 > 0 && d123_1 <= 0) {\n        var inv_d23 = 1 / (d23_1 + d23_2);\n        this.m_v2.a = d23_1 * inv_d23;\n        this.m_v3.a = d23_2 * inv_d23;\n        this.m_count = 2;\n        this.m_v1.set(this.m_v3);\n        return;\n      }\n      var inv_d123 = 1 / (d123_1 + d123_2 + d123_3);\n      this.m_v1.a = d123_1 * inv_d123;\n      this.m_v2.a = d123_2 * inv_d123;\n      this.m_v3.a = d123_3 * inv_d123;\n      this.m_count = 3;\n    };\n    return Simplex2;\n  }()\n);\nvar simplex = new Simplex();\nvar input$1 = new DistanceInput();\nvar cache$1 = new SimplexCache();\nvar output$1 = new DistanceOutput();\nvar testOverlap = function(shapeA, indexA, shapeB, indexB, xfA2, xfB2) {\n  input$1.recycle();\n  input$1.proxyA.set(shapeA, indexA);\n  input$1.proxyB.set(shapeB, indexB);\n  copyTransform(input$1.transformA, xfA2);\n  copyTransform(input$1.transformB, xfB2);\n  input$1.useRadii = true;\n  output$1.recycle();\n  cache$1.recycle();\n  Distance(output$1, cache$1, input$1);\n  return output$1.distance < 10 * EPSILON;\n};\nDistance.testOverlap = testOverlap;\nDistance.Input = DistanceInput;\nDistance.Output = DistanceOutput;\nDistance.Proxy = DistanceProxy;\nDistance.Cache = SimplexCache;\nvar ShapeCastInput = (\n  /** @class */\n  function() {\n    function ShapeCastInput2() {\n      this.proxyA = new DistanceProxy();\n      this.proxyB = new DistanceProxy();\n      this.transformA = Transform.identity();\n      this.transformB = Transform.identity();\n      this.translationB = Vec2.zero();\n    }\n    ShapeCastInput2.prototype.recycle = function() {\n      this.proxyA.recycle();\n      this.proxyB.recycle();\n      this.transformA.setIdentity();\n      this.transformB.setIdentity();\n      zeroVec2(this.translationB);\n    };\n    return ShapeCastInput2;\n  }()\n);\nvar ShapeCastOutput = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function ShapeCastOutput2() {\n      this.point = Vec2.zero();\n      this.normal = Vec2.zero();\n      this.lambda = 1;\n      this.iterations = 0;\n    }\n    return ShapeCastOutput2;\n  }()\n);\nvar ShapeCast = function(output2, input2) {\n  output2.iterations = 0;\n  output2.lambda = 1;\n  output2.normal.setZero();\n  output2.point.setZero();\n  var proxyA = input2.proxyA;\n  var proxyB = input2.proxyB;\n  var radiusA = math_max$4(proxyA.m_radius, SettingsInternal.polygonRadius);\n  var radiusB = math_max$4(proxyB.m_radius, SettingsInternal.polygonRadius);\n  var radius = radiusA + radiusB;\n  var xfA2 = input2.transformA;\n  var xfB2 = input2.transformB;\n  var r = input2.translationB;\n  var n2 = Vec2.zero();\n  var lambda = 0;\n  var simplex2 = new Simplex();\n  simplex2.m_count = 0;\n  var vertices = simplex2.m_v;\n  var indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(r)));\n  var wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));\n  var indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, r));\n  var wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));\n  var v3 = Vec2.sub(wA, wB);\n  var sigma = math_max$4(SettingsInternal.polygonRadius, radius - SettingsInternal.polygonRadius);\n  var tolerance = 0.5 * SettingsInternal.linearSlop;\n  var k_maxIters = 20;\n  var iter = 0;\n  while (iter < k_maxIters && v3.length() - sigma > tolerance) {\n    output2.iterations += 1;\n    indexA = proxyA.getSupport(Rot.mulTVec2(xfA2.q, Vec2.neg(v3)));\n    wA = Transform.mulVec2(xfA2, proxyA.getVertex(indexA));\n    indexB = proxyB.getSupport(Rot.mulTVec2(xfB2.q, v3));\n    wB = Transform.mulVec2(xfB2, proxyB.getVertex(indexB));\n    var p = Vec2.sub(wA, wB);\n    v3.normalize();\n    var vp = Vec2.dot(v3, p);\n    var vr = Vec2.dot(v3, r);\n    if (vp - sigma > lambda * vr) {\n      if (vr <= 0) {\n        return false;\n      }\n      lambda = (vp - sigma) / vr;\n      if (lambda > 1) {\n        return false;\n      }\n      n2.setMul(-1, v3);\n      simplex2.m_count = 0;\n    }\n    var vertex = vertices[simplex2.m_count];\n    vertex.indexA = indexB;\n    vertex.wA = Vec2.combine(1, wB, lambda, r);\n    vertex.indexB = indexA;\n    vertex.wB = wA;\n    vertex.w = Vec2.sub(vertex.wB, vertex.wA);\n    vertex.a = 1;\n    simplex2.m_count += 1;\n    switch (simplex2.m_count) {\n      case 1:\n        break;\n      case 2:\n        simplex2.solve2();\n        break;\n      case 3:\n        simplex2.solve3();\n        break;\n    }\n    if (simplex2.m_count == 3) {\n      return false;\n    }\n    v3.setVec2(simplex2.getClosestPoint());\n    ++iter;\n  }\n  if (iter == 0) {\n    return false;\n  }\n  var pointA2 = Vec2.zero();\n  var pointB2 = Vec2.zero();\n  simplex2.getWitnessPoints(pointB2, pointA2);\n  if (v3.lengthSquared() > 0) {\n    n2.setMul(-1, v3);\n    n2.normalize();\n  }\n  output2.point = Vec2.combine(1, pointA2, radiusA, n2);\n  output2.normal = n2;\n  output2.lambda = lambda;\n  output2.iterations = iter;\n  return true;\n};\nvar math_abs$7 = Math.abs;\nvar math_max$3 = Math.max;\nvar TOIInput = (\n  /** @class */\n  function() {\n    function TOIInput2() {\n      this.proxyA = new DistanceProxy();\n      this.proxyB = new DistanceProxy();\n      this.sweepA = new Sweep();\n      this.sweepB = new Sweep();\n    }\n    TOIInput2.prototype.recycle = function() {\n      this.proxyA.recycle();\n      this.proxyB.recycle();\n      this.sweepA.recycle();\n      this.sweepB.recycle();\n      this.tMax = -1;\n    };\n    return TOIInput2;\n  }()\n);\nvar TOIOutputState;\n(function(TOIOutputState2) {\n  TOIOutputState2[TOIOutputState2[\"e_unset\"] = -1] = \"e_unset\";\n  TOIOutputState2[TOIOutputState2[\"e_unknown\"] = 0] = \"e_unknown\";\n  TOIOutputState2[TOIOutputState2[\"e_failed\"] = 1] = \"e_failed\";\n  TOIOutputState2[TOIOutputState2[\"e_overlapped\"] = 2] = \"e_overlapped\";\n  TOIOutputState2[TOIOutputState2[\"e_touching\"] = 3] = \"e_touching\";\n  TOIOutputState2[TOIOutputState2[\"e_separated\"] = 4] = \"e_separated\";\n})(TOIOutputState || (TOIOutputState = {}));\nvar TOIOutput = (\n  /** @class */\n  function() {\n    function TOIOutput2() {\n      this.state = TOIOutputState.e_unset;\n      this.t = -1;\n    }\n    TOIOutput2.prototype.recycle = function() {\n      this.state = TOIOutputState.e_unset;\n      this.t = -1;\n    };\n    return TOIOutput2;\n  }()\n);\nstats.toiTime = 0;\nstats.toiMaxTime = 0;\nstats.toiCalls = 0;\nstats.toiIters = 0;\nstats.toiMaxIters = 0;\nstats.toiRootIters = 0;\nstats.toiMaxRootIters = 0;\nvar distanceInput = new DistanceInput();\nvar distanceOutput = new DistanceOutput();\nvar cache = new SimplexCache();\nvar xfA$1 = transform(0, 0, 0);\nvar xfB$1 = transform(0, 0, 0);\nvar temp$4 = vec2(0, 0);\nvar pointA$2 = vec2(0, 0);\nvar pointB$2 = vec2(0, 0);\nvar normal$3 = vec2(0, 0);\nvar axisA = vec2(0, 0);\nvar axisB = vec2(0, 0);\nvar localPointA = vec2(0, 0);\nvar localPointB = vec2(0, 0);\nvar TimeOfImpact = function(output2, input2) {\n  var timer = Timer.now();\n  ++stats.toiCalls;\n  output2.state = TOIOutputState.e_unknown;\n  output2.t = input2.tMax;\n  var proxyA = input2.proxyA;\n  var proxyB = input2.proxyB;\n  var sweepA = input2.sweepA;\n  var sweepB = input2.sweepB;\n  sweepA.normalize();\n  sweepB.normalize();\n  var tMax = input2.tMax;\n  var totalRadius = proxyA.m_radius + proxyB.m_radius;\n  var target = math_max$3(SettingsInternal.linearSlop, totalRadius - 3 * SettingsInternal.linearSlop);\n  var tolerance = 0.25 * SettingsInternal.linearSlop;\n  var t1 = 0;\n  var k_maxIterations = SettingsInternal.maxTOIIterations;\n  var iter = 0;\n  cache.recycle();\n  distanceInput.proxyA.setVertices(proxyA.m_vertices, proxyA.m_count, proxyA.m_radius);\n  distanceInput.proxyB.setVertices(proxyB.m_vertices, proxyB.m_count, proxyB.m_radius);\n  distanceInput.useRadii = false;\n  while (true) {\n    sweepA.getTransform(xfA$1, t1);\n    sweepB.getTransform(xfB$1, t1);\n    copyTransform(distanceInput.transformA, xfA$1);\n    copyTransform(distanceInput.transformB, xfB$1);\n    Distance(distanceOutput, cache, distanceInput);\n    if (distanceOutput.distance <= 0) {\n      output2.state = TOIOutputState.e_overlapped;\n      output2.t = 0;\n      break;\n    }\n    if (distanceOutput.distance < target + tolerance) {\n      output2.state = TOIOutputState.e_touching;\n      output2.t = t1;\n      break;\n    }\n    separationFunction.initialize(cache, proxyA, sweepA, proxyB, sweepB, t1);\n    var done = false;\n    var t2 = tMax;\n    var pushBackIter = 0;\n    while (true) {\n      var s2 = separationFunction.findMinSeparation(t2);\n      if (s2 > target + tolerance) {\n        output2.state = TOIOutputState.e_separated;\n        output2.t = tMax;\n        done = true;\n        break;\n      }\n      if (s2 > target - tolerance) {\n        t1 = t2;\n        break;\n      }\n      var s1 = separationFunction.evaluate(t1);\n      if (s1 < target - tolerance) {\n        output2.state = TOIOutputState.e_failed;\n        output2.t = t1;\n        done = true;\n        break;\n      }\n      if (s1 <= target + tolerance) {\n        output2.state = TOIOutputState.e_touching;\n        output2.t = t1;\n        done = true;\n        break;\n      }\n      var rootIterCount = 0;\n      var a1 = t1;\n      var a2 = t2;\n      while (true) {\n        var t = void 0;\n        if (rootIterCount & 1) {\n          t = a1 + (target - s1) * (a2 - a1) / (s2 - s1);\n        } else {\n          t = 0.5 * (a1 + a2);\n        }\n        ++rootIterCount;\n        ++stats.toiRootIters;\n        var s3 = separationFunction.evaluate(t);\n        if (math_abs$7(s3 - target) < tolerance) {\n          t2 = t;\n          break;\n        }\n        if (s3 > target) {\n          a1 = t;\n          s1 = s3;\n        } else {\n          a2 = t;\n          s2 = s3;\n        }\n        if (rootIterCount === 50) {\n          break;\n        }\n      }\n      stats.toiMaxRootIters = math_max$3(stats.toiMaxRootIters, rootIterCount);\n      ++pushBackIter;\n      if (pushBackIter === SettingsInternal.maxPolygonVertices) {\n        break;\n      }\n    }\n    ++iter;\n    ++stats.toiIters;\n    if (done) {\n      break;\n    }\n    if (iter === k_maxIterations) {\n      output2.state = TOIOutputState.e_failed;\n      output2.t = t1;\n      break;\n    }\n  }\n  stats.toiMaxIters = math_max$3(stats.toiMaxIters, iter);\n  var time = Timer.diff(timer);\n  stats.toiMaxTime = math_max$3(stats.toiMaxTime, time);\n  stats.toiTime += time;\n  separationFunction.recycle();\n};\nvar SeparationFunctionType;\n(function(SeparationFunctionType2) {\n  SeparationFunctionType2[SeparationFunctionType2[\"e_unset\"] = -1] = \"e_unset\";\n  SeparationFunctionType2[SeparationFunctionType2[\"e_points\"] = 1] = \"e_points\";\n  SeparationFunctionType2[SeparationFunctionType2[\"e_faceA\"] = 2] = \"e_faceA\";\n  SeparationFunctionType2[SeparationFunctionType2[\"e_faceB\"] = 3] = \"e_faceB\";\n})(SeparationFunctionType || (SeparationFunctionType = {}));\nvar SeparationFunction = (\n  /** @class */\n  function() {\n    function SeparationFunction2() {\n      this.m_proxyA = null;\n      this.m_proxyB = null;\n      this.m_sweepA = null;\n      this.m_sweepB = null;\n      this.m_type = SeparationFunctionType.e_unset;\n      this.m_localPoint = vec2(0, 0);\n      this.m_axis = vec2(0, 0);\n      this.indexA = -1;\n      this.indexB = -1;\n    }\n    SeparationFunction2.prototype.recycle = function() {\n      this.m_proxyA = null;\n      this.m_proxyB = null;\n      this.m_sweepA = null;\n      this.m_sweepB = null;\n      this.m_type = SeparationFunctionType.e_unset;\n      zeroVec2(this.m_localPoint);\n      zeroVec2(this.m_axis);\n      this.indexA = -1;\n      this.indexB = -1;\n    };\n    SeparationFunction2.prototype.initialize = function(cache2, proxyA, sweepA, proxyB, sweepB, t1) {\n      var count = cache2.count;\n      this.m_proxyA = proxyA;\n      this.m_proxyB = proxyB;\n      this.m_sweepA = sweepA;\n      this.m_sweepB = sweepB;\n      this.m_sweepA.getTransform(xfA$1, t1);\n      this.m_sweepB.getTransform(xfB$1, t1);\n      if (count === 1) {\n        this.m_type = SeparationFunctionType.e_points;\n        var localPointA_1 = this.m_proxyA.getVertex(cache2.indexA[0]);\n        var localPointB_1 = this.m_proxyB.getVertex(cache2.indexB[0]);\n        transformVec2(pointA$2, xfA$1, localPointA_1);\n        transformVec2(pointB$2, xfB$1, localPointB_1);\n        subVec2(this.m_axis, pointB$2, pointA$2);\n        var s2 = normalizeVec2Length(this.m_axis);\n        return s2;\n      } else if (cache2.indexA[0] === cache2.indexA[1]) {\n        this.m_type = SeparationFunctionType.e_faceB;\n        var localPointB1 = proxyB.getVertex(cache2.indexB[0]);\n        var localPointB2 = proxyB.getVertex(cache2.indexB[1]);\n        crossVec2Num(this.m_axis, subVec2(temp$4, localPointB2, localPointB1), 1);\n        normalizeVec2(this.m_axis);\n        rotVec2(normal$3, xfB$1.q, this.m_axis);\n        combine2Vec2(this.m_localPoint, 0.5, localPointB1, 0.5, localPointB2);\n        transformVec2(pointB$2, xfB$1, this.m_localPoint);\n        var localPointA_2 = proxyA.getVertex(cache2.indexA[0]);\n        var pointA_1 = Transform.mulVec2(xfA$1, localPointA_2);\n        var s2 = dotVec2(pointA_1, normal$3) - dotVec2(pointB$2, normal$3);\n        if (s2 < 0) {\n          negVec2(this.m_axis);\n          s2 = -s2;\n        }\n        return s2;\n      } else {\n        this.m_type = SeparationFunctionType.e_faceA;\n        var localPointA1 = this.m_proxyA.getVertex(cache2.indexA[0]);\n        var localPointA2 = this.m_proxyA.getVertex(cache2.indexA[1]);\n        crossVec2Num(this.m_axis, subVec2(temp$4, localPointA2, localPointA1), 1);\n        normalizeVec2(this.m_axis);\n        rotVec2(normal$3, xfA$1.q, this.m_axis);\n        combine2Vec2(this.m_localPoint, 0.5, localPointA1, 0.5, localPointA2);\n        transformVec2(pointA$2, xfA$1, this.m_localPoint);\n        var localPointB_2 = this.m_proxyB.getVertex(cache2.indexB[0]);\n        transformVec2(pointB$2, xfB$1, localPointB_2);\n        var s2 = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);\n        if (s2 < 0) {\n          negVec2(this.m_axis);\n          s2 = -s2;\n        }\n        return s2;\n      }\n    };\n    SeparationFunction2.prototype.compute = function(find, t) {\n      this.m_sweepA.getTransform(xfA$1, t);\n      this.m_sweepB.getTransform(xfB$1, t);\n      switch (this.m_type) {\n        case SeparationFunctionType.e_points: {\n          if (find) {\n            derotVec2(axisA, xfA$1.q, this.m_axis);\n            derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, this.m_axis));\n            this.indexA = this.m_proxyA.getSupport(axisA);\n            this.indexB = this.m_proxyB.getSupport(axisB);\n          }\n          copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));\n          copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));\n          transformVec2(pointA$2, xfA$1, localPointA);\n          transformVec2(pointB$2, xfB$1, localPointB);\n          var sep = dotVec2(pointB$2, this.m_axis) - dotVec2(pointA$2, this.m_axis);\n          return sep;\n        }\n        case SeparationFunctionType.e_faceA: {\n          rotVec2(normal$3, xfA$1.q, this.m_axis);\n          transformVec2(pointA$2, xfA$1, this.m_localPoint);\n          if (find) {\n            derotVec2(axisB, xfB$1.q, scaleVec2(temp$4, -1, normal$3));\n            this.indexA = -1;\n            this.indexB = this.m_proxyB.getSupport(axisB);\n          }\n          copyVec2(localPointB, this.m_proxyB.getVertex(this.indexB));\n          transformVec2(pointB$2, xfB$1, localPointB);\n          var sep = dotVec2(pointB$2, normal$3) - dotVec2(pointA$2, normal$3);\n          return sep;\n        }\n        case SeparationFunctionType.e_faceB: {\n          rotVec2(normal$3, xfB$1.q, this.m_axis);\n          transformVec2(pointB$2, xfB$1, this.m_localPoint);\n          if (find) {\n            derotVec2(axisA, xfA$1.q, scaleVec2(temp$4, -1, normal$3));\n            this.indexB = -1;\n            this.indexA = this.m_proxyA.getSupport(axisA);\n          }\n          copyVec2(localPointA, this.m_proxyA.getVertex(this.indexA));\n          transformVec2(pointA$2, xfA$1, localPointA);\n          var sep = dotVec2(pointA$2, normal$3) - dotVec2(pointB$2, normal$3);\n          return sep;\n        }\n        default:\n          if (find) {\n            this.indexA = -1;\n            this.indexB = -1;\n          }\n          return 0;\n      }\n    };\n    SeparationFunction2.prototype.findMinSeparation = function(t) {\n      return this.compute(true, t);\n    };\n    SeparationFunction2.prototype.evaluate = function(t) {\n      return this.compute(false, t);\n    };\n    return SeparationFunction2;\n  }()\n);\nvar separationFunction = new SeparationFunction();\nTimeOfImpact.Input = TOIInput;\nTimeOfImpact.Output = TOIOutput;\nvar math_abs$6 = Math.abs;\nvar math_sqrt$3 = Math.sqrt;\nvar math_min$5 = Math.min;\nvar TimeStep = (\n  /** @class */\n  function() {\n    function TimeStep2() {\n      this.dt = 0;\n      this.inv_dt = 0;\n      this.velocityIterations = 0;\n      this.positionIterations = 0;\n      this.warmStarting = false;\n      this.blockSolve = true;\n      this.inv_dt0 = 0;\n      this.dtRatio = 1;\n    }\n    TimeStep2.prototype.reset = function(dt) {\n      if (this.dt > 0) {\n        this.inv_dt0 = this.inv_dt;\n      }\n      this.dt = dt;\n      this.inv_dt = dt == 0 ? 0 : 1 / dt;\n      this.dtRatio = dt * this.inv_dt0;\n    };\n    return TimeStep2;\n  }()\n);\nvar s_subStep = new TimeStep();\nvar c = vec2(0, 0);\nvar v = vec2(0, 0);\nvar translation = vec2(0, 0);\nvar input = new TOIInput();\nvar output = new TOIOutput();\nvar backup = new Sweep();\nvar backup1 = new Sweep();\nvar backup2 = new Sweep();\nvar ContactImpulse = (\n  /** @class */\n  function() {\n    function ContactImpulse2(contact) {\n      this.contact = contact;\n      this.normals = [];\n      this.tangents = [];\n    }\n    ContactImpulse2.prototype.recycle = function() {\n      this.normals.length = 0;\n      this.tangents.length = 0;\n    };\n    Object.defineProperty(ContactImpulse2.prototype, \"normalImpulses\", {\n      get: function() {\n        var contact = this.contact;\n        var normals = this.normals;\n        normals.length = 0;\n        for (var p = 0; p < contact.v_points.length; ++p) {\n          normals.push(contact.v_points[p].normalImpulse);\n        }\n        return normals;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(ContactImpulse2.prototype, \"tangentImpulses\", {\n      get: function() {\n        var contact = this.contact;\n        var tangents = this.tangents;\n        tangents.length = 0;\n        for (var p = 0; p < contact.v_points.length; ++p) {\n          tangents.push(contact.v_points[p].tangentImpulse);\n        }\n        return tangents;\n      },\n      enumerable: false,\n      configurable: true\n    });\n    return ContactImpulse2;\n  }()\n);\nvar Solver = (\n  /** @class */\n  function() {\n    function Solver2(world) {\n      this.m_world = world;\n      this.m_stack = [];\n      this.m_bodies = [];\n      this.m_contacts = [];\n      this.m_joints = [];\n    }\n    Solver2.prototype.clear = function() {\n      this.m_stack.length = 0;\n      this.m_bodies.length = 0;\n      this.m_contacts.length = 0;\n      this.m_joints.length = 0;\n    };\n    Solver2.prototype.addBody = function(body) {\n      this.m_bodies.push(body);\n    };\n    Solver2.prototype.addContact = function(contact) {\n      this.m_contacts.push(contact);\n    };\n    Solver2.prototype.addJoint = function(joint) {\n      this.m_joints.push(joint);\n    };\n    Solver2.prototype.solveWorld = function(step) {\n      var world = this.m_world;\n      for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {\n        b2.m_islandFlag = false;\n      }\n      for (var c_1 = world.m_contactList; c_1; c_1 = c_1.m_next) {\n        c_1.m_islandFlag = false;\n      }\n      for (var j = world.m_jointList; j; j = j.m_next) {\n        j.m_islandFlag = false;\n      }\n      var stack = this.m_stack;\n      for (var seed = world.m_bodyList; seed; seed = seed.m_next) {\n        if (seed.m_islandFlag) {\n          continue;\n        }\n        if (seed.isAwake() == false || seed.isActive() == false) {\n          continue;\n        }\n        if (seed.isStatic()) {\n          continue;\n        }\n        this.clear();\n        stack.push(seed);\n        seed.m_islandFlag = true;\n        while (stack.length > 0) {\n          var b2 = stack.pop();\n          this.addBody(b2);\n          b2.m_awakeFlag = true;\n          if (b2.isStatic()) {\n            continue;\n          }\n          for (var ce = b2.m_contactList; ce; ce = ce.next) {\n            var contact = ce.contact;\n            if (contact.m_islandFlag) {\n              continue;\n            }\n            if (contact.isEnabled() == false || contact.isTouching() == false) {\n              continue;\n            }\n            var sensorA = contact.m_fixtureA.m_isSensor;\n            var sensorB = contact.m_fixtureB.m_isSensor;\n            if (sensorA || sensorB) {\n              continue;\n            }\n            this.addContact(contact);\n            contact.m_islandFlag = true;\n            var other = ce.other;\n            if (other.m_islandFlag) {\n              continue;\n            }\n            stack.push(other);\n            other.m_islandFlag = true;\n          }\n          for (var je = b2.m_jointList; je; je = je.next) {\n            if (je.joint.m_islandFlag == true) {\n              continue;\n            }\n            var other = je.other;\n            if (other.isActive() == false) {\n              continue;\n            }\n            this.addJoint(je.joint);\n            je.joint.m_islandFlag = true;\n            if (other.m_islandFlag) {\n              continue;\n            }\n            stack.push(other);\n            other.m_islandFlag = true;\n          }\n        }\n        this.solveIsland(step);\n        for (var i = 0; i < this.m_bodies.length; ++i) {\n          var b2 = this.m_bodies[i];\n          if (b2.isStatic()) {\n            b2.m_islandFlag = false;\n          }\n        }\n      }\n    };\n    Solver2.prototype.solveIsland = function(step) {\n      var world = this.m_world;\n      var gravity = world.m_gravity;\n      var allowSleep = world.m_allowSleep;\n      var h = step.dt;\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(c, body.m_sweep.c);\n        var a2 = body.m_sweep.a;\n        copyVec2(v, body.m_linearVelocity);\n        var w = body.m_angularVelocity;\n        copyVec2(body.m_sweep.c0, body.m_sweep.c);\n        body.m_sweep.a0 = body.m_sweep.a;\n        if (body.isDynamic()) {\n          plusScaleVec2(v, h * body.m_gravityScale, gravity);\n          plusScaleVec2(v, h * body.m_invMass, body.m_force);\n          w += h * body.m_invI * body.m_torque;\n          scaleVec2(v, 1 / (1 + h * body.m_linearDamping), v);\n          w *= 1 / (1 + h * body.m_angularDamping);\n        }\n        copyVec2(body.c_position.c, c);\n        body.c_position.a = a2;\n        copyVec2(body.c_velocity.v, v);\n        body.c_velocity.w = w;\n      }\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.initConstraint(step);\n      }\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.initVelocityConstraint(step);\n      }\n      if (step.warmStarting) {\n        for (var i = 0; i < this.m_contacts.length; ++i) {\n          var contact = this.m_contacts[i];\n          contact.warmStartConstraint(step);\n        }\n      }\n      for (var i = 0; i < this.m_joints.length; ++i) {\n        var joint = this.m_joints[i];\n        joint.initVelocityConstraints(step);\n      }\n      for (var i = 0; i < step.velocityIterations; ++i) {\n        for (var j = 0; j < this.m_joints.length; ++j) {\n          var joint = this.m_joints[j];\n          joint.solveVelocityConstraints(step);\n        }\n        for (var j = 0; j < this.m_contacts.length; ++j) {\n          var contact = this.m_contacts[j];\n          contact.solveVelocityConstraint(step);\n        }\n      }\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.storeConstraintImpulses(step);\n      }\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(c, body.c_position.c);\n        var a2 = body.c_position.a;\n        copyVec2(v, body.c_velocity.v);\n        var w = body.c_velocity.w;\n        scaleVec2(translation, h, v);\n        var translationLengthSqr = lengthSqrVec2(translation);\n        if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {\n          var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);\n          mulVec2(v, ratio);\n        }\n        var rotation2 = h * w;\n        if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {\n          var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);\n          w *= ratio;\n        }\n        plusScaleVec2(c, h, v);\n        a2 += h * w;\n        copyVec2(body.c_position.c, c);\n        body.c_position.a = a2;\n        copyVec2(body.c_velocity.v, v);\n        body.c_velocity.w = w;\n      }\n      var positionSolved = false;\n      for (var i = 0; i < step.positionIterations; ++i) {\n        var minSeparation = 0;\n        for (var j = 0; j < this.m_contacts.length; ++j) {\n          var contact = this.m_contacts[j];\n          var separation = contact.solvePositionConstraint(step);\n          minSeparation = math_min$5(minSeparation, separation);\n        }\n        var contactsOkay = minSeparation >= -3 * SettingsInternal.linearSlop;\n        var jointsOkay = true;\n        for (var j = 0; j < this.m_joints.length; ++j) {\n          var joint = this.m_joints[j];\n          var jointOkay = joint.solvePositionConstraints(step);\n          jointsOkay = jointsOkay && jointOkay;\n        }\n        if (contactsOkay && jointsOkay) {\n          positionSolved = true;\n          break;\n        }\n      }\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(body.m_sweep.c, body.c_position.c);\n        body.m_sweep.a = body.c_position.a;\n        copyVec2(body.m_linearVelocity, body.c_velocity.v);\n        body.m_angularVelocity = body.c_velocity.w;\n        body.synchronizeTransform();\n      }\n      this.postSolveIsland();\n      if (allowSleep) {\n        var minSleepTime = Infinity;\n        var linTolSqr = SettingsInternal.linearSleepToleranceSqr;\n        var angTolSqr = SettingsInternal.angularSleepToleranceSqr;\n        for (var i = 0; i < this.m_bodies.length; ++i) {\n          var body = this.m_bodies[i];\n          if (body.isStatic()) {\n            continue;\n          }\n          if (body.m_autoSleepFlag == false || body.m_angularVelocity * body.m_angularVelocity > angTolSqr || lengthSqrVec2(body.m_linearVelocity) > linTolSqr) {\n            body.m_sleepTime = 0;\n            minSleepTime = 0;\n          } else {\n            body.m_sleepTime += h;\n            minSleepTime = math_min$5(minSleepTime, body.m_sleepTime);\n          }\n        }\n        if (minSleepTime >= SettingsInternal.timeToSleep && positionSolved) {\n          for (var i = 0; i < this.m_bodies.length; ++i) {\n            var body = this.m_bodies[i];\n            body.setAwake(false);\n          }\n        }\n      }\n    };\n    Solver2.prototype.solveWorldTOI = function(step) {\n      var world = this.m_world;\n      if (world.m_stepComplete) {\n        for (var b2 = world.m_bodyList; b2; b2 = b2.m_next) {\n          b2.m_islandFlag = false;\n          b2.m_sweep.alpha0 = 0;\n        }\n        for (var c_2 = world.m_contactList; c_2; c_2 = c_2.m_next) {\n          c_2.m_toiFlag = false;\n          c_2.m_islandFlag = false;\n          c_2.m_toiCount = 0;\n          c_2.m_toi = 1;\n        }\n      }\n      while (true) {\n        var minContact = null;\n        var minAlpha = 1;\n        for (var c_3 = world.m_contactList; c_3; c_3 = c_3.m_next) {\n          if (c_3.isEnabled() == false) {\n            continue;\n          }\n          if (c_3.m_toiCount > SettingsInternal.maxSubSteps) {\n            continue;\n          }\n          var alpha = 1;\n          if (c_3.m_toiFlag) {\n            alpha = c_3.m_toi;\n          } else {\n            var fA_1 = c_3.getFixtureA();\n            var fB_1 = c_3.getFixtureB();\n            if (fA_1.isSensor() || fB_1.isSensor()) {\n              continue;\n            }\n            var bA_1 = fA_1.getBody();\n            var bB_1 = fB_1.getBody();\n            var activeA = bA_1.isAwake() && !bA_1.isStatic();\n            var activeB = bB_1.isAwake() && !bB_1.isStatic();\n            if (activeA == false && activeB == false) {\n              continue;\n            }\n            var collideA = bA_1.isBullet() || !bA_1.isDynamic();\n            var collideB = bB_1.isBullet() || !bB_1.isDynamic();\n            if (collideA == false && collideB == false) {\n              continue;\n            }\n            var alpha0 = bA_1.m_sweep.alpha0;\n            if (bA_1.m_sweep.alpha0 < bB_1.m_sweep.alpha0) {\n              alpha0 = bB_1.m_sweep.alpha0;\n              bA_1.m_sweep.advance(alpha0);\n            } else if (bB_1.m_sweep.alpha0 < bA_1.m_sweep.alpha0) {\n              alpha0 = bA_1.m_sweep.alpha0;\n              bB_1.m_sweep.advance(alpha0);\n            }\n            var indexA = c_3.getChildIndexA();\n            var indexB = c_3.getChildIndexB();\n            input.proxyA.set(fA_1.getShape(), indexA);\n            input.proxyB.set(fB_1.getShape(), indexB);\n            input.sweepA.set(bA_1.m_sweep);\n            input.sweepB.set(bB_1.m_sweep);\n            input.tMax = 1;\n            TimeOfImpact(output, input);\n            var beta = output.t;\n            if (output.state == TOIOutputState.e_touching) {\n              alpha = math_min$5(alpha0 + (1 - alpha0) * beta, 1);\n            } else {\n              alpha = 1;\n            }\n            c_3.m_toi = alpha;\n            c_3.m_toiFlag = true;\n          }\n          if (alpha < minAlpha) {\n            minContact = c_3;\n            minAlpha = alpha;\n          }\n        }\n        if (minContact == null || 1 - 10 * EPSILON < minAlpha) {\n          world.m_stepComplete = true;\n          break;\n        }\n        var fA = minContact.getFixtureA();\n        var fB = minContact.getFixtureB();\n        var bA = fA.getBody();\n        var bB = fB.getBody();\n        backup1.set(bA.m_sweep);\n        backup2.set(bB.m_sweep);\n        bA.advance(minAlpha);\n        bB.advance(minAlpha);\n        minContact.update(world);\n        minContact.m_toiFlag = false;\n        ++minContact.m_toiCount;\n        if (minContact.isEnabled() == false || minContact.isTouching() == false) {\n          minContact.setEnabled(false);\n          bA.m_sweep.set(backup1);\n          bB.m_sweep.set(backup2);\n          bA.synchronizeTransform();\n          bB.synchronizeTransform();\n          continue;\n        }\n        bA.setAwake(true);\n        bB.setAwake(true);\n        this.clear();\n        this.addBody(bA);\n        this.addBody(bB);\n        this.addContact(minContact);\n        bA.m_islandFlag = true;\n        bB.m_islandFlag = true;\n        minContact.m_islandFlag = true;\n        var bodies = [bA, bB];\n        for (var i = 0; i < bodies.length; ++i) {\n          var body = bodies[i];\n          if (body.isDynamic()) {\n            for (var ce = body.m_contactList; ce; ce = ce.next) {\n              var contact = ce.contact;\n              if (contact.m_islandFlag) {\n                continue;\n              }\n              var other = ce.other;\n              if (other.isDynamic() && !body.isBullet() && !other.isBullet()) {\n                continue;\n              }\n              var sensorA = contact.m_fixtureA.m_isSensor;\n              var sensorB = contact.m_fixtureB.m_isSensor;\n              if (sensorA || sensorB) {\n                continue;\n              }\n              backup.set(other.m_sweep);\n              if (other.m_islandFlag == false) {\n                other.advance(minAlpha);\n              }\n              contact.update(world);\n              if (contact.isEnabled() == false || contact.isTouching() == false) {\n                other.m_sweep.set(backup);\n                other.synchronizeTransform();\n                continue;\n              }\n              contact.m_islandFlag = true;\n              this.addContact(contact);\n              if (other.m_islandFlag) {\n                continue;\n              }\n              other.m_islandFlag = true;\n              if (!other.isStatic()) {\n                other.setAwake(true);\n              }\n              this.addBody(other);\n            }\n          }\n        }\n        s_subStep.reset((1 - minAlpha) * step.dt);\n        s_subStep.dtRatio = 1;\n        s_subStep.positionIterations = 20;\n        s_subStep.velocityIterations = step.velocityIterations;\n        s_subStep.warmStarting = false;\n        this.solveIslandTOI(s_subStep, bA, bB);\n        for (var i = 0; i < this.m_bodies.length; ++i) {\n          var body = this.m_bodies[i];\n          body.m_islandFlag = false;\n          if (!body.isDynamic()) {\n            continue;\n          }\n          body.synchronizeFixtures();\n          for (var ce = body.m_contactList; ce; ce = ce.next) {\n            ce.contact.m_toiFlag = false;\n            ce.contact.m_islandFlag = false;\n          }\n        }\n        world.findNewContacts();\n        if (world.m_subStepping) {\n          world.m_stepComplete = false;\n          break;\n        }\n      }\n    };\n    Solver2.prototype.solveIslandTOI = function(subStep, toiA, toiB) {\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(body.c_position.c, body.m_sweep.c);\n        body.c_position.a = body.m_sweep.a;\n        copyVec2(body.c_velocity.v, body.m_linearVelocity);\n        body.c_velocity.w = body.m_angularVelocity;\n      }\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.initConstraint(subStep);\n      }\n      for (var i = 0; i < subStep.positionIterations; ++i) {\n        var minSeparation = 0;\n        for (var j = 0; j < this.m_contacts.length; ++j) {\n          var contact = this.m_contacts[j];\n          var separation = contact.solvePositionConstraintTOI(subStep, toiA, toiB);\n          minSeparation = math_min$5(minSeparation, separation);\n        }\n        var contactsOkay = minSeparation >= -1.5 * SettingsInternal.linearSlop;\n        if (contactsOkay) {\n          break;\n        }\n      }\n      var i;\n      copyVec2(toiA.m_sweep.c0, toiA.c_position.c);\n      toiA.m_sweep.a0 = toiA.c_position.a;\n      copyVec2(toiB.m_sweep.c0, toiB.c_position.c);\n      toiB.m_sweep.a0 = toiB.c_position.a;\n      for (var i = 0; i < this.m_contacts.length; ++i) {\n        var contact = this.m_contacts[i];\n        contact.initVelocityConstraint(subStep);\n      }\n      for (var i = 0; i < subStep.velocityIterations; ++i) {\n        for (var j = 0; j < this.m_contacts.length; ++j) {\n          var contact = this.m_contacts[j];\n          contact.solveVelocityConstraint(subStep);\n        }\n      }\n      var h = subStep.dt;\n      for (var i = 0; i < this.m_bodies.length; ++i) {\n        var body = this.m_bodies[i];\n        copyVec2(c, body.c_position.c);\n        var a2 = body.c_position.a;\n        copyVec2(v, body.c_velocity.v);\n        var w = body.c_velocity.w;\n        scaleVec2(translation, h, v);\n        var translationLengthSqr = lengthSqrVec2(translation);\n        if (translationLengthSqr > SettingsInternal.maxTranslationSquared) {\n          var ratio = SettingsInternal.maxTranslation / math_sqrt$3(translationLengthSqr);\n          mulVec2(v, ratio);\n        }\n        var rotation2 = h * w;\n        if (rotation2 * rotation2 > SettingsInternal.maxRotationSquared) {\n          var ratio = SettingsInternal.maxRotation / math_abs$6(rotation2);\n          w *= ratio;\n        }\n        plusScaleVec2(c, h, v);\n        a2 += h * w;\n        copyVec2(body.c_position.c, c);\n        body.c_position.a = a2;\n        copyVec2(body.c_velocity.v, v);\n        body.c_velocity.w = w;\n        copyVec2(body.m_sweep.c, c);\n        body.m_sweep.a = a2;\n        copyVec2(body.m_linearVelocity, v);\n        body.m_angularVelocity = w;\n        body.synchronizeTransform();\n      }\n      this.postSolveIsland();\n    };\n    Solver2.prototype.postSolveIsland = function() {\n      for (var c_5 = 0; c_5 < this.m_contacts.length; ++c_5) {\n        var contact = this.m_contacts[c_5];\n        this.m_world.postSolve(contact, contact.m_impulse);\n      }\n    };\n    return Solver2;\n  }()\n);\nSolver.TimeStep = TimeStep;\nvar Mat22 = (\n  /** @class */\n  function() {\n    function Mat222(a2, b2, c2, d2) {\n      if (typeof a2 === \"object\" && a2 !== null) {\n        this.ex = Vec2.clone(a2);\n        this.ey = Vec2.clone(b2);\n      } else if (typeof a2 === \"number\") {\n        this.ex = Vec2.neo(a2, c2);\n        this.ey = Vec2.neo(b2, d2);\n      } else {\n        this.ex = Vec2.zero();\n        this.ey = Vec2.zero();\n      }\n    }\n    Mat222.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    Mat222.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Vec2.isValid(obj.ex) && Vec2.isValid(obj.ey);\n    };\n    Mat222.assert = function(o) {\n    };\n    Mat222.prototype.set = function(a2, b2, c2, d2) {\n      if (typeof a2 === \"number\" && typeof b2 === \"number\" && typeof c2 === \"number\" && typeof d2 === \"number\") {\n        this.ex.setNum(a2, c2);\n        this.ey.setNum(b2, d2);\n      } else if (typeof a2 === \"object\" && typeof b2 === \"object\") {\n        this.ex.setVec2(a2);\n        this.ey.setVec2(b2);\n      } else if (typeof a2 === \"object\") {\n        this.ex.setVec2(a2.ex);\n        this.ey.setVec2(a2.ey);\n      } else ;\n    };\n    Mat222.prototype.setIdentity = function() {\n      this.ex.x = 1;\n      this.ey.x = 0;\n      this.ex.y = 0;\n      this.ey.y = 1;\n    };\n    Mat222.prototype.setZero = function() {\n      this.ex.x = 0;\n      this.ey.x = 0;\n      this.ex.y = 0;\n      this.ey.y = 0;\n    };\n    Mat222.prototype.getInverse = function() {\n      var a2 = this.ex.x;\n      var b2 = this.ey.x;\n      var c2 = this.ex.y;\n      var d2 = this.ey.y;\n      var det = a2 * d2 - b2 * c2;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var imx = new Mat222();\n      imx.ex.x = det * d2;\n      imx.ey.x = -det * b2;\n      imx.ex.y = -det * c2;\n      imx.ey.y = det * a2;\n      return imx;\n    };\n    Mat222.prototype.solve = function(v3) {\n      var a2 = this.ex.x;\n      var b2 = this.ey.x;\n      var c2 = this.ex.y;\n      var d2 = this.ey.y;\n      var det = a2 * d2 - b2 * c2;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var w = Vec2.zero();\n      w.x = det * (d2 * v3.x - b2 * v3.y);\n      w.y = det * (a2 * v3.y - c2 * v3.x);\n      return w;\n    };\n    Mat222.mul = function(mx, v3) {\n      if (v3 && \"x\" in v3 && \"y\" in v3) {\n        var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;\n        var y = mx.ex.y * v3.x + mx.ey.y * v3.y;\n        return Vec2.neo(x2, y);\n      } else if (v3 && \"ex\" in v3 && \"ey\" in v3) {\n        var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;\n        var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;\n        var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;\n        var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;\n        return new Mat222(a2, b2, c2, d2);\n      }\n    };\n    Mat222.mulVec2 = function(mx, v3) {\n      var x2 = mx.ex.x * v3.x + mx.ey.x * v3.y;\n      var y = mx.ex.y * v3.x + mx.ey.y * v3.y;\n      return Vec2.neo(x2, y);\n    };\n    Mat222.mulMat22 = function(mx, v3) {\n      var a2 = mx.ex.x * v3.ex.x + mx.ey.x * v3.ex.y;\n      var b2 = mx.ex.x * v3.ey.x + mx.ey.x * v3.ey.y;\n      var c2 = mx.ex.y * v3.ex.x + mx.ey.y * v3.ex.y;\n      var d2 = mx.ex.y * v3.ey.x + mx.ey.y * v3.ey.y;\n      return new Mat222(a2, b2, c2, d2);\n    };\n    Mat222.mulT = function(mx, v3) {\n      if (v3 && \"x\" in v3 && \"y\" in v3) {\n        return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));\n      } else if (v3 && \"ex\" in v3 && \"ey\" in v3) {\n        var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));\n        var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));\n        return new Mat222(c1, c2);\n      }\n    };\n    Mat222.mulTVec2 = function(mx, v3) {\n      return Vec2.neo(Vec2.dot(v3, mx.ex), Vec2.dot(v3, mx.ey));\n    };\n    Mat222.mulTMat22 = function(mx, v3) {\n      var c1 = Vec2.neo(Vec2.dot(mx.ex, v3.ex), Vec2.dot(mx.ey, v3.ex));\n      var c2 = Vec2.neo(Vec2.dot(mx.ex, v3.ey), Vec2.dot(mx.ey, v3.ey));\n      return new Mat222(c1, c2);\n    };\n    Mat222.abs = function(mx) {\n      return new Mat222(Vec2.abs(mx.ex), Vec2.abs(mx.ey));\n    };\n    Mat222.add = function(mx1, mx2) {\n      return new Mat222(Vec2.add(mx1.ex, mx2.ex), Vec2.add(mx1.ey, mx2.ey));\n    };\n    return Mat222;\n  }()\n);\nvar math_sqrt$2 = Math.sqrt;\nvar pointA$1 = vec2(0, 0);\nvar pointB$1 = vec2(0, 0);\nvar temp$3 = vec2(0, 0);\nvar cA$1 = vec2(0, 0);\nvar cB$1 = vec2(0, 0);\nvar dist = vec2(0, 0);\nvar planePoint$2 = vec2(0, 0);\nvar clipPoint$1 = vec2(0, 0);\nvar ManifoldType;\n(function(ManifoldType2) {\n  ManifoldType2[ManifoldType2[\"e_unset\"] = -1] = \"e_unset\";\n  ManifoldType2[ManifoldType2[\"e_circles\"] = 0] = \"e_circles\";\n  ManifoldType2[ManifoldType2[\"e_faceA\"] = 1] = \"e_faceA\";\n  ManifoldType2[ManifoldType2[\"e_faceB\"] = 2] = \"e_faceB\";\n})(ManifoldType || (ManifoldType = {}));\nvar ContactFeatureType;\n(function(ContactFeatureType2) {\n  ContactFeatureType2[ContactFeatureType2[\"e_unset\"] = -1] = \"e_unset\";\n  ContactFeatureType2[ContactFeatureType2[\"e_vertex\"] = 0] = \"e_vertex\";\n  ContactFeatureType2[ContactFeatureType2[\"e_face\"] = 1] = \"e_face\";\n})(ContactFeatureType || (ContactFeatureType = {}));\nvar PointState;\n(function(PointState2) {\n  PointState2[PointState2[\"nullState\"] = 0] = \"nullState\";\n  PointState2[PointState2[\"addState\"] = 1] = \"addState\";\n  PointState2[PointState2[\"persistState\"] = 2] = \"persistState\";\n  PointState2[PointState2[\"removeState\"] = 3] = \"removeState\";\n})(PointState || (PointState = {}));\nvar ClipVertex = (\n  /** @class */\n  function() {\n    function ClipVertex2() {\n      this.v = vec2(0, 0);\n      this.id = new ContactID();\n    }\n    ClipVertex2.prototype.set = function(o) {\n      copyVec2(this.v, o.v);\n      this.id.set(o.id);\n    };\n    ClipVertex2.prototype.recycle = function() {\n      zeroVec2(this.v);\n      this.id.recycle();\n    };\n    return ClipVertex2;\n  }()\n);\nvar Manifold = (\n  /** @class */\n  function() {\n    function Manifold2() {\n      this.localNormal = vec2(0, 0);\n      this.localPoint = vec2(0, 0);\n      this.points = [new ManifoldPoint(), new ManifoldPoint()];\n      this.pointCount = 0;\n    }\n    Manifold2.prototype.set = function(that) {\n      this.type = that.type;\n      copyVec2(this.localNormal, that.localNormal);\n      copyVec2(this.localPoint, that.localPoint);\n      this.pointCount = that.pointCount;\n      this.points[0].set(that.points[0]);\n      this.points[1].set(that.points[1]);\n    };\n    Manifold2.prototype.recycle = function() {\n      this.type = ManifoldType.e_unset;\n      zeroVec2(this.localNormal);\n      zeroVec2(this.localPoint);\n      this.pointCount = 0;\n      this.points[0].recycle();\n      this.points[1].recycle();\n    };\n    Manifold2.prototype.getWorldManifold = function(wm, xfA2, radiusA, xfB2, radiusB) {\n      if (this.pointCount == 0) {\n        return wm;\n      }\n      wm = wm || new WorldManifold();\n      wm.pointCount = this.pointCount;\n      var normal3 = wm.normal;\n      var points = wm.points;\n      var separations = wm.separations;\n      switch (this.type) {\n        case ManifoldType.e_circles: {\n          setVec2(normal3, 1, 0);\n          var manifoldPoint = this.points[0];\n          transformVec2(pointA$1, xfA2, this.localPoint);\n          transformVec2(pointB$1, xfB2, manifoldPoint.localPoint);\n          subVec2(dist, pointB$1, pointA$1);\n          var lengthSqr = lengthSqrVec2(dist);\n          if (lengthSqr > EPSILON * EPSILON) {\n            var length_1 = math_sqrt$2(lengthSqr);\n            scaleVec2(normal3, 1 / length_1, dist);\n          }\n          combine2Vec2(cA$1, 1, pointA$1, radiusA, normal3);\n          combine2Vec2(cB$1, 1, pointB$1, -radiusB, normal3);\n          combine2Vec2(points[0], 0.5, cA$1, 0.5, cB$1);\n          separations[0] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);\n          break;\n        }\n        case ManifoldType.e_faceA: {\n          rotVec2(normal3, xfA2.q, this.localNormal);\n          transformVec2(planePoint$2, xfA2, this.localPoint);\n          for (var i = 0; i < this.pointCount; ++i) {\n            var manifoldPoint = this.points[i];\n            transformVec2(clipPoint$1, xfB2, manifoldPoint.localPoint);\n            combine2Vec2(cA$1, 1, clipPoint$1, radiusA - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);\n            combine2Vec2(cB$1, 1, clipPoint$1, -radiusB, normal3);\n            combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);\n            separations[i] = dotVec2(subVec2(temp$3, cB$1, cA$1), normal3);\n          }\n          break;\n        }\n        case ManifoldType.e_faceB: {\n          rotVec2(normal3, xfB2.q, this.localNormal);\n          transformVec2(planePoint$2, xfB2, this.localPoint);\n          for (var i = 0; i < this.pointCount; ++i) {\n            var manifoldPoint = this.points[i];\n            transformVec2(clipPoint$1, xfA2, manifoldPoint.localPoint);\n            combine2Vec2(cB$1, 1, clipPoint$1, radiusB - dotVec2(subVec2(temp$3, clipPoint$1, planePoint$2), normal3), normal3);\n            combine2Vec2(cA$1, 1, clipPoint$1, -radiusA, normal3);\n            combine2Vec2(points[i], 0.5, cA$1, 0.5, cB$1);\n            separations[i] = dotVec2(subVec2(temp$3, cA$1, cB$1), normal3);\n          }\n          negVec2(normal3);\n          break;\n        }\n      }\n      return wm;\n    };\n    Manifold2.clipSegmentToLine = clipSegmentToLine;\n    Manifold2.ClipVertex = ClipVertex;\n    Manifold2.getPointStates = getPointStates;\n    Manifold2.PointState = PointState;\n    return Manifold2;\n  }()\n);\nvar ManifoldPoint = (\n  /** @class */\n  function() {\n    function ManifoldPoint2() {\n      this.localPoint = vec2(0, 0);\n      this.normalImpulse = 0;\n      this.tangentImpulse = 0;\n      this.id = new ContactID();\n    }\n    ManifoldPoint2.prototype.set = function(that) {\n      copyVec2(this.localPoint, that.localPoint);\n      this.normalImpulse = that.normalImpulse;\n      this.tangentImpulse = that.tangentImpulse;\n      this.id.set(that.id);\n    };\n    ManifoldPoint2.prototype.recycle = function() {\n      zeroVec2(this.localPoint);\n      this.normalImpulse = 0;\n      this.tangentImpulse = 0;\n      this.id.recycle();\n    };\n    return ManifoldPoint2;\n  }()\n);\nvar ContactID = (\n  /** @class */\n  function() {\n    function ContactID2() {\n      this.key = -1;\n      this.indexA = -1;\n      this.indexB = -1;\n      this.typeA = ContactFeatureType.e_unset;\n      this.typeB = ContactFeatureType.e_unset;\n    }\n    ContactID2.prototype.setFeatures = function(indexA, typeA, indexB, typeB) {\n      this.indexA = indexA;\n      this.indexB = indexB;\n      this.typeA = typeA;\n      this.typeB = typeB;\n      this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;\n    };\n    ContactID2.prototype.set = function(that) {\n      this.indexA = that.indexA;\n      this.indexB = that.indexB;\n      this.typeA = that.typeA;\n      this.typeB = that.typeB;\n      this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;\n    };\n    ContactID2.prototype.swapFeatures = function() {\n      var indexA = this.indexA;\n      var indexB = this.indexB;\n      var typeA = this.typeA;\n      var typeB = this.typeB;\n      this.indexA = indexB;\n      this.indexB = indexA;\n      this.typeA = typeB;\n      this.typeB = typeA;\n      this.key = this.indexA + this.indexB * 4 + this.typeA * 16 + this.typeB * 64;\n    };\n    ContactID2.prototype.recycle = function() {\n      this.indexA = 0;\n      this.indexB = 0;\n      this.typeA = ContactFeatureType.e_unset;\n      this.typeB = ContactFeatureType.e_unset;\n      this.key = -1;\n    };\n    return ContactID2;\n  }()\n);\nvar WorldManifold = (\n  /** @class */\n  function() {\n    function WorldManifold2() {\n      this.normal = vec2(0, 0);\n      this.points = [vec2(0, 0), vec2(0, 0)];\n      this.separations = [0, 0];\n      this.pointCount = 0;\n    }\n    WorldManifold2.prototype.recycle = function() {\n      zeroVec2(this.normal);\n      zeroVec2(this.points[0]);\n      zeroVec2(this.points[1]);\n      this.separations[0] = 0;\n      this.separations[1] = 0;\n      this.pointCount = 0;\n    };\n    return WorldManifold2;\n  }()\n);\nfunction getPointStates(state1, state2, manifold1, manifold2) {\n  for (var i = 0; i < manifold1.pointCount; ++i) {\n    var id = manifold1.points[i].id;\n    state1[i] = PointState.removeState;\n    for (var j = 0; j < manifold2.pointCount; ++j) {\n      if (manifold2.points[j].id.key === id.key) {\n        state1[i] = PointState.persistState;\n        break;\n      }\n    }\n  }\n  for (var i = 0; i < manifold2.pointCount; ++i) {\n    var id = manifold2.points[i].id;\n    state2[i] = PointState.addState;\n    for (var j = 0; j < manifold1.pointCount; ++j) {\n      if (manifold1.points[j].id.key === id.key) {\n        state2[i] = PointState.persistState;\n        break;\n      }\n    }\n  }\n}\nfunction clipSegmentToLine(vOut, vIn, normal3, offset, vertexIndexA) {\n  var numOut = 0;\n  var distance0 = dotVec2(normal3, vIn[0].v) - offset;\n  var distance1 = dotVec2(normal3, vIn[1].v) - offset;\n  if (distance0 <= 0)\n    vOut[numOut++].set(vIn[0]);\n  if (distance1 <= 0)\n    vOut[numOut++].set(vIn[1]);\n  if (distance0 * distance1 < 0) {\n    var interp = distance0 / (distance0 - distance1);\n    combine2Vec2(vOut[numOut].v, 1 - interp, vIn[0].v, interp, vIn[1].v);\n    vOut[numOut].id.setFeatures(vertexIndexA, ContactFeatureType.e_vertex, vIn[0].id.indexB, ContactFeatureType.e_face);\n    ++numOut;\n  }\n  return numOut;\n}\nvar math_sqrt$1 = Math.sqrt;\nvar math_max$2 = Math.max;\nvar math_min$4 = Math.min;\nvar contactPool = new Pool({\n  create: function() {\n    return new Contact();\n  },\n  release: function(contact) {\n    contact.recycle();\n  }\n});\nvar oldManifold = new Manifold();\nvar worldManifold = new WorldManifold();\nvar ContactEdge = (\n  /** @class */\n  function() {\n    function ContactEdge2(contact) {\n      this.prev = null;\n      this.next = null;\n      this.other = null;\n      this.contact = contact;\n    }\n    ContactEdge2.prototype.recycle = function() {\n      this.prev = null;\n      this.next = null;\n      this.other = null;\n    };\n    return ContactEdge2;\n  }()\n);\nfunction mixFriction(friction1, friction2) {\n  return math_sqrt$1(friction1 * friction2);\n}\nfunction mixRestitution(restitution1, restitution2) {\n  return restitution1 > restitution2 ? restitution1 : restitution2;\n}\nvar s_registers = [];\nvar VelocityConstraintPoint = (\n  /** @class */\n  function() {\n    function VelocityConstraintPoint2() {\n      this.rA = vec2(0, 0);\n      this.rB = vec2(0, 0);\n      this.normalImpulse = 0;\n      this.tangentImpulse = 0;\n      this.normalMass = 0;\n      this.tangentMass = 0;\n      this.velocityBias = 0;\n    }\n    VelocityConstraintPoint2.prototype.recycle = function() {\n      zeroVec2(this.rA);\n      zeroVec2(this.rB);\n      this.normalImpulse = 0;\n      this.tangentImpulse = 0;\n      this.normalMass = 0;\n      this.tangentMass = 0;\n      this.velocityBias = 0;\n    };\n    return VelocityConstraintPoint2;\n  }()\n);\nvar cA = vec2(0, 0);\nvar vA = vec2(0, 0);\nvar cB = vec2(0, 0);\nvar vB = vec2(0, 0);\nvar tangent$1 = vec2(0, 0);\nvar xfA = transform(0, 0, 0);\nvar xfB = transform(0, 0, 0);\nvar pointA = vec2(0, 0);\nvar pointB = vec2(0, 0);\nvar clipPoint = vec2(0, 0);\nvar planePoint$1 = vec2(0, 0);\nvar rA = vec2(0, 0);\nvar rB = vec2(0, 0);\nvar P$1 = vec2(0, 0);\nvar normal$2 = vec2(0, 0);\nvar point = vec2(0, 0);\nvar dv = vec2(0, 0);\nvar dv1 = vec2(0, 0);\nvar dv2 = vec2(0, 0);\nvar b = vec2(0, 0);\nvar a = vec2(0, 0);\nvar x = vec2(0, 0);\nvar d = vec2(0, 0);\nvar P1 = vec2(0, 0);\nvar P2 = vec2(0, 0);\nvar temp$2 = vec2(0, 0);\nvar Contact = (\n  /** @class */\n  function() {\n    function Contact2() {\n      this.m_nodeA = new ContactEdge(this);\n      this.m_nodeB = new ContactEdge(this);\n      this.m_fixtureA = null;\n      this.m_fixtureB = null;\n      this.m_indexA = -1;\n      this.m_indexB = -1;\n      this.m_evaluateFcn = null;\n      this.m_manifold = new Manifold();\n      this.m_prev = null;\n      this.m_next = null;\n      this.m_toi = 1;\n      this.m_toiCount = 0;\n      this.m_toiFlag = false;\n      this.m_friction = 0;\n      this.m_restitution = 0;\n      this.m_tangentSpeed = 0;\n      this.m_enabledFlag = true;\n      this.m_islandFlag = false;\n      this.m_touchingFlag = false;\n      this.m_filterFlag = false;\n      this.m_bulletHitFlag = false;\n      this.m_impulse = new ContactImpulse(this);\n      this.v_points = [new VelocityConstraintPoint(), new VelocityConstraintPoint()];\n      this.v_normal = vec2(0, 0);\n      this.v_normalMass = new Mat22();\n      this.v_K = new Mat22();\n      this.v_pointCount = 0;\n      this.v_tangentSpeed = 0;\n      this.v_friction = 0;\n      this.v_restitution = 0;\n      this.v_invMassA = 0;\n      this.v_invMassB = 0;\n      this.v_invIA = 0;\n      this.v_invIB = 0;\n      this.p_localPoints = [vec2(0, 0), vec2(0, 0)];\n      this.p_localNormal = vec2(0, 0);\n      this.p_localPoint = vec2(0, 0);\n      this.p_localCenterA = vec2(0, 0);\n      this.p_localCenterB = vec2(0, 0);\n      this.p_type = ManifoldType.e_unset;\n      this.p_radiusA = 0;\n      this.p_radiusB = 0;\n      this.p_pointCount = 0;\n      this.p_invMassA = 0;\n      this.p_invMassB = 0;\n      this.p_invIA = 0;\n      this.p_invIB = 0;\n    }\n    Contact2.prototype.initialize = function(fA, indexA, fB, indexB, evaluateFcn) {\n      this.m_fixtureA = fA;\n      this.m_fixtureB = fB;\n      this.m_indexA = indexA;\n      this.m_indexB = indexB;\n      this.m_evaluateFcn = evaluateFcn;\n      this.m_friction = mixFriction(this.m_fixtureA.m_friction, this.m_fixtureB.m_friction);\n      this.m_restitution = mixRestitution(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution);\n    };\n    Contact2.prototype.recycle = function() {\n      this.m_nodeA.recycle();\n      this.m_nodeB.recycle();\n      this.m_fixtureA = null;\n      this.m_fixtureB = null;\n      this.m_indexA = -1;\n      this.m_indexB = -1;\n      this.m_evaluateFcn = null;\n      this.m_manifold.recycle();\n      this.m_prev = null;\n      this.m_next = null;\n      this.m_toi = 1;\n      this.m_toiCount = 0;\n      this.m_toiFlag = false;\n      this.m_friction = 0;\n      this.m_restitution = 0;\n      this.m_tangentSpeed = 0;\n      this.m_enabledFlag = true;\n      this.m_islandFlag = false;\n      this.m_touchingFlag = false;\n      this.m_filterFlag = false;\n      this.m_bulletHitFlag = false;\n      this.m_impulse.recycle();\n      for (var _i = 0, _a2 = this.v_points; _i < _a2.length; _i++) {\n        var point_1 = _a2[_i];\n        point_1.recycle();\n      }\n      zeroVec2(this.v_normal);\n      this.v_normalMass.setZero();\n      this.v_K.setZero();\n      this.v_pointCount = 0;\n      this.v_tangentSpeed = 0;\n      this.v_friction = 0;\n      this.v_restitution = 0;\n      this.v_invMassA = 0;\n      this.v_invMassB = 0;\n      this.v_invIA = 0;\n      this.v_invIB = 0;\n      for (var _b = 0, _c = this.p_localPoints; _b < _c.length; _b++) {\n        var point_2 = _c[_b];\n        zeroVec2(point_2);\n      }\n      zeroVec2(this.p_localNormal);\n      zeroVec2(this.p_localPoint);\n      zeroVec2(this.p_localCenterA);\n      zeroVec2(this.p_localCenterB);\n      this.p_type = ManifoldType.e_unset;\n      this.p_radiusA = 0;\n      this.p_radiusB = 0;\n      this.p_pointCount = 0;\n      this.p_invMassA = 0;\n      this.p_invMassB = 0;\n      this.p_invIA = 0;\n      this.p_invIB = 0;\n    };\n    Contact2.prototype.initConstraint = function(step) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var shapeA = fixtureA.m_shape;\n      var shapeB = fixtureB.m_shape;\n      if (shapeA === null || shapeB === null)\n        return;\n      var manifold = this.m_manifold;\n      var pointCount = manifold.pointCount;\n      this.v_invMassA = bodyA.m_invMass;\n      this.v_invMassB = bodyB.m_invMass;\n      this.v_invIA = bodyA.m_invI;\n      this.v_invIB = bodyB.m_invI;\n      this.v_friction = this.m_friction;\n      this.v_restitution = this.m_restitution;\n      this.v_tangentSpeed = this.m_tangentSpeed;\n      this.v_pointCount = pointCount;\n      this.v_K.setZero();\n      this.v_normalMass.setZero();\n      this.p_invMassA = bodyA.m_invMass;\n      this.p_invMassB = bodyB.m_invMass;\n      this.p_invIA = bodyA.m_invI;\n      this.p_invIB = bodyB.m_invI;\n      copyVec2(this.p_localCenterA, bodyA.m_sweep.localCenter);\n      copyVec2(this.p_localCenterB, bodyB.m_sweep.localCenter);\n      this.p_radiusA = shapeA.m_radius;\n      this.p_radiusB = shapeB.m_radius;\n      this.p_type = manifold.type;\n      copyVec2(this.p_localNormal, manifold.localNormal);\n      copyVec2(this.p_localPoint, manifold.localPoint);\n      this.p_pointCount = pointCount;\n      for (var j = 0; j < SettingsInternal.maxManifoldPoints; ++j) {\n        this.v_points[j].recycle();\n        zeroVec2(this.p_localPoints[j]);\n      }\n      for (var j = 0; j < pointCount; ++j) {\n        var cp = manifold.points[j];\n        var vcp = this.v_points[j];\n        if (step.warmStarting) {\n          vcp.normalImpulse = step.dtRatio * cp.normalImpulse;\n          vcp.tangentImpulse = step.dtRatio * cp.tangentImpulse;\n        }\n        copyVec2(this.p_localPoints[j], cp.localPoint);\n      }\n    };\n    Contact2.prototype.getManifold = function() {\n      return this.m_manifold;\n    };\n    Contact2.prototype.getWorldManifold = function(worldManifold2) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var shapeA = fixtureA.m_shape;\n      var shapeB = fixtureB.m_shape;\n      if (shapeA === null || shapeB === null)\n        return;\n      return this.m_manifold.getWorldManifold(worldManifold2, bodyA.getTransform(), shapeA.m_radius, bodyB.getTransform(), shapeB.m_radius);\n    };\n    Contact2.prototype.setEnabled = function(flag) {\n      this.m_enabledFlag = !!flag;\n    };\n    Contact2.prototype.isEnabled = function() {\n      return this.m_enabledFlag;\n    };\n    Contact2.prototype.isTouching = function() {\n      return this.m_touchingFlag;\n    };\n    Contact2.prototype.getNext = function() {\n      return this.m_next;\n    };\n    Contact2.prototype.getFixtureA = function() {\n      return this.m_fixtureA;\n    };\n    Contact2.prototype.getFixtureB = function() {\n      return this.m_fixtureB;\n    };\n    Contact2.prototype.getChildIndexA = function() {\n      return this.m_indexA;\n    };\n    Contact2.prototype.getChildIndexB = function() {\n      return this.m_indexB;\n    };\n    Contact2.prototype.flagForFiltering = function() {\n      this.m_filterFlag = true;\n    };\n    Contact2.prototype.setFriction = function(friction) {\n      this.m_friction = friction;\n    };\n    Contact2.prototype.getFriction = function() {\n      return this.m_friction;\n    };\n    Contact2.prototype.resetFriction = function() {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      this.m_friction = mixFriction(fixtureA.m_friction, fixtureB.m_friction);\n    };\n    Contact2.prototype.setRestitution = function(restitution) {\n      this.m_restitution = restitution;\n    };\n    Contact2.prototype.getRestitution = function() {\n      return this.m_restitution;\n    };\n    Contact2.prototype.resetRestitution = function() {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      this.m_restitution = mixRestitution(fixtureA.m_restitution, fixtureB.m_restitution);\n    };\n    Contact2.prototype.setTangentSpeed = function(speed) {\n      this.m_tangentSpeed = speed;\n    };\n    Contact2.prototype.getTangentSpeed = function() {\n      return this.m_tangentSpeed;\n    };\n    Contact2.prototype.evaluate = function(manifold, xfA2, xfB2) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      this.m_evaluateFcn(manifold, xfA2, fixtureA, this.m_indexA, xfB2, fixtureB, this.m_indexB);\n    };\n    Contact2.prototype.update = function(listener) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var shapeA = fixtureA.m_shape;\n      var shapeB = fixtureB.m_shape;\n      if (shapeA === null || shapeB === null)\n        return;\n      this.m_enabledFlag = true;\n      var touching = false;\n      var wasTouching = this.m_touchingFlag;\n      var sensorA = fixtureA.m_isSensor;\n      var sensorB = fixtureB.m_isSensor;\n      var sensor = sensorA || sensorB;\n      var xfA2 = bodyA.m_xf;\n      var xfB2 = bodyB.m_xf;\n      if (sensor) {\n        touching = testOverlap(shapeA, this.m_indexA, shapeB, this.m_indexB, xfA2, xfB2);\n        this.m_manifold.pointCount = 0;\n      } else {\n        oldManifold.recycle();\n        oldManifold.set(this.m_manifold);\n        this.m_manifold.recycle();\n        this.evaluate(this.m_manifold, xfA2, xfB2);\n        touching = this.m_manifold.pointCount > 0;\n        for (var i = 0; i < this.m_manifold.pointCount; ++i) {\n          var nmp = this.m_manifold.points[i];\n          nmp.normalImpulse = 0;\n          nmp.tangentImpulse = 0;\n          for (var j = 0; j < oldManifold.pointCount; ++j) {\n            var omp = oldManifold.points[j];\n            if (omp.id.key === nmp.id.key) {\n              nmp.normalImpulse = omp.normalImpulse;\n              nmp.tangentImpulse = omp.tangentImpulse;\n              break;\n            }\n          }\n        }\n        if (touching !== wasTouching) {\n          bodyA.setAwake(true);\n          bodyB.setAwake(true);\n        }\n      }\n      this.m_touchingFlag = touching;\n      var hasListener = typeof listener === \"object\" && listener !== null;\n      if (!wasTouching && touching && hasListener) {\n        listener.beginContact(this);\n      }\n      if (wasTouching && !touching && hasListener) {\n        listener.endContact(this);\n      }\n      if (!sensor && touching && hasListener && oldManifold) {\n        listener.preSolve(this, oldManifold);\n      }\n    };\n    Contact2.prototype.solvePositionConstraint = function(step) {\n      return this._solvePositionConstraint(step, null, null);\n    };\n    Contact2.prototype.solvePositionConstraintTOI = function(step, toiA, toiB) {\n      return this._solvePositionConstraint(step, toiA, toiB);\n    };\n    Contact2.prototype._solvePositionConstraint = function(step, toiA, toiB) {\n      var toi = toiA !== null && toiB !== null ? true : false;\n      var minSeparation = 0;\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return minSeparation;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return minSeparation;\n      var positionA = bodyA.c_position;\n      var positionB = bodyB.c_position;\n      var localCenterA = this.p_localCenterA;\n      var localCenterB = this.p_localCenterB;\n      var mA = 0;\n      var iA = 0;\n      if (!toi || bodyA === toiA || bodyA === toiB) {\n        mA = this.p_invMassA;\n        iA = this.p_invIA;\n      }\n      var mB = 0;\n      var iB = 0;\n      if (!toi || bodyB === toiA || bodyB === toiB) {\n        mB = this.p_invMassB;\n        iB = this.p_invIB;\n      }\n      copyVec2(cA, positionA.c);\n      var aA = positionA.a;\n      copyVec2(cB, positionB.c);\n      var aB = positionB.a;\n      for (var j = 0; j < this.p_pointCount; ++j) {\n        getTransform(xfA, localCenterA, cA, aA);\n        getTransform(xfB, localCenterB, cB, aB);\n        var separation = void 0;\n        switch (this.p_type) {\n          case ManifoldType.e_circles: {\n            transformVec2(pointA, xfA, this.p_localPoint);\n            transformVec2(pointB, xfB, this.p_localPoints[0]);\n            subVec2(normal$2, pointB, pointA);\n            normalizeVec2(normal$2);\n            combine2Vec2(point, 0.5, pointA, 0.5, pointB);\n            separation = dotVec2(pointB, normal$2) - dotVec2(pointA, normal$2) - this.p_radiusA - this.p_radiusB;\n            break;\n          }\n          case ManifoldType.e_faceA: {\n            rotVec2(normal$2, xfA.q, this.p_localNormal);\n            transformVec2(planePoint$1, xfA, this.p_localPoint);\n            transformVec2(clipPoint, xfB, this.p_localPoints[j]);\n            separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;\n            copyVec2(point, clipPoint);\n            break;\n          }\n          case ManifoldType.e_faceB: {\n            rotVec2(normal$2, xfB.q, this.p_localNormal);\n            transformVec2(planePoint$1, xfB, this.p_localPoint);\n            transformVec2(clipPoint, xfA, this.p_localPoints[j]);\n            separation = dotVec2(clipPoint, normal$2) - dotVec2(planePoint$1, normal$2) - this.p_radiusA - this.p_radiusB;\n            copyVec2(point, clipPoint);\n            negVec2(normal$2);\n            break;\n          }\n          default: {\n            return minSeparation;\n          }\n        }\n        subVec2(rA, point, cA);\n        subVec2(rB, point, cB);\n        minSeparation = math_min$4(minSeparation, separation);\n        var baumgarte = toi ? SettingsInternal.toiBaugarte : SettingsInternal.baumgarte;\n        var linearSlop = SettingsInternal.linearSlop;\n        var maxLinearCorrection = SettingsInternal.maxLinearCorrection;\n        var C = clamp(baumgarte * (separation + linearSlop), -maxLinearCorrection, 0);\n        var rnA = crossVec2Vec2(rA, normal$2);\n        var rnB = crossVec2Vec2(rB, normal$2);\n        var K = mA + mB + iA * rnA * rnA + iB * rnB * rnB;\n        var impulse = K > 0 ? -C / K : 0;\n        scaleVec2(P$1, impulse, normal$2);\n        minusScaleVec2(cA, mA, P$1);\n        aA -= iA * crossVec2Vec2(rA, P$1);\n        plusScaleVec2(cB, mB, P$1);\n        aB += iB * crossVec2Vec2(rB, P$1);\n      }\n      copyVec2(positionA.c, cA);\n      positionA.a = aA;\n      copyVec2(positionB.c, cB);\n      positionB.a = aB;\n      return minSeparation;\n    };\n    Contact2.prototype.initVelocityConstraint = function(step) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var velocityA = bodyA.c_velocity;\n      var velocityB = bodyB.c_velocity;\n      var positionA = bodyA.c_position;\n      var positionB = bodyB.c_position;\n      var radiusA = this.p_radiusA;\n      var radiusB = this.p_radiusB;\n      var manifold = this.m_manifold;\n      var mA = this.v_invMassA;\n      var mB = this.v_invMassB;\n      var iA = this.v_invIA;\n      var iB = this.v_invIB;\n      var localCenterA = this.p_localCenterA;\n      var localCenterB = this.p_localCenterB;\n      copyVec2(cA, positionA.c);\n      var aA = positionA.a;\n      copyVec2(vA, velocityA.v);\n      var wA = velocityA.w;\n      copyVec2(cB, positionB.c);\n      var aB = positionB.a;\n      copyVec2(vB, velocityB.v);\n      var wB = velocityB.w;\n      getTransform(xfA, localCenterA, cA, aA);\n      getTransform(xfB, localCenterB, cB, aB);\n      worldManifold.recycle();\n      manifold.getWorldManifold(worldManifold, xfA, radiusA, xfB, radiusB);\n      copyVec2(this.v_normal, worldManifold.normal);\n      for (var j = 0; j < this.v_pointCount; ++j) {\n        var vcp = this.v_points[j];\n        var wmp = worldManifold.points[j];\n        subVec2(vcp.rA, wmp, cA);\n        subVec2(vcp.rB, wmp, cB);\n        var rnA = crossVec2Vec2(vcp.rA, this.v_normal);\n        var rnB = crossVec2Vec2(vcp.rB, this.v_normal);\n        var kNormal = mA + mB + iA * rnA * rnA + iB * rnB * rnB;\n        vcp.normalMass = kNormal > 0 ? 1 / kNormal : 0;\n        crossVec2Num(tangent$1, this.v_normal, 1);\n        var rtA = crossVec2Vec2(vcp.rA, tangent$1);\n        var rtB = crossVec2Vec2(vcp.rB, tangent$1);\n        var kTangent = mA + mB + iA * rtA * rtA + iB * rtB * rtB;\n        vcp.tangentMass = kTangent > 0 ? 1 / kTangent : 0;\n        vcp.velocityBias = 0;\n        var vRel = 0;\n        vRel += dotVec2(this.v_normal, vB);\n        vRel += dotVec2(this.v_normal, crossNumVec2(temp$2, wB, vcp.rB));\n        vRel -= dotVec2(this.v_normal, vA);\n        vRel -= dotVec2(this.v_normal, crossNumVec2(temp$2, wA, vcp.rA));\n        if (vRel < -SettingsInternal.velocityThreshold) {\n          vcp.velocityBias = -this.v_restitution * vRel;\n        }\n      }\n      if (this.v_pointCount == 2 && step.blockSolve) {\n        var vcp1 = this.v_points[0];\n        var vcp2 = this.v_points[1];\n        var rn1A = crossVec2Vec2(vcp1.rA, this.v_normal);\n        var rn1B = crossVec2Vec2(vcp1.rB, this.v_normal);\n        var rn2A = crossVec2Vec2(vcp2.rA, this.v_normal);\n        var rn2B = crossVec2Vec2(vcp2.rB, this.v_normal);\n        var k11 = mA + mB + iA * rn1A * rn1A + iB * rn1B * rn1B;\n        var k22 = mA + mB + iA * rn2A * rn2A + iB * rn2B * rn2B;\n        var k12 = mA + mB + iA * rn1A * rn2A + iB * rn1B * rn2B;\n        var k_maxConditionNumber = 1e3;\n        if (k11 * k11 < k_maxConditionNumber * (k11 * k22 - k12 * k12)) {\n          this.v_K.ex.setNum(k11, k12);\n          this.v_K.ey.setNum(k12, k22);\n          var a_1 = this.v_K.ex.x;\n          var b_1 = this.v_K.ey.x;\n          var c2 = this.v_K.ex.y;\n          var d_1 = this.v_K.ey.y;\n          var det = a_1 * d_1 - b_1 * c2;\n          if (det !== 0) {\n            det = 1 / det;\n          }\n          this.v_normalMass.ex.x = det * d_1;\n          this.v_normalMass.ey.x = -det * b_1;\n          this.v_normalMass.ex.y = -det * c2;\n          this.v_normalMass.ey.y = det * a_1;\n        } else {\n          this.v_pointCount = 1;\n        }\n      }\n      copyVec2(positionA.c, cA);\n      positionA.a = aA;\n      copyVec2(velocityA.v, vA);\n      velocityA.w = wA;\n      copyVec2(positionB.c, cB);\n      positionB.a = aB;\n      copyVec2(velocityB.v, vB);\n      velocityB.w = wB;\n    };\n    Contact2.prototype.warmStartConstraint = function(step) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var velocityA = bodyA.c_velocity;\n      var velocityB = bodyB.c_velocity;\n      var mA = this.v_invMassA;\n      var iA = this.v_invIA;\n      var mB = this.v_invMassB;\n      var iB = this.v_invIB;\n      copyVec2(vA, velocityA.v);\n      var wA = velocityA.w;\n      copyVec2(vB, velocityB.v);\n      var wB = velocityB.w;\n      copyVec2(normal$2, this.v_normal);\n      crossVec2Num(tangent$1, normal$2, 1);\n      for (var j = 0; j < this.v_pointCount; ++j) {\n        var vcp = this.v_points[j];\n        combine2Vec2(P$1, vcp.normalImpulse, normal$2, vcp.tangentImpulse, tangent$1);\n        wA -= iA * crossVec2Vec2(vcp.rA, P$1);\n        minusScaleVec2(vA, mA, P$1);\n        wB += iB * crossVec2Vec2(vcp.rB, P$1);\n        plusScaleVec2(vB, mB, P$1);\n      }\n      copyVec2(velocityA.v, vA);\n      velocityA.w = wA;\n      copyVec2(velocityB.v, vB);\n      velocityB.w = wB;\n    };\n    Contact2.prototype.storeConstraintImpulses = function(step) {\n      var manifold = this.m_manifold;\n      for (var j = 0; j < this.v_pointCount; ++j) {\n        manifold.points[j].normalImpulse = this.v_points[j].normalImpulse;\n        manifold.points[j].tangentImpulse = this.v_points[j].tangentImpulse;\n      }\n    };\n    Contact2.prototype.solveVelocityConstraint = function(step) {\n      var fixtureA = this.m_fixtureA;\n      var fixtureB = this.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      var velocityA = bodyA.c_velocity;\n      var velocityB = bodyB.c_velocity;\n      var mA = this.v_invMassA;\n      var iA = this.v_invIA;\n      var mB = this.v_invMassB;\n      var iB = this.v_invIB;\n      copyVec2(vA, velocityA.v);\n      var wA = velocityA.w;\n      copyVec2(vB, velocityB.v);\n      var wB = velocityB.w;\n      copyVec2(normal$2, this.v_normal);\n      crossVec2Num(tangent$1, normal$2, 1);\n      var friction = this.v_friction;\n      for (var j = 0; j < this.v_pointCount; ++j) {\n        var vcp = this.v_points[j];\n        zeroVec2(dv);\n        plusVec2(dv, vB);\n        plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));\n        minusVec2(dv, vA);\n        minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));\n        var vt = dotVec2(dv, tangent$1) - this.v_tangentSpeed;\n        var lambda = vcp.tangentMass * -vt;\n        var maxFriction = friction * vcp.normalImpulse;\n        var newImpulse = clamp(vcp.tangentImpulse + lambda, -maxFriction, maxFriction);\n        lambda = newImpulse - vcp.tangentImpulse;\n        vcp.tangentImpulse = newImpulse;\n        scaleVec2(P$1, lambda, tangent$1);\n        minusScaleVec2(vA, mA, P$1);\n        wA -= iA * crossVec2Vec2(vcp.rA, P$1);\n        plusScaleVec2(vB, mB, P$1);\n        wB += iB * crossVec2Vec2(vcp.rB, P$1);\n      }\n      if (this.v_pointCount == 1 || step.blockSolve == false) {\n        for (var i = 0; i < this.v_pointCount; ++i) {\n          var vcp = this.v_points[i];\n          zeroVec2(dv);\n          plusVec2(dv, vB);\n          plusVec2(dv, crossNumVec2(temp$2, wB, vcp.rB));\n          minusVec2(dv, vA);\n          minusVec2(dv, crossNumVec2(temp$2, wA, vcp.rA));\n          var vn = dotVec2(dv, normal$2);\n          var lambda = -vcp.normalMass * (vn - vcp.velocityBias);\n          var newImpulse = math_max$2(vcp.normalImpulse + lambda, 0);\n          lambda = newImpulse - vcp.normalImpulse;\n          vcp.normalImpulse = newImpulse;\n          scaleVec2(P$1, lambda, normal$2);\n          minusScaleVec2(vA, mA, P$1);\n          wA -= iA * crossVec2Vec2(vcp.rA, P$1);\n          plusScaleVec2(vB, mB, P$1);\n          wB += iB * crossVec2Vec2(vcp.rB, P$1);\n        }\n      } else {\n        var vcp1 = this.v_points[0];\n        var vcp2 = this.v_points[1];\n        setVec2(a, vcp1.normalImpulse, vcp2.normalImpulse);\n        zeroVec2(dv1);\n        plusVec2(dv1, vB);\n        plusVec2(dv1, crossNumVec2(temp$2, wB, vcp1.rB));\n        minusVec2(dv1, vA);\n        minusVec2(dv1, crossNumVec2(temp$2, wA, vcp1.rA));\n        zeroVec2(dv2);\n        plusVec2(dv2, vB);\n        plusVec2(dv2, crossNumVec2(temp$2, wB, vcp2.rB));\n        minusVec2(dv2, vA);\n        minusVec2(dv2, crossNumVec2(temp$2, wA, vcp2.rA));\n        var vn1 = dotVec2(dv1, normal$2);\n        var vn2 = dotVec2(dv2, normal$2);\n        setVec2(b, vn1 - vcp1.velocityBias, vn2 - vcp2.velocityBias);\n        b.x -= this.v_K.ex.x * a.x + this.v_K.ey.x * a.y;\n        b.y -= this.v_K.ex.y * a.x + this.v_K.ey.y * a.y;\n        while (true) {\n          zeroVec2(x);\n          x.x = -(this.v_normalMass.ex.x * b.x + this.v_normalMass.ey.x * b.y);\n          x.y = -(this.v_normalMass.ex.y * b.x + this.v_normalMass.ey.y * b.y);\n          if (x.x >= 0 && x.y >= 0) {\n            subVec2(d, x, a);\n            scaleVec2(P1, d.x, normal$2);\n            scaleVec2(P2, d.y, normal$2);\n            combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);\n            wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));\n            combine3Vec2(vB, mB, P1, mB, P2, 1, vB);\n            wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));\n            vcp1.normalImpulse = x.x;\n            vcp2.normalImpulse = x.y;\n            break;\n          }\n          x.x = -vcp1.normalMass * b.x;\n          x.y = 0;\n          vn1 = 0;\n          vn2 = this.v_K.ex.y * x.x + b.y;\n          if (x.x >= 0 && vn2 >= 0) {\n            subVec2(d, x, a);\n            scaleVec2(P1, d.x, normal$2);\n            scaleVec2(P2, d.y, normal$2);\n            combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);\n            wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));\n            combine3Vec2(vB, mB, P1, mB, P2, 1, vB);\n            wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));\n            vcp1.normalImpulse = x.x;\n            vcp2.normalImpulse = x.y;\n            break;\n          }\n          x.x = 0;\n          x.y = -vcp2.normalMass * b.y;\n          vn1 = this.v_K.ey.x * x.y + b.x;\n          vn2 = 0;\n          if (x.y >= 0 && vn1 >= 0) {\n            subVec2(d, x, a);\n            scaleVec2(P1, d.x, normal$2);\n            scaleVec2(P2, d.y, normal$2);\n            combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);\n            wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));\n            combine3Vec2(vB, mB, P1, mB, P2, 1, vB);\n            wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));\n            vcp1.normalImpulse = x.x;\n            vcp2.normalImpulse = x.y;\n            break;\n          }\n          x.x = 0;\n          x.y = 0;\n          vn1 = b.x;\n          vn2 = b.y;\n          if (vn1 >= 0 && vn2 >= 0) {\n            subVec2(d, x, a);\n            scaleVec2(P1, d.x, normal$2);\n            scaleVec2(P2, d.y, normal$2);\n            combine3Vec2(vA, -mA, P1, -mA, P2, 1, vA);\n            wA -= iA * (crossVec2Vec2(vcp1.rA, P1) + crossVec2Vec2(vcp2.rA, P2));\n            combine3Vec2(vB, mB, P1, mB, P2, 1, vB);\n            wB += iB * (crossVec2Vec2(vcp1.rB, P1) + crossVec2Vec2(vcp2.rB, P2));\n            vcp1.normalImpulse = x.x;\n            vcp2.normalImpulse = x.y;\n            break;\n          }\n          break;\n        }\n      }\n      copyVec2(velocityA.v, vA);\n      velocityA.w = wA;\n      copyVec2(velocityB.v, vB);\n      velocityB.w = wB;\n    };\n    Contact2.addType = function(type1, type2, callback) {\n      s_registers[type1] = s_registers[type1] || {};\n      s_registers[type1][type2] = callback;\n    };\n    Contact2.create = function(fixtureA, indexA, fixtureB, indexB) {\n      var typeA = fixtureA.m_shape.m_type;\n      var typeB = fixtureB.m_shape.m_type;\n      var contact = contactPool.allocate();\n      var evaluateFcn;\n      if (evaluateFcn = s_registers[typeA] && s_registers[typeA][typeB]) {\n        contact.initialize(fixtureA, indexA, fixtureB, indexB, evaluateFcn);\n      } else if (evaluateFcn = s_registers[typeB] && s_registers[typeB][typeA]) {\n        contact.initialize(fixtureB, indexB, fixtureA, indexA, evaluateFcn);\n      } else {\n        return null;\n      }\n      fixtureA = contact.m_fixtureA;\n      fixtureB = contact.m_fixtureB;\n      indexA = contact.getChildIndexA();\n      indexB = contact.getChildIndexB();\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      contact.m_nodeA.contact = contact;\n      contact.m_nodeA.other = bodyB;\n      contact.m_nodeA.prev = null;\n      contact.m_nodeA.next = bodyA.m_contactList;\n      if (bodyA.m_contactList != null) {\n        bodyA.m_contactList.prev = contact.m_nodeA;\n      }\n      bodyA.m_contactList = contact.m_nodeA;\n      contact.m_nodeB.contact = contact;\n      contact.m_nodeB.other = bodyA;\n      contact.m_nodeB.prev = null;\n      contact.m_nodeB.next = bodyB.m_contactList;\n      if (bodyB.m_contactList != null) {\n        bodyB.m_contactList.prev = contact.m_nodeB;\n      }\n      bodyB.m_contactList = contact.m_nodeB;\n      if (fixtureA.isSensor() == false && fixtureB.isSensor() == false) {\n        bodyA.setAwake(true);\n        bodyB.setAwake(true);\n      }\n      return contact;\n    };\n    Contact2.destroy = function(contact, listener) {\n      var fixtureA = contact.m_fixtureA;\n      var fixtureB = contact.m_fixtureB;\n      if (fixtureA === null || fixtureB === null)\n        return;\n      var bodyA = fixtureA.m_body;\n      var bodyB = fixtureB.m_body;\n      if (bodyA === null || bodyB === null)\n        return;\n      if (contact.isTouching()) {\n        listener.endContact(contact);\n      }\n      if (contact.m_nodeA.prev) {\n        contact.m_nodeA.prev.next = contact.m_nodeA.next;\n      }\n      if (contact.m_nodeA.next) {\n        contact.m_nodeA.next.prev = contact.m_nodeA.prev;\n      }\n      if (contact.m_nodeA == bodyA.m_contactList) {\n        bodyA.m_contactList = contact.m_nodeA.next;\n      }\n      if (contact.m_nodeB.prev) {\n        contact.m_nodeB.prev.next = contact.m_nodeB.next;\n      }\n      if (contact.m_nodeB.next) {\n        contact.m_nodeB.next.prev = contact.m_nodeB.prev;\n      }\n      if (contact.m_nodeB == bodyB.m_contactList) {\n        bodyB.m_contactList = contact.m_nodeB.next;\n      }\n      if (contact.m_manifold.pointCount > 0 && !fixtureA.m_isSensor && !fixtureB.m_isSensor) {\n        bodyA.setAwake(true);\n        bodyB.setAwake(true);\n      }\n      contactPool.release(contact);\n    };\n    return Contact2;\n  }()\n);\nvar DEFAULTS$b = {\n  gravity: Vec2.zero(),\n  allowSleep: true,\n  warmStarting: true,\n  continuousPhysics: true,\n  subStepping: false,\n  blockSolve: true,\n  velocityIterations: 8,\n  positionIterations: 3\n};\nvar World = (\n  /** @class */\n  function() {\n    function World2(def) {\n      if (!(this instanceof World2)) {\n        return new World2(def);\n      }\n      this.s_step = new TimeStep();\n      if (!def) {\n        def = {};\n      } else if (Vec2.isValid(def)) {\n        def = { gravity: def };\n      }\n      def = options(def, DEFAULTS$b);\n      this.m_solver = new Solver(this);\n      this.m_broadPhase = new BroadPhase();\n      this.m_contactList = null;\n      this.m_contactCount = 0;\n      this.m_bodyList = null;\n      this.m_bodyCount = 0;\n      this.m_jointList = null;\n      this.m_jointCount = 0;\n      this.m_stepComplete = true;\n      this.m_allowSleep = def.allowSleep;\n      this.m_gravity = Vec2.clone(def.gravity);\n      this.m_clearForces = true;\n      this.m_newFixture = false;\n      this.m_locked = false;\n      this.m_warmStarting = def.warmStarting;\n      this.m_continuousPhysics = def.continuousPhysics;\n      this.m_subStepping = def.subStepping;\n      this.m_blockSolve = def.blockSolve;\n      this.m_velocityIterations = def.velocityIterations;\n      this.m_positionIterations = def.positionIterations;\n      this.m_t = 0;\n      this.m_step_callback = [];\n    }\n    World2.prototype._serialize = function() {\n      var bodies = [];\n      var joints = [];\n      for (var b2 = this.getBodyList(); b2; b2 = b2.getNext()) {\n        bodies.push(b2);\n      }\n      for (var j = this.getJointList(); j; j = j.getNext()) {\n        if (typeof j._serialize === \"function\") {\n          joints.push(j);\n        }\n      }\n      return {\n        gravity: this.m_gravity,\n        bodies,\n        joints\n      };\n    };\n    World2._deserialize = function(data, context, restore) {\n      if (!data) {\n        return new World2();\n      }\n      var world = new World2(data.gravity);\n      if (data.bodies) {\n        for (var i = data.bodies.length - 1; i >= 0; i -= 1) {\n          world._addBody(restore(Body, data.bodies[i], world));\n        }\n      }\n      if (data.joints) {\n        for (var i = data.joints.length - 1; i >= 0; i--) {\n          world.createJoint(restore(Joint, data.joints[i], world));\n        }\n      }\n      return world;\n    };\n    World2.prototype.getBodyList = function() {\n      return this.m_bodyList;\n    };\n    World2.prototype.getJointList = function() {\n      return this.m_jointList;\n    };\n    World2.prototype.getContactList = function() {\n      return this.m_contactList;\n    };\n    World2.prototype.getBodyCount = function() {\n      return this.m_bodyCount;\n    };\n    World2.prototype.getJointCount = function() {\n      return this.m_jointCount;\n    };\n    World2.prototype.getContactCount = function() {\n      return this.m_contactCount;\n    };\n    World2.prototype.setGravity = function(gravity) {\n      this.m_gravity.set(gravity);\n    };\n    World2.prototype.getGravity = function() {\n      return this.m_gravity;\n    };\n    World2.prototype.isLocked = function() {\n      return this.m_locked;\n    };\n    World2.prototype.setAllowSleeping = function(flag) {\n      if (flag == this.m_allowSleep) {\n        return;\n      }\n      this.m_allowSleep = flag;\n      if (this.m_allowSleep == false) {\n        for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {\n          b2.setAwake(true);\n        }\n      }\n    };\n    World2.prototype.getAllowSleeping = function() {\n      return this.m_allowSleep;\n    };\n    World2.prototype.setWarmStarting = function(flag) {\n      this.m_warmStarting = flag;\n    };\n    World2.prototype.getWarmStarting = function() {\n      return this.m_warmStarting;\n    };\n    World2.prototype.setContinuousPhysics = function(flag) {\n      this.m_continuousPhysics = flag;\n    };\n    World2.prototype.getContinuousPhysics = function() {\n      return this.m_continuousPhysics;\n    };\n    World2.prototype.setSubStepping = function(flag) {\n      this.m_subStepping = flag;\n    };\n    World2.prototype.getSubStepping = function() {\n      return this.m_subStepping;\n    };\n    World2.prototype.setAutoClearForces = function(flag) {\n      this.m_clearForces = flag;\n    };\n    World2.prototype.getAutoClearForces = function() {\n      return this.m_clearForces;\n    };\n    World2.prototype.clearForces = function() {\n      for (var body = this.m_bodyList; body; body = body.getNext()) {\n        body.m_force.setZero();\n        body.m_torque = 0;\n      }\n    };\n    World2.prototype.queryAABB = function(aabb, callback) {\n      var broadPhase = this.m_broadPhase;\n      this.m_broadPhase.query(aabb, function(proxyId) {\n        var proxy = broadPhase.getUserData(proxyId);\n        return callback(proxy.fixture);\n      });\n    };\n    World2.prototype.rayCast = function(point1, point2, callback) {\n      var broadPhase = this.m_broadPhase;\n      this.m_broadPhase.rayCast({\n        maxFraction: 1,\n        p1: point1,\n        p2: point2\n      }, function(input2, proxyId) {\n        var proxy = broadPhase.getUserData(proxyId);\n        var fixture = proxy.fixture;\n        var index = proxy.childIndex;\n        var output2 = {};\n        var hit = fixture.rayCast(output2, input2, index);\n        if (hit) {\n          var fraction = output2.fraction;\n          var point3 = Vec2.add(Vec2.mulNumVec2(1 - fraction, input2.p1), Vec2.mulNumVec2(fraction, input2.p2));\n          return callback(fixture, point3, output2.normal, fraction);\n        }\n        return input2.maxFraction;\n      });\n    };\n    World2.prototype.getProxyCount = function() {\n      return this.m_broadPhase.getProxyCount();\n    };\n    World2.prototype.getTreeHeight = function() {\n      return this.m_broadPhase.getTreeHeight();\n    };\n    World2.prototype.getTreeBalance = function() {\n      return this.m_broadPhase.getTreeBalance();\n    };\n    World2.prototype.getTreeQuality = function() {\n      return this.m_broadPhase.getTreeQuality();\n    };\n    World2.prototype.shiftOrigin = function(newOrigin) {\n      if (this.isLocked()) {\n        return;\n      }\n      for (var b2 = this.m_bodyList; b2; b2 = b2.m_next) {\n        b2.m_xf.p.sub(newOrigin);\n        b2.m_sweep.c0.sub(newOrigin);\n        b2.m_sweep.c.sub(newOrigin);\n      }\n      for (var j = this.m_jointList; j; j = j.m_next) {\n        j.shiftOrigin(newOrigin);\n      }\n      this.m_broadPhase.shiftOrigin(newOrigin);\n    };\n    World2.prototype._addBody = function(body) {\n      if (this.isLocked()) {\n        return;\n      }\n      body.m_prev = null;\n      body.m_next = this.m_bodyList;\n      if (this.m_bodyList) {\n        this.m_bodyList.m_prev = body;\n      }\n      this.m_bodyList = body;\n      ++this.m_bodyCount;\n    };\n    World2.prototype.createBody = function(arg1, arg2) {\n      if (this.isLocked()) {\n        return null;\n      }\n      var def = {};\n      if (!arg1) ;\n      else if (Vec2.isValid(arg1)) {\n        def = { position: arg1, angle: arg2 };\n      } else if (typeof arg1 === \"object\") {\n        def = arg1;\n      }\n      var body = new Body(this, def);\n      this._addBody(body);\n      return body;\n    };\n    World2.prototype.createDynamicBody = function(arg1, arg2) {\n      var def = {};\n      if (!arg1) ;\n      else if (Vec2.isValid(arg1)) {\n        def = { position: arg1, angle: arg2 };\n      } else if (typeof arg1 === \"object\") {\n        def = arg1;\n      }\n      def.type = \"dynamic\";\n      return this.createBody(def);\n    };\n    World2.prototype.createKinematicBody = function(arg1, arg2) {\n      var def = {};\n      if (!arg1) ;\n      else if (Vec2.isValid(arg1)) {\n        def = { position: arg1, angle: arg2 };\n      } else if (typeof arg1 === \"object\") {\n        def = arg1;\n      }\n      def.type = \"kinematic\";\n      return this.createBody(def);\n    };\n    World2.prototype.destroyBody = function(b2) {\n      if (this.isLocked()) {\n        return;\n      }\n      if (b2.m_destroyed) {\n        return false;\n      }\n      var je = b2.m_jointList;\n      while (je) {\n        var je0 = je;\n        je = je.next;\n        this.publish(\"remove-joint\", je0.joint);\n        this.destroyJoint(je0.joint);\n        b2.m_jointList = je;\n      }\n      b2.m_jointList = null;\n      var ce = b2.m_contactList;\n      while (ce) {\n        var ce0 = ce;\n        ce = ce.next;\n        this.destroyContact(ce0.contact);\n        b2.m_contactList = ce;\n      }\n      b2.m_contactList = null;\n      var f = b2.m_fixtureList;\n      while (f) {\n        var f0 = f;\n        f = f.m_next;\n        this.publish(\"remove-fixture\", f0);\n        f0.destroyProxies(this.m_broadPhase);\n        b2.m_fixtureList = f;\n      }\n      b2.m_fixtureList = null;\n      if (b2.m_prev) {\n        b2.m_prev.m_next = b2.m_next;\n      }\n      if (b2.m_next) {\n        b2.m_next.m_prev = b2.m_prev;\n      }\n      if (b2 == this.m_bodyList) {\n        this.m_bodyList = b2.m_next;\n      }\n      b2.m_destroyed = true;\n      --this.m_bodyCount;\n      this.publish(\"remove-body\", b2);\n      return true;\n    };\n    World2.prototype.createJoint = function(joint) {\n      if (this.isLocked()) {\n        return null;\n      }\n      joint.m_prev = null;\n      joint.m_next = this.m_jointList;\n      if (this.m_jointList) {\n        this.m_jointList.m_prev = joint;\n      }\n      this.m_jointList = joint;\n      ++this.m_jointCount;\n      joint.m_edgeA.joint = joint;\n      joint.m_edgeA.other = joint.m_bodyB;\n      joint.m_edgeA.prev = null;\n      joint.m_edgeA.next = joint.m_bodyA.m_jointList;\n      if (joint.m_bodyA.m_jointList)\n        joint.m_bodyA.m_jointList.prev = joint.m_edgeA;\n      joint.m_bodyA.m_jointList = joint.m_edgeA;\n      joint.m_edgeB.joint = joint;\n      joint.m_edgeB.other = joint.m_bodyA;\n      joint.m_edgeB.prev = null;\n      joint.m_edgeB.next = joint.m_bodyB.m_jointList;\n      if (joint.m_bodyB.m_jointList)\n        joint.m_bodyB.m_jointList.prev = joint.m_edgeB;\n      joint.m_bodyB.m_jointList = joint.m_edgeB;\n      if (joint.m_collideConnected == false) {\n        for (var edge = joint.m_bodyB.getContactList(); edge; edge = edge.next) {\n          if (edge.other == joint.m_bodyA) {\n            edge.contact.flagForFiltering();\n          }\n        }\n      }\n      return joint;\n    };\n    World2.prototype.destroyJoint = function(joint) {\n      if (this.isLocked()) {\n        return;\n      }\n      if (joint.m_prev) {\n        joint.m_prev.m_next = joint.m_next;\n      }\n      if (joint.m_next) {\n        joint.m_next.m_prev = joint.m_prev;\n      }\n      if (joint == this.m_jointList) {\n        this.m_jointList = joint.m_next;\n      }\n      var bodyA = joint.m_bodyA;\n      var bodyB = joint.m_bodyB;\n      bodyA.setAwake(true);\n      bodyB.setAwake(true);\n      if (joint.m_edgeA.prev) {\n        joint.m_edgeA.prev.next = joint.m_edgeA.next;\n      }\n      if (joint.m_edgeA.next) {\n        joint.m_edgeA.next.prev = joint.m_edgeA.prev;\n      }\n      if (joint.m_edgeA == bodyA.m_jointList) {\n        bodyA.m_jointList = joint.m_edgeA.next;\n      }\n      joint.m_edgeA.prev = null;\n      joint.m_edgeA.next = null;\n      if (joint.m_edgeB.prev) {\n        joint.m_edgeB.prev.next = joint.m_edgeB.next;\n      }\n      if (joint.m_edgeB.next) {\n        joint.m_edgeB.next.prev = joint.m_edgeB.prev;\n      }\n      if (joint.m_edgeB == bodyB.m_jointList) {\n        bodyB.m_jointList = joint.m_edgeB.next;\n      }\n      joint.m_edgeB.prev = null;\n      joint.m_edgeB.next = null;\n      --this.m_jointCount;\n      if (joint.m_collideConnected == false) {\n        var edge = bodyB.getContactList();\n        while (edge) {\n          if (edge.other == bodyA) {\n            edge.contact.flagForFiltering();\n          }\n          edge = edge.next;\n        }\n      }\n      this.publish(\"remove-joint\", joint);\n    };\n    World2.prototype.step = function(timeStep, velocityIterations, positionIterations) {\n      this.publish(\"pre-step\", timeStep);\n      if ((velocityIterations | 0) !== velocityIterations) {\n        velocityIterations = 0;\n      }\n      velocityIterations = velocityIterations || this.m_velocityIterations;\n      positionIterations = positionIterations || this.m_positionIterations;\n      if (this.m_newFixture) {\n        this.findNewContacts();\n        this.m_newFixture = false;\n      }\n      this.m_locked = true;\n      this.s_step.reset(timeStep);\n      this.s_step.velocityIterations = velocityIterations;\n      this.s_step.positionIterations = positionIterations;\n      this.s_step.warmStarting = this.m_warmStarting;\n      this.s_step.blockSolve = this.m_blockSolve;\n      this.updateContacts();\n      if (this.m_stepComplete && timeStep > 0) {\n        this.m_solver.solveWorld(this.s_step);\n        for (var b2 = this.m_bodyList; b2; b2 = b2.getNext()) {\n          if (b2.m_islandFlag == false) {\n            continue;\n          }\n          if (b2.isStatic()) {\n            continue;\n          }\n          b2.synchronizeFixtures();\n        }\n        this.findNewContacts();\n      }\n      if (this.m_continuousPhysics && timeStep > 0) {\n        this.m_solver.solveWorldTOI(this.s_step);\n      }\n      if (this.m_clearForces) {\n        this.clearForces();\n      }\n      this.m_locked = false;\n      var callback;\n      while (callback = this.m_step_callback.shift()) {\n        callback(this);\n      }\n      this.publish(\"post-step\", timeStep);\n    };\n    World2.prototype.queueUpdate = function(callback) {\n      if (!this.isLocked()) {\n        callback(this);\n      } else {\n        this.m_step_callback.push(callback);\n      }\n    };\n    World2.prototype.findNewContacts = function() {\n      var _this = this;\n      this.m_broadPhase.updatePairs(function(proxyA, proxyB) {\n        return _this.createContact(proxyA, proxyB);\n      });\n    };\n    World2.prototype.createContact = function(proxyA, proxyB) {\n      var fixtureA = proxyA.fixture;\n      var fixtureB = proxyB.fixture;\n      var indexA = proxyA.childIndex;\n      var indexB = proxyB.childIndex;\n      var bodyA = fixtureA.getBody();\n      var bodyB = fixtureB.getBody();\n      if (bodyA == bodyB) {\n        return;\n      }\n      var edge = bodyB.getContactList();\n      while (edge) {\n        if (edge.other == bodyA) {\n          var fA = edge.contact.getFixtureA();\n          var fB = edge.contact.getFixtureB();\n          var iA = edge.contact.getChildIndexA();\n          var iB = edge.contact.getChildIndexB();\n          if (fA == fixtureA && fB == fixtureB && iA == indexA && iB == indexB) {\n            return;\n          }\n          if (fA == fixtureB && fB == fixtureA && iA == indexB && iB == indexA) {\n            return;\n          }\n        }\n        edge = edge.next;\n      }\n      if (bodyB.shouldCollide(bodyA) == false) {\n        return;\n      }\n      if (fixtureB.shouldCollide(fixtureA) == false) {\n        return;\n      }\n      var contact = Contact.create(fixtureA, indexA, fixtureB, indexB);\n      if (contact == null) {\n        return;\n      }\n      contact.m_prev = null;\n      if (this.m_contactList != null) {\n        contact.m_next = this.m_contactList;\n        this.m_contactList.m_prev = contact;\n      }\n      this.m_contactList = contact;\n      ++this.m_contactCount;\n    };\n    World2.prototype.updateContacts = function() {\n      var c2;\n      var next_c = this.m_contactList;\n      while (c2 = next_c) {\n        next_c = c2.getNext();\n        var fixtureA = c2.getFixtureA();\n        var fixtureB = c2.getFixtureB();\n        var indexA = c2.getChildIndexA();\n        var indexB = c2.getChildIndexB();\n        var bodyA = fixtureA.getBody();\n        var bodyB = fixtureB.getBody();\n        if (c2.m_filterFlag) {\n          if (bodyB.shouldCollide(bodyA) == false) {\n            this.destroyContact(c2);\n            continue;\n          }\n          if (fixtureB.shouldCollide(fixtureA) == false) {\n            this.destroyContact(c2);\n            continue;\n          }\n          c2.m_filterFlag = false;\n        }\n        var activeA = bodyA.isAwake() && !bodyA.isStatic();\n        var activeB = bodyB.isAwake() && !bodyB.isStatic();\n        if (activeA == false && activeB == false) {\n          continue;\n        }\n        var proxyIdA = fixtureA.m_proxies[indexA].proxyId;\n        var proxyIdB = fixtureB.m_proxies[indexB].proxyId;\n        var overlap = this.m_broadPhase.testOverlap(proxyIdA, proxyIdB);\n        if (overlap == false) {\n          this.destroyContact(c2);\n          continue;\n        }\n        c2.update(this);\n      }\n    };\n    World2.prototype.destroyContact = function(contact) {\n      if (contact.m_prev) {\n        contact.m_prev.m_next = contact.m_next;\n      }\n      if (contact.m_next) {\n        contact.m_next.m_prev = contact.m_prev;\n      }\n      if (contact == this.m_contactList) {\n        this.m_contactList = contact.m_next;\n      }\n      Contact.destroy(contact, this);\n      --this.m_contactCount;\n    };\n    World2.prototype.on = function(name, listener) {\n      if (typeof name !== \"string\" || typeof listener !== \"function\") {\n        return this;\n      }\n      if (!this._listeners) {\n        this._listeners = {};\n      }\n      if (!this._listeners[name]) {\n        this._listeners[name] = [];\n      }\n      this._listeners[name].push(listener);\n      return this;\n    };\n    World2.prototype.off = function(name, listener) {\n      if (typeof name !== \"string\" || typeof listener !== \"function\") {\n        return this;\n      }\n      var listeners = this._listeners && this._listeners[name];\n      if (!listeners || !listeners.length) {\n        return this;\n      }\n      var index = listeners.indexOf(listener);\n      if (index >= 0) {\n        listeners.splice(index, 1);\n      }\n      return this;\n    };\n    World2.prototype.publish = function(name, arg1, arg2, arg3) {\n      var listeners = this._listeners && this._listeners[name];\n      if (!listeners || !listeners.length) {\n        return 0;\n      }\n      for (var l = 0; l < listeners.length; l++) {\n        listeners[l].call(this, arg1, arg2, arg3);\n      }\n      return listeners.length;\n    };\n    World2.prototype.beginContact = function(contact) {\n      this.publish(\"begin-contact\", contact);\n    };\n    World2.prototype.endContact = function(contact) {\n      this.publish(\"end-contact\", contact);\n    };\n    World2.prototype.preSolve = function(contact, oldManifold2) {\n      this.publish(\"pre-solve\", contact, oldManifold2);\n    };\n    World2.prototype.postSolve = function(contact, impulse) {\n      this.publish(\"post-solve\", contact, impulse);\n    };\n    return World2;\n  }()\n);\nvar Vec3 = (\n  /** @class */\n  function() {\n    function Vec32(x2, y, z) {\n      if (!(this instanceof Vec32)) {\n        return new Vec32(x2, y, z);\n      }\n      if (typeof x2 === \"undefined\") {\n        this.x = 0;\n        this.y = 0;\n        this.z = 0;\n      } else if (typeof x2 === \"object\") {\n        this.x = x2.x;\n        this.y = x2.y;\n        this.z = x2.z;\n      } else {\n        this.x = x2;\n        this.y = y;\n        this.z = z;\n      }\n    }\n    Vec32.prototype._serialize = function() {\n      return {\n        x: this.x,\n        y: this.y,\n        z: this.z\n      };\n    };\n    Vec32._deserialize = function(data) {\n      var obj = Object.create(Vec32.prototype);\n      obj.x = data.x;\n      obj.y = data.y;\n      obj.z = data.z;\n      return obj;\n    };\n    Vec32.neo = function(x2, y, z) {\n      var obj = Object.create(Vec32.prototype);\n      obj.x = x2;\n      obj.y = y;\n      obj.z = z;\n      return obj;\n    };\n    Vec32.zero = function() {\n      var obj = Object.create(Vec32.prototype);\n      obj.x = 0;\n      obj.y = 0;\n      obj.z = 0;\n      return obj;\n    };\n    Vec32.clone = function(v3) {\n      return Vec32.neo(v3.x, v3.y, v3.z);\n    };\n    Vec32.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    Vec32.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Number.isFinite(obj.x) && Number.isFinite(obj.y) && Number.isFinite(obj.z);\n    };\n    Vec32.assert = function(o) {\n    };\n    Vec32.prototype.setZero = function() {\n      this.x = 0;\n      this.y = 0;\n      this.z = 0;\n      return this;\n    };\n    Vec32.prototype.set = function(x2, y, z) {\n      this.x = x2;\n      this.y = y;\n      this.z = z;\n      return this;\n    };\n    Vec32.prototype.add = function(w) {\n      this.x += w.x;\n      this.y += w.y;\n      this.z += w.z;\n      return this;\n    };\n    Vec32.prototype.sub = function(w) {\n      this.x -= w.x;\n      this.y -= w.y;\n      this.z -= w.z;\n      return this;\n    };\n    Vec32.prototype.mul = function(m) {\n      this.x *= m;\n      this.y *= m;\n      this.z *= m;\n      return this;\n    };\n    Vec32.areEqual = function(v3, w) {\n      return v3 === w || typeof v3 === \"object\" && v3 !== null && typeof w === \"object\" && w !== null && v3.x === w.x && v3.y === w.y && v3.z === w.z;\n    };\n    Vec32.dot = function(v3, w) {\n      return v3.x * w.x + v3.y * w.y + v3.z * w.z;\n    };\n    Vec32.cross = function(v3, w) {\n      return new Vec32(v3.y * w.z - v3.z * w.y, v3.z * w.x - v3.x * w.z, v3.x * w.y - v3.y * w.x);\n    };\n    Vec32.add = function(v3, w) {\n      return new Vec32(v3.x + w.x, v3.y + w.y, v3.z + w.z);\n    };\n    Vec32.sub = function(v3, w) {\n      return new Vec32(v3.x - w.x, v3.y - w.y, v3.z - w.z);\n    };\n    Vec32.mul = function(v3, m) {\n      return new Vec32(m * v3.x, m * v3.y, m * v3.z);\n    };\n    Vec32.prototype.neg = function() {\n      this.x = -this.x;\n      this.y = -this.y;\n      this.z = -this.z;\n      return this;\n    };\n    Vec32.neg = function(v3) {\n      return new Vec32(-v3.x, -v3.y, -v3.z);\n    };\n    return Vec32;\n  }()\n);\nvar v1$2 = vec2(0, 0);\nvar v2$1 = vec2(0, 0);\nvar EdgeShape = (\n  /** @class */\n  function(_super) {\n    __extends(EdgeShape2, _super);\n    function EdgeShape2(v122, v22) {\n      var _this = this;\n      if (!(_this instanceof EdgeShape2)) {\n        return new EdgeShape2(v122, v22);\n      }\n      _this = _super.call(this) || this;\n      _this.m_type = EdgeShape2.TYPE;\n      _this.m_radius = SettingsInternal.polygonRadius;\n      _this.m_vertex1 = v122 ? Vec2.clone(v122) : Vec2.zero();\n      _this.m_vertex2 = v22 ? Vec2.clone(v22) : Vec2.zero();\n      _this.m_vertex0 = Vec2.zero();\n      _this.m_vertex3 = Vec2.zero();\n      _this.m_hasVertex0 = false;\n      _this.m_hasVertex3 = false;\n      return _this;\n    }\n    EdgeShape2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        vertex1: this.m_vertex1,\n        vertex2: this.m_vertex2,\n        vertex0: this.m_vertex0,\n        vertex3: this.m_vertex3,\n        hasVertex0: this.m_hasVertex0,\n        hasVertex3: this.m_hasVertex3\n      };\n    };\n    EdgeShape2._deserialize = function(data) {\n      var shape = new EdgeShape2(data.vertex1, data.vertex2);\n      if (shape.m_hasVertex0) {\n        shape.setPrevVertex(data.vertex0);\n      }\n      if (shape.m_hasVertex3) {\n        shape.setNextVertex(data.vertex3);\n      }\n      return shape;\n    };\n    EdgeShape2.prototype._reset = function() {\n    };\n    EdgeShape2.prototype.getRadius = function() {\n      return this.m_radius;\n    };\n    EdgeShape2.prototype.getType = function() {\n      return this.m_type;\n    };\n    EdgeShape2.prototype.setNext = function(v3) {\n      return this.setNextVertex(v3);\n    };\n    EdgeShape2.prototype.setNextVertex = function(v3) {\n      if (v3) {\n        this.m_vertex3.setVec2(v3);\n        this.m_hasVertex3 = true;\n      } else {\n        this.m_vertex3.setZero();\n        this.m_hasVertex3 = false;\n      }\n      return this;\n    };\n    EdgeShape2.prototype.getNextVertex = function() {\n      return this.m_vertex3;\n    };\n    EdgeShape2.prototype.setPrev = function(v3) {\n      return this.setPrevVertex(v3);\n    };\n    EdgeShape2.prototype.setPrevVertex = function(v3) {\n      if (v3) {\n        this.m_vertex0.setVec2(v3);\n        this.m_hasVertex0 = true;\n      } else {\n        this.m_vertex0.setZero();\n        this.m_hasVertex0 = false;\n      }\n      return this;\n    };\n    EdgeShape2.prototype.getPrevVertex = function() {\n      return this.m_vertex0;\n    };\n    EdgeShape2.prototype._set = function(v122, v22) {\n      this.m_vertex1.setVec2(v122);\n      this.m_vertex2.setVec2(v22);\n      this.m_hasVertex0 = false;\n      this.m_hasVertex3 = false;\n      return this;\n    };\n    EdgeShape2.prototype._clone = function() {\n      var clone = new EdgeShape2();\n      clone.m_type = this.m_type;\n      clone.m_radius = this.m_radius;\n      clone.m_vertex1.setVec2(this.m_vertex1);\n      clone.m_vertex2.setVec2(this.m_vertex2);\n      clone.m_vertex0.setVec2(this.m_vertex0);\n      clone.m_vertex3.setVec2(this.m_vertex3);\n      clone.m_hasVertex0 = this.m_hasVertex0;\n      clone.m_hasVertex3 = this.m_hasVertex3;\n      return clone;\n    };\n    EdgeShape2.prototype.getChildCount = function() {\n      return 1;\n    };\n    EdgeShape2.prototype.testPoint = function(xf2, p) {\n      return false;\n    };\n    EdgeShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {\n      var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));\n      var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));\n      var d2 = Vec2.sub(p2, p1);\n      var v122 = this.m_vertex1;\n      var v22 = this.m_vertex2;\n      var e3 = Vec2.sub(v22, v122);\n      var normal3 = Vec2.neo(e3.y, -e3.x);\n      normal3.normalize();\n      var numerator = Vec2.dot(normal3, Vec2.sub(v122, p1));\n      var denominator = Vec2.dot(normal3, d2);\n      if (denominator == 0) {\n        return false;\n      }\n      var t = numerator / denominator;\n      if (t < 0 || input2.maxFraction < t) {\n        return false;\n      }\n      var q = Vec2.add(p1, Vec2.mulNumVec2(t, d2));\n      var r = Vec2.sub(v22, v122);\n      var rr = Vec2.dot(r, r);\n      if (rr == 0) {\n        return false;\n      }\n      var s2 = Vec2.dot(Vec2.sub(q, v122), r) / rr;\n      if (s2 < 0 || 1 < s2) {\n        return false;\n      }\n      output2.fraction = t;\n      if (numerator > 0) {\n        output2.normal = Rot.mulVec2(xf2.q, normal3).neg();\n      } else {\n        output2.normal = Rot.mulVec2(xf2.q, normal3);\n      }\n      return true;\n    };\n    EdgeShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {\n      transformVec2(v1$2, xf2, this.m_vertex1);\n      transformVec2(v2$1, xf2, this.m_vertex2);\n      AABB.combinePoints(aabb, v1$2, v2$1);\n      AABB.extend(aabb, this.m_radius);\n    };\n    EdgeShape2.prototype.computeMass = function(massData, density) {\n      massData.mass = 0;\n      combine2Vec2(massData.center, 0.5, this.m_vertex1, 0.5, this.m_vertex2);\n      massData.I = 0;\n    };\n    EdgeShape2.prototype.computeDistanceProxy = function(proxy) {\n      proxy.m_vertices[0] = this.m_vertex1;\n      proxy.m_vertices[1] = this.m_vertex2;\n      proxy.m_vertices.length = 2;\n      proxy.m_count = 2;\n      proxy.m_radius = this.m_radius;\n    };\n    EdgeShape2.TYPE = \"edge\";\n    return EdgeShape2;\n  }(Shape)\n);\nvar v1$1 = vec2(0, 0);\nvar v2 = vec2(0, 0);\nvar ChainShape = (\n  /** @class */\n  function(_super) {\n    __extends(ChainShape2, _super);\n    function ChainShape2(vertices, loop) {\n      var _this = this;\n      if (!(_this instanceof ChainShape2)) {\n        return new ChainShape2(vertices, loop);\n      }\n      _this = _super.call(this) || this;\n      _this.m_type = ChainShape2.TYPE;\n      _this.m_radius = SettingsInternal.polygonRadius;\n      _this.m_vertices = [];\n      _this.m_count = 0;\n      _this.m_prevVertex = null;\n      _this.m_nextVertex = null;\n      _this.m_hasPrevVertex = false;\n      _this.m_hasNextVertex = false;\n      _this.m_isLoop = !!loop;\n      if (vertices && vertices.length) {\n        if (loop) {\n          _this._createLoop(vertices);\n        } else {\n          _this._createChain(vertices);\n        }\n      }\n      return _this;\n    }\n    ChainShape2.prototype._serialize = function() {\n      var data = {\n        type: this.m_type,\n        vertices: this.m_isLoop ? this.m_vertices.slice(0, this.m_vertices.length - 1) : this.m_vertices,\n        isLoop: this.m_isLoop,\n        hasPrevVertex: this.m_hasPrevVertex,\n        hasNextVertex: this.m_hasNextVertex,\n        prevVertex: null,\n        nextVertex: null\n      };\n      if (this.m_prevVertex) {\n        data.prevVertex = this.m_prevVertex;\n      }\n      if (this.m_nextVertex) {\n        data.nextVertex = this.m_nextVertex;\n      }\n      return data;\n    };\n    ChainShape2._deserialize = function(data, fixture, restore) {\n      var vertices = [];\n      if (data.vertices) {\n        for (var i = 0; i < data.vertices.length; i++) {\n          vertices.push(restore(Vec2, data.vertices[i]));\n        }\n      }\n      var shape = new ChainShape2(vertices, data.isLoop);\n      if (data.prevVertex) {\n        shape.setPrevVertex(data.prevVertex);\n      }\n      if (data.nextVertex) {\n        shape.setNextVertex(data.nextVertex);\n      }\n      return shape;\n    };\n    ChainShape2.prototype.getType = function() {\n      return this.m_type;\n    };\n    ChainShape2.prototype.getRadius = function() {\n      return this.m_radius;\n    };\n    ChainShape2.prototype._createLoop = function(vertices) {\n      if (vertices.length < 3) {\n        return;\n      }\n      var i;\n      this.m_vertices = [];\n      this.m_count = vertices.length + 1;\n      for (var i = 0; i < vertices.length; ++i) {\n        this.m_vertices[i] = Vec2.clone(vertices[i]);\n      }\n      this.m_vertices[vertices.length] = Vec2.clone(vertices[0]);\n      this.m_prevVertex = this.m_vertices[this.m_count - 2];\n      this.m_nextVertex = this.m_vertices[1];\n      this.m_hasPrevVertex = true;\n      this.m_hasNextVertex = true;\n      return this;\n    };\n    ChainShape2.prototype._createChain = function(vertices) {\n      var i;\n      this.m_vertices = [];\n      this.m_count = vertices.length;\n      for (var i = 0; i < vertices.length; ++i) {\n        this.m_vertices[i] = Vec2.clone(vertices[i]);\n      }\n      this.m_prevVertex = null;\n      this.m_nextVertex = null;\n      this.m_hasPrevVertex = false;\n      this.m_hasNextVertex = false;\n      return this;\n    };\n    ChainShape2.prototype._reset = function() {\n      if (this.m_isLoop) {\n        this._createLoop(this.m_vertices.slice(0, this.m_vertices.length - 1));\n      } else {\n        this._createChain(this.m_vertices);\n      }\n    };\n    ChainShape2.prototype.setPrevVertex = function(prevVertex) {\n      this.m_prevVertex = prevVertex;\n      this.m_hasPrevVertex = true;\n    };\n    ChainShape2.prototype.getPrevVertex = function() {\n      return this.m_prevVertex;\n    };\n    ChainShape2.prototype.setNextVertex = function(nextVertex) {\n      this.m_nextVertex = nextVertex;\n      this.m_hasNextVertex = true;\n    };\n    ChainShape2.prototype.getNextVertex = function() {\n      return this.m_nextVertex;\n    };\n    ChainShape2.prototype._clone = function() {\n      var clone = new ChainShape2();\n      clone._createChain(this.m_vertices);\n      clone.m_type = this.m_type;\n      clone.m_radius = this.m_radius;\n      clone.m_prevVertex = this.m_prevVertex;\n      clone.m_nextVertex = this.m_nextVertex;\n      clone.m_hasPrevVertex = this.m_hasPrevVertex;\n      clone.m_hasNextVertex = this.m_hasNextVertex;\n      return clone;\n    };\n    ChainShape2.prototype.getChildCount = function() {\n      return this.m_count - 1;\n    };\n    ChainShape2.prototype.getChildEdge = function(edge, childIndex) {\n      edge.m_type = EdgeShape.TYPE;\n      edge.m_radius = this.m_radius;\n      edge.m_vertex1 = this.m_vertices[childIndex];\n      edge.m_vertex2 = this.m_vertices[childIndex + 1];\n      if (childIndex > 0) {\n        edge.m_vertex0 = this.m_vertices[childIndex - 1];\n        edge.m_hasVertex0 = true;\n      } else {\n        edge.m_vertex0 = this.m_prevVertex;\n        edge.m_hasVertex0 = this.m_hasPrevVertex;\n      }\n      if (childIndex < this.m_count - 2) {\n        edge.m_vertex3 = this.m_vertices[childIndex + 2];\n        edge.m_hasVertex3 = true;\n      } else {\n        edge.m_vertex3 = this.m_nextVertex;\n        edge.m_hasVertex3 = this.m_hasNextVertex;\n      }\n    };\n    ChainShape2.prototype.getVertex = function(index) {\n      if (index < this.m_count) {\n        return this.m_vertices[index];\n      } else {\n        return this.m_vertices[0];\n      }\n    };\n    ChainShape2.prototype.isLoop = function() {\n      return this.m_isLoop;\n    };\n    ChainShape2.prototype.testPoint = function(xf2, p) {\n      return false;\n    };\n    ChainShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {\n      var edgeShape = new EdgeShape(this.getVertex(childIndex), this.getVertex(childIndex + 1));\n      return edgeShape.rayCast(output2, input2, xf2, 0);\n    };\n    ChainShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {\n      transformVec2(v1$1, xf2, this.getVertex(childIndex));\n      transformVec2(v2, xf2, this.getVertex(childIndex + 1));\n      AABB.combinePoints(aabb, v1$1, v2);\n    };\n    ChainShape2.prototype.computeMass = function(massData, density) {\n      massData.mass = 0;\n      zeroVec2(massData.center);\n      massData.I = 0;\n    };\n    ChainShape2.prototype.computeDistanceProxy = function(proxy, childIndex) {\n      proxy.m_vertices[0] = this.getVertex(childIndex);\n      proxy.m_vertices[1] = this.getVertex(childIndex + 1);\n      proxy.m_count = 2;\n      proxy.m_radius = this.m_radius;\n    };\n    ChainShape2.TYPE = \"chain\";\n    return ChainShape2;\n  }(Shape)\n);\nvar math_max$1 = Math.max;\nvar math_min$3 = Math.min;\nvar temp$1 = vec2(0, 0);\nvar e$1 = vec2(0, 0);\nvar e1$1 = vec2(0, 0);\nvar e2$1 = vec2(0, 0);\nvar center = vec2(0, 0);\nvar s = vec2(0, 0);\nvar PolygonShape = (\n  /** @class */\n  function(_super) {\n    __extends(PolygonShape2, _super);\n    function PolygonShape2(vertices) {\n      var _this = this;\n      if (!(_this instanceof PolygonShape2)) {\n        return new PolygonShape2(vertices);\n      }\n      _this = _super.call(this) || this;\n      _this.m_type = PolygonShape2.TYPE;\n      _this.m_radius = SettingsInternal.polygonRadius;\n      _this.m_centroid = Vec2.zero();\n      _this.m_vertices = [];\n      _this.m_normals = [];\n      _this.m_count = 0;\n      if (vertices && vertices.length) {\n        _this._set(vertices);\n      }\n      return _this;\n    }\n    PolygonShape2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        vertices: this.m_vertices\n      };\n    };\n    PolygonShape2._deserialize = function(data, fixture, restore) {\n      var vertices = [];\n      if (data.vertices) {\n        for (var i = 0; i < data.vertices.length; i++) {\n          vertices.push(restore(Vec2, data.vertices[i]));\n        }\n      }\n      var shape = new PolygonShape2(vertices);\n      return shape;\n    };\n    PolygonShape2.prototype.getType = function() {\n      return this.m_type;\n    };\n    PolygonShape2.prototype.getRadius = function() {\n      return this.m_radius;\n    };\n    PolygonShape2.prototype._clone = function() {\n      var clone = new PolygonShape2();\n      clone.m_type = this.m_type;\n      clone.m_radius = this.m_radius;\n      clone.m_count = this.m_count;\n      clone.m_centroid.setVec2(this.m_centroid);\n      for (var i = 0; i < this.m_count; i++) {\n        clone.m_vertices.push(this.m_vertices[i].clone());\n      }\n      for (var i = 0; i < this.m_normals.length; i++) {\n        clone.m_normals.push(this.m_normals[i].clone());\n      }\n      return clone;\n    };\n    PolygonShape2.prototype.getChildCount = function() {\n      return 1;\n    };\n    PolygonShape2.prototype._reset = function() {\n      this._set(this.m_vertices);\n    };\n    PolygonShape2.prototype._set = function(vertices) {\n      if (vertices.length < 3) {\n        this._setAsBox(1, 1);\n        return;\n      }\n      var n2 = math_min$3(vertices.length, SettingsInternal.maxPolygonVertices);\n      var ps = [];\n      for (var i = 0; i < n2; ++i) {\n        var v3 = vertices[i];\n        var unique = true;\n        for (var j = 0; j < ps.length; ++j) {\n          if (Vec2.distanceSquared(v3, ps[j]) < 0.25 * SettingsInternal.linearSlopSquared) {\n            unique = false;\n            break;\n          }\n        }\n        if (unique) {\n          ps.push(Vec2.clone(v3));\n        }\n      }\n      n2 = ps.length;\n      if (n2 < 3) {\n        this._setAsBox(1, 1);\n        return;\n      }\n      var i0 = 0;\n      var x0 = ps[0].x;\n      for (var i = 1; i < n2; ++i) {\n        var x2 = ps[i].x;\n        if (x2 > x0 || x2 === x0 && ps[i].y < ps[i0].y) {\n          i0 = i;\n          x0 = x2;\n        }\n      }\n      var hull = [];\n      var m = 0;\n      var ih = i0;\n      while (true) {\n        hull[m] = ih;\n        var ie2 = 0;\n        for (var j = 1; j < n2; ++j) {\n          if (ie2 === ih) {\n            ie2 = j;\n            continue;\n          }\n          var r = Vec2.sub(ps[ie2], ps[hull[m]]);\n          var v3 = Vec2.sub(ps[j], ps[hull[m]]);\n          var c2 = Vec2.crossVec2Vec2(r, v3);\n          if (c2 < 0) {\n            ie2 = j;\n          }\n          if (c2 === 0 && v3.lengthSquared() > r.lengthSquared()) {\n            ie2 = j;\n          }\n        }\n        ++m;\n        ih = ie2;\n        if (ie2 === i0) {\n          break;\n        }\n      }\n      if (m < 3) {\n        this._setAsBox(1, 1);\n        return;\n      }\n      this.m_count = m;\n      this.m_vertices = [];\n      for (var i = 0; i < m; ++i) {\n        this.m_vertices[i] = ps[hull[i]];\n      }\n      for (var i = 0; i < m; ++i) {\n        var i1 = i;\n        var i2 = i + 1 < m ? i + 1 : 0;\n        var edge = Vec2.sub(this.m_vertices[i2], this.m_vertices[i1]);\n        this.m_normals[i] = Vec2.crossVec2Num(edge, 1);\n        this.m_normals[i].normalize();\n      }\n      this.m_centroid = computeCentroid(this.m_vertices, m);\n    };\n    PolygonShape2.prototype._setAsBox = function(hx, hy, center2, angle) {\n      this.m_vertices[0] = Vec2.neo(hx, -hy);\n      this.m_vertices[1] = Vec2.neo(hx, hy);\n      this.m_vertices[2] = Vec2.neo(-hx, hy);\n      this.m_vertices[3] = Vec2.neo(-hx, -hy);\n      this.m_normals[0] = Vec2.neo(1, 0);\n      this.m_normals[1] = Vec2.neo(0, 1);\n      this.m_normals[2] = Vec2.neo(-1, 0);\n      this.m_normals[3] = Vec2.neo(0, -1);\n      this.m_count = 4;\n      if (center2 && Vec2.isValid(center2)) {\n        angle = angle || 0;\n        copyVec2(this.m_centroid, center2);\n        var xf2 = Transform.identity();\n        xf2.p.setVec2(center2);\n        xf2.q.setAngle(angle);\n        for (var i = 0; i < this.m_count; ++i) {\n          this.m_vertices[i] = Transform.mulVec2(xf2, this.m_vertices[i]);\n          this.m_normals[i] = Rot.mulVec2(xf2.q, this.m_normals[i]);\n        }\n      }\n    };\n    PolygonShape2.prototype.testPoint = function(xf2, p) {\n      var pLocal = detransformVec2(temp$1, xf2, p);\n      for (var i = 0; i < this.m_count; ++i) {\n        var dot = dotVec2(this.m_normals[i], pLocal) - dotVec2(this.m_normals[i], this.m_vertices[i]);\n        if (dot > 0) {\n          return false;\n        }\n      }\n      return true;\n    };\n    PolygonShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {\n      var p1 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p1, xf2.p));\n      var p2 = Rot.mulTVec2(xf2.q, Vec2.sub(input2.p2, xf2.p));\n      var d2 = Vec2.sub(p2, p1);\n      var lower = 0;\n      var upper = input2.maxFraction;\n      var index = -1;\n      for (var i = 0; i < this.m_count; ++i) {\n        var numerator = Vec2.dot(this.m_normals[i], Vec2.sub(this.m_vertices[i], p1));\n        var denominator = Vec2.dot(this.m_normals[i], d2);\n        if (denominator == 0) {\n          if (numerator < 0) {\n            return false;\n          }\n        } else {\n          if (denominator < 0 && numerator < lower * denominator) {\n            lower = numerator / denominator;\n            index = i;\n          } else if (denominator > 0 && numerator < upper * denominator) {\n            upper = numerator / denominator;\n          }\n        }\n        if (upper < lower) {\n          return false;\n        }\n      }\n      if (index >= 0) {\n        output2.fraction = lower;\n        output2.normal = Rot.mulVec2(xf2.q, this.m_normals[index]);\n        return true;\n      }\n      return false;\n    };\n    PolygonShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {\n      var minX = Infinity;\n      var minY = Infinity;\n      var maxX = -Infinity;\n      var maxY = -Infinity;\n      for (var i = 0; i < this.m_count; ++i) {\n        var v3 = transformVec2(temp$1, xf2, this.m_vertices[i]);\n        minX = math_min$3(minX, v3.x);\n        maxX = math_max$1(maxX, v3.x);\n        minY = math_min$3(minY, v3.y);\n        maxY = math_max$1(maxY, v3.y);\n      }\n      setVec2(aabb.lowerBound, minX - this.m_radius, minY - this.m_radius);\n      setVec2(aabb.upperBound, maxX + this.m_radius, maxY + this.m_radius);\n    };\n    PolygonShape2.prototype.computeMass = function(massData, density) {\n      zeroVec2(center);\n      var area = 0;\n      var I = 0;\n      zeroVec2(s);\n      for (var i = 0; i < this.m_count; ++i) {\n        plusVec2(s, this.m_vertices[i]);\n      }\n      scaleVec2(s, 1 / this.m_count, s);\n      var k_inv3 = 1 / 3;\n      for (var i = 0; i < this.m_count; ++i) {\n        subVec2(e1$1, this.m_vertices[i], s);\n        if (i + 1 < this.m_count) {\n          subVec2(e2$1, this.m_vertices[i + 1], s);\n        } else {\n          subVec2(e2$1, this.m_vertices[0], s);\n        }\n        var D = crossVec2Vec2(e1$1, e2$1);\n        var triangleArea = 0.5 * D;\n        area += triangleArea;\n        combine2Vec2(temp$1, triangleArea * k_inv3, e1$1, triangleArea * k_inv3, e2$1);\n        plusVec2(center, temp$1);\n        var ex1 = e1$1.x;\n        var ey1 = e1$1.y;\n        var ex2 = e2$1.x;\n        var ey2 = e2$1.y;\n        var intx2 = ex1 * ex1 + ex2 * ex1 + ex2 * ex2;\n        var inty2 = ey1 * ey1 + ey2 * ey1 + ey2 * ey2;\n        I += 0.25 * k_inv3 * D * (intx2 + inty2);\n      }\n      massData.mass = density * area;\n      scaleVec2(center, 1 / area, center);\n      addVec2(massData.center, center, s);\n      massData.I = density * I;\n      massData.I += massData.mass * (dotVec2(massData.center, massData.center) - dotVec2(center, center));\n    };\n    PolygonShape2.prototype.validate = function() {\n      for (var i = 0; i < this.m_count; ++i) {\n        var i1 = i;\n        var i2 = i < this.m_count - 1 ? i1 + 1 : 0;\n        var p = this.m_vertices[i1];\n        subVec2(e$1, this.m_vertices[i2], p);\n        for (var j = 0; j < this.m_count; ++j) {\n          if (j == i1 || j == i2) {\n            continue;\n          }\n          var c2 = crossVec2Vec2(e$1, subVec2(temp$1, this.m_vertices[j], p));\n          if (c2 < 0) {\n            return false;\n          }\n        }\n      }\n      return true;\n    };\n    PolygonShape2.prototype.computeDistanceProxy = function(proxy) {\n      for (var i = 0; i < this.m_count; ++i) {\n        proxy.m_vertices[i] = this.m_vertices[i];\n      }\n      proxy.m_vertices.length = this.m_count;\n      proxy.m_count = this.m_count;\n      proxy.m_radius = this.m_radius;\n    };\n    PolygonShape2.TYPE = \"polygon\";\n    return PolygonShape2;\n  }(Shape)\n);\nfunction computeCentroid(vs, count) {\n  var c2 = Vec2.zero();\n  var area = 0;\n  var pRef = Vec2.zero();\n  var i;\n  var inv3 = 1 / 3;\n  for (var i = 0; i < count; ++i) {\n    var p1 = pRef;\n    var p2 = vs[i];\n    var p3 = i + 1 < count ? vs[i + 1] : vs[0];\n    var e1_1 = Vec2.sub(p2, p1);\n    var e2_1 = Vec2.sub(p3, p1);\n    var D = Vec2.crossVec2Vec2(e1_1, e2_1);\n    var triangleArea = 0.5 * D;\n    area += triangleArea;\n    combine3Vec2(temp$1, 1, p1, 1, p2, 1, p3);\n    plusScaleVec2(c2, triangleArea * inv3, temp$1);\n  }\n  c2.mul(1 / area);\n  return c2;\n}\nvar math_sqrt = Math.sqrt;\nvar math_PI$4 = Math.PI;\nvar temp = vec2(0, 0);\nvar CircleShape = (\n  /** @class */\n  function(_super) {\n    __extends(CircleShape2, _super);\n    function CircleShape2(a2, b2) {\n      var _this = this;\n      if (!(_this instanceof CircleShape2)) {\n        return new CircleShape2(a2, b2);\n      }\n      _this = _super.call(this) || this;\n      _this.m_type = CircleShape2.TYPE;\n      _this.m_p = Vec2.zero();\n      _this.m_radius = 1;\n      if (typeof a2 === \"object\" && Vec2.isValid(a2)) {\n        _this.m_p.setVec2(a2);\n        if (typeof b2 === \"number\") {\n          _this.m_radius = b2;\n        }\n      } else if (typeof a2 === \"number\") {\n        _this.m_radius = a2;\n      }\n      return _this;\n    }\n    CircleShape2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        p: this.m_p,\n        radius: this.m_radius\n      };\n    };\n    CircleShape2._deserialize = function(data) {\n      return new CircleShape2(data.p, data.radius);\n    };\n    CircleShape2.prototype._reset = function() {\n    };\n    CircleShape2.prototype.getType = function() {\n      return this.m_type;\n    };\n    CircleShape2.prototype.getRadius = function() {\n      return this.m_radius;\n    };\n    CircleShape2.prototype.getCenter = function() {\n      return this.m_p;\n    };\n    CircleShape2.prototype._clone = function() {\n      var clone = new CircleShape2();\n      clone.m_type = this.m_type;\n      clone.m_radius = this.m_radius;\n      clone.m_p = this.m_p.clone();\n      return clone;\n    };\n    CircleShape2.prototype.getChildCount = function() {\n      return 1;\n    };\n    CircleShape2.prototype.testPoint = function(xf2, p) {\n      var center2 = transformVec2(temp, xf2, this.m_p);\n      return distSqrVec2(p, center2) <= this.m_radius * this.m_radius;\n    };\n    CircleShape2.prototype.rayCast = function(output2, input2, xf2, childIndex) {\n      var position = Vec2.add(xf2.p, Rot.mulVec2(xf2.q, this.m_p));\n      var s2 = Vec2.sub(input2.p1, position);\n      var b2 = Vec2.dot(s2, s2) - this.m_radius * this.m_radius;\n      var r = Vec2.sub(input2.p2, input2.p1);\n      var c2 = Vec2.dot(s2, r);\n      var rr = Vec2.dot(r, r);\n      var sigma = c2 * c2 - rr * b2;\n      if (sigma < 0 || rr < EPSILON) {\n        return false;\n      }\n      var a2 = -(c2 + math_sqrt(sigma));\n      if (0 <= a2 && a2 <= input2.maxFraction * rr) {\n        a2 /= rr;\n        output2.fraction = a2;\n        output2.normal = Vec2.add(s2, Vec2.mulNumVec2(a2, r));\n        output2.normal.normalize();\n        return true;\n      }\n      return false;\n    };\n    CircleShape2.prototype.computeAABB = function(aabb, xf2, childIndex) {\n      var p = transformVec2(temp, xf2, this.m_p);\n      setVec2(aabb.lowerBound, p.x - this.m_radius, p.y - this.m_radius);\n      setVec2(aabb.upperBound, p.x + this.m_radius, p.y + this.m_radius);\n    };\n    CircleShape2.prototype.computeMass = function(massData, density) {\n      massData.mass = density * math_PI$4 * this.m_radius * this.m_radius;\n      copyVec2(massData.center, this.m_p);\n      massData.I = massData.mass * (0.5 * this.m_radius * this.m_radius + lengthSqrVec2(this.m_p));\n    };\n    CircleShape2.prototype.computeDistanceProxy = function(proxy) {\n      proxy.m_vertices[0] = this.m_p;\n      proxy.m_vertices.length = 1;\n      proxy.m_count = 1;\n      proxy.m_radius = this.m_radius;\n    };\n    CircleShape2.TYPE = \"circle\";\n    return CircleShape2;\n  }(Shape)\n);\nvar math_abs$5 = Math.abs;\nvar math_PI$3 = Math.PI;\nvar DEFAULTS$a = {\n  frequencyHz: 0,\n  dampingRatio: 0\n};\nvar DistanceJoint = (\n  /** @class */\n  function(_super) {\n    __extends(DistanceJoint2, _super);\n    function DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB) {\n      var _this = this;\n      if (!(_this instanceof DistanceJoint2)) {\n        return new DistanceJoint2(def, bodyA, bodyB, anchorA, anchorB);\n      }\n      if (bodyB && anchorA && \"m_type\" in anchorA && \"x\" in bodyB && \"y\" in bodyB) {\n        var temp3 = bodyB;\n        bodyB = anchorA;\n        anchorA = temp3;\n      }\n      def = options(def, DEFAULTS$a);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = DistanceJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.zero());\n      _this.m_length = Number.isFinite(def.length) ? def.length : Vec2.distance(bodyA.getWorldPoint(_this.m_localAnchorA), bodyB.getWorldPoint(_this.m_localAnchorB));\n      _this.m_frequencyHz = def.frequencyHz;\n      _this.m_dampingRatio = def.dampingRatio;\n      _this.m_impulse = 0;\n      _this.m_gamma = 0;\n      _this.m_bias = 0;\n      return _this;\n    }\n    DistanceJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        frequencyHz: this.m_frequencyHz,\n        dampingRatio: this.m_dampingRatio,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        length: this.m_length,\n        impulse: this.m_impulse,\n        gamma: this.m_gamma,\n        bias: this.m_bias\n      };\n    };\n    DistanceJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new DistanceJoint2(data);\n      return joint;\n    };\n    DistanceJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (def.length > 0) {\n        this.m_length = +def.length;\n      } else if (def.length < 0) ;\n      else if (def.anchorA || def.anchorA || def.anchorA || def.anchorA) {\n        this.m_length = Vec2.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA), this.m_bodyB.getWorldPoint(this.m_localAnchorB));\n      }\n      if (Number.isFinite(def.frequencyHz)) {\n        this.m_frequencyHz = def.frequencyHz;\n      }\n      if (Number.isFinite(def.dampingRatio)) {\n        this.m_dampingRatio = def.dampingRatio;\n      }\n    };\n    DistanceJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    DistanceJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    DistanceJoint2.prototype.setLength = function(length) {\n      this.m_length = length;\n    };\n    DistanceJoint2.prototype.getLength = function() {\n      return this.m_length;\n    };\n    DistanceJoint2.prototype.setFrequency = function(hz) {\n      this.m_frequencyHz = hz;\n    };\n    DistanceJoint2.prototype.getFrequency = function() {\n      return this.m_frequencyHz;\n    };\n    DistanceJoint2.prototype.setDampingRatio = function(ratio) {\n      this.m_dampingRatio = ratio;\n    };\n    DistanceJoint2.prototype.getDampingRatio = function() {\n      return this.m_dampingRatio;\n    };\n    DistanceJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    DistanceJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    DistanceJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);\n    };\n    DistanceJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return 0;\n    };\n    DistanceJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      this.m_u = Vec2.sub(Vec2.add(cB2, this.m_rB), Vec2.add(cA2, this.m_rA));\n      var length = this.m_u.length();\n      if (length > SettingsInternal.linearSlop) {\n        this.m_u.mul(1 / length);\n      } else {\n        this.m_u.setNum(0, 0);\n      }\n      var crAu = Vec2.crossVec2Vec2(this.m_rA, this.m_u);\n      var crBu = Vec2.crossVec2Vec2(this.m_rB, this.m_u);\n      var invMass = this.m_invMassA + this.m_invIA * crAu * crAu + this.m_invMassB + this.m_invIB * crBu * crBu;\n      this.m_mass = invMass != 0 ? 1 / invMass : 0;\n      if (this.m_frequencyHz > 0) {\n        var C = length - this.m_length;\n        var omega = 2 * math_PI$3 * this.m_frequencyHz;\n        var d2 = 2 * this.m_mass * this.m_dampingRatio * omega;\n        var k = this.m_mass * omega * omega;\n        var h = step.dt;\n        this.m_gamma = h * (d2 + h * k);\n        this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;\n        this.m_bias = C * h * k * this.m_gamma;\n        invMass += this.m_gamma;\n        this.m_mass = invMass != 0 ? 1 / invMass : 0;\n      } else {\n        this.m_gamma = 0;\n        this.m_bias = 0;\n      }\n      if (step.warmStarting) {\n        this.m_impulse *= step.dtRatio;\n        var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);\n        vA2.subMul(this.m_invMassA, P3);\n        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);\n        vB2.addMul(this.m_invMassB, P3);\n        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      } else {\n        this.m_impulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    DistanceJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));\n      var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));\n      var Cdot = Vec2.dot(this.m_u, vpB) - Vec2.dot(this.m_u, vpA);\n      var impulse = -this.m_mass * (Cdot + this.m_bias + this.m_gamma * this.m_impulse);\n      this.m_impulse += impulse;\n      var P3 = Vec2.mulNumVec2(impulse, this.m_u);\n      vA2.subMul(this.m_invMassA, P3);\n      wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);\n      vB2.addMul(this.m_invMassB, P3);\n      wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    DistanceJoint2.prototype.solvePositionConstraints = function(step) {\n      if (this.m_frequencyHz > 0) {\n        return true;\n      }\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);\n      var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);\n      var u = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));\n      var length = u.normalize();\n      var C = clamp(length - this.m_length, -SettingsInternal.maxLinearCorrection, SettingsInternal.maxLinearCorrection);\n      var impulse = -this.m_mass * C;\n      var P3 = Vec2.mulNumVec2(impulse, u);\n      cA2.subMul(this.m_invMassA, P3);\n      aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);\n      cB2.addMul(this.m_invMassB, P3);\n      aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      return math_abs$5(C) < SettingsInternal.linearSlop;\n    };\n    DistanceJoint2.TYPE = \"distance-joint\";\n    return DistanceJoint2;\n  }(Joint)\n);\nvar DEFAULTS$9 = {\n  maxForce: 0,\n  maxTorque: 0\n};\nvar FrictionJoint = (\n  /** @class */\n  function(_super) {\n    __extends(FrictionJoint2, _super);\n    function FrictionJoint2(def, bodyA, bodyB, anchor) {\n      var _this = this;\n      if (!(_this instanceof FrictionJoint2)) {\n        return new FrictionJoint2(def, bodyA, bodyB, anchor);\n      }\n      def = options(def, DEFAULTS$9);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = FrictionJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());\n      _this.m_linearImpulse = Vec2.zero();\n      _this.m_angularImpulse = 0;\n      _this.m_maxForce = def.maxForce;\n      _this.m_maxTorque = def.maxTorque;\n      return _this;\n    }\n    FrictionJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        maxForce: this.m_maxForce,\n        maxTorque: this.m_maxTorque,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB\n      };\n    };\n    FrictionJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new FrictionJoint2(data);\n      return joint;\n    };\n    FrictionJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (Number.isFinite(def.maxForce)) {\n        this.m_maxForce = def.maxForce;\n      }\n      if (Number.isFinite(def.maxTorque)) {\n        this.m_maxTorque = def.maxTorque;\n      }\n    };\n    FrictionJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    FrictionJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    FrictionJoint2.prototype.setMaxForce = function(force) {\n      this.m_maxForce = force;\n    };\n    FrictionJoint2.prototype.getMaxForce = function() {\n      return this.m_maxForce;\n    };\n    FrictionJoint2.prototype.setMaxTorque = function(torque) {\n      this.m_maxTorque = torque;\n    };\n    FrictionJoint2.prototype.getMaxTorque = function() {\n      return this.m_maxTorque;\n    };\n    FrictionJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    FrictionJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    FrictionJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);\n    };\n    FrictionJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_angularImpulse;\n    };\n    FrictionJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var K = new Mat22();\n      K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;\n      K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;\n      K.ey.x = K.ex.y;\n      K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;\n      this.m_linearMass = K.getInverse();\n      this.m_angularMass = iA + iB;\n      if (this.m_angularMass > 0) {\n        this.m_angularMass = 1 / this.m_angularMass;\n      }\n      if (step.warmStarting) {\n        this.m_linearImpulse.mul(step.dtRatio);\n        this.m_angularImpulse *= step.dtRatio;\n        var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);\n      } else {\n        this.m_linearImpulse.setZero();\n        this.m_angularImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    FrictionJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var h = step.dt;\n      {\n        var Cdot = wB - wA;\n        var impulse = -this.m_angularMass * Cdot;\n        var oldImpulse = this.m_angularImpulse;\n        var maxImpulse = h * this.m_maxTorque;\n        this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_angularImpulse - oldImpulse;\n        wA -= iA * impulse;\n        wB += iB * impulse;\n      }\n      {\n        var Cdot = Vec2.sub(Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB)), Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA)));\n        var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));\n        var oldImpulse = this.m_linearImpulse;\n        this.m_linearImpulse.add(impulse);\n        var maxImpulse = h * this.m_maxForce;\n        if (this.m_linearImpulse.lengthSquared() > maxImpulse * maxImpulse) {\n          this.m_linearImpulse.normalize();\n          this.m_linearImpulse.mul(maxImpulse);\n        }\n        impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);\n        vA2.subMul(mA, impulse);\n        wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);\n        vB2.addMul(mB, impulse);\n        wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    FrictionJoint2.prototype.solvePositionConstraints = function(step) {\n      return true;\n    };\n    FrictionJoint2.TYPE = \"friction-joint\";\n    return FrictionJoint2;\n  }(Joint)\n);\nvar Mat33 = (\n  /** @class */\n  function() {\n    function Mat332(a2, b2, c2) {\n      if (typeof a2 === \"object\" && a2 !== null) {\n        this.ex = Vec3.clone(a2);\n        this.ey = Vec3.clone(b2);\n        this.ez = Vec3.clone(c2);\n      } else {\n        this.ex = Vec3.zero();\n        this.ey = Vec3.zero();\n        this.ez = Vec3.zero();\n      }\n    }\n    Mat332.prototype.toString = function() {\n      return JSON.stringify(this);\n    };\n    Mat332.isValid = function(obj) {\n      if (obj === null || typeof obj === \"undefined\") {\n        return false;\n      }\n      return Vec3.isValid(obj.ex) && Vec3.isValid(obj.ey) && Vec3.isValid(obj.ez);\n    };\n    Mat332.assert = function(o) {\n    };\n    Mat332.prototype.setZero = function() {\n      this.ex.setZero();\n      this.ey.setZero();\n      this.ez.setZero();\n      return this;\n    };\n    Mat332.prototype.solve33 = function(v3) {\n      var cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;\n      var cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;\n      var cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;\n      var det = this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var r = new Vec3();\n      cross_x = this.ey.y * this.ez.z - this.ey.z * this.ez.y;\n      cross_y = this.ey.z * this.ez.x - this.ey.x * this.ez.z;\n      cross_z = this.ey.x * this.ez.y - this.ey.y * this.ez.x;\n      r.x = det * (v3.x * cross_x + v3.y * cross_y + v3.z * cross_z);\n      cross_x = v3.y * this.ez.z - v3.z * this.ez.y;\n      cross_y = v3.z * this.ez.x - v3.x * this.ez.z;\n      cross_z = v3.x * this.ez.y - v3.y * this.ez.x;\n      r.y = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);\n      cross_x = this.ey.y * v3.z - this.ey.z * v3.y;\n      cross_y = this.ey.z * v3.x - this.ey.x * v3.z;\n      cross_z = this.ey.x * v3.y - this.ey.y * v3.x;\n      r.z = det * (this.ex.x * cross_x + this.ex.y * cross_y + this.ex.z * cross_z);\n      return r;\n    };\n    Mat332.prototype.solve22 = function(v3) {\n      var a11 = this.ex.x;\n      var a12 = this.ey.x;\n      var a21 = this.ex.y;\n      var a22 = this.ey.y;\n      var det = a11 * a22 - a12 * a21;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var r = Vec2.zero();\n      r.x = det * (a22 * v3.x - a12 * v3.y);\n      r.y = det * (a11 * v3.y - a21 * v3.x);\n      return r;\n    };\n    Mat332.prototype.getInverse22 = function(M) {\n      var a2 = this.ex.x;\n      var b2 = this.ey.x;\n      var c2 = this.ex.y;\n      var d2 = this.ey.y;\n      var det = a2 * d2 - b2 * c2;\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      M.ex.x = det * d2;\n      M.ey.x = -det * b2;\n      M.ex.z = 0;\n      M.ex.y = -det * c2;\n      M.ey.y = det * a2;\n      M.ey.z = 0;\n      M.ez.x = 0;\n      M.ez.y = 0;\n      M.ez.z = 0;\n    };\n    Mat332.prototype.getSymInverse33 = function(M) {\n      var det = Vec3.dot(this.ex, Vec3.cross(this.ey, this.ez));\n      if (det !== 0) {\n        det = 1 / det;\n      }\n      var a11 = this.ex.x;\n      var a12 = this.ey.x;\n      var a13 = this.ez.x;\n      var a22 = this.ey.y;\n      var a23 = this.ez.y;\n      var a33 = this.ez.z;\n      M.ex.x = det * (a22 * a33 - a23 * a23);\n      M.ex.y = det * (a13 * a23 - a12 * a33);\n      M.ex.z = det * (a12 * a23 - a13 * a22);\n      M.ey.x = M.ex.y;\n      M.ey.y = det * (a11 * a33 - a13 * a13);\n      M.ey.z = det * (a13 * a12 - a11 * a23);\n      M.ez.x = M.ex.z;\n      M.ez.y = M.ey.z;\n      M.ez.z = det * (a11 * a22 - a12 * a12);\n    };\n    Mat332.mul = function(a2, b2) {\n      if (b2 && \"z\" in b2 && \"y\" in b2 && \"x\" in b2) {\n        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;\n        var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;\n        var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;\n        return new Vec3(x2, y, z);\n      } else if (b2 && \"y\" in b2 && \"x\" in b2) {\n        var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;\n        var y = a2.ex.y * b2.x + a2.ey.y * b2.y;\n        return Vec2.neo(x2, y);\n      }\n    };\n    Mat332.mulVec3 = function(a2, b2) {\n      var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y + a2.ez.x * b2.z;\n      var y = a2.ex.y * b2.x + a2.ey.y * b2.y + a2.ez.y * b2.z;\n      var z = a2.ex.z * b2.x + a2.ey.z * b2.y + a2.ez.z * b2.z;\n      return new Vec3(x2, y, z);\n    };\n    Mat332.mulVec2 = function(a2, b2) {\n      var x2 = a2.ex.x * b2.x + a2.ey.x * b2.y;\n      var y = a2.ex.y * b2.x + a2.ey.y * b2.y;\n      return Vec2.neo(x2, y);\n    };\n    Mat332.add = function(a2, b2) {\n      return new Mat332(Vec3.add(a2.ex, b2.ex), Vec3.add(a2.ey, b2.ey), Vec3.add(a2.ez, b2.ez));\n    };\n    return Mat332;\n  }()\n);\nvar math_abs$4 = Math.abs;\nvar LimitState$2;\n(function(LimitState2) {\n  LimitState2[LimitState2[\"inactiveLimit\"] = 0] = \"inactiveLimit\";\n  LimitState2[LimitState2[\"atLowerLimit\"] = 1] = \"atLowerLimit\";\n  LimitState2[LimitState2[\"atUpperLimit\"] = 2] = \"atUpperLimit\";\n  LimitState2[LimitState2[\"equalLimits\"] = 3] = \"equalLimits\";\n})(LimitState$2 || (LimitState$2 = {}));\nvar DEFAULTS$8 = {\n  lowerAngle: 0,\n  upperAngle: 0,\n  maxMotorTorque: 0,\n  motorSpeed: 0,\n  enableLimit: false,\n  enableMotor: false\n};\nvar RevoluteJoint = (\n  /** @class */\n  function(_super) {\n    __extends(RevoluteJoint2, _super);\n    function RevoluteJoint2(def, bodyA, bodyB, anchor) {\n      var _this = this;\n      var _a2, _b, _c, _d, _e, _f;\n      if (!(_this instanceof RevoluteJoint2)) {\n        return new RevoluteJoint2(def, bodyA, bodyB, anchor);\n      }\n      def = def !== null && def !== void 0 ? def : {};\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_mass = new Mat33();\n      _this.m_limitState = LimitState$2.inactiveLimit;\n      _this.m_type = RevoluteJoint2.TYPE;\n      if (Vec2.isValid(anchor)) {\n        _this.m_localAnchorA = bodyA.getLocalPoint(anchor);\n      } else if (Vec2.isValid(def.localAnchorA)) {\n        _this.m_localAnchorA = Vec2.clone(def.localAnchorA);\n      } else {\n        _this.m_localAnchorA = Vec2.zero();\n      }\n      if (Vec2.isValid(anchor)) {\n        _this.m_localAnchorB = bodyB.getLocalPoint(anchor);\n      } else if (Vec2.isValid(def.localAnchorB)) {\n        _this.m_localAnchorB = Vec2.clone(def.localAnchorB);\n      } else {\n        _this.m_localAnchorB = Vec2.zero();\n      }\n      if (Number.isFinite(def.referenceAngle)) {\n        _this.m_referenceAngle = def.referenceAngle;\n      } else {\n        _this.m_referenceAngle = bodyB.getAngle() - bodyA.getAngle();\n      }\n      _this.m_impulse = new Vec3();\n      _this.m_motorImpulse = 0;\n      _this.m_lowerAngle = (_a2 = def.lowerAngle) !== null && _a2 !== void 0 ? _a2 : DEFAULTS$8.lowerAngle;\n      _this.m_upperAngle = (_b = def.upperAngle) !== null && _b !== void 0 ? _b : DEFAULTS$8.upperAngle;\n      _this.m_maxMotorTorque = (_c = def.maxMotorTorque) !== null && _c !== void 0 ? _c : DEFAULTS$8.maxMotorTorque;\n      _this.m_motorSpeed = (_d = def.motorSpeed) !== null && _d !== void 0 ? _d : DEFAULTS$8.motorSpeed;\n      _this.m_enableLimit = (_e = def.enableLimit) !== null && _e !== void 0 ? _e : DEFAULTS$8.enableLimit;\n      _this.m_enableMotor = (_f = def.enableMotor) !== null && _f !== void 0 ? _f : DEFAULTS$8.enableMotor;\n      return _this;\n    }\n    RevoluteJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        lowerAngle: this.m_lowerAngle,\n        upperAngle: this.m_upperAngle,\n        maxMotorTorque: this.m_maxMotorTorque,\n        motorSpeed: this.m_motorSpeed,\n        enableLimit: this.m_enableLimit,\n        enableMotor: this.m_enableMotor,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        referenceAngle: this.m_referenceAngle\n      };\n    };\n    RevoluteJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new RevoluteJoint2(data);\n      return joint;\n    };\n    RevoluteJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (Number.isFinite(def.referenceAngle)) {\n        this.m_referenceAngle = def.referenceAngle;\n      }\n      if (def.enableLimit !== void 0) {\n        this.m_enableLimit = def.enableLimit;\n      }\n      if (Number.isFinite(def.lowerAngle)) {\n        this.m_lowerAngle = def.lowerAngle;\n      }\n      if (Number.isFinite(def.upperAngle)) {\n        this.m_upperAngle = def.upperAngle;\n      }\n      if (Number.isFinite(def.maxMotorTorque)) {\n        this.m_maxMotorTorque = def.maxMotorTorque;\n      }\n      if (Number.isFinite(def.motorSpeed)) {\n        this.m_motorSpeed = def.motorSpeed;\n      }\n      if (def.enableMotor !== void 0) {\n        this.m_enableMotor = def.enableMotor;\n      }\n    };\n    RevoluteJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    RevoluteJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    RevoluteJoint2.prototype.getReferenceAngle = function() {\n      return this.m_referenceAngle;\n    };\n    RevoluteJoint2.prototype.getJointAngle = function() {\n      var bA = this.m_bodyA;\n      var bB = this.m_bodyB;\n      return bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;\n    };\n    RevoluteJoint2.prototype.getJointSpeed = function() {\n      var bA = this.m_bodyA;\n      var bB = this.m_bodyB;\n      return bB.m_angularVelocity - bA.m_angularVelocity;\n    };\n    RevoluteJoint2.prototype.isMotorEnabled = function() {\n      return this.m_enableMotor;\n    };\n    RevoluteJoint2.prototype.enableMotor = function(flag) {\n      if (flag == this.m_enableMotor)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_enableMotor = flag;\n    };\n    RevoluteJoint2.prototype.getMotorTorque = function(inv_dt) {\n      return inv_dt * this.m_motorImpulse;\n    };\n    RevoluteJoint2.prototype.setMotorSpeed = function(speed) {\n      if (speed == this.m_motorSpeed)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_motorSpeed = speed;\n    };\n    RevoluteJoint2.prototype.getMotorSpeed = function() {\n      return this.m_motorSpeed;\n    };\n    RevoluteJoint2.prototype.setMaxMotorTorque = function(torque) {\n      if (torque == this.m_maxMotorTorque)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_maxMotorTorque = torque;\n    };\n    RevoluteJoint2.prototype.getMaxMotorTorque = function() {\n      return this.m_maxMotorTorque;\n    };\n    RevoluteJoint2.prototype.isLimitEnabled = function() {\n      return this.m_enableLimit;\n    };\n    RevoluteJoint2.prototype.enableLimit = function(flag) {\n      if (flag != this.m_enableLimit) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_enableLimit = flag;\n        this.m_impulse.z = 0;\n      }\n    };\n    RevoluteJoint2.prototype.getLowerLimit = function() {\n      return this.m_lowerAngle;\n    };\n    RevoluteJoint2.prototype.getUpperLimit = function() {\n      return this.m_upperAngle;\n    };\n    RevoluteJoint2.prototype.setLimits = function(lower, upper) {\n      if (lower != this.m_lowerAngle || upper != this.m_upperAngle) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_impulse.z = 0;\n        this.m_lowerAngle = lower;\n        this.m_upperAngle = upper;\n      }\n    };\n    RevoluteJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    RevoluteJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    RevoluteJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);\n    };\n    RevoluteJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_impulse.z;\n    };\n    RevoluteJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var fixedRotation = iA + iB === 0;\n      this.m_mass.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;\n      this.m_mass.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;\n      this.m_mass.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;\n      this.m_mass.ex.y = this.m_mass.ey.x;\n      this.m_mass.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;\n      this.m_mass.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;\n      this.m_mass.ex.z = this.m_mass.ez.x;\n      this.m_mass.ey.z = this.m_mass.ez.y;\n      this.m_mass.ez.z = iA + iB;\n      this.m_motorMass = iA + iB;\n      if (this.m_motorMass > 0) {\n        this.m_motorMass = 1 / this.m_motorMass;\n      }\n      if (this.m_enableMotor == false || fixedRotation) {\n        this.m_motorImpulse = 0;\n      }\n      if (this.m_enableLimit && fixedRotation == false) {\n        var jointAngle = aB - aA - this.m_referenceAngle;\n        if (math_abs$4(this.m_upperAngle - this.m_lowerAngle) < 2 * SettingsInternal.angularSlop) {\n          this.m_limitState = LimitState$2.equalLimits;\n        } else if (jointAngle <= this.m_lowerAngle) {\n          if (this.m_limitState != LimitState$2.atLowerLimit) {\n            this.m_impulse.z = 0;\n          }\n          this.m_limitState = LimitState$2.atLowerLimit;\n        } else if (jointAngle >= this.m_upperAngle) {\n          if (this.m_limitState != LimitState$2.atUpperLimit) {\n            this.m_impulse.z = 0;\n          }\n          this.m_limitState = LimitState$2.atUpperLimit;\n        } else {\n          this.m_limitState = LimitState$2.inactiveLimit;\n          this.m_impulse.z = 0;\n        }\n      } else {\n        this.m_limitState = LimitState$2.inactiveLimit;\n      }\n      if (step.warmStarting) {\n        this.m_impulse.mul(step.dtRatio);\n        this.m_motorImpulse *= step.dtRatio;\n        var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_motorImpulse + this.m_impulse.z);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_motorImpulse + this.m_impulse.z);\n      } else {\n        this.m_impulse.setZero();\n        this.m_motorImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    RevoluteJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var fixedRotation = iA + iB === 0;\n      if (this.m_enableMotor && this.m_limitState != LimitState$2.equalLimits && fixedRotation == false) {\n        var Cdot = wB - wA - this.m_motorSpeed;\n        var impulse = -this.m_motorMass * Cdot;\n        var oldImpulse = this.m_motorImpulse;\n        var maxImpulse = step.dt * this.m_maxMotorTorque;\n        this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_motorImpulse - oldImpulse;\n        wA -= iA * impulse;\n        wB += iB * impulse;\n      }\n      if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {\n        var Cdot1 = Vec2.zero();\n        Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        var Cdot2 = wB - wA;\n        var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);\n        var impulse = Vec3.neg(this.m_mass.solve33(Cdot));\n        if (this.m_limitState == LimitState$2.equalLimits) {\n          this.m_impulse.add(impulse);\n        } else if (this.m_limitState == LimitState$2.atLowerLimit) {\n          var newImpulse = this.m_impulse.z + impulse.z;\n          if (newImpulse < 0) {\n            var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));\n            var reduced = this.m_mass.solve22(rhs);\n            impulse.x = reduced.x;\n            impulse.y = reduced.y;\n            impulse.z = -this.m_impulse.z;\n            this.m_impulse.x += reduced.x;\n            this.m_impulse.y += reduced.y;\n            this.m_impulse.z = 0;\n          } else {\n            this.m_impulse.add(impulse);\n          }\n        } else if (this.m_limitState == LimitState$2.atUpperLimit) {\n          var newImpulse = this.m_impulse.z + impulse.z;\n          if (newImpulse > 0) {\n            var rhs = Vec2.combine(-1, Cdot1, this.m_impulse.z, Vec2.neo(this.m_mass.ez.x, this.m_mass.ez.y));\n            var reduced = this.m_mass.solve22(rhs);\n            impulse.x = reduced.x;\n            impulse.y = reduced.y;\n            impulse.z = -this.m_impulse.z;\n            this.m_impulse.x += reduced.x;\n            this.m_impulse.y += reduced.y;\n            this.m_impulse.z = 0;\n          } else {\n            this.m_impulse.add(impulse);\n          }\n        }\n        var P3 = Vec2.neo(impulse.x, impulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);\n      } else {\n        var Cdot = Vec2.zero();\n        Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        var impulse = this.m_mass.solve22(Vec2.neg(Cdot));\n        this.m_impulse.x += impulse.x;\n        this.m_impulse.y += impulse.y;\n        vA2.subMul(mA, impulse);\n        wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);\n        vB2.addMul(mB, impulse);\n        wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    RevoluteJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var angularError = 0;\n      var positionError = 0;\n      var fixedRotation = this.m_invIA + this.m_invIB == 0;\n      if (this.m_enableLimit && this.m_limitState != LimitState$2.inactiveLimit && fixedRotation == false) {\n        var angle = aB - aA - this.m_referenceAngle;\n        var limitImpulse = 0;\n        if (this.m_limitState == LimitState$2.equalLimits) {\n          var C = clamp(angle - this.m_lowerAngle, -SettingsInternal.maxAngularCorrection, SettingsInternal.maxAngularCorrection);\n          limitImpulse = -this.m_motorMass * C;\n          angularError = math_abs$4(C);\n        } else if (this.m_limitState == LimitState$2.atLowerLimit) {\n          var C = angle - this.m_lowerAngle;\n          angularError = -C;\n          C = clamp(C + SettingsInternal.angularSlop, -SettingsInternal.maxAngularCorrection, 0);\n          limitImpulse = -this.m_motorMass * C;\n        } else if (this.m_limitState == LimitState$2.atUpperLimit) {\n          var C = angle - this.m_upperAngle;\n          angularError = C;\n          C = clamp(C - SettingsInternal.angularSlop, 0, SettingsInternal.maxAngularCorrection);\n          limitImpulse = -this.m_motorMass * C;\n        }\n        aA -= this.m_invIA * limitImpulse;\n        aB += this.m_invIB * limitImpulse;\n      }\n      {\n        qA.setAngle(aA);\n        qB.setAngle(aB);\n        var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n        var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n        var C = Vec2.zero();\n        C.addCombine(1, cB2, 1, rB2);\n        C.subCombine(1, cA2, 1, rA2);\n        positionError = C.length();\n        var mA = this.m_invMassA;\n        var mB = this.m_invMassB;\n        var iA = this.m_invIA;\n        var iB = this.m_invIB;\n        var K = new Mat22();\n        K.ex.x = mA + mB + iA * rA2.y * rA2.y + iB * rB2.y * rB2.y;\n        K.ex.y = -iA * rA2.x * rA2.y - iB * rB2.x * rB2.y;\n        K.ey.x = K.ex.y;\n        K.ey.y = mA + mB + iA * rA2.x * rA2.x + iB * rB2.x * rB2.x;\n        var impulse = Vec2.neg(K.solve(C));\n        cA2.subMul(mA, impulse);\n        aA -= iA * Vec2.crossVec2Vec2(rA2, impulse);\n        cB2.addMul(mB, impulse);\n        aB += iB * Vec2.crossVec2Vec2(rB2, impulse);\n      }\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;\n    };\n    RevoluteJoint2.TYPE = \"revolute-joint\";\n    return RevoluteJoint2;\n  }(Joint)\n);\nvar math_abs$3 = Math.abs;\nvar math_max = Math.max;\nvar math_min$2 = Math.min;\nvar LimitState$1;\n(function(LimitState2) {\n  LimitState2[LimitState2[\"inactiveLimit\"] = 0] = \"inactiveLimit\";\n  LimitState2[LimitState2[\"atLowerLimit\"] = 1] = \"atLowerLimit\";\n  LimitState2[LimitState2[\"atUpperLimit\"] = 2] = \"atUpperLimit\";\n  LimitState2[LimitState2[\"equalLimits\"] = 3] = \"equalLimits\";\n})(LimitState$1 || (LimitState$1 = {}));\nvar DEFAULTS$7 = {\n  enableLimit: false,\n  lowerTranslation: 0,\n  upperTranslation: 0,\n  enableMotor: false,\n  maxMotorForce: 0,\n  motorSpeed: 0\n};\nvar PrismaticJoint = (\n  /** @class */\n  function(_super) {\n    __extends(PrismaticJoint2, _super);\n    function PrismaticJoint2(def, bodyA, bodyB, anchor, axis) {\n      var _this = this;\n      if (!(_this instanceof PrismaticJoint2)) {\n        return new PrismaticJoint2(def, bodyA, bodyB, anchor, axis);\n      }\n      def = options(def, DEFAULTS$7);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = PrismaticJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());\n      _this.m_localXAxisA = Vec2.clone(axis ? bodyA.getLocalVector(axis) : def.localAxisA || Vec2.neo(1, 0));\n      _this.m_localXAxisA.normalize();\n      _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);\n      _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();\n      _this.m_impulse = new Vec3();\n      _this.m_motorMass = 0;\n      _this.m_motorImpulse = 0;\n      _this.m_lowerTranslation = def.lowerTranslation;\n      _this.m_upperTranslation = def.upperTranslation;\n      _this.m_maxMotorForce = def.maxMotorForce;\n      _this.m_motorSpeed = def.motorSpeed;\n      _this.m_enableLimit = def.enableLimit;\n      _this.m_enableMotor = def.enableMotor;\n      _this.m_limitState = LimitState$1.inactiveLimit;\n      _this.m_axis = Vec2.zero();\n      _this.m_perp = Vec2.zero();\n      _this.m_K = new Mat33();\n      return _this;\n    }\n    PrismaticJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        lowerTranslation: this.m_lowerTranslation,\n        upperTranslation: this.m_upperTranslation,\n        maxMotorForce: this.m_maxMotorForce,\n        motorSpeed: this.m_motorSpeed,\n        enableLimit: this.m_enableLimit,\n        enableMotor: this.m_enableMotor,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        localAxisA: this.m_localXAxisA,\n        referenceAngle: this.m_referenceAngle\n      };\n    };\n    PrismaticJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      data.localAxisA = Vec2.clone(data.localAxisA);\n      var joint = new PrismaticJoint2(data);\n      return joint;\n    };\n    PrismaticJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (def.localAxisA) {\n        this.m_localXAxisA.setVec2(def.localAxisA);\n        this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));\n      }\n      if (Number.isFinite(def.referenceAngle)) {\n        this.m_referenceAngle = def.referenceAngle;\n      }\n      if (typeof def.enableLimit !== \"undefined\") {\n        this.m_enableLimit = !!def.enableLimit;\n      }\n      if (Number.isFinite(def.lowerTranslation)) {\n        this.m_lowerTranslation = def.lowerTranslation;\n      }\n      if (Number.isFinite(def.upperTranslation)) {\n        this.m_upperTranslation = def.upperTranslation;\n      }\n      if (typeof def.enableMotor !== \"undefined\") {\n        this.m_enableMotor = !!def.enableMotor;\n      }\n      if (Number.isFinite(def.maxMotorForce)) {\n        this.m_maxMotorForce = def.maxMotorForce;\n      }\n      if (Number.isFinite(def.motorSpeed)) {\n        this.m_motorSpeed = def.motorSpeed;\n      }\n    };\n    PrismaticJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    PrismaticJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    PrismaticJoint2.prototype.getLocalAxisA = function() {\n      return this.m_localXAxisA;\n    };\n    PrismaticJoint2.prototype.getReferenceAngle = function() {\n      return this.m_referenceAngle;\n    };\n    PrismaticJoint2.prototype.getJointTranslation = function() {\n      var pA2 = this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n      var pB2 = this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n      var d2 = Vec2.sub(pB2, pA2);\n      var axis = this.m_bodyA.getWorldVector(this.m_localXAxisA);\n      var translation2 = Vec2.dot(d2, axis);\n      return translation2;\n    };\n    PrismaticJoint2.prototype.getJointSpeed = function() {\n      var bA = this.m_bodyA;\n      var bB = this.m_bodyB;\n      var rA2 = Rot.mulVec2(bA.m_xf.q, Vec2.sub(this.m_localAnchorA, bA.m_sweep.localCenter));\n      var rB2 = Rot.mulVec2(bB.m_xf.q, Vec2.sub(this.m_localAnchorB, bB.m_sweep.localCenter));\n      var p1 = Vec2.add(bA.m_sweep.c, rA2);\n      var p2 = Vec2.add(bB.m_sweep.c, rB2);\n      var d2 = Vec2.sub(p2, p1);\n      var axis = Rot.mulVec2(bA.m_xf.q, this.m_localXAxisA);\n      var vA2 = bA.m_linearVelocity;\n      var vB2 = bB.m_linearVelocity;\n      var wA = bA.m_angularVelocity;\n      var wB = bB.m_angularVelocity;\n      var speed = Vec2.dot(d2, Vec2.crossNumVec2(wA, axis)) + Vec2.dot(axis, Vec2.sub(Vec2.addCrossNumVec2(vB2, wB, rB2), Vec2.addCrossNumVec2(vA2, wA, rA2)));\n      return speed;\n    };\n    PrismaticJoint2.prototype.isLimitEnabled = function() {\n      return this.m_enableLimit;\n    };\n    PrismaticJoint2.prototype.enableLimit = function(flag) {\n      if (flag != this.m_enableLimit) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_enableLimit = flag;\n        this.m_impulse.z = 0;\n      }\n    };\n    PrismaticJoint2.prototype.getLowerLimit = function() {\n      return this.m_lowerTranslation;\n    };\n    PrismaticJoint2.prototype.getUpperLimit = function() {\n      return this.m_upperTranslation;\n    };\n    PrismaticJoint2.prototype.setLimits = function(lower, upper) {\n      if (lower != this.m_lowerTranslation || upper != this.m_upperTranslation) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_lowerTranslation = lower;\n        this.m_upperTranslation = upper;\n        this.m_impulse.z = 0;\n      }\n    };\n    PrismaticJoint2.prototype.isMotorEnabled = function() {\n      return this.m_enableMotor;\n    };\n    PrismaticJoint2.prototype.enableMotor = function(flag) {\n      if (flag == this.m_enableMotor)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_enableMotor = flag;\n    };\n    PrismaticJoint2.prototype.setMotorSpeed = function(speed) {\n      if (speed == this.m_motorSpeed)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_motorSpeed = speed;\n    };\n    PrismaticJoint2.prototype.setMaxMotorForce = function(force) {\n      if (force == this.m_maxMotorForce)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_maxMotorForce = force;\n    };\n    PrismaticJoint2.prototype.getMaxMotorForce = function() {\n      return this.m_maxMotorForce;\n    };\n    PrismaticJoint2.prototype.getMotorSpeed = function() {\n      return this.m_motorSpeed;\n    };\n    PrismaticJoint2.prototype.getMotorForce = function(inv_dt) {\n      return inv_dt * this.m_motorImpulse;\n    };\n    PrismaticJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    PrismaticJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    PrismaticJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis).mul(inv_dt);\n    };\n    PrismaticJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_impulse.y;\n    };\n    PrismaticJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var d2 = Vec2.zero();\n      d2.addCombine(1, cB2, 1, rB2);\n      d2.subCombine(1, cA2, 1, rA2);\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      {\n        this.m_axis = Rot.mulVec2(qA, this.m_localXAxisA);\n        this.m_a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_axis);\n        this.m_a2 = Vec2.crossVec2Vec2(rB2, this.m_axis);\n        this.m_motorMass = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;\n        if (this.m_motorMass > 0) {\n          this.m_motorMass = 1 / this.m_motorMass;\n        }\n      }\n      {\n        this.m_perp = Rot.mulVec2(qA, this.m_localYAxisA);\n        this.m_s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_perp);\n        this.m_s2 = Vec2.crossVec2Vec2(rB2, this.m_perp);\n        Vec2.crossVec2Vec2(rA2, this.m_perp);\n        var k11 = mA + mB + iA * this.m_s1 * this.m_s1 + iB * this.m_s2 * this.m_s2;\n        var k12 = iA * this.m_s1 + iB * this.m_s2;\n        var k13 = iA * this.m_s1 * this.m_a1 + iB * this.m_s2 * this.m_a2;\n        var k22 = iA + iB;\n        if (k22 == 0) {\n          k22 = 1;\n        }\n        var k23 = iA * this.m_a1 + iB * this.m_a2;\n        var k33 = mA + mB + iA * this.m_a1 * this.m_a1 + iB * this.m_a2 * this.m_a2;\n        this.m_K.ex.set(k11, k12, k13);\n        this.m_K.ey.set(k12, k22, k23);\n        this.m_K.ez.set(k13, k23, k33);\n      }\n      if (this.m_enableLimit) {\n        var jointTranslation = Vec2.dot(this.m_axis, d2);\n        if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * SettingsInternal.linearSlop) {\n          this.m_limitState = LimitState$1.equalLimits;\n        } else if (jointTranslation <= this.m_lowerTranslation) {\n          if (this.m_limitState != LimitState$1.atLowerLimit) {\n            this.m_limitState = LimitState$1.atLowerLimit;\n            this.m_impulse.z = 0;\n          }\n        } else if (jointTranslation >= this.m_upperTranslation) {\n          if (this.m_limitState != LimitState$1.atUpperLimit) {\n            this.m_limitState = LimitState$1.atUpperLimit;\n            this.m_impulse.z = 0;\n          }\n        } else {\n          this.m_limitState = LimitState$1.inactiveLimit;\n          this.m_impulse.z = 0;\n        }\n      } else {\n        this.m_limitState = LimitState$1.inactiveLimit;\n        this.m_impulse.z = 0;\n      }\n      if (this.m_enableMotor == false) {\n        this.m_motorImpulse = 0;\n      }\n      if (step.warmStarting) {\n        this.m_impulse.mul(step.dtRatio);\n        this.m_motorImpulse *= step.dtRatio;\n        var P3 = Vec2.combine(this.m_impulse.x, this.m_perp, this.m_motorImpulse + this.m_impulse.z, this.m_axis);\n        var LA = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1;\n        var LB = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      } else {\n        this.m_impulse.setZero();\n        this.m_motorImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    PrismaticJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      if (this.m_enableMotor && this.m_limitState != LimitState$1.equalLimits) {\n        var Cdot = Vec2.dot(this.m_axis, Vec2.sub(vB2, vA2)) + this.m_a2 * wB - this.m_a1 * wA;\n        var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);\n        var oldImpulse = this.m_motorImpulse;\n        var maxImpulse = step.dt * this.m_maxMotorForce;\n        this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_motorImpulse - oldImpulse;\n        var P3 = Vec2.mulNumVec2(impulse, this.m_axis);\n        var LA = impulse * this.m_a1;\n        var LB = impulse * this.m_a2;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      }\n      var Cdot1 = Vec2.zero();\n      Cdot1.x += Vec2.dot(this.m_perp, vB2) + this.m_s2 * wB;\n      Cdot1.x -= Vec2.dot(this.m_perp, vA2) + this.m_s1 * wA;\n      Cdot1.y = wB - wA;\n      if (this.m_enableLimit && this.m_limitState != LimitState$1.inactiveLimit) {\n        var Cdot2 = 0;\n        Cdot2 += Vec2.dot(this.m_axis, vB2) + this.m_a2 * wB;\n        Cdot2 -= Vec2.dot(this.m_axis, vA2) + this.m_a1 * wA;\n        var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);\n        var f1 = Vec3.clone(this.m_impulse);\n        var df = this.m_K.solve33(Vec3.neg(Cdot));\n        this.m_impulse.add(df);\n        if (this.m_limitState == LimitState$1.atLowerLimit) {\n          this.m_impulse.z = math_max(this.m_impulse.z, 0);\n        } else if (this.m_limitState == LimitState$1.atUpperLimit) {\n          this.m_impulse.z = math_min$2(this.m_impulse.z, 0);\n        }\n        var b2 = Vec2.combine(-1, Cdot1, -(this.m_impulse.z - f1.z), Vec2.neo(this.m_K.ez.x, this.m_K.ez.y));\n        var f2r = Vec2.add(this.m_K.solve22(b2), Vec2.neo(f1.x, f1.y));\n        this.m_impulse.x = f2r.x;\n        this.m_impulse.y = f2r.y;\n        df = Vec3.sub(this.m_impulse, f1);\n        var P3 = Vec2.combine(df.x, this.m_perp, df.z, this.m_axis);\n        var LA = df.x * this.m_s1 + df.y + df.z * this.m_a1;\n        var LB = df.x * this.m_s2 + df.y + df.z * this.m_a2;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      } else {\n        var df = this.m_K.solve22(Vec2.neg(Cdot1));\n        this.m_impulse.x += df.x;\n        this.m_impulse.y += df.y;\n        var P3 = Vec2.mulNumVec2(df.x, this.m_perp);\n        var LA = df.x * this.m_s1 + df.y;\n        var LB = df.x * this.m_s2 + df.y;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    PrismaticJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var d2 = Vec2.sub(Vec2.add(cB2, rB2), Vec2.add(cA2, rA2));\n      var axis = Rot.mulVec2(qA, this.m_localXAxisA);\n      var a1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), axis);\n      var a2 = Vec2.crossVec2Vec2(rB2, axis);\n      var perp2 = Rot.mulVec2(qA, this.m_localYAxisA);\n      var s1 = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), perp2);\n      var s2 = Vec2.crossVec2Vec2(rB2, perp2);\n      var impulse = new Vec3();\n      var C1 = Vec2.zero();\n      C1.x = Vec2.dot(perp2, d2);\n      C1.y = aB - aA - this.m_referenceAngle;\n      var linearError = math_abs$3(C1.x);\n      var angularError = math_abs$3(C1.y);\n      var linearSlop = SettingsInternal.linearSlop;\n      var maxLinearCorrection = SettingsInternal.maxLinearCorrection;\n      var active = false;\n      var C2 = 0;\n      if (this.m_enableLimit) {\n        var translation2 = Vec2.dot(axis, d2);\n        if (math_abs$3(this.m_upperTranslation - this.m_lowerTranslation) < 2 * linearSlop) {\n          C2 = clamp(translation2, -maxLinearCorrection, maxLinearCorrection);\n          linearError = math_max(linearError, math_abs$3(translation2));\n          active = true;\n        } else if (translation2 <= this.m_lowerTranslation) {\n          C2 = clamp(translation2 - this.m_lowerTranslation + linearSlop, -maxLinearCorrection, 0);\n          linearError = Math.max(linearError, this.m_lowerTranslation - translation2);\n          active = true;\n        } else if (translation2 >= this.m_upperTranslation) {\n          C2 = clamp(translation2 - this.m_upperTranslation - linearSlop, 0, maxLinearCorrection);\n          linearError = Math.max(linearError, translation2 - this.m_upperTranslation);\n          active = true;\n        }\n      }\n      if (active) {\n        var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;\n        var k12 = iA * s1 + iB * s2;\n        var k13 = iA * s1 * a1 + iB * s2 * a2;\n        var k22 = iA + iB;\n        if (k22 == 0) {\n          k22 = 1;\n        }\n        var k23 = iA * a1 + iB * a2;\n        var k33 = mA + mB + iA * a1 * a1 + iB * a2 * a2;\n        var K = new Mat33();\n        K.ex.set(k11, k12, k13);\n        K.ey.set(k12, k22, k23);\n        K.ez.set(k13, k23, k33);\n        var C = new Vec3();\n        C.x = C1.x;\n        C.y = C1.y;\n        C.z = C2;\n        impulse = K.solve33(Vec3.neg(C));\n      } else {\n        var k11 = mA + mB + iA * s1 * s1 + iB * s2 * s2;\n        var k12 = iA * s1 + iB * s2;\n        var k22 = iA + iB;\n        if (k22 == 0) {\n          k22 = 1;\n        }\n        var K = new Mat22();\n        K.ex.setNum(k11, k12);\n        K.ey.setNum(k12, k22);\n        var impulse1 = K.solve(Vec2.neg(C1));\n        impulse.x = impulse1.x;\n        impulse.y = impulse1.y;\n        impulse.z = 0;\n      }\n      var P3 = Vec2.combine(impulse.x, perp2, impulse.z, axis);\n      var LA = impulse.x * s1 + impulse.y + impulse.z * a1;\n      var LB = impulse.x * s2 + impulse.y + impulse.z * a2;\n      cA2.subMul(mA, P3);\n      aA -= iA * LA;\n      cB2.addMul(mB, P3);\n      aB += iB * LB;\n      this.m_bodyA.c_position.c = cA2;\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c = cB2;\n      this.m_bodyB.c_position.a = aB;\n      return linearError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;\n    };\n    PrismaticJoint2.TYPE = \"prismatic-joint\";\n    return PrismaticJoint2;\n  }(Joint)\n);\nvar DEFAULTS$6 = {\n  ratio: 1\n};\nvar GearJoint = (\n  /** @class */\n  function(_super) {\n    __extends(GearJoint2, _super);\n    function GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio) {\n      var _this = this;\n      if (!(_this instanceof GearJoint2)) {\n        return new GearJoint2(def, bodyA, bodyB, joint1, joint2, ratio);\n      }\n      def = options(def, DEFAULTS$6);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = GearJoint2.TYPE;\n      _this.m_joint1 = joint1 ? joint1 : def.joint1;\n      _this.m_joint2 = joint2 ? joint2 : def.joint2;\n      _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;\n      _this.m_type1 = _this.m_joint1.getType();\n      _this.m_type2 = _this.m_joint2.getType();\n      var coordinateA;\n      var coordinateB;\n      _this.m_bodyC = _this.m_joint1.getBodyA();\n      _this.m_bodyA = _this.m_joint1.getBodyB();\n      var xfA2 = _this.m_bodyA.m_xf;\n      var aA = _this.m_bodyA.m_sweep.a;\n      var xfC = _this.m_bodyC.m_xf;\n      var aC = _this.m_bodyC.m_sweep.a;\n      if (_this.m_type1 === RevoluteJoint.TYPE) {\n        var revolute = _this.m_joint1;\n        _this.m_localAnchorC = revolute.m_localAnchorA;\n        _this.m_localAnchorA = revolute.m_localAnchorB;\n        _this.m_referenceAngleA = revolute.m_referenceAngle;\n        _this.m_localAxisC = Vec2.zero();\n        coordinateA = aA - aC - _this.m_referenceAngleA;\n      } else {\n        var prismatic = _this.m_joint1;\n        _this.m_localAnchorC = prismatic.m_localAnchorA;\n        _this.m_localAnchorA = prismatic.m_localAnchorB;\n        _this.m_referenceAngleA = prismatic.m_referenceAngle;\n        _this.m_localAxisC = prismatic.m_localXAxisA;\n        var pC = _this.m_localAnchorC;\n        var pA2 = Rot.mulTVec2(xfC.q, Vec2.add(Rot.mulVec2(xfA2.q, _this.m_localAnchorA), Vec2.sub(xfA2.p, xfC.p)));\n        coordinateA = Vec2.dot(pA2, _this.m_localAxisC) - Vec2.dot(pC, _this.m_localAxisC);\n      }\n      _this.m_bodyD = _this.m_joint2.getBodyA();\n      _this.m_bodyB = _this.m_joint2.getBodyB();\n      var xfB2 = _this.m_bodyB.m_xf;\n      var aB = _this.m_bodyB.m_sweep.a;\n      var xfD = _this.m_bodyD.m_xf;\n      var aD = _this.m_bodyD.m_sweep.a;\n      if (_this.m_type2 === RevoluteJoint.TYPE) {\n        var revolute = _this.m_joint2;\n        _this.m_localAnchorD = revolute.m_localAnchorA;\n        _this.m_localAnchorB = revolute.m_localAnchorB;\n        _this.m_referenceAngleB = revolute.m_referenceAngle;\n        _this.m_localAxisD = Vec2.zero();\n        coordinateB = aB - aD - _this.m_referenceAngleB;\n      } else {\n        var prismatic = _this.m_joint2;\n        _this.m_localAnchorD = prismatic.m_localAnchorA;\n        _this.m_localAnchorB = prismatic.m_localAnchorB;\n        _this.m_referenceAngleB = prismatic.m_referenceAngle;\n        _this.m_localAxisD = prismatic.m_localXAxisA;\n        var pD = _this.m_localAnchorD;\n        var pB2 = Rot.mulTVec2(xfD.q, Vec2.add(Rot.mulVec2(xfB2.q, _this.m_localAnchorB), Vec2.sub(xfB2.p, xfD.p)));\n        coordinateB = Vec2.dot(pB2, _this.m_localAxisD) - Vec2.dot(pD, _this.m_localAxisD);\n      }\n      _this.m_constant = coordinateA + _this.m_ratio * coordinateB;\n      _this.m_impulse = 0;\n      return _this;\n    }\n    GearJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        joint1: this.m_joint1,\n        joint2: this.m_joint2,\n        ratio: this.m_ratio\n        // _constant: this.m_constant,\n      };\n    };\n    GearJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      data.joint1 = restore(Joint, data.joint1, world);\n      data.joint2 = restore(Joint, data.joint2, world);\n      var joint = new GearJoint2(data);\n      return joint;\n    };\n    GearJoint2.prototype._reset = function(def) {\n      if (Number.isFinite(def.ratio)) {\n        this.m_ratio = def.ratio;\n      }\n    };\n    GearJoint2.prototype.getJoint1 = function() {\n      return this.m_joint1;\n    };\n    GearJoint2.prototype.getJoint2 = function() {\n      return this.m_joint2;\n    };\n    GearJoint2.prototype.setRatio = function(ratio) {\n      this.m_ratio = ratio;\n    };\n    GearJoint2.prototype.getRatio = function() {\n      return this.m_ratio;\n    };\n    GearJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    GearJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    GearJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(this.m_impulse, this.m_JvAC).mul(inv_dt);\n    };\n    GearJoint2.prototype.getReactionTorque = function(inv_dt) {\n      var L = this.m_impulse * this.m_JwA;\n      return inv_dt * L;\n    };\n    GearJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_lcA = this.m_bodyA.m_sweep.localCenter;\n      this.m_lcB = this.m_bodyB.m_sweep.localCenter;\n      this.m_lcC = this.m_bodyC.m_sweep.localCenter;\n      this.m_lcD = this.m_bodyD.m_sweep.localCenter;\n      this.m_mA = this.m_bodyA.m_invMass;\n      this.m_mB = this.m_bodyB.m_invMass;\n      this.m_mC = this.m_bodyC.m_invMass;\n      this.m_mD = this.m_bodyD.m_invMass;\n      this.m_iA = this.m_bodyA.m_invI;\n      this.m_iB = this.m_bodyB.m_invI;\n      this.m_iC = this.m_bodyC.m_invI;\n      this.m_iD = this.m_bodyD.m_invI;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var aC = this.m_bodyC.c_position.a;\n      var vC = this.m_bodyC.c_velocity.v;\n      var wC = this.m_bodyC.c_velocity.w;\n      var aD = this.m_bodyD.c_position.a;\n      var vD = this.m_bodyD.c_velocity.v;\n      var wD = this.m_bodyD.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var qC = Rot.neo(aC);\n      var qD = Rot.neo(aD);\n      this.m_mass = 0;\n      if (this.m_type1 == RevoluteJoint.TYPE) {\n        this.m_JvAC = Vec2.zero();\n        this.m_JwA = 1;\n        this.m_JwC = 1;\n        this.m_mass += this.m_iA + this.m_iC;\n      } else {\n        var u = Rot.mulVec2(qC, this.m_localAxisC);\n        var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);\n        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);\n        this.m_JvAC = u;\n        this.m_JwC = Vec2.crossVec2Vec2(rC, u);\n        this.m_JwA = Vec2.crossVec2Vec2(rA2, u);\n        this.m_mass += this.m_mC + this.m_mA + this.m_iC * this.m_JwC * this.m_JwC + this.m_iA * this.m_JwA * this.m_JwA;\n      }\n      if (this.m_type2 == RevoluteJoint.TYPE) {\n        this.m_JvBD = Vec2.zero();\n        this.m_JwB = this.m_ratio;\n        this.m_JwD = this.m_ratio;\n        this.m_mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);\n      } else {\n        var u = Rot.mulVec2(qD, this.m_localAxisD);\n        var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);\n        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);\n        this.m_JvBD = Vec2.mulNumVec2(this.m_ratio, u);\n        this.m_JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);\n        this.m_JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);\n        this.m_mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * this.m_JwD * this.m_JwD + this.m_iB * this.m_JwB * this.m_JwB;\n      }\n      this.m_mass = this.m_mass > 0 ? 1 / this.m_mass : 0;\n      if (step.warmStarting) {\n        vA2.addMul(this.m_mA * this.m_impulse, this.m_JvAC);\n        wA += this.m_iA * this.m_impulse * this.m_JwA;\n        vB2.addMul(this.m_mB * this.m_impulse, this.m_JvBD);\n        wB += this.m_iB * this.m_impulse * this.m_JwB;\n        vC.subMul(this.m_mC * this.m_impulse, this.m_JvAC);\n        wC -= this.m_iC * this.m_impulse * this.m_JwC;\n        vD.subMul(this.m_mD * this.m_impulse, this.m_JvBD);\n        wD -= this.m_iD * this.m_impulse * this.m_JwD;\n      } else {\n        this.m_impulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n      this.m_bodyC.c_velocity.v.setVec2(vC);\n      this.m_bodyC.c_velocity.w = wC;\n      this.m_bodyD.c_velocity.v.setVec2(vD);\n      this.m_bodyD.c_velocity.w = wD;\n    };\n    GearJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var vC = this.m_bodyC.c_velocity.v;\n      var wC = this.m_bodyC.c_velocity.w;\n      var vD = this.m_bodyD.c_velocity.v;\n      var wD = this.m_bodyD.c_velocity.w;\n      var Cdot = Vec2.dot(this.m_JvAC, vA2) - Vec2.dot(this.m_JvAC, vC) + Vec2.dot(this.m_JvBD, vB2) - Vec2.dot(this.m_JvBD, vD);\n      Cdot += this.m_JwA * wA - this.m_JwC * wC + (this.m_JwB * wB - this.m_JwD * wD);\n      var impulse = -this.m_mass * Cdot;\n      this.m_impulse += impulse;\n      vA2.addMul(this.m_mA * impulse, this.m_JvAC);\n      wA += this.m_iA * impulse * this.m_JwA;\n      vB2.addMul(this.m_mB * impulse, this.m_JvBD);\n      wB += this.m_iB * impulse * this.m_JwB;\n      vC.subMul(this.m_mC * impulse, this.m_JvAC);\n      wC -= this.m_iC * impulse * this.m_JwC;\n      vD.subMul(this.m_mD * impulse, this.m_JvBD);\n      wD -= this.m_iD * impulse * this.m_JwD;\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n      this.m_bodyC.c_velocity.v.setVec2(vC);\n      this.m_bodyC.c_velocity.w = wC;\n      this.m_bodyD.c_velocity.v.setVec2(vD);\n      this.m_bodyD.c_velocity.w = wD;\n    };\n    GearJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var cC = this.m_bodyC.c_position.c;\n      var aC = this.m_bodyC.c_position.a;\n      var cD = this.m_bodyD.c_position.c;\n      var aD = this.m_bodyD.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var qC = Rot.neo(aC);\n      var qD = Rot.neo(aD);\n      var linearError = 0;\n      var coordinateA;\n      var coordinateB;\n      var JvAC;\n      var JvBD;\n      var JwA;\n      var JwB;\n      var JwC;\n      var JwD;\n      var mass = 0;\n      if (this.m_type1 == RevoluteJoint.TYPE) {\n        JvAC = Vec2.zero();\n        JwA = 1;\n        JwC = 1;\n        mass += this.m_iA + this.m_iC;\n        coordinateA = aA - aC - this.m_referenceAngleA;\n      } else {\n        var u = Rot.mulVec2(qC, this.m_localAxisC);\n        var rC = Rot.mulSub(qC, this.m_localAnchorC, this.m_lcC);\n        var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_lcA);\n        JvAC = u;\n        JwC = Vec2.crossVec2Vec2(rC, u);\n        JwA = Vec2.crossVec2Vec2(rA2, u);\n        mass += this.m_mC + this.m_mA + this.m_iC * JwC * JwC + this.m_iA * JwA * JwA;\n        var pC = Vec2.sub(this.m_localAnchorC, this.m_lcC);\n        var pA2 = Rot.mulTVec2(qC, Vec2.add(rA2, Vec2.sub(cA2, cC)));\n        coordinateA = Vec2.dot(Vec2.sub(pA2, pC), this.m_localAxisC);\n      }\n      if (this.m_type2 == RevoluteJoint.TYPE) {\n        JvBD = Vec2.zero();\n        JwB = this.m_ratio;\n        JwD = this.m_ratio;\n        mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD);\n        coordinateB = aB - aD - this.m_referenceAngleB;\n      } else {\n        var u = Rot.mulVec2(qD, this.m_localAxisD);\n        var rD = Rot.mulSub(qD, this.m_localAnchorD, this.m_lcD);\n        var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_lcB);\n        JvBD = Vec2.mulNumVec2(this.m_ratio, u);\n        JwD = this.m_ratio * Vec2.crossVec2Vec2(rD, u);\n        JwB = this.m_ratio * Vec2.crossVec2Vec2(rB2, u);\n        mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * JwD * JwD + this.m_iB * JwB * JwB;\n        var pD = Vec2.sub(this.m_localAnchorD, this.m_lcD);\n        var pB2 = Rot.mulTVec2(qD, Vec2.add(rB2, Vec2.sub(cB2, cD)));\n        coordinateB = Vec2.dot(pB2, this.m_localAxisD) - Vec2.dot(pD, this.m_localAxisD);\n      }\n      var C = coordinateA + this.m_ratio * coordinateB - this.m_constant;\n      var impulse = 0;\n      if (mass > 0) {\n        impulse = -C / mass;\n      }\n      cA2.addMul(this.m_mA * impulse, JvAC);\n      aA += this.m_iA * impulse * JwA;\n      cB2.addMul(this.m_mB * impulse, JvBD);\n      aB += this.m_iB * impulse * JwB;\n      cC.subMul(this.m_mC * impulse, JvAC);\n      aC -= this.m_iC * impulse * JwC;\n      cD.subMul(this.m_mD * impulse, JvBD);\n      aD -= this.m_iD * impulse * JwD;\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      this.m_bodyC.c_position.c.setVec2(cC);\n      this.m_bodyC.c_position.a = aC;\n      this.m_bodyD.c_position.c.setVec2(cD);\n      this.m_bodyD.c_position.a = aD;\n      return linearError < SettingsInternal.linearSlop;\n    };\n    GearJoint2.TYPE = \"gear-joint\";\n    return GearJoint2;\n  }(Joint)\n);\nvar DEFAULTS$5 = {\n  maxForce: 1,\n  maxTorque: 1,\n  correctionFactor: 0.3\n};\nvar MotorJoint = (\n  /** @class */\n  function(_super) {\n    __extends(MotorJoint2, _super);\n    function MotorJoint2(def, bodyA, bodyB) {\n      var _this = this;\n      if (!(_this instanceof MotorJoint2)) {\n        return new MotorJoint2(def, bodyA, bodyB);\n      }\n      def = options(def, DEFAULTS$5);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = MotorJoint2.TYPE;\n      _this.m_linearOffset = Vec2.isValid(def.linearOffset) ? Vec2.clone(def.linearOffset) : bodyA.getLocalPoint(bodyB.getPosition());\n      _this.m_angularOffset = Number.isFinite(def.angularOffset) ? def.angularOffset : bodyB.getAngle() - bodyA.getAngle();\n      _this.m_linearImpulse = Vec2.zero();\n      _this.m_angularImpulse = 0;\n      _this.m_maxForce = def.maxForce;\n      _this.m_maxTorque = def.maxTorque;\n      _this.m_correctionFactor = def.correctionFactor;\n      return _this;\n    }\n    MotorJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        maxForce: this.m_maxForce,\n        maxTorque: this.m_maxTorque,\n        correctionFactor: this.m_correctionFactor,\n        linearOffset: this.m_linearOffset,\n        angularOffset: this.m_angularOffset\n      };\n    };\n    MotorJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new MotorJoint2(data);\n      return joint;\n    };\n    MotorJoint2.prototype._reset = function(def) {\n      if (Number.isFinite(def.angularOffset)) {\n        this.m_angularOffset = def.angularOffset;\n      }\n      if (Number.isFinite(def.maxForce)) {\n        this.m_maxForce = def.maxForce;\n      }\n      if (Number.isFinite(def.maxTorque)) {\n        this.m_maxTorque = def.maxTorque;\n      }\n      if (Number.isFinite(def.correctionFactor)) {\n        this.m_correctionFactor = def.correctionFactor;\n      }\n      if (Vec2.isValid(def.linearOffset)) {\n        this.m_linearOffset.set(def.linearOffset);\n      }\n    };\n    MotorJoint2.prototype.setMaxForce = function(force) {\n      this.m_maxForce = force;\n    };\n    MotorJoint2.prototype.getMaxForce = function() {\n      return this.m_maxForce;\n    };\n    MotorJoint2.prototype.setMaxTorque = function(torque) {\n      this.m_maxTorque = torque;\n    };\n    MotorJoint2.prototype.getMaxTorque = function() {\n      return this.m_maxTorque;\n    };\n    MotorJoint2.prototype.setCorrectionFactor = function(factor) {\n      this.m_correctionFactor = factor;\n    };\n    MotorJoint2.prototype.getCorrectionFactor = function() {\n      return this.m_correctionFactor;\n    };\n    MotorJoint2.prototype.setLinearOffset = function(linearOffset) {\n      if (linearOffset.x != this.m_linearOffset.x || linearOffset.y != this.m_linearOffset.y) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_linearOffset.set(linearOffset);\n      }\n    };\n    MotorJoint2.prototype.getLinearOffset = function() {\n      return this.m_linearOffset;\n    };\n    MotorJoint2.prototype.setAngularOffset = function(angularOffset) {\n      if (angularOffset != this.m_angularOffset) {\n        this.m_bodyA.setAwake(true);\n        this.m_bodyB.setAwake(true);\n        this.m_angularOffset = angularOffset;\n      }\n    };\n    MotorJoint2.prototype.getAngularOffset = function() {\n      return this.m_angularOffset;\n    };\n    MotorJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getPosition();\n    };\n    MotorJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getPosition();\n    };\n    MotorJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(inv_dt, this.m_linearImpulse);\n    };\n    MotorJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_angularImpulse;\n    };\n    MotorJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_linearOffset, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.neg(this.m_localCenterB));\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var K = new Mat22();\n      K.ex.x = mA + mB + iA * this.m_rA.y * this.m_rA.y + iB * this.m_rB.y * this.m_rB.y;\n      K.ex.y = -iA * this.m_rA.x * this.m_rA.y - iB * this.m_rB.x * this.m_rB.y;\n      K.ey.x = K.ex.y;\n      K.ey.y = mA + mB + iA * this.m_rA.x * this.m_rA.x + iB * this.m_rB.x * this.m_rB.x;\n      this.m_linearMass = K.getInverse();\n      this.m_angularMass = iA + iB;\n      if (this.m_angularMass > 0) {\n        this.m_angularMass = 1 / this.m_angularMass;\n      }\n      this.m_linearError = Vec2.zero();\n      this.m_linearError.addCombine(1, cB2, 1, this.m_rB);\n      this.m_linearError.subCombine(1, cA2, 1, this.m_rA);\n      this.m_angularError = aB - aA - this.m_angularOffset;\n      if (step.warmStarting) {\n        this.m_linearImpulse.mul(step.dtRatio);\n        this.m_angularImpulse *= step.dtRatio;\n        var P3 = Vec2.neo(this.m_linearImpulse.x, this.m_linearImpulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_angularImpulse);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_angularImpulse);\n      } else {\n        this.m_linearImpulse.setZero();\n        this.m_angularImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    MotorJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var h = step.dt;\n      var inv_h = step.inv_dt;\n      {\n        var Cdot = wB - wA + inv_h * this.m_correctionFactor * this.m_angularError;\n        var impulse = -this.m_angularMass * Cdot;\n        var oldImpulse = this.m_angularImpulse;\n        var maxImpulse = h * this.m_maxTorque;\n        this.m_angularImpulse = clamp(this.m_angularImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_angularImpulse - oldImpulse;\n        wA -= iA * impulse;\n        wB += iB * impulse;\n      }\n      {\n        var Cdot = Vec2.zero();\n        Cdot.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        Cdot.addMul(inv_h * this.m_correctionFactor, this.m_linearError);\n        var impulse = Vec2.neg(Mat22.mulVec2(this.m_linearMass, Cdot));\n        var oldImpulse = Vec2.clone(this.m_linearImpulse);\n        this.m_linearImpulse.add(impulse);\n        var maxImpulse = h * this.m_maxForce;\n        this.m_linearImpulse.clamp(maxImpulse);\n        impulse = Vec2.sub(this.m_linearImpulse, oldImpulse);\n        vA2.subMul(mA, impulse);\n        wA -= iA * Vec2.crossVec2Vec2(this.m_rA, impulse);\n        vB2.addMul(mB, impulse);\n        wB += iB * Vec2.crossVec2Vec2(this.m_rB, impulse);\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    MotorJoint2.prototype.solvePositionConstraints = function(step) {\n      return true;\n    };\n    MotorJoint2.TYPE = \"motor-joint\";\n    return MotorJoint2;\n  }(Joint)\n);\nvar math_PI$2 = Math.PI;\nvar DEFAULTS$4 = {\n  maxForce: 0,\n  frequencyHz: 5,\n  dampingRatio: 0.7\n};\nvar MouseJoint = (\n  /** @class */\n  function(_super) {\n    __extends(MouseJoint2, _super);\n    function MouseJoint2(def, bodyA, bodyB, target) {\n      var _this = this;\n      if (!(_this instanceof MouseJoint2)) {\n        return new MouseJoint2(def, bodyA, bodyB, target);\n      }\n      def = options(def, DEFAULTS$4);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = MouseJoint2.TYPE;\n      if (Vec2.isValid(target)) {\n        _this.m_targetA = Vec2.clone(target);\n      } else if (Vec2.isValid(def.target)) {\n        _this.m_targetA = Vec2.clone(def.target);\n      } else {\n        _this.m_targetA = Vec2.zero();\n      }\n      _this.m_localAnchorB = Transform.mulTVec2(bodyB.getTransform(), _this.m_targetA);\n      _this.m_maxForce = def.maxForce;\n      _this.m_impulse = Vec2.zero();\n      _this.m_frequencyHz = def.frequencyHz;\n      _this.m_dampingRatio = def.dampingRatio;\n      _this.m_beta = 0;\n      _this.m_gamma = 0;\n      _this.m_rB = Vec2.zero();\n      _this.m_localCenterB = Vec2.zero();\n      _this.m_invMassB = 0;\n      _this.m_invIB = 0;\n      _this.m_mass = new Mat22();\n      _this.m_C = Vec2.zero();\n      return _this;\n    }\n    MouseJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        target: this.m_targetA,\n        maxForce: this.m_maxForce,\n        frequencyHz: this.m_frequencyHz,\n        dampingRatio: this.m_dampingRatio,\n        _localAnchorB: this.m_localAnchorB\n      };\n    };\n    MouseJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      data.target = Vec2.clone(data.target);\n      var joint = new MouseJoint2(data);\n      if (data._localAnchorB) {\n        joint.m_localAnchorB = data._localAnchorB;\n      }\n      return joint;\n    };\n    MouseJoint2.prototype._reset = function(def) {\n      if (Number.isFinite(def.maxForce)) {\n        this.m_maxForce = def.maxForce;\n      }\n      if (Number.isFinite(def.frequencyHz)) {\n        this.m_frequencyHz = def.frequencyHz;\n      }\n      if (Number.isFinite(def.dampingRatio)) {\n        this.m_dampingRatio = def.dampingRatio;\n      }\n    };\n    MouseJoint2.prototype.setTarget = function(target) {\n      if (Vec2.areEqual(target, this.m_targetA))\n        return;\n      this.m_bodyB.setAwake(true);\n      this.m_targetA.set(target);\n    };\n    MouseJoint2.prototype.getTarget = function() {\n      return this.m_targetA;\n    };\n    MouseJoint2.prototype.setMaxForce = function(force) {\n      this.m_maxForce = force;\n    };\n    MouseJoint2.prototype.getMaxForce = function() {\n      return this.m_maxForce;\n    };\n    MouseJoint2.prototype.setFrequency = function(hz) {\n      this.m_frequencyHz = hz;\n    };\n    MouseJoint2.prototype.getFrequency = function() {\n      return this.m_frequencyHz;\n    };\n    MouseJoint2.prototype.setDampingRatio = function(ratio) {\n      this.m_dampingRatio = ratio;\n    };\n    MouseJoint2.prototype.getDampingRatio = function() {\n      return this.m_dampingRatio;\n    };\n    MouseJoint2.prototype.getAnchorA = function() {\n      return Vec2.clone(this.m_targetA);\n    };\n    MouseJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    MouseJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(inv_dt, this.m_impulse);\n    };\n    MouseJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * 0;\n    };\n    MouseJoint2.prototype.shiftOrigin = function(newOrigin) {\n      this.m_targetA.sub(newOrigin);\n    };\n    MouseJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var position = this.m_bodyB.c_position;\n      var velocity = this.m_bodyB.c_velocity;\n      var cB2 = position.c;\n      var aB = position.a;\n      var vB2 = velocity.v;\n      var wB = velocity.w;\n      var qB = Rot.neo(aB);\n      var mass = this.m_bodyB.getMass();\n      var omega = 2 * math_PI$2 * this.m_frequencyHz;\n      var d2 = 2 * mass * this.m_dampingRatio * omega;\n      var k = mass * (omega * omega);\n      var h = step.dt;\n      this.m_gamma = h * (d2 + h * k);\n      if (this.m_gamma != 0) {\n        this.m_gamma = 1 / this.m_gamma;\n      }\n      this.m_beta = h * k * this.m_gamma;\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var K = new Mat22();\n      K.ex.x = this.m_invMassB + this.m_invIB * this.m_rB.y * this.m_rB.y + this.m_gamma;\n      K.ex.y = -this.m_invIB * this.m_rB.x * this.m_rB.y;\n      K.ey.x = K.ex.y;\n      K.ey.y = this.m_invMassB + this.m_invIB * this.m_rB.x * this.m_rB.x + this.m_gamma;\n      this.m_mass = K.getInverse();\n      this.m_C.setVec2(cB2);\n      this.m_C.addCombine(1, this.m_rB, -1, this.m_targetA);\n      this.m_C.mul(this.m_beta);\n      wB *= 0.98;\n      if (step.warmStarting) {\n        this.m_impulse.mul(step.dtRatio);\n        vB2.addMul(this.m_invMassB, this.m_impulse);\n        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, this.m_impulse);\n      } else {\n        this.m_impulse.setZero();\n      }\n      velocity.v.setVec2(vB2);\n      velocity.w = wB;\n    };\n    MouseJoint2.prototype.solveVelocityConstraints = function(step) {\n      var velocity = this.m_bodyB.c_velocity;\n      var vB2 = Vec2.clone(velocity.v);\n      var wB = velocity.w;\n      var Cdot = Vec2.crossNumVec2(wB, this.m_rB);\n      Cdot.add(vB2);\n      Cdot.addCombine(1, this.m_C, this.m_gamma, this.m_impulse);\n      Cdot.neg();\n      var impulse = Mat22.mulVec2(this.m_mass, Cdot);\n      var oldImpulse = Vec2.clone(this.m_impulse);\n      this.m_impulse.add(impulse);\n      var maxImpulse = step.dt * this.m_maxForce;\n      this.m_impulse.clamp(maxImpulse);\n      impulse = Vec2.sub(this.m_impulse, oldImpulse);\n      vB2.addMul(this.m_invMassB, impulse);\n      wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, impulse);\n      velocity.v.setVec2(vB2);\n      velocity.w = wB;\n    };\n    MouseJoint2.prototype.solvePositionConstraints = function(step) {\n      return true;\n    };\n    MouseJoint2.TYPE = \"mouse-joint\";\n    return MouseJoint2;\n  }(Joint)\n);\nvar math_abs$2 = Math.abs;\nvar DEFAULTS$3 = {\n  collideConnected: true\n};\nvar PulleyJoint = (\n  /** @class */\n  function(_super) {\n    __extends(PulleyJoint2, _super);\n    function PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio) {\n      var _this = this;\n      if (!(_this instanceof PulleyJoint2)) {\n        return new PulleyJoint2(def, bodyA, bodyB, groundA, groundB, anchorA, anchorB, ratio);\n      }\n      def = options(def, DEFAULTS$3);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = PulleyJoint2.TYPE;\n      _this.m_groundAnchorA = Vec2.clone(groundA ? groundA : def.groundAnchorA || Vec2.neo(-1, 1));\n      _this.m_groundAnchorB = Vec2.clone(groundB ? groundB : def.groundAnchorB || Vec2.neo(1, 1));\n      _this.m_localAnchorA = Vec2.clone(anchorA ? bodyA.getLocalPoint(anchorA) : def.localAnchorA || Vec2.neo(-1, 0));\n      _this.m_localAnchorB = Vec2.clone(anchorB ? bodyB.getLocalPoint(anchorB) : def.localAnchorB || Vec2.neo(1, 0));\n      _this.m_lengthA = Number.isFinite(def.lengthA) ? def.lengthA : Vec2.distance(anchorA, groundA);\n      _this.m_lengthB = Number.isFinite(def.lengthB) ? def.lengthB : Vec2.distance(anchorB, groundB);\n      _this.m_ratio = Number.isFinite(ratio) ? ratio : def.ratio;\n      _this.m_constant = _this.m_lengthA + _this.m_ratio * _this.m_lengthB;\n      _this.m_impulse = 0;\n      return _this;\n    }\n    PulleyJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        groundAnchorA: this.m_groundAnchorA,\n        groundAnchorB: this.m_groundAnchorB,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        lengthA: this.m_lengthA,\n        lengthB: this.m_lengthB,\n        ratio: this.m_ratio\n      };\n    };\n    PulleyJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new PulleyJoint2(data);\n      return joint;\n    };\n    PulleyJoint2.prototype._reset = function(def) {\n      if (Vec2.isValid(def.groundAnchorA)) {\n        this.m_groundAnchorA.set(def.groundAnchorA);\n      }\n      if (Vec2.isValid(def.groundAnchorB)) {\n        this.m_groundAnchorB.set(def.groundAnchorB);\n      }\n      if (Vec2.isValid(def.localAnchorA)) {\n        this.m_localAnchorA.set(def.localAnchorA);\n      } else if (Vec2.isValid(def.anchorA)) {\n        this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(def.anchorA));\n      }\n      if (Vec2.isValid(def.localAnchorB)) {\n        this.m_localAnchorB.set(def.localAnchorB);\n      } else if (Vec2.isValid(def.anchorB)) {\n        this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(def.anchorB));\n      }\n      if (Number.isFinite(def.lengthA)) {\n        this.m_lengthA = def.lengthA;\n      }\n      if (Number.isFinite(def.lengthB)) {\n        this.m_lengthB = def.lengthB;\n      }\n      if (Number.isFinite(def.ratio)) {\n        this.m_ratio = def.ratio;\n      }\n    };\n    PulleyJoint2.prototype.getGroundAnchorA = function() {\n      return this.m_groundAnchorA;\n    };\n    PulleyJoint2.prototype.getGroundAnchorB = function() {\n      return this.m_groundAnchorB;\n    };\n    PulleyJoint2.prototype.getLengthA = function() {\n      return this.m_lengthA;\n    };\n    PulleyJoint2.prototype.getLengthB = function() {\n      return this.m_lengthB;\n    };\n    PulleyJoint2.prototype.getRatio = function() {\n      return this.m_ratio;\n    };\n    PulleyJoint2.prototype.getCurrentLengthA = function() {\n      var p = this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n      var s2 = this.m_groundAnchorA;\n      return Vec2.distance(p, s2);\n    };\n    PulleyJoint2.prototype.getCurrentLengthB = function() {\n      var p = this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n      var s2 = this.m_groundAnchorB;\n      return Vec2.distance(p, s2);\n    };\n    PulleyJoint2.prototype.shiftOrigin = function(newOrigin) {\n      this.m_groundAnchorA.sub(newOrigin);\n      this.m_groundAnchorB.sub(newOrigin);\n    };\n    PulleyJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    PulleyJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    PulleyJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(this.m_impulse, this.m_uB).mul(inv_dt);\n    };\n    PulleyJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return 0;\n    };\n    PulleyJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      this.m_uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);\n      this.m_uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);\n      var lengthA = this.m_uA.length();\n      var lengthB = this.m_uB.length();\n      if (lengthA > 10 * SettingsInternal.linearSlop) {\n        this.m_uA.mul(1 / lengthA);\n      } else {\n        this.m_uA.setZero();\n      }\n      if (lengthB > 10 * SettingsInternal.linearSlop) {\n        this.m_uB.mul(1 / lengthB);\n      } else {\n        this.m_uB.setZero();\n      }\n      var ruA = Vec2.crossVec2Vec2(this.m_rA, this.m_uA);\n      var ruB = Vec2.crossVec2Vec2(this.m_rB, this.m_uB);\n      var mA = this.m_invMassA + this.m_invIA * ruA * ruA;\n      var mB = this.m_invMassB + this.m_invIB * ruB * ruB;\n      this.m_mass = mA + this.m_ratio * this.m_ratio * mB;\n      if (this.m_mass > 0) {\n        this.m_mass = 1 / this.m_mass;\n      }\n      if (step.warmStarting) {\n        this.m_impulse *= step.dtRatio;\n        var PA = Vec2.mulNumVec2(-this.m_impulse, this.m_uA);\n        var PB = Vec2.mulNumVec2(-this.m_ratio * this.m_impulse, this.m_uB);\n        vA2.addMul(this.m_invMassA, PA);\n        wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);\n        vB2.addMul(this.m_invMassB, PB);\n        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);\n      } else {\n        this.m_impulse = 0;\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    PulleyJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var vpA = Vec2.add(vA2, Vec2.crossNumVec2(wA, this.m_rA));\n      var vpB = Vec2.add(vB2, Vec2.crossNumVec2(wB, this.m_rB));\n      var Cdot = -Vec2.dot(this.m_uA, vpA) - this.m_ratio * Vec2.dot(this.m_uB, vpB);\n      var impulse = -this.m_mass * Cdot;\n      this.m_impulse += impulse;\n      var PA = Vec2.mulNumVec2(-impulse, this.m_uA);\n      var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, this.m_uB);\n      vA2.addMul(this.m_invMassA, PA);\n      wA += this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, PA);\n      vB2.addMul(this.m_invMassB, PB);\n      wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, PB);\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    PulleyJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var uA = Vec2.sub(Vec2.add(cA2, this.m_rA), this.m_groundAnchorA);\n      var uB = Vec2.sub(Vec2.add(cB2, this.m_rB), this.m_groundAnchorB);\n      var lengthA = uA.length();\n      var lengthB = uB.length();\n      if (lengthA > 10 * SettingsInternal.linearSlop) {\n        uA.mul(1 / lengthA);\n      } else {\n        uA.setZero();\n      }\n      if (lengthB > 10 * SettingsInternal.linearSlop) {\n        uB.mul(1 / lengthB);\n      } else {\n        uB.setZero();\n      }\n      var ruA = Vec2.crossVec2Vec2(rA2, uA);\n      var ruB = Vec2.crossVec2Vec2(rB2, uB);\n      var mA = this.m_invMassA + this.m_invIA * ruA * ruA;\n      var mB = this.m_invMassB + this.m_invIB * ruB * ruB;\n      var mass = mA + this.m_ratio * this.m_ratio * mB;\n      if (mass > 0) {\n        mass = 1 / mass;\n      }\n      var C = this.m_constant - lengthA - this.m_ratio * lengthB;\n      var linearError = math_abs$2(C);\n      var impulse = -mass * C;\n      var PA = Vec2.mulNumVec2(-impulse, uA);\n      var PB = Vec2.mulNumVec2(-this.m_ratio * impulse, uB);\n      cA2.addMul(this.m_invMassA, PA);\n      aA += this.m_invIA * Vec2.crossVec2Vec2(rA2, PA);\n      cB2.addMul(this.m_invMassB, PB);\n      aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, PB);\n      this.m_bodyA.c_position.c = cA2;\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c = cB2;\n      this.m_bodyB.c_position.a = aB;\n      return linearError < SettingsInternal.linearSlop;\n    };\n    PulleyJoint2.TYPE = \"pulley-joint\";\n    return PulleyJoint2;\n  }(Joint)\n);\nvar math_min$1 = Math.min;\nvar LimitState;\n(function(LimitState2) {\n  LimitState2[LimitState2[\"inactiveLimit\"] = 0] = \"inactiveLimit\";\n  LimitState2[LimitState2[\"atLowerLimit\"] = 1] = \"atLowerLimit\";\n  LimitState2[LimitState2[\"atUpperLimit\"] = 2] = \"atUpperLimit\";\n  LimitState2[LimitState2[\"equalLimits\"] = 3] = \"equalLimits\";\n})(LimitState || (LimitState = {}));\nvar DEFAULTS$2 = {\n  maxLength: 0\n};\nvar RopeJoint = (\n  /** @class */\n  function(_super) {\n    __extends(RopeJoint2, _super);\n    function RopeJoint2(def, bodyA, bodyB, anchor) {\n      var _this = this;\n      if (!(_this instanceof RopeJoint2)) {\n        return new RopeJoint2(def, bodyA, bodyB, anchor);\n      }\n      def = options(def, DEFAULTS$2);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = RopeJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.neo(-1, 0));\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.neo(1, 0));\n      _this.m_maxLength = def.maxLength;\n      _this.m_mass = 0;\n      _this.m_impulse = 0;\n      _this.m_length = 0;\n      _this.m_state = LimitState.inactiveLimit;\n      return _this;\n    }\n    RopeJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        maxLength: this.m_maxLength\n      };\n    };\n    RopeJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new RopeJoint2(data);\n      return joint;\n    };\n    RopeJoint2.prototype._reset = function(def) {\n      if (Number.isFinite(def.maxLength)) {\n        this.m_maxLength = def.maxLength;\n      }\n    };\n    RopeJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    RopeJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    RopeJoint2.prototype.setMaxLength = function(length) {\n      this.m_maxLength = length;\n    };\n    RopeJoint2.prototype.getMaxLength = function() {\n      return this.m_maxLength;\n    };\n    RopeJoint2.prototype.getLimitState = function() {\n      return this.m_state;\n    };\n    RopeJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    RopeJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    RopeJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.mulNumVec2(this.m_impulse, this.m_u).mul(inv_dt);\n    };\n    RopeJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return 0;\n    };\n    RopeJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);\n      this.m_rB = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);\n      this.m_u = Vec2.zero();\n      this.m_u.addCombine(1, cB2, 1, this.m_rB);\n      this.m_u.subCombine(1, cA2, 1, this.m_rA);\n      this.m_length = this.m_u.length();\n      var C = this.m_length - this.m_maxLength;\n      if (C > 0) {\n        this.m_state = LimitState.atUpperLimit;\n      } else {\n        this.m_state = LimitState.inactiveLimit;\n      }\n      if (this.m_length > SettingsInternal.linearSlop) {\n        this.m_u.mul(1 / this.m_length);\n      } else {\n        this.m_u.setZero();\n        this.m_mass = 0;\n        this.m_impulse = 0;\n        return;\n      }\n      var crA = Vec2.crossVec2Vec2(this.m_rA, this.m_u);\n      var crB = Vec2.crossVec2Vec2(this.m_rB, this.m_u);\n      var invMass = this.m_invMassA + this.m_invIA * crA * crA + this.m_invMassB + this.m_invIB * crB * crB;\n      this.m_mass = invMass != 0 ? 1 / invMass : 0;\n      if (step.warmStarting) {\n        this.m_impulse *= step.dtRatio;\n        var P3 = Vec2.mulNumVec2(this.m_impulse, this.m_u);\n        vA2.subMul(this.m_invMassA, P3);\n        wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);\n        vB2.addMul(this.m_invMassB, P3);\n        wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      } else {\n        this.m_impulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    RopeJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var vpA = Vec2.addCrossNumVec2(vA2, wA, this.m_rA);\n      var vpB = Vec2.addCrossNumVec2(vB2, wB, this.m_rB);\n      var C = this.m_length - this.m_maxLength;\n      var Cdot = Vec2.dot(this.m_u, Vec2.sub(vpB, vpA));\n      if (C < 0) {\n        Cdot += step.inv_dt * C;\n      }\n      var impulse = -this.m_mass * Cdot;\n      var oldImpulse = this.m_impulse;\n      this.m_impulse = math_min$1(0, this.m_impulse + impulse);\n      impulse = this.m_impulse - oldImpulse;\n      var P3 = Vec2.mulNumVec2(impulse, this.m_u);\n      vA2.subMul(this.m_invMassA, P3);\n      wA -= this.m_invIA * Vec2.crossVec2Vec2(this.m_rA, P3);\n      vB2.addMul(this.m_invMassB, P3);\n      wB += this.m_invIB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    RopeJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulSub(qA, this.m_localAnchorA, this.m_localCenterA);\n      var rB2 = Rot.mulSub(qB, this.m_localAnchorB, this.m_localCenterB);\n      var u = Vec2.zero();\n      u.addCombine(1, cB2, 1, rB2);\n      u.subCombine(1, cA2, 1, rA2);\n      var length = u.normalize();\n      var C = length - this.m_maxLength;\n      C = clamp(C, 0, SettingsInternal.maxLinearCorrection);\n      var impulse = -this.m_mass * C;\n      var P3 = Vec2.mulNumVec2(impulse, u);\n      cA2.subMul(this.m_invMassA, P3);\n      aA -= this.m_invIA * Vec2.crossVec2Vec2(rA2, P3);\n      cB2.addMul(this.m_invMassB, P3);\n      aB += this.m_invIB * Vec2.crossVec2Vec2(rB2, P3);\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      return length - this.m_maxLength < SettingsInternal.linearSlop;\n    };\n    RopeJoint2.TYPE = \"rope-joint\";\n    return RopeJoint2;\n  }(Joint)\n);\nvar math_abs$1 = Math.abs;\nvar math_PI$1 = Math.PI;\nvar DEFAULTS$1 = {\n  frequencyHz: 0,\n  dampingRatio: 0\n};\nvar WeldJoint = (\n  /** @class */\n  function(_super) {\n    __extends(WeldJoint2, _super);\n    function WeldJoint2(def, bodyA, bodyB, anchor) {\n      var _this = this;\n      if (!(_this instanceof WeldJoint2)) {\n        return new WeldJoint2(def, bodyA, bodyB, anchor);\n      }\n      def = options(def, DEFAULTS$1);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_type = WeldJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());\n      _this.m_referenceAngle = Number.isFinite(def.referenceAngle) ? def.referenceAngle : bodyB.getAngle() - bodyA.getAngle();\n      _this.m_frequencyHz = def.frequencyHz;\n      _this.m_dampingRatio = def.dampingRatio;\n      _this.m_impulse = new Vec3();\n      _this.m_bias = 0;\n      _this.m_gamma = 0;\n      _this.m_mass = new Mat33();\n      return _this;\n    }\n    WeldJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        frequencyHz: this.m_frequencyHz,\n        dampingRatio: this.m_dampingRatio,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        referenceAngle: this.m_referenceAngle\n      };\n    };\n    WeldJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new WeldJoint2(data);\n      return joint;\n    };\n    WeldJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (Number.isFinite(def.frequencyHz)) {\n        this.m_frequencyHz = def.frequencyHz;\n      }\n      if (Number.isFinite(def.dampingRatio)) {\n        this.m_dampingRatio = def.dampingRatio;\n      }\n    };\n    WeldJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    WeldJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    WeldJoint2.prototype.getReferenceAngle = function() {\n      return this.m_referenceAngle;\n    };\n    WeldJoint2.prototype.setFrequency = function(hz) {\n      this.m_frequencyHz = hz;\n    };\n    WeldJoint2.prototype.getFrequency = function() {\n      return this.m_frequencyHz;\n    };\n    WeldJoint2.prototype.setDampingRatio = function(ratio) {\n      this.m_dampingRatio = ratio;\n    };\n    WeldJoint2.prototype.getDampingRatio = function() {\n      return this.m_dampingRatio;\n    };\n    WeldJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    WeldJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    WeldJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.neo(this.m_impulse.x, this.m_impulse.y).mul(inv_dt);\n    };\n    WeldJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_impulse.z;\n    };\n    WeldJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      this.m_rA = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      this.m_rB = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var K = new Mat33();\n      K.ex.x = mA + mB + this.m_rA.y * this.m_rA.y * iA + this.m_rB.y * this.m_rB.y * iB;\n      K.ey.x = -this.m_rA.y * this.m_rA.x * iA - this.m_rB.y * this.m_rB.x * iB;\n      K.ez.x = -this.m_rA.y * iA - this.m_rB.y * iB;\n      K.ex.y = K.ey.x;\n      K.ey.y = mA + mB + this.m_rA.x * this.m_rA.x * iA + this.m_rB.x * this.m_rB.x * iB;\n      K.ez.y = this.m_rA.x * iA + this.m_rB.x * iB;\n      K.ex.z = K.ez.x;\n      K.ey.z = K.ez.y;\n      K.ez.z = iA + iB;\n      if (this.m_frequencyHz > 0) {\n        K.getInverse22(this.m_mass);\n        var invM = iA + iB;\n        var m = invM > 0 ? 1 / invM : 0;\n        var C = aB - aA - this.m_referenceAngle;\n        var omega = 2 * math_PI$1 * this.m_frequencyHz;\n        var d2 = 2 * m * this.m_dampingRatio * omega;\n        var k = m * omega * omega;\n        var h = step.dt;\n        this.m_gamma = h * (d2 + h * k);\n        this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0;\n        this.m_bias = C * h * k * this.m_gamma;\n        invM += this.m_gamma;\n        this.m_mass.ez.z = invM != 0 ? 1 / invM : 0;\n      } else if (K.ez.z == 0) {\n        K.getInverse22(this.m_mass);\n        this.m_gamma = 0;\n        this.m_bias = 0;\n      } else {\n        K.getSymInverse33(this.m_mass);\n        this.m_gamma = 0;\n        this.m_bias = 0;\n      }\n      if (step.warmStarting) {\n        this.m_impulse.mul(step.dtRatio);\n        var P3 = Vec2.neo(this.m_impulse.x, this.m_impulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + this.m_impulse.z);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + this.m_impulse.z);\n      } else {\n        this.m_impulse.setZero();\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    WeldJoint2.prototype.solveVelocityConstraints = function(step) {\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      if (this.m_frequencyHz > 0) {\n        var Cdot2 = wB - wA;\n        var impulse2 = -this.m_mass.ez.z * (Cdot2 + this.m_bias + this.m_gamma * this.m_impulse.z);\n        this.m_impulse.z += impulse2;\n        wA -= iA * impulse2;\n        wB += iB * impulse2;\n        var Cdot1 = Vec2.zero();\n        Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        var impulse1 = Vec2.neg(Mat33.mulVec2(this.m_mass, Cdot1));\n        this.m_impulse.x += impulse1.x;\n        this.m_impulse.y += impulse1.y;\n        var P3 = Vec2.clone(impulse1);\n        vA2.subMul(mA, P3);\n        wA -= iA * Vec2.crossVec2Vec2(this.m_rA, P3);\n        vB2.addMul(mB, P3);\n        wB += iB * Vec2.crossVec2Vec2(this.m_rB, P3);\n      } else {\n        var Cdot1 = Vec2.zero();\n        Cdot1.addCombine(1, vB2, 1, Vec2.crossNumVec2(wB, this.m_rB));\n        Cdot1.subCombine(1, vA2, 1, Vec2.crossNumVec2(wA, this.m_rA));\n        var Cdot2 = wB - wA;\n        var Cdot = new Vec3(Cdot1.x, Cdot1.y, Cdot2);\n        var impulse = Vec3.neg(Mat33.mulVec3(this.m_mass, Cdot));\n        this.m_impulse.add(impulse);\n        var P3 = Vec2.neo(impulse.x, impulse.y);\n        vA2.subMul(mA, P3);\n        wA -= iA * (Vec2.crossVec2Vec2(this.m_rA, P3) + impulse.z);\n        vB2.addMul(mB, P3);\n        wB += iB * (Vec2.crossVec2Vec2(this.m_rB, P3) + impulse.z);\n      }\n      this.m_bodyA.c_velocity.v = vA2;\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v = vB2;\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    WeldJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var positionError;\n      var angularError;\n      var K = new Mat33();\n      K.ex.x = mA + mB + rA2.y * rA2.y * iA + rB2.y * rB2.y * iB;\n      K.ey.x = -rA2.y * rA2.x * iA - rB2.y * rB2.x * iB;\n      K.ez.x = -rA2.y * iA - rB2.y * iB;\n      K.ex.y = K.ey.x;\n      K.ey.y = mA + mB + rA2.x * rA2.x * iA + rB2.x * rB2.x * iB;\n      K.ez.y = rA2.x * iA + rB2.x * iB;\n      K.ex.z = K.ez.x;\n      K.ey.z = K.ez.y;\n      K.ez.z = iA + iB;\n      if (this.m_frequencyHz > 0) {\n        var C1 = Vec2.zero();\n        C1.addCombine(1, cB2, 1, rB2);\n        C1.subCombine(1, cA2, 1, rA2);\n        positionError = C1.length();\n        angularError = 0;\n        var P3 = Vec2.neg(K.solve22(C1));\n        cA2.subMul(mA, P3);\n        aA -= iA * Vec2.crossVec2Vec2(rA2, P3);\n        cB2.addMul(mB, P3);\n        aB += iB * Vec2.crossVec2Vec2(rB2, P3);\n      } else {\n        var C1 = Vec2.zero();\n        C1.addCombine(1, cB2, 1, rB2);\n        C1.subCombine(1, cA2, 1, rA2);\n        var C2 = aB - aA - this.m_referenceAngle;\n        positionError = C1.length();\n        angularError = math_abs$1(C2);\n        var C = new Vec3(C1.x, C1.y, C2);\n        var impulse = new Vec3();\n        if (K.ez.z > 0) {\n          impulse = Vec3.neg(K.solve33(C));\n        } else {\n          var impulse2 = Vec2.neg(K.solve22(C1));\n          impulse.set(impulse2.x, impulse2.y, 0);\n        }\n        var P3 = Vec2.neo(impulse.x, impulse.y);\n        cA2.subMul(mA, P3);\n        aA -= iA * (Vec2.crossVec2Vec2(rA2, P3) + impulse.z);\n        cB2.addMul(mB, P3);\n        aB += iB * (Vec2.crossVec2Vec2(rB2, P3) + impulse.z);\n      }\n      this.m_bodyA.c_position.c = cA2;\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c = cB2;\n      this.m_bodyB.c_position.a = aB;\n      return positionError <= SettingsInternal.linearSlop && angularError <= SettingsInternal.angularSlop;\n    };\n    WeldJoint2.TYPE = \"weld-joint\";\n    return WeldJoint2;\n  }(Joint)\n);\nvar math_abs = Math.abs;\nvar math_PI = Math.PI;\nvar DEFAULTS = {\n  enableMotor: false,\n  maxMotorTorque: 0,\n  motorSpeed: 0,\n  frequencyHz: 2,\n  dampingRatio: 0.7\n};\nvar WheelJoint = (\n  /** @class */\n  function(_super) {\n    __extends(WheelJoint2, _super);\n    function WheelJoint2(def, bodyA, bodyB, anchor, axis) {\n      var _this = this;\n      if (!(_this instanceof WheelJoint2)) {\n        return new WheelJoint2(def, bodyA, bodyB, anchor, axis);\n      }\n      def = options(def, DEFAULTS);\n      _this = _super.call(this, def, bodyA, bodyB) || this;\n      bodyA = _this.m_bodyA;\n      bodyB = _this.m_bodyB;\n      _this.m_ax = Vec2.zero();\n      _this.m_ay = Vec2.zero();\n      _this.m_type = WheelJoint2.TYPE;\n      _this.m_localAnchorA = Vec2.clone(anchor ? bodyA.getLocalPoint(anchor) : def.localAnchorA || Vec2.zero());\n      _this.m_localAnchorB = Vec2.clone(anchor ? bodyB.getLocalPoint(anchor) : def.localAnchorB || Vec2.zero());\n      if (Vec2.isValid(axis)) {\n        _this.m_localXAxisA = bodyA.getLocalVector(axis);\n      } else if (Vec2.isValid(def.localAxisA)) {\n        _this.m_localXAxisA = Vec2.clone(def.localAxisA);\n      } else if (Vec2.isValid(def.localAxis)) {\n        _this.m_localXAxisA = Vec2.clone(def.localAxis);\n      } else {\n        _this.m_localXAxisA = Vec2.neo(1, 0);\n      }\n      _this.m_localYAxisA = Vec2.crossNumVec2(1, _this.m_localXAxisA);\n      _this.m_mass = 0;\n      _this.m_impulse = 0;\n      _this.m_motorMass = 0;\n      _this.m_motorImpulse = 0;\n      _this.m_springMass = 0;\n      _this.m_springImpulse = 0;\n      _this.m_maxMotorTorque = def.maxMotorTorque;\n      _this.m_motorSpeed = def.motorSpeed;\n      _this.m_enableMotor = def.enableMotor;\n      _this.m_frequencyHz = def.frequencyHz;\n      _this.m_dampingRatio = def.dampingRatio;\n      _this.m_bias = 0;\n      _this.m_gamma = 0;\n      return _this;\n    }\n    WheelJoint2.prototype._serialize = function() {\n      return {\n        type: this.m_type,\n        bodyA: this.m_bodyA,\n        bodyB: this.m_bodyB,\n        collideConnected: this.m_collideConnected,\n        enableMotor: this.m_enableMotor,\n        maxMotorTorque: this.m_maxMotorTorque,\n        motorSpeed: this.m_motorSpeed,\n        frequencyHz: this.m_frequencyHz,\n        dampingRatio: this.m_dampingRatio,\n        localAnchorA: this.m_localAnchorA,\n        localAnchorB: this.m_localAnchorB,\n        localAxisA: this.m_localXAxisA\n      };\n    };\n    WheelJoint2._deserialize = function(data, world, restore) {\n      data = __assign({}, data);\n      data.bodyA = restore(Body, data.bodyA, world);\n      data.bodyB = restore(Body, data.bodyB, world);\n      var joint = new WheelJoint2(data);\n      return joint;\n    };\n    WheelJoint2.prototype._reset = function(def) {\n      if (def.anchorA) {\n        this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(def.anchorA));\n      } else if (def.localAnchorA) {\n        this.m_localAnchorA.setVec2(def.localAnchorA);\n      }\n      if (def.anchorB) {\n        this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(def.anchorB));\n      } else if (def.localAnchorB) {\n        this.m_localAnchorB.setVec2(def.localAnchorB);\n      }\n      if (def.localAxisA) {\n        this.m_localXAxisA.setVec2(def.localAxisA);\n        this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1, def.localAxisA));\n      }\n      if (def.enableMotor !== void 0) {\n        this.m_enableMotor = def.enableMotor;\n      }\n      if (Number.isFinite(def.maxMotorTorque)) {\n        this.m_maxMotorTorque = def.maxMotorTorque;\n      }\n      if (Number.isFinite(def.motorSpeed)) {\n        this.m_motorSpeed = def.motorSpeed;\n      }\n      if (Number.isFinite(def.frequencyHz)) {\n        this.m_frequencyHz = def.frequencyHz;\n      }\n      if (Number.isFinite(def.dampingRatio)) {\n        this.m_dampingRatio = def.dampingRatio;\n      }\n    };\n    WheelJoint2.prototype.getLocalAnchorA = function() {\n      return this.m_localAnchorA;\n    };\n    WheelJoint2.prototype.getLocalAnchorB = function() {\n      return this.m_localAnchorB;\n    };\n    WheelJoint2.prototype.getLocalAxisA = function() {\n      return this.m_localXAxisA;\n    };\n    WheelJoint2.prototype.getJointTranslation = function() {\n      var bA = this.m_bodyA;\n      var bB = this.m_bodyB;\n      var pA2 = bA.getWorldPoint(this.m_localAnchorA);\n      var pB2 = bB.getWorldPoint(this.m_localAnchorB);\n      var d2 = Vec2.sub(pB2, pA2);\n      var axis = bA.getWorldVector(this.m_localXAxisA);\n      var translation2 = Vec2.dot(d2, axis);\n      return translation2;\n    };\n    WheelJoint2.prototype.getJointSpeed = function() {\n      var wA = this.m_bodyA.m_angularVelocity;\n      var wB = this.m_bodyB.m_angularVelocity;\n      return wB - wA;\n    };\n    WheelJoint2.prototype.isMotorEnabled = function() {\n      return this.m_enableMotor;\n    };\n    WheelJoint2.prototype.enableMotor = function(flag) {\n      if (flag == this.m_enableMotor)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_enableMotor = flag;\n    };\n    WheelJoint2.prototype.setMotorSpeed = function(speed) {\n      if (speed == this.m_motorSpeed)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_motorSpeed = speed;\n    };\n    WheelJoint2.prototype.getMotorSpeed = function() {\n      return this.m_motorSpeed;\n    };\n    WheelJoint2.prototype.setMaxMotorTorque = function(torque) {\n      if (torque == this.m_maxMotorTorque)\n        return;\n      this.m_bodyA.setAwake(true);\n      this.m_bodyB.setAwake(true);\n      this.m_maxMotorTorque = torque;\n    };\n    WheelJoint2.prototype.getMaxMotorTorque = function() {\n      return this.m_maxMotorTorque;\n    };\n    WheelJoint2.prototype.getMotorTorque = function(inv_dt) {\n      return inv_dt * this.m_motorImpulse;\n    };\n    WheelJoint2.prototype.setSpringFrequencyHz = function(hz) {\n      this.m_frequencyHz = hz;\n    };\n    WheelJoint2.prototype.getSpringFrequencyHz = function() {\n      return this.m_frequencyHz;\n    };\n    WheelJoint2.prototype.setSpringDampingRatio = function(ratio) {\n      this.m_dampingRatio = ratio;\n    };\n    WheelJoint2.prototype.getSpringDampingRatio = function() {\n      return this.m_dampingRatio;\n    };\n    WheelJoint2.prototype.getAnchorA = function() {\n      return this.m_bodyA.getWorldPoint(this.m_localAnchorA);\n    };\n    WheelJoint2.prototype.getAnchorB = function() {\n      return this.m_bodyB.getWorldPoint(this.m_localAnchorB);\n    };\n    WheelJoint2.prototype.getReactionForce = function(inv_dt) {\n      return Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax).mul(inv_dt);\n    };\n    WheelJoint2.prototype.getReactionTorque = function(inv_dt) {\n      return inv_dt * this.m_motorImpulse;\n    };\n    WheelJoint2.prototype.initVelocityConstraints = function(step) {\n      this.m_localCenterA = this.m_bodyA.m_sweep.localCenter;\n      this.m_localCenterB = this.m_bodyB.m_sweep.localCenter;\n      this.m_invMassA = this.m_bodyA.m_invMass;\n      this.m_invMassB = this.m_bodyB.m_invMass;\n      this.m_invIA = this.m_bodyA.m_invI;\n      this.m_invIB = this.m_bodyB.m_invI;\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var d2 = Vec2.zero();\n      d2.addCombine(1, cB2, 1, rB2);\n      d2.subCombine(1, cA2, 1, rA2);\n      {\n        this.m_ay = Rot.mulVec2(qA, this.m_localYAxisA);\n        this.m_sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ay);\n        this.m_sBy = Vec2.crossVec2Vec2(rB2, this.m_ay);\n        this.m_mass = mA + mB + iA * this.m_sAy * this.m_sAy + iB * this.m_sBy * this.m_sBy;\n        if (this.m_mass > 0) {\n          this.m_mass = 1 / this.m_mass;\n        }\n      }\n      this.m_springMass = 0;\n      this.m_bias = 0;\n      this.m_gamma = 0;\n      if (this.m_frequencyHz > 0) {\n        this.m_ax = Rot.mulVec2(qA, this.m_localXAxisA);\n        this.m_sAx = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), this.m_ax);\n        this.m_sBx = Vec2.crossVec2Vec2(rB2, this.m_ax);\n        var invMass = mA + mB + iA * this.m_sAx * this.m_sAx + iB * this.m_sBx * this.m_sBx;\n        if (invMass > 0) {\n          this.m_springMass = 1 / invMass;\n          var C = Vec2.dot(d2, this.m_ax);\n          var omega = 2 * math_PI * this.m_frequencyHz;\n          var damp = 2 * this.m_springMass * this.m_dampingRatio * omega;\n          var k = this.m_springMass * omega * omega;\n          var h = step.dt;\n          this.m_gamma = h * (damp + h * k);\n          if (this.m_gamma > 0) {\n            this.m_gamma = 1 / this.m_gamma;\n          }\n          this.m_bias = C * h * k * this.m_gamma;\n          this.m_springMass = invMass + this.m_gamma;\n          if (this.m_springMass > 0) {\n            this.m_springMass = 1 / this.m_springMass;\n          }\n        }\n      } else {\n        this.m_springImpulse = 0;\n      }\n      if (this.m_enableMotor) {\n        this.m_motorMass = iA + iB;\n        if (this.m_motorMass > 0) {\n          this.m_motorMass = 1 / this.m_motorMass;\n        }\n      } else {\n        this.m_motorMass = 0;\n        this.m_motorImpulse = 0;\n      }\n      if (step.warmStarting) {\n        this.m_impulse *= step.dtRatio;\n        this.m_springImpulse *= step.dtRatio;\n        this.m_motorImpulse *= step.dtRatio;\n        var P3 = Vec2.combine(this.m_impulse, this.m_ay, this.m_springImpulse, this.m_ax);\n        var LA = this.m_impulse * this.m_sAy + this.m_springImpulse * this.m_sAx + this.m_motorImpulse;\n        var LB = this.m_impulse * this.m_sBy + this.m_springImpulse * this.m_sBx + this.m_motorImpulse;\n        vA2.subMul(this.m_invMassA, P3);\n        wA -= this.m_invIA * LA;\n        vB2.addMul(this.m_invMassB, P3);\n        wB += this.m_invIB * LB;\n      } else {\n        this.m_impulse = 0;\n        this.m_springImpulse = 0;\n        this.m_motorImpulse = 0;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    WheelJoint2.prototype.solveVelocityConstraints = function(step) {\n      var mA = this.m_invMassA;\n      var mB = this.m_invMassB;\n      var iA = this.m_invIA;\n      var iB = this.m_invIB;\n      var vA2 = this.m_bodyA.c_velocity.v;\n      var wA = this.m_bodyA.c_velocity.w;\n      var vB2 = this.m_bodyB.c_velocity.v;\n      var wB = this.m_bodyB.c_velocity.w;\n      {\n        var Cdot = Vec2.dot(this.m_ax, vB2) - Vec2.dot(this.m_ax, vA2) + this.m_sBx * wB - this.m_sAx * wA;\n        var impulse = -this.m_springMass * (Cdot + this.m_bias + this.m_gamma * this.m_springImpulse);\n        this.m_springImpulse += impulse;\n        var P3 = Vec2.mulNumVec2(impulse, this.m_ax);\n        var LA = impulse * this.m_sAx;\n        var LB = impulse * this.m_sBx;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      }\n      {\n        var Cdot = wB - wA - this.m_motorSpeed;\n        var impulse = -this.m_motorMass * Cdot;\n        var oldImpulse = this.m_motorImpulse;\n        var maxImpulse = step.dt * this.m_maxMotorTorque;\n        this.m_motorImpulse = clamp(this.m_motorImpulse + impulse, -maxImpulse, maxImpulse);\n        impulse = this.m_motorImpulse - oldImpulse;\n        wA -= iA * impulse;\n        wB += iB * impulse;\n      }\n      {\n        var Cdot = Vec2.dot(this.m_ay, vB2) - Vec2.dot(this.m_ay, vA2) + this.m_sBy * wB - this.m_sAy * wA;\n        var impulse = -this.m_mass * Cdot;\n        this.m_impulse += impulse;\n        var P3 = Vec2.mulNumVec2(impulse, this.m_ay);\n        var LA = impulse * this.m_sAy;\n        var LB = impulse * this.m_sBy;\n        vA2.subMul(mA, P3);\n        wA -= iA * LA;\n        vB2.addMul(mB, P3);\n        wB += iB * LB;\n      }\n      this.m_bodyA.c_velocity.v.setVec2(vA2);\n      this.m_bodyA.c_velocity.w = wA;\n      this.m_bodyB.c_velocity.v.setVec2(vB2);\n      this.m_bodyB.c_velocity.w = wB;\n    };\n    WheelJoint2.prototype.solvePositionConstraints = function(step) {\n      var cA2 = this.m_bodyA.c_position.c;\n      var aA = this.m_bodyA.c_position.a;\n      var cB2 = this.m_bodyB.c_position.c;\n      var aB = this.m_bodyB.c_position.a;\n      var qA = Rot.neo(aA);\n      var qB = Rot.neo(aB);\n      var rA2 = Rot.mulVec2(qA, Vec2.sub(this.m_localAnchorA, this.m_localCenterA));\n      var rB2 = Rot.mulVec2(qB, Vec2.sub(this.m_localAnchorB, this.m_localCenterB));\n      var d2 = Vec2.zero();\n      d2.addCombine(1, cB2, 1, rB2);\n      d2.subCombine(1, cA2, 1, rA2);\n      var ay = Rot.mulVec2(qA, this.m_localYAxisA);\n      var sAy = Vec2.crossVec2Vec2(Vec2.add(d2, rA2), ay);\n      var sBy = Vec2.crossVec2Vec2(rB2, ay);\n      var C = Vec2.dot(d2, ay);\n      var k = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_sAy * this.m_sAy + this.m_invIB * this.m_sBy * this.m_sBy;\n      var impulse = k != 0 ? -C / k : 0;\n      var P3 = Vec2.mulNumVec2(impulse, ay);\n      var LA = impulse * sAy;\n      var LB = impulse * sBy;\n      cA2.subMul(this.m_invMassA, P3);\n      aA -= this.m_invIA * LA;\n      cB2.addMul(this.m_invMassB, P3);\n      aB += this.m_invIB * LB;\n      this.m_bodyA.c_position.c.setVec2(cA2);\n      this.m_bodyA.c_position.a = aA;\n      this.m_bodyB.c_position.c.setVec2(cB2);\n      this.m_bodyB.c_position.a = aB;\n      return math_abs(C) <= SettingsInternal.linearSlop;\n    };\n    WheelJoint2.TYPE = \"wheel-joint\";\n    return WheelJoint2;\n  }(Joint)\n);\nvar _a;\nvar SID = 0;\nvar SERIALIZE_REF_TYPES = {\n  \"World\": World,\n  \"Body\": Body,\n  \"Joint\": Joint,\n  \"Fixture\": Fixture,\n  \"Shape\": Shape\n};\nvar DESERIALIZE_BY_REF_TYPE = {\n  \"Vec2\": Vec2,\n  \"Vec3\": Vec3,\n  \"World\": World,\n  \"Body\": Body,\n  \"Joint\": Joint,\n  \"Fixture\": Fixture,\n  \"Shape\": Shape\n};\nvar DESERIALIZE_BY_TYPE_FIELD = (_a = {}, _a[Body.STATIC] = Body, _a[Body.DYNAMIC] = Body, _a[Body.KINEMATIC] = Body, _a[ChainShape.TYPE] = ChainShape, // [BoxShape.TYPE]: BoxShape,\n_a[PolygonShape.TYPE] = PolygonShape, _a[EdgeShape.TYPE] = EdgeShape, _a[CircleShape.TYPE] = CircleShape, _a[DistanceJoint.TYPE] = DistanceJoint, _a[FrictionJoint.TYPE] = FrictionJoint, _a[GearJoint.TYPE] = GearJoint, _a[MotorJoint.TYPE] = MotorJoint, _a[MouseJoint.TYPE] = MouseJoint, _a[PrismaticJoint.TYPE] = PrismaticJoint, _a[PulleyJoint.TYPE] = PulleyJoint, _a[RevoluteJoint.TYPE] = RevoluteJoint, _a[RopeJoint.TYPE] = RopeJoint, _a[WeldJoint.TYPE] = WeldJoint, _a[WheelJoint.TYPE] = WheelJoint, _a);\nvar DEFAULT_OPTIONS = {\n  rootClass: World,\n  preSerialize: function(obj) {\n    return obj;\n  },\n  postSerialize: function(data, obj) {\n    return data;\n  },\n  preDeserialize: function(data) {\n    return data;\n  },\n  postDeserialize: function(obj, data) {\n    return obj;\n  }\n};\nvar Serializer = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function Serializer2(options2) {\n      var _this = this;\n      this.toJson = function(root) {\n        var preSerialize = _this.options.preSerialize;\n        var postSerialize = _this.options.postSerialize;\n        var json = [];\n        var refQueue = [root];\n        var refMemoById = {};\n        function addToRefQueue(value, typeName) {\n          value.__sid = value.__sid || ++SID;\n          if (!refMemoById[value.__sid]) {\n            refQueue.push(value);\n            var index = json.length + refQueue.length;\n            var ref = {\n              refIndex: index,\n              refType: typeName\n            };\n            refMemoById[value.__sid] = ref;\n          }\n          return refMemoById[value.__sid];\n        }\n        function serializeWithHooks(obj2) {\n          obj2 = preSerialize(obj2);\n          var data = obj2._serialize();\n          data = postSerialize(data, obj2);\n          return data;\n        }\n        function traverse(value, noRefType) {\n          if (noRefType === void 0) {\n            noRefType = false;\n          }\n          if (typeof value !== \"object\" || value === null) {\n            return value;\n          }\n          if (typeof value._serialize === \"function\") {\n            if (!noRefType) {\n              for (var typeName in SERIALIZE_REF_TYPES) {\n                if (value instanceof SERIALIZE_REF_TYPES[typeName]) {\n                  return addToRefQueue(value, typeName);\n                }\n              }\n            }\n            value = serializeWithHooks(value);\n          }\n          if (Array.isArray(value)) {\n            var newValue = [];\n            for (var key = 0; key < value.length; key++) {\n              newValue[key] = traverse(value[key]);\n            }\n            value = newValue;\n          } else {\n            var newValue = {};\n            for (var key in value) {\n              if (value.hasOwnProperty(key)) {\n                newValue[key] = traverse(value[key]);\n              }\n            }\n            value = newValue;\n          }\n          return value;\n        }\n        while (refQueue.length) {\n          var obj = refQueue.shift();\n          var str = traverse(obj, true);\n          json.push(str);\n        }\n        return json;\n      };\n      this.fromJson = function(json) {\n        var preDeserialize = _this.options.preDeserialize;\n        var postDeserialize = _this.options.postDeserialize;\n        var rootClass = _this.options.rootClass;\n        var deserializedRefMemoByIndex = {};\n        function deserializeWithHooks(classHint, data, context) {\n          if (!classHint || !classHint._deserialize) {\n            classHint = DESERIALIZE_BY_TYPE_FIELD[data.type];\n          }\n          var deserializer = classHint && classHint._deserialize;\n          if (!deserializer) {\n            return;\n          }\n          data = preDeserialize(data);\n          var classDeserializeFn = classHint._deserialize;\n          var obj = classDeserializeFn(data, context, deserializeChild);\n          obj = postDeserialize(obj, data);\n          return obj;\n        }\n        function deserializeChild(classHint, dataOrRef, context) {\n          var isRefObject = dataOrRef.refIndex && dataOrRef.refType;\n          if (!isRefObject) {\n            return deserializeWithHooks(classHint, dataOrRef, context);\n          }\n          var ref = dataOrRef;\n          if (DESERIALIZE_BY_REF_TYPE[ref.refType]) {\n            classHint = DESERIALIZE_BY_REF_TYPE[ref.refType];\n          }\n          var refIndex = ref.refIndex;\n          if (!deserializedRefMemoByIndex[refIndex]) {\n            var data = json[refIndex];\n            var obj = deserializeWithHooks(classHint, data, context);\n            deserializedRefMemoByIndex[refIndex] = obj;\n          }\n          return deserializedRefMemoByIndex[refIndex];\n        }\n        var root = deserializeWithHooks(rootClass, json[0], null);\n        return root;\n      };\n      this.options = __assign(__assign({}, DEFAULT_OPTIONS), options2);\n    }\n    return Serializer2;\n  }()\n);\nvar worldSerializer = new Serializer({\n  rootClass: World\n});\nSerializer.fromJson = worldSerializer.fromJson;\nSerializer.toJson = worldSerializer.toJson;\nvar Testbed = (\n  /** @class */\n  function() {\n    function Testbed2() {\n    }\n    Testbed2.mount = function(options2) {\n      throw new Error(\"Not implemented\");\n    };\n    Testbed2.start = function(world) {\n      var testbed2 = Testbed2.mount();\n      testbed2.start(world);\n      return testbed2;\n    };\n    return Testbed2;\n  }()\n);\nfunction testbed(a2, b2) {\n  var callback;\n  var options2;\n  if (typeof a2 === \"function\") {\n    callback = a2;\n    options2 = b2;\n  } else if (typeof b2 === \"function\") {\n    callback = b2;\n    options2 = a2;\n  } else {\n    options2 = a2 !== null && a2 !== void 0 ? a2 : b2;\n  }\n  var testbed2 = Testbed.mount(options2);\n  if (callback) {\n    var world = callback(testbed2) || testbed2.world;\n    testbed2.start(world);\n  } else {\n    return testbed2;\n  }\n}\nvar BoxShape = (\n  /** @class */\n  function(_super) {\n    __extends(BoxShape2, _super);\n    function BoxShape2(halfWidth, halfHeight, center2, angle) {\n      var _this = this;\n      if (!(_this instanceof BoxShape2)) {\n        return new BoxShape2(halfWidth, halfHeight, center2, angle);\n      }\n      _this = _super.call(this) || this;\n      _this._setAsBox(halfWidth, halfHeight, center2, angle);\n      return _this;\n    }\n    BoxShape2.TYPE = \"polygon\";\n    return BoxShape2;\n  }(PolygonShape)\n);\nContact.addType(CircleShape.TYPE, CircleShape.TYPE, CircleCircleContact);\nfunction CircleCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  CollideCircles(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);\n}\nvar pA = vec2(0, 0);\nvar pB = vec2(0, 0);\nvar CollideCircles = function(manifold, circleA, xfA2, circleB, xfB2) {\n  manifold.pointCount = 0;\n  transformVec2(pA, xfA2, circleA.m_p);\n  transformVec2(pB, xfB2, circleB.m_p);\n  var distSqr = distSqrVec2(pB, pA);\n  var rA2 = circleA.m_radius;\n  var rB2 = circleB.m_radius;\n  var radius = rA2 + rB2;\n  if (distSqr > radius * radius) {\n    return;\n  }\n  manifold.type = ManifoldType.e_circles;\n  copyVec2(manifold.localPoint, circleA.m_p);\n  zeroVec2(manifold.localNormal);\n  manifold.pointCount = 1;\n  copyVec2(manifold.points[0].localPoint, circleB.m_p);\n  manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n};\nContact.addType(EdgeShape.TYPE, CircleShape.TYPE, EdgeCircleContact);\nContact.addType(ChainShape.TYPE, CircleShape.TYPE, ChainCircleContact);\nfunction EdgeCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  var shapeA = fixtureA.getShape();\n  var shapeB = fixtureB.getShape();\n  CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);\n}\nfunction ChainCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  var chain = fixtureA.getShape();\n  var edge = new EdgeShape();\n  chain.getChildEdge(edge, indexA);\n  var shapeA = edge;\n  var shapeB = fixtureB.getShape();\n  CollideEdgeCircle(manifold, shapeA, xfA2, shapeB, xfB2);\n}\nvar e = vec2(0, 0);\nvar e1 = vec2(0, 0);\nvar e2 = vec2(0, 0);\nvar Q = vec2(0, 0);\nvar P = vec2(0, 0);\nvar n$2 = vec2(0, 0);\nvar CollideEdgeCircle = function(manifold, edgeA, xfA2, circleB, xfB2) {\n  manifold.pointCount = 0;\n  retransformVec2(Q, xfB2, xfA2, circleB.m_p);\n  var A = edgeA.m_vertex1;\n  var B = edgeA.m_vertex2;\n  subVec2(e, B, A);\n  var u = dotVec2(e, B) - dotVec2(e, Q);\n  var v3 = dotVec2(e, Q) - dotVec2(e, A);\n  var radius = edgeA.m_radius + circleB.m_radius;\n  if (v3 <= 0) {\n    copyVec2(P, A);\n    var dd_1 = distSqrVec2(Q, A);\n    if (dd_1 > radius * radius) {\n      return;\n    }\n    if (edgeA.m_hasVertex0) {\n      var A1 = edgeA.m_vertex0;\n      var B1 = A;\n      subVec2(e1, B1, A1);\n      var u1 = dotVec2(e1, B1) - dotVec2(e1, Q);\n      if (u1 > 0) {\n        return;\n      }\n    }\n    manifold.type = ManifoldType.e_circles;\n    zeroVec2(manifold.localNormal);\n    copyVec2(manifold.localPoint, P);\n    manifold.pointCount = 1;\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n    return;\n  }\n  if (u <= 0) {\n    copyVec2(P, B);\n    var dd_2 = distSqrVec2(Q, P);\n    if (dd_2 > radius * radius) {\n      return;\n    }\n    if (edgeA.m_hasVertex3) {\n      var B2 = edgeA.m_vertex3;\n      var A2 = B;\n      subVec2(e2, B2, A2);\n      var v22 = dotVec2(e2, Q) - dotVec2(e2, A2);\n      if (v22 > 0) {\n        return;\n      }\n    }\n    manifold.type = ManifoldType.e_circles;\n    zeroVec2(manifold.localNormal);\n    copyVec2(manifold.localPoint, P);\n    manifold.pointCount = 1;\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(1, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n    return;\n  }\n  var den = lengthSqrVec2(e);\n  combine2Vec2(P, u / den, A, v3 / den, B);\n  var dd = distSqrVec2(Q, P);\n  if (dd > radius * radius) {\n    return;\n  }\n  crossNumVec2(n$2, 1, e);\n  if (dotVec2(n$2, Q) - dotVec2(n$2, A) < 0) {\n    negVec2(n$2);\n  }\n  normalizeVec2(n$2);\n  manifold.type = ManifoldType.e_faceA;\n  copyVec2(manifold.localNormal, n$2);\n  copyVec2(manifold.localPoint, A);\n  manifold.pointCount = 1;\n  copyVec2(manifold.points[0].localPoint, circleB.m_p);\n  manifold.points[0].id.setFeatures(0, ContactFeatureType.e_face, 0, ContactFeatureType.e_vertex);\n};\nvar incidentEdge = [new ClipVertex(), new ClipVertex()];\nvar clipPoints1$1 = [new ClipVertex(), new ClipVertex()];\nvar clipPoints2$1 = [new ClipVertex(), new ClipVertex()];\nvar clipSegmentToLineNormal = vec2(0, 0);\nvar v1 = vec2(0, 0);\nvar n$1 = vec2(0, 0);\nvar xf$1 = transform(0, 0, 0);\nvar v11 = vec2(0, 0);\nvar v12 = vec2(0, 0);\nvar localTangent = vec2(0, 0);\nvar localNormal = vec2(0, 0);\nvar planePoint = vec2(0, 0);\nvar tangent = vec2(0, 0);\nvar normal$1 = vec2(0, 0);\nvar normal1$1 = vec2(0, 0);\nContact.addType(PolygonShape.TYPE, PolygonShape.TYPE, PolygonContact);\nfunction PolygonContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  CollidePolygons(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);\n}\nfunction findMaxSeparation(poly1, xf1, poly2, xf2, output2) {\n  var count1 = poly1.m_count;\n  var count2 = poly2.m_count;\n  var n1s = poly1.m_normals;\n  var v1s = poly1.m_vertices;\n  var v2s = poly2.m_vertices;\n  detransformTransform(xf$1, xf2, xf1);\n  var bestIndex = 0;\n  var maxSeparation2 = -Infinity;\n  for (var i = 0; i < count1; ++i) {\n    rotVec2(n$1, xf$1.q, n1s[i]);\n    transformVec2(v1, xf$1, v1s[i]);\n    var si = Infinity;\n    for (var j = 0; j < count2; ++j) {\n      var sij = dotVec2(n$1, v2s[j]) - dotVec2(n$1, v1);\n      if (sij < si) {\n        si = sij;\n      }\n    }\n    if (si > maxSeparation2) {\n      maxSeparation2 = si;\n      bestIndex = i;\n    }\n  }\n  output2.maxSeparation = maxSeparation2;\n  output2.bestIndex = bestIndex;\n}\nfunction findIncidentEdge(clipVertex, poly1, xf1, edge12, poly2, xf2) {\n  var normals1 = poly1.m_normals;\n  var count2 = poly2.m_count;\n  var vertices2 = poly2.m_vertices;\n  var normals2 = poly2.m_normals;\n  rerotVec2(normal1$1, xf2.q, xf1.q, normals1[edge12]);\n  var index = 0;\n  var minDot = Infinity;\n  for (var i = 0; i < count2; ++i) {\n    var dot = dotVec2(normal1$1, normals2[i]);\n    if (dot < minDot) {\n      minDot = dot;\n      index = i;\n    }\n  }\n  var i1 = index;\n  var i2 = i1 + 1 < count2 ? i1 + 1 : 0;\n  transformVec2(clipVertex[0].v, xf2, vertices2[i1]);\n  clipVertex[0].id.setFeatures(edge12, ContactFeatureType.e_face, i1, ContactFeatureType.e_vertex);\n  transformVec2(clipVertex[1].v, xf2, vertices2[i2]);\n  clipVertex[1].id.setFeatures(edge12, ContactFeatureType.e_face, i2, ContactFeatureType.e_vertex);\n}\nvar maxSeparation = {\n  maxSeparation: 0,\n  bestIndex: 0\n};\nvar CollidePolygons = function(manifold, polyA, xfA2, polyB, xfB2) {\n  manifold.pointCount = 0;\n  var totalRadius = polyA.m_radius + polyB.m_radius;\n  findMaxSeparation(polyA, xfA2, polyB, xfB2, maxSeparation);\n  var edgeA = maxSeparation.bestIndex;\n  var separationA = maxSeparation.maxSeparation;\n  if (separationA > totalRadius)\n    return;\n  findMaxSeparation(polyB, xfB2, polyA, xfA2, maxSeparation);\n  var edgeB = maxSeparation.bestIndex;\n  var separationB = maxSeparation.maxSeparation;\n  if (separationB > totalRadius)\n    return;\n  var poly1;\n  var poly2;\n  var xf1;\n  var xf2;\n  var edge12;\n  var flip;\n  var k_tol = 0.1 * SettingsInternal.linearSlop;\n  if (separationB > separationA + k_tol) {\n    poly1 = polyB;\n    poly2 = polyA;\n    xf1 = xfB2;\n    xf2 = xfA2;\n    edge12 = edgeB;\n    manifold.type = ManifoldType.e_faceB;\n    flip = true;\n  } else {\n    poly1 = polyA;\n    poly2 = polyB;\n    xf1 = xfA2;\n    xf2 = xfB2;\n    edge12 = edgeA;\n    manifold.type = ManifoldType.e_faceA;\n    flip = false;\n  }\n  incidentEdge[0].recycle();\n  incidentEdge[1].recycle();\n  findIncidentEdge(incidentEdge, poly1, xf1, edge12, poly2, xf2);\n  var count1 = poly1.m_count;\n  var vertices1 = poly1.m_vertices;\n  var iv1 = edge12;\n  var iv2 = edge12 + 1 < count1 ? edge12 + 1 : 0;\n  copyVec2(v11, vertices1[iv1]);\n  copyVec2(v12, vertices1[iv2]);\n  subVec2(localTangent, v12, v11);\n  normalizeVec2(localTangent);\n  crossVec2Num(localNormal, localTangent, 1);\n  combine2Vec2(planePoint, 0.5, v11, 0.5, v12);\n  rotVec2(tangent, xf1.q, localTangent);\n  crossVec2Num(normal$1, tangent, 1);\n  transformVec2(v11, xf1, v11);\n  transformVec2(v12, xf1, v12);\n  var frontOffset = dotVec2(normal$1, v11);\n  var sideOffset1 = -dotVec2(tangent, v11) + totalRadius;\n  var sideOffset2 = dotVec2(tangent, v12) + totalRadius;\n  clipPoints1$1[0].recycle();\n  clipPoints1$1[1].recycle();\n  clipPoints2$1[0].recycle();\n  clipPoints2$1[1].recycle();\n  setVec2(clipSegmentToLineNormal, -tangent.x, -tangent.y);\n  var np1 = clipSegmentToLine(clipPoints1$1, incidentEdge, clipSegmentToLineNormal, sideOffset1, iv1);\n  if (np1 < 2) {\n    return;\n  }\n  setVec2(clipSegmentToLineNormal, tangent.x, tangent.y);\n  var np2 = clipSegmentToLine(clipPoints2$1, clipPoints1$1, clipSegmentToLineNormal, sideOffset2, iv2);\n  if (np2 < 2) {\n    return;\n  }\n  copyVec2(manifold.localNormal, localNormal);\n  copyVec2(manifold.localPoint, planePoint);\n  var pointCount = 0;\n  for (var i = 0; i < clipPoints2$1.length; ++i) {\n    var separation = dotVec2(normal$1, clipPoints2$1[i].v) - frontOffset;\n    if (separation <= totalRadius) {\n      var cp = manifold.points[pointCount];\n      detransformVec2(cp.localPoint, xf2, clipPoints2$1[i].v);\n      cp.id.set(clipPoints2$1[i].id);\n      if (flip) {\n        cp.id.swapFeatures();\n      }\n      ++pointCount;\n    }\n  }\n  manifold.pointCount = pointCount;\n};\nContact.addType(PolygonShape.TYPE, CircleShape.TYPE, PolygonCircleContact);\nfunction PolygonCircleContact(manifold, xfA2, fixtureA, indexA, xfB2, fixtureB, indexB) {\n  CollidePolygonCircle(manifold, fixtureA.getShape(), xfA2, fixtureB.getShape(), xfB2);\n}\nvar cLocal = vec2(0, 0);\nvar faceCenter = vec2(0, 0);\nvar CollidePolygonCircle = function(manifold, polygonA, xfA2, circleB, xfB2) {\n  manifold.pointCount = 0;\n  retransformVec2(cLocal, xfB2, xfA2, circleB.m_p);\n  var normalIndex = 0;\n  var separation = -Infinity;\n  var radius = polygonA.m_radius + circleB.m_radius;\n  var vertexCount = polygonA.m_count;\n  var vertices = polygonA.m_vertices;\n  var normals = polygonA.m_normals;\n  for (var i = 0; i < vertexCount; ++i) {\n    var s2 = dotVec2(normals[i], cLocal) - dotVec2(normals[i], vertices[i]);\n    if (s2 > radius) {\n      return;\n    }\n    if (s2 > separation) {\n      separation = s2;\n      normalIndex = i;\n    }\n  }\n  var vertIndex1 = normalIndex;\n  var vertIndex2 = vertIndex1 + 1 < vertexCount ? vertIndex1 + 1 : 0;\n  var v13 = vertices[vertIndex1];\n  var v22 = vertices[vertIndex2];\n  if (separation < EPSILON) {\n    manifold.pointCount = 1;\n    manifold.type = ManifoldType.e_faceA;\n    copyVec2(manifold.localNormal, normals[normalIndex]);\n    combine2Vec2(manifold.localPoint, 0.5, v13, 0.5, v22);\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n    return;\n  }\n  var u1 = dotVec2(cLocal, v22) - dotVec2(cLocal, v13) - dotVec2(v13, v22) + dotVec2(v13, v13);\n  var u2 = dotVec2(cLocal, v13) - dotVec2(cLocal, v22) - dotVec2(v22, v13) + dotVec2(v22, v22);\n  if (u1 <= 0) {\n    if (distSqrVec2(cLocal, v13) > radius * radius) {\n      return;\n    }\n    manifold.pointCount = 1;\n    manifold.type = ManifoldType.e_faceA;\n    subVec2(manifold.localNormal, cLocal, v13);\n    normalizeVec2(manifold.localNormal);\n    copyVec2(manifold.localPoint, v13);\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n  } else if (u2 <= 0) {\n    if (distSqrVec2(cLocal, v22) > radius * radius) {\n      return;\n    }\n    manifold.pointCount = 1;\n    manifold.type = ManifoldType.e_faceA;\n    subVec2(manifold.localNormal, cLocal, v22);\n    normalizeVec2(manifold.localNormal);\n    copyVec2(manifold.localPoint, v22);\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n  } else {\n    combine2Vec2(faceCenter, 0.5, v13, 0.5, v22);\n    var separation_1 = dotVec2(cLocal, normals[vertIndex1]) - dotVec2(faceCenter, normals[vertIndex1]);\n    if (separation_1 > radius) {\n      return;\n    }\n    manifold.pointCount = 1;\n    manifold.type = ManifoldType.e_faceA;\n    copyVec2(manifold.localNormal, normals[vertIndex1]);\n    copyVec2(manifold.localPoint, faceCenter);\n    copyVec2(manifold.points[0].localPoint, circleB.m_p);\n    manifold.points[0].id.setFeatures(0, ContactFeatureType.e_vertex, 0, ContactFeatureType.e_vertex);\n  }\n};\nvar math_min = Math.min;\nContact.addType(EdgeShape.TYPE, PolygonShape.TYPE, EdgePolygonContact);\nContact.addType(ChainShape.TYPE, PolygonShape.TYPE, ChainPolygonContact);\nfunction EdgePolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {\n  CollideEdgePolygon(manifold, fA.getShape(), xfA2, fB.getShape(), xfB2);\n}\nvar edge_reuse = new EdgeShape();\nfunction ChainPolygonContact(manifold, xfA2, fA, indexA, xfB2, fB, indexB) {\n  var chain = fA.getShape();\n  chain.getChildEdge(edge_reuse, indexA);\n  CollideEdgePolygon(manifold, edge_reuse, xfA2, fB.getShape(), xfB2);\n}\nvar EPAxisType;\n(function(EPAxisType2) {\n  EPAxisType2[EPAxisType2[\"e_unknown\"] = -1] = \"e_unknown\";\n  EPAxisType2[EPAxisType2[\"e_edgeA\"] = 1] = \"e_edgeA\";\n  EPAxisType2[EPAxisType2[\"e_edgeB\"] = 2] = \"e_edgeB\";\n})(EPAxisType || (EPAxisType = {}));\nvar VertexType;\n(function(VertexType2) {\n  VertexType2[VertexType2[\"e_isolated\"] = 0] = \"e_isolated\";\n  VertexType2[VertexType2[\"e_concave\"] = 1] = \"e_concave\";\n  VertexType2[VertexType2[\"e_convex\"] = 2] = \"e_convex\";\n})(VertexType || (VertexType = {}));\nvar EPAxis = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function EPAxis2() {\n    }\n    return EPAxis2;\n  }()\n);\nvar TempPolygon = (\n  /** @class */\n  /* @__PURE__ */ function() {\n    function TempPolygon2() {\n      this.vertices = [];\n      this.normals = [];\n      this.count = 0;\n      for (var i = 0; i < SettingsInternal.maxPolygonVertices; i++) {\n        this.vertices.push(vec2(0, 0));\n        this.normals.push(vec2(0, 0));\n      }\n    }\n    return TempPolygon2;\n  }()\n);\nvar ReferenceFace = (\n  /** @class */\n  function() {\n    function ReferenceFace2() {\n      this.v1 = vec2(0, 0);\n      this.v2 = vec2(0, 0);\n      this.normal = vec2(0, 0);\n      this.sideNormal1 = vec2(0, 0);\n      this.sideNormal2 = vec2(0, 0);\n    }\n    ReferenceFace2.prototype.recycle = function() {\n      zeroVec2(this.v1);\n      zeroVec2(this.v2);\n      zeroVec2(this.normal);\n      zeroVec2(this.sideNormal1);\n      zeroVec2(this.sideNormal2);\n    };\n    return ReferenceFace2;\n  }()\n);\nvar clipPoints1 = [new ClipVertex(), new ClipVertex()];\nvar clipPoints2 = [new ClipVertex(), new ClipVertex()];\nvar ie = [new ClipVertex(), new ClipVertex()];\nvar edgeAxis = new EPAxis();\nvar polygonAxis = new EPAxis();\nvar polygonBA = new TempPolygon();\nvar rf = new ReferenceFace();\nvar centroidB = vec2(0, 0);\nvar edge0 = vec2(0, 0);\nvar edge1 = vec2(0, 0);\nvar edge2 = vec2(0, 0);\nvar xf = transform(0, 0, 0);\nvar normal = vec2(0, 0);\nvar normal0 = vec2(0, 0);\nvar normal1 = vec2(0, 0);\nvar normal2 = vec2(0, 0);\nvar lowerLimit = vec2(0, 0);\nvar upperLimit = vec2(0, 0);\nvar perp = vec2(0, 0);\nvar n = vec2(0, 0);\nvar CollideEdgePolygon = function(manifold, edgeA, xfA2, polygonB, xfB2) {\n  detransformTransform(xf, xfA2, xfB2);\n  transformVec2(centroidB, xf, polygonB.m_centroid);\n  var v0 = edgeA.m_vertex0;\n  var v13 = edgeA.m_vertex1;\n  var v22 = edgeA.m_vertex2;\n  var v3 = edgeA.m_vertex3;\n  var hasVertex0 = edgeA.m_hasVertex0;\n  var hasVertex3 = edgeA.m_hasVertex3;\n  subVec2(edge1, v22, v13);\n  normalizeVec2(edge1);\n  setVec2(normal1, edge1.y, -edge1.x);\n  var offset1 = dotVec2(normal1, centroidB) - dotVec2(normal1, v13);\n  var offset0 = 0;\n  var offset2 = 0;\n  var convex1 = false;\n  var convex2 = false;\n  zeroVec2(normal0);\n  zeroVec2(normal2);\n  if (hasVertex0) {\n    subVec2(edge0, v13, v0);\n    normalizeVec2(edge0);\n    setVec2(normal0, edge0.y, -edge0.x);\n    convex1 = crossVec2Vec2(edge0, edge1) >= 0;\n    offset0 = Vec2.dot(normal0, centroidB) - Vec2.dot(normal0, v0);\n  }\n  if (hasVertex3) {\n    subVec2(edge2, v3, v22);\n    normalizeVec2(edge2);\n    setVec2(normal2, edge2.y, -edge2.x);\n    convex2 = Vec2.crossVec2Vec2(edge1, edge2) > 0;\n    offset2 = Vec2.dot(normal2, centroidB) - Vec2.dot(normal2, v22);\n  }\n  var front;\n  zeroVec2(normal);\n  zeroVec2(lowerLimit);\n  zeroVec2(upperLimit);\n  if (hasVertex0 && hasVertex3) {\n    if (convex1 && convex2) {\n      front = offset0 >= 0 || offset1 >= 0 || offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal0);\n        copyVec2(upperLimit, normal2);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        scaleVec2(upperLimit, -1, normal1);\n      }\n    } else if (convex1) {\n      front = offset0 >= 0 || offset1 >= 0 && offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal0);\n        copyVec2(upperLimit, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal2);\n        scaleVec2(upperLimit, -1, normal1);\n      }\n    } else if (convex2) {\n      front = offset2 >= 0 || offset0 >= 0 && offset1 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal1);\n        copyVec2(upperLimit, normal2);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        scaleVec2(upperLimit, -1, normal0);\n      }\n    } else {\n      front = offset0 >= 0 && offset1 >= 0 && offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal1);\n        copyVec2(upperLimit, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal2);\n        scaleVec2(upperLimit, -1, normal0);\n      }\n    }\n  } else if (hasVertex0) {\n    if (convex1) {\n      front = offset0 >= 0 || offset1 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal0);\n        scaleVec2(upperLimit, -1, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        copyVec2(lowerLimit, normal1);\n        scaleVec2(upperLimit, -1, normal1);\n      }\n    } else {\n      front = offset0 >= 0 && offset1 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        copyVec2(lowerLimit, normal1);\n        scaleVec2(upperLimit, -1, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        copyVec2(lowerLimit, normal1);\n        scaleVec2(upperLimit, -1, normal0);\n      }\n    }\n  } else if (hasVertex3) {\n    if (convex2) {\n      front = offset1 >= 0 || offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        copyVec2(upperLimit, normal2);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        copyVec2(upperLimit, normal1);\n      }\n    } else {\n      front = offset1 >= 0 && offset2 >= 0;\n      if (front) {\n        copyVec2(normal, normal1);\n        scaleVec2(lowerLimit, -1, normal1);\n        copyVec2(upperLimit, normal1);\n      } else {\n        scaleVec2(normal, -1, normal1);\n        scaleVec2(lowerLimit, -1, normal2);\n        copyVec2(upperLimit, normal1);\n      }\n    }\n  } else {\n    front = offset1 >= 0;\n    if (front) {\n      copyVec2(normal, normal1);\n      scaleVec2(lowerLimit, -1, normal1);\n      scaleVec2(upperLimit, -1, normal1);\n    } else {\n      scaleVec2(normal, -1, normal1);\n      copyVec2(lowerLimit, normal1);\n      copyVec2(upperLimit, normal1);\n    }\n  }\n  polygonBA.count = polygonB.m_count;\n  for (var i = 0; i < polygonB.m_count; ++i) {\n    transformVec2(polygonBA.vertices[i], xf, polygonB.m_vertices[i]);\n    rotVec2(polygonBA.normals[i], xf.q, polygonB.m_normals[i]);\n  }\n  var radius = polygonB.m_radius + edgeA.m_radius;\n  manifold.pointCount = 0;\n  {\n    edgeAxis.type = EPAxisType.e_edgeA;\n    edgeAxis.index = front ? 0 : 1;\n    edgeAxis.separation = Infinity;\n    for (var i = 0; i < polygonBA.count; ++i) {\n      var v4 = polygonBA.vertices[i];\n      var s2 = dotVec2(normal, v4) - dotVec2(normal, v13);\n      if (s2 < edgeAxis.separation) {\n        edgeAxis.separation = s2;\n      }\n    }\n  }\n  if (edgeAxis.type == EPAxisType.e_unknown) {\n    return;\n  }\n  if (edgeAxis.separation > radius) {\n    return;\n  }\n  {\n    polygonAxis.type = EPAxisType.e_unknown;\n    polygonAxis.index = -1;\n    polygonAxis.separation = -Infinity;\n    setVec2(perp, -normal.y, normal.x);\n    for (var i = 0; i < polygonBA.count; ++i) {\n      scaleVec2(n, -1, polygonBA.normals[i]);\n      var s1 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v13);\n      var s22 = dotVec2(n, polygonBA.vertices[i]) - dotVec2(n, v22);\n      var s2 = math_min(s1, s22);\n      if (s2 > radius) {\n        polygonAxis.type = EPAxisType.e_edgeB;\n        polygonAxis.index = i;\n        polygonAxis.separation = s2;\n        break;\n      }\n      if (dotVec2(n, perp) >= 0) {\n        if (dotVec2(n, normal) - dotVec2(upperLimit, normal) < -SettingsInternal.angularSlop) {\n          continue;\n        }\n      } else {\n        if (dotVec2(n, normal) - dotVec2(lowerLimit, normal) < -SettingsInternal.angularSlop) {\n          continue;\n        }\n      }\n      if (s2 > polygonAxis.separation) {\n        polygonAxis.type = EPAxisType.e_edgeB;\n        polygonAxis.index = i;\n        polygonAxis.separation = s2;\n      }\n    }\n  }\n  if (polygonAxis.type != EPAxisType.e_unknown && polygonAxis.separation > radius) {\n    return;\n  }\n  var k_relativeTol = 0.98;\n  var k_absoluteTol = 1e-3;\n  var primaryAxis;\n  if (polygonAxis.type == EPAxisType.e_unknown) {\n    primaryAxis = edgeAxis;\n  } else if (polygonAxis.separation > k_relativeTol * edgeAxis.separation + k_absoluteTol) {\n    primaryAxis = polygonAxis;\n  } else {\n    primaryAxis = edgeAxis;\n  }\n  ie[0].recycle();\n  ie[1].recycle();\n  if (primaryAxis.type == EPAxisType.e_edgeA) {\n    manifold.type = ManifoldType.e_faceA;\n    var bestIndex = 0;\n    var bestValue = dotVec2(normal, polygonBA.normals[0]);\n    for (var i = 1; i < polygonBA.count; ++i) {\n      var value = dotVec2(normal, polygonBA.normals[i]);\n      if (value < bestValue) {\n        bestValue = value;\n        bestIndex = i;\n      }\n    }\n    var i1 = bestIndex;\n    var i2 = i1 + 1 < polygonBA.count ? i1 + 1 : 0;\n    copyVec2(ie[0].v, polygonBA.vertices[i1]);\n    ie[0].id.setFeatures(0, ContactFeatureType.e_face, i1, ContactFeatureType.e_vertex);\n    copyVec2(ie[1].v, polygonBA.vertices[i2]);\n    ie[1].id.setFeatures(0, ContactFeatureType.e_face, i2, ContactFeatureType.e_vertex);\n    if (front) {\n      rf.i1 = 0;\n      rf.i2 = 1;\n      copyVec2(rf.v1, v13);\n      copyVec2(rf.v2, v22);\n      copyVec2(rf.normal, normal1);\n    } else {\n      rf.i1 = 1;\n      rf.i2 = 0;\n      copyVec2(rf.v1, v22);\n      copyVec2(rf.v2, v13);\n      scaleVec2(rf.normal, -1, normal1);\n    }\n  } else {\n    manifold.type = ManifoldType.e_faceB;\n    copyVec2(ie[0].v, v13);\n    ie[0].id.setFeatures(0, ContactFeatureType.e_vertex, primaryAxis.index, ContactFeatureType.e_face);\n    copyVec2(ie[1].v, v22);\n    ie[1].id.setFeatures(0, ContactFeatureType.e_vertex, primaryAxis.index, ContactFeatureType.e_face);\n    rf.i1 = primaryAxis.index;\n    rf.i2 = rf.i1 + 1 < polygonBA.count ? rf.i1 + 1 : 0;\n    copyVec2(rf.v1, polygonBA.vertices[rf.i1]);\n    copyVec2(rf.v2, polygonBA.vertices[rf.i2]);\n    copyVec2(rf.normal, polygonBA.normals[rf.i1]);\n  }\n  setVec2(rf.sideNormal1, rf.normal.y, -rf.normal.x);\n  setVec2(rf.sideNormal2, -rf.sideNormal1.x, -rf.sideNormal1.y);\n  rf.sideOffset1 = dotVec2(rf.sideNormal1, rf.v1);\n  rf.sideOffset2 = dotVec2(rf.sideNormal2, rf.v2);\n  clipPoints1[0].recycle();\n  clipPoints1[1].recycle();\n  clipPoints2[0].recycle();\n  clipPoints2[1].recycle();\n  var np1 = clipSegmentToLine(clipPoints1, ie, rf.sideNormal1, rf.sideOffset1, rf.i1);\n  if (np1 < SettingsInternal.maxManifoldPoints) {\n    return;\n  }\n  var np2 = clipSegmentToLine(clipPoints2, clipPoints1, rf.sideNormal2, rf.sideOffset2, rf.i2);\n  if (np2 < SettingsInternal.maxManifoldPoints) {\n    return;\n  }\n  if (primaryAxis.type == EPAxisType.e_edgeA) {\n    copyVec2(manifold.localNormal, rf.normal);\n    copyVec2(manifold.localPoint, rf.v1);\n  } else {\n    copyVec2(manifold.localNormal, polygonB.m_normals[rf.i1]);\n    copyVec2(manifold.localPoint, polygonB.m_vertices[rf.i1]);\n  }\n  var pointCount = 0;\n  for (var i = 0; i < SettingsInternal.maxManifoldPoints; ++i) {\n    var separation = dotVec2(rf.normal, clipPoints2[i].v) - dotVec2(rf.normal, rf.v1);\n    if (separation <= radius) {\n      var cp = manifold.points[pointCount];\n      if (primaryAxis.type == EPAxisType.e_edgeA) {\n        detransformVec2(cp.localPoint, xf, clipPoints2[i].v);\n        cp.id.set(clipPoints2[i].id);\n      } else {\n        copyVec2(cp.localPoint, clipPoints2[i].v);\n        cp.id.set(clipPoints2[i].id);\n        cp.id.swapFeatures();\n      }\n      ++pointCount;\n    }\n  }\n  manifold.pointCount = pointCount;\n};\nvar internal = {\n  CollidePolygons,\n  Settings,\n  Sweep,\n  Manifold,\n  Distance,\n  TimeOfImpact,\n  DynamicTree,\n  stats\n};\nvar DataDriver = (\n  /** @class */\n  function() {\n    function DataDriver2(key, listener) {\n      this._refMap = {};\n      this._map = {};\n      this._xmap = {};\n      this._data = [];\n      this._entered = [];\n      this._exited = [];\n      this._key = key;\n      this._listener = listener;\n    }\n    DataDriver2.prototype.update = function(data) {\n      if (!Array.isArray(data))\n        throw \"Invalid data: \" + data;\n      this._entered.length = 0;\n      this._exited.length = 0;\n      this._data.length = data.length;\n      for (var i = 0; i < data.length; i++) {\n        if (typeof data[i] !== \"object\" || data[i] === null)\n          continue;\n        var d2 = data[i];\n        var id = this._key(d2);\n        if (!this._map[id]) {\n          this._entered.push(d2);\n        } else {\n          delete this._map[id];\n        }\n        this._data[i] = d2;\n        this._xmap[id] = d2;\n      }\n      for (var id in this._map) {\n        this._exited.push(this._map[id]);\n        delete this._map[id];\n      }\n      var temp3 = this._map;\n      this._map = this._xmap;\n      this._xmap = temp3;\n      for (var i = 0; i < this._exited.length; i++) {\n        var d2 = this._exited[i];\n        var key = this._key(d2);\n        var ref = this._refMap[key];\n        this._listener.exit(d2, ref);\n        delete this._refMap[key];\n      }\n      for (var i = 0; i < this._entered.length; i++) {\n        var d2 = this._entered[i];\n        var key = this._key(d2);\n        var ref = this._listener.enter(d2);\n        if (ref) {\n          this._refMap[key] = ref;\n        }\n      }\n      for (var i = 0; i < this._data.length; i++) {\n        if (typeof data[i] !== \"object\" || data[i] === null)\n          continue;\n        var d2 = this._data[i];\n        var key = this._key(d2);\n        var ref = this._refMap[key];\n        this._listener.update(d2, ref);\n      }\n      this._entered.length = 0;\n      this._exited.length = 0;\n      this._data.length = 0;\n    };\n    DataDriver2.prototype.ref = function(d2) {\n      return this._refMap[this._key(d2)];\n    };\n    return DataDriver2;\n  }()\n);\nconst planck = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({\n  __proto__: null,\n  AABB,\n  Body,\n  Box: BoxShape,\n  BoxShape,\n  BroadPhase,\n  Chain: ChainShape,\n  ChainShape,\n  Circle: CircleShape,\n  CircleShape,\n  ClipVertex,\n  CollideCircles,\n  CollideEdgeCircle,\n  CollideEdgePolygon,\n  CollidePolygonCircle,\n  CollidePolygons,\n  Contact,\n  ContactEdge,\n  get ContactFeatureType() {\n    return ContactFeatureType;\n  },\n  ContactID,\n  ContactImpulse,\n  DataDriver,\n  Distance,\n  DistanceInput,\n  DistanceJoint,\n  DistanceOutput,\n  DistanceProxy,\n  DynamicTree,\n  Edge: EdgeShape,\n  EdgeShape,\n  Fixture,\n  FixtureProxy,\n  FrictionJoint,\n  GearJoint,\n  Joint,\n  JointEdge,\n  Manifold,\n  ManifoldPoint,\n  get ManifoldType() {\n    return ManifoldType;\n  },\n  Mat22,\n  Mat33,\n  Math: math,\n  MotorJoint,\n  MouseJoint,\n  get PointState() {\n    return PointState;\n  },\n  Polygon: PolygonShape,\n  PolygonShape,\n  PrismaticJoint,\n  PulleyJoint,\n  RevoluteJoint,\n  RopeJoint,\n  Rot,\n  Serializer,\n  Settings,\n  SettingsInternal,\n  Shape,\n  ShapeCast,\n  ShapeCastInput,\n  ShapeCastOutput,\n  SimplexCache,\n  Solver,\n  Sweep,\n  TOIInput,\n  TOIOutput,\n  get TOIOutputState() {\n    return TOIOutputState;\n  },\n  Testbed,\n  TimeOfImpact,\n  TimeStep,\n  Transform,\n  TreeNode,\n  Vec2,\n  Vec3,\n  VelocityConstraintPoint,\n  WeldJoint,\n  WheelJoint,\n  World,\n  WorldManifold,\n  clipSegmentToLine,\n  getPointStates,\n  internal,\n  mixFriction,\n  mixRestitution,\n  stats,\n  testOverlap,\n  testbed\n}, Symbol.toStringTag, { value: \"Module\" }));\nexport {\n  AABB,\n  Body,\n  BoxShape as Box,\n  BoxShape,\n  BroadPhase,\n  ChainShape as Chain,\n  ChainShape,\n  CircleShape as Circle,\n  CircleShape,\n  ClipVertex,\n  CollideCircles,\n  CollideEdgeCircle,\n  CollideEdgePolygon,\n  CollidePolygonCircle,\n  CollidePolygons,\n  Contact,\n  ContactEdge,\n  ContactFeatureType,\n  ContactID,\n  ContactImpulse,\n  DataDriver,\n  Distance,\n  DistanceInput,\n  DistanceJoint,\n  DistanceOutput,\n  DistanceProxy,\n  DynamicTree,\n  EdgeShape as Edge,\n  EdgeShape,\n  Fixture,\n  FixtureProxy,\n  FrictionJoint,\n  GearJoint,\n  Joint,\n  JointEdge,\n  Manifold,\n  ManifoldPoint,\n  ManifoldType,\n  Mat22,\n  Mat33,\n  math as Math,\n  MotorJoint,\n  MouseJoint,\n  PointState,\n  PolygonShape as Polygon,\n  PolygonShape,\n  PrismaticJoint,\n  PulleyJoint,\n  RevoluteJoint,\n  RopeJoint,\n  Rot,\n  Serializer,\n  Settings,\n  SettingsInternal,\n  Shape,\n  ShapeCast,\n  ShapeCastInput,\n  ShapeCastOutput,\n  SimplexCache,\n  Solver,\n  Sweep,\n  TOIInput,\n  TOIOutput,\n  TOIOutputState,\n  Testbed,\n  TimeOfImpact,\n  TimeStep,\n  Transform,\n  TreeNode,\n  Vec2,\n  Vec3,\n  VelocityConstraintPoint,\n  WeldJoint,\n  WheelJoint,\n  World,\n  WorldManifold,\n  clipSegmentToLine,\n  planck as default,\n  getPointStates,\n  internal,\n  mixFriction,\n  mixRestitution,\n  stats,\n  testOverlap,\n  testbed\n};\n//# sourceMappingURL=planck.mjs.map\n","/**\n * Physics configuration constants.\n *\n * All measurements are in pixels unless otherwise noted.\n * Planck.js uses meters internally, so we scale by PHYSICS_CONFIG.scale.\n */\n\nexport const PHYSICS_CONFIG = {\n  /** Pixels per meter - used for Planck.js coordinate conversion */\n  scale: 100,\n\n  /** Gravity in pixels per second squared (~20 m/s, 2x normal) */\n  gravity: 1960,\n\n  /** Fixed timestep in milliseconds (60 Hz) */\n  fixedTimestep: 1000 / 60,\n\n  /** Velocity constraint solver iterations */\n  velocityIterations: 8,\n\n  /** Position constraint solver iterations */\n  positionIterations: 3,\n\n  /** Default density for part bodies (kg/m) */\n  partDensity: 1.0,\n\n  /** Default friction coefficient */\n  friction: 0.3,\n\n  /** Default restitution (bounciness) - low for minimal bounce */\n  restitution: 0.1,\n\n  /** Linear damping to slow falling parts (low for faster falling) */\n  linearDamping: 0.05,\n\n  /** Angular damping to reduce rotation */\n  angularDamping: 0.3,\n\n  /** Play area bounds in pixels */\n  playArea: {\n    minX: 132,\n    maxX: 947,\n    minY: 600,\n    maxY: 1750,\n    width: 815,\n    height: 1150,\n    centerX: 540,\n    centerY: 1175,\n  },\n\n  /** Boundary wall thickness in pixels */\n  boundaryThickness: 50,\n} as const;\n\nexport type PhysicsConfig = typeof PHYSICS_CONFIG;\n","/**\n * PhysicsWorldManager - Singleton manager for Planck.js physics world.\n *\n * Manages the physics simulation including:\n * - World creation with gravity\n * - Body lifecycle (create, convert, destroy)\n * - Fixed timestep simulation for determinism\n * - Position queries and sleep state\n * - Boundary walls for world edges\n */\n\nimport { World, Vec2, Box } from 'planck';\n\nimport type { Body } from 'planck';\nimport type { Entity2D } from '@play-co/odie';\n\nimport { PHYSICS_CONFIG } from './PhysicsConfig';\nimport type { PixelPosition } from './types';\n\n/** Category bit for boundary walls - collides with all layers. */\nconst BOUNDARY_CATEGORY = 0x8000;\n\n/** Category bits for all part layers combined. */\nconst ALL_PARTS_MASK = 0x00ff;\n\n/** Body position in meters. */\ninterface BodyPosition {\n  x: number;\n  y: number;\n}\n\n/** Body dimensions in meters. */\ninterface BodyDimensions extends BodyPosition {\n  halfWidth: number;\n  halfHeight: number;\n}\n\n/**\n * Get the collision category bit for a given layer.\n *\n * @param layer - The layer number (1-8)\n * @returns The category bit for that layer\n * @example\n * const category = getLayerCategory(1); // returns 0x0001\n */\nfunction getLayerCategory(layer: number): number {\n  return 1 << (layer - 1);\n}\n\n/**\n * Singleton manager for Planck.js physics world.\n *\n * Manages physics simulation including body creation, stepping,\n * and position synchronization with game entities.\n *\n * @example\n * const physics = PhysicsWorldManager.getInstance();\n * const bodyId = physics.createBodyForPart(entity, 100, 50, true, 1);\n */\nexport class PhysicsWorldManager {\n  private static instance: PhysicsWorldManager | null = null;\n\n  // Planck.js World type is marked deprecated but is the correct API\n  // eslint-disable-next-line @typescript-eslint/no-deprecated\n  private world: World;\n  private bodies = new Map<number, Body>();\n  private nextBodyId = 0;\n  private accumulator = 0;\n  private paused = false;\n\n  private constructor() {\n    // Create world with gravity (negative Y because Planck uses standard coordinates)\n    const gravityMeters = PHYSICS_CONFIG.gravity / PHYSICS_CONFIG.scale;\n    this.world = new World({ gravity: new Vec2(0, gravityMeters) });\n\n    this.createBoundaryWalls();\n  }\n\n  /**\n   * Get singleton instance.\n   *\n   * @returns The PhysicsWorldManager singleton\n   * @example\n   * const physics = PhysicsWorldManager.getInstance();\n   */\n  static getInstance(): PhysicsWorldManager {\n    PhysicsWorldManager.instance ??= new PhysicsWorldManager();\n    return PhysicsWorldManager.instance;\n  }\n\n  /**\n   * Destroy singleton instance (for testing).\n   *\n   * @example\n   * PhysicsWorldManager.destroy();\n   */\n  static destroy(): void {\n    if (PhysicsWorldManager.instance) {\n      PhysicsWorldManager.instance.bodies.clear();\n      PhysicsWorldManager.instance = null;\n    }\n  }\n\n  /**\n   * Create a physics body for a part entity.\n   *\n   * @param entity - The entity to create a body for\n   * @param width - Width in pixels\n   * @param height - Height in pixels\n   * @param isStatic - Whether the body should be static\n   * @param layer - The visual layer (1-8) for collision filtering\n   * @returns Body ID for future reference\n   * @example\n   * const bodyId = physics.createBodyForPart(entity, 100, 50, true, 1);\n   */\n  createBodyForPart(\n    entity: Entity2D,\n    width: number,\n    height: number,\n    isStatic: boolean,\n    layer = 1\n  ): number {\n    const dims = this.calculateBodyDimensions(entity, width, height);\n    const body = this.createPartBody(dims, isStatic);\n    this.attachPartFixture(body, dims, layer);\n    return this.registerBody(body, entity.UID);\n  }\n\n  /**\n   * Calculate body dimensions in meters.\n   *\n   * @param entity - The entity to calculate for\n   * @param width - Width in pixels\n   * @param height - Height in pixels\n   * @returns Dimensions object\n   * @example\n   * const dims = this.calculateBodyDimensions(entity, 100, 50);\n   */\n  private calculateBodyDimensions(\n    entity: Entity2D,\n    width: number,\n    height: number\n  ): BodyDimensions {\n    const scale = PHYSICS_CONFIG.scale;\n    return {\n      x: entity.position.x / scale,\n      y: entity.position.y / scale,\n      halfWidth: width / 2 / scale,\n      halfHeight: height / 2 / scale,\n    };\n  }\n\n  /**\n   * Create a body for a part.\n   *\n   * @param dims - Body position in meters\n   * @param isStatic - Whether body is static\n   * @returns The created body\n   * @example\n   * const body = this.createPartBody(dims, true);\n   */\n  private createPartBody(dims: BodyPosition, isStatic: boolean): Body {\n    return this.world.createBody({\n      type: isStatic ? 'static' : 'dynamic',\n      position: new Vec2(dims.x, dims.y),\n      linearDamping: PHYSICS_CONFIG.linearDamping,\n      angularDamping: PHYSICS_CONFIG.angularDamping,\n    });\n  }\n\n  /**\n   * Attach fixture with collision filtering.\n   *\n   * @param body - The body to attach fixture to\n   * @param dims - Body dimensions in meters\n   * @param layer - Collision layer\n   * @example\n   * this.attachPartFixture(body, dims, 1);\n   */\n  private attachPartFixture(\n    body: Body,\n    dims: BodyDimensions,\n    layer: number\n  ): void {\n    const layerCategory = getLayerCategory(layer);\n    body.createFixture({\n      shape: new Box(dims.halfWidth, dims.halfHeight),\n      density: PHYSICS_CONFIG.partDensity,\n      friction: PHYSICS_CONFIG.friction,\n      restitution: PHYSICS_CONFIG.restitution,\n      filterCategoryBits: layerCategory,\n      filterMaskBits: layerCategory | BOUNDARY_CATEGORY,\n    });\n  }\n\n  /**\n   * Register body and return ID.\n   *\n   * @param body - The body to register\n   * @param entityUid - Entity UID for reverse lookup\n   * @returns Body ID\n   * @example\n   * const bodyId = this.registerBody(body, entity.UID);\n   */\n  private registerBody(body: Body, entityUid: number): number {\n    const bodyId = this.nextBodyId++;\n    this.bodies.set(bodyId, body);\n    body.setUserData({ entityUid, bodyId });\n    return bodyId;\n  }\n\n  /**\n   * Convert a static body to dynamic (for when part becomes free).\n   *\n   * @param bodyId - The body ID to convert\n   * @example\n   * physics.setBodyDynamic(bodyId);\n   */\n  setBodyDynamic(bodyId: number): void {\n    const body = this.bodies.get(bodyId);\n    if (!body) return;\n\n    body.setType('dynamic');\n    body.setAwake(true);\n  }\n\n  /**\n   * Step the physics simulation with fixed timestep accumulator.\n   *\n   * @param deltaMs - Time elapsed in milliseconds\n   * @example\n   * physics.step(16.67); // ~60fps\n   */\n  step(deltaMs: number): void {\n    if (this.paused) return;\n\n    this.accumulator += deltaMs;\n\n    while (this.accumulator >= PHYSICS_CONFIG.fixedTimestep) {\n      this.world.step(\n        PHYSICS_CONFIG.fixedTimestep / 1000,\n        PHYSICS_CONFIG.velocityIterations,\n        PHYSICS_CONFIG.positionIterations\n      );\n      this.accumulator -= PHYSICS_CONFIG.fixedTimestep;\n    }\n  }\n\n  /**\n   * Step physics by exact delta (bypasses accumulator for deterministic testing).\n   *\n   * @param deltaMs - Exact time to step in milliseconds\n   * @example\n   * physics.stepExact(16.67);\n   */\n  stepExact(deltaMs: number): void {\n    this.world.step(\n      deltaMs / 1000,\n      PHYSICS_CONFIG.velocityIterations,\n      PHYSICS_CONFIG.positionIterations\n    );\n  }\n\n  /**\n   * Get body position in pixel coordinates.\n   *\n   * @param bodyId - The body ID to query\n   * @returns Position in pixels or null if body not found\n   * @example\n   * const pos = physics.getBodyPosition(bodyId);\n   */\n  getBodyPosition(bodyId: number): PixelPosition | null {\n    const body = this.bodies.get(bodyId);\n    if (!body) return null;\n\n    const pos = body.getPosition();\n    return {\n      x: pos.x * PHYSICS_CONFIG.scale,\n      y: pos.y * PHYSICS_CONFIG.scale,\n    };\n  }\n\n  /**\n   * Get body rotation in radians.\n   *\n   * @param bodyId - The body ID to query\n   * @returns Rotation in radians or 0 if body not found\n   * @example\n   * const angle = physics.getBodyRotation(bodyId);\n   */\n  getBodyRotation(bodyId: number): number {\n    const body = this.bodies.get(bodyId);\n    if (!body) return 0;\n\n    return body.getAngle();\n  }\n\n  /**\n   * Check if a body is sleeping (at rest).\n   *\n   * @param bodyId - The body ID to check\n   * @returns True if sleeping or body not found\n   * @example\n   * if (physics.isBodySleeping(bodyId)) { ... }\n   */\n  isBodySleeping(bodyId: number): boolean {\n    const body = this.bodies.get(bodyId);\n    if (!body) return true;\n\n    return !body.isAwake();\n  }\n\n  /**\n   * Remove a body from the simulation.\n   *\n   * @param bodyId - The body ID to remove\n   * @example\n   * physics.removeBody(bodyId);\n   */\n  removeBody(bodyId: number): void {\n    const body = this.bodies.get(bodyId);\n    if (!body) return;\n\n    this.world.destroyBody(body);\n    this.bodies.delete(bodyId);\n  }\n\n  /**\n   * Pause physics simulation.\n   *\n   * @example\n   * physics.pause();\n   */\n  pause(): void {\n    this.paused = true;\n  }\n\n  /**\n   * Resume physics simulation.\n   *\n   * @example\n   * physics.resume();\n   */\n  resume(): void {\n    this.paused = false;\n  }\n\n  /**\n   * Check if simulation is paused.\n   *\n   * @returns True if paused\n   * @example\n   * if (physics.isPaused()) { ... }\n   */\n  isPaused(): boolean {\n    return this.paused;\n  }\n\n  /**\n   * Reset physics world (clear all dynamic bodies, keep boundaries).\n   * Used for level restart.\n   *\n   * @example\n   * physics.reset();\n   */\n  reset(): void {\n    // Remove all user-created bodies\n    for (const [, body] of this.bodies) {\n      this.world.destroyBody(body);\n    }\n    this.bodies.clear();\n    this.nextBodyId = 0;\n    this.accumulator = 0;\n    this.paused = false;\n  }\n\n  /**\n   * Get all body IDs (for debugging).\n   *\n   * @returns Array of body IDs\n   * @example\n   * const ids = physics.getAllBodyIds();\n   */\n  getAllBodyIds(): number[] {\n    return Array.from(this.bodies.keys());\n  }\n\n  /**\n   * Create boundary walls around the play area.\n   * Note: No bottom wall - parts fall through and get cleaned up.\n   *\n   * @example\n   * // Called automatically in constructor\n   */\n  private createBoundaryWalls(): void {\n    const dims = this.calculateBoundaryDimensions();\n    // Left wall\n    this.createWall(\n      dims.minX - dims.thickness / 2,\n      dims.centerY,\n      dims.thickness / 2,\n      dims.height + dims.thickness\n    );\n    // Right wall\n    this.createWall(\n      dims.maxX + dims.thickness / 2,\n      dims.centerY,\n      dims.thickness / 2,\n      dims.height + dims.thickness\n    );\n  }\n\n  /**\n   * Calculate boundary dimensions in meters.\n   *\n   * @returns Boundary dimensions object\n   * @example\n   * const dims = this.calculateBoundaryDimensions();\n   */\n  private calculateBoundaryDimensions(): {\n    thickness: number;\n    minX: number;\n    maxX: number;\n    maxY: number;\n    width: number;\n    height: number;\n    centerX: number;\n    centerY: number;\n  } {\n    const { playArea, boundaryThickness, scale } = PHYSICS_CONFIG;\n    const thickness = boundaryThickness / scale;\n    const minX = playArea.minX / scale;\n    const maxX = playArea.maxX / scale;\n    const minY = playArea.minY / scale;\n    const maxY = playArea.maxY / scale;\n    return {\n      thickness,\n      minX,\n      maxX,\n      maxY,\n      width: (maxX - minX) / 2,\n      height: (maxY - minY) / 2,\n      centerX: (minX + maxX) / 2,\n      centerY: (minY + maxY) / 2,\n    };\n  }\n\n  /**\n   * Create a single wall body.\n   *\n   * @param x - X position in meters\n   * @param y - Y position in meters\n   * @param halfWidth - Half-width of the wall\n   * @param halfHeight - Half-height of the wall\n   * @example\n   * this.createWall(5, 10, 1, 0.5);\n   */\n  private createWall(\n    x: number,\n    y: number,\n    halfWidth: number,\n    halfHeight: number\n  ): void {\n    const wall = this.world.createBody({\n      type: 'static',\n      position: new Vec2(x, y),\n    });\n    // Boundary walls collide with all layers\n    wall.createFixture({\n      shape: new Box(halfWidth, halfHeight),\n      friction: PHYSICS_CONFIG.friction,\n      filterCategoryBits: BOUNDARY_CATEGORY,\n      filterMaskBits: ALL_PARTS_MASK,\n    });\n  }\n}\n","/**\n * Part registry for looking up part definitions by ID.\n *\n * Parts are registered at module load time via `registerPart()`.\n * Use `getPart()` to retrieve a part definition by its ID.\n *\n * @module\n */\n\nimport type { PartDefinition } from '@shared/types';\n\n/** Registry of all registered parts */\nconst parts = new Map<string, PartDefinition>();\n\n/**\n * Register a part definition.\n *\n * @param part - The part definition to register\n * @throws Error if a part with the same ID is already registered\n *\n * @example\n * ```typescript\n * import { registerPart } from '@shared/parts/registry';\n *\n * const myPart: PartDefinition = {\n *   id: 'my-part',\n *   name: 'My Part',\n *   // ... other properties\n * };\n *\n * registerPart(myPart);\n * ```\n */\nexport function registerPart(part: PartDefinition): void {\n  if (parts.has(part.id)) {\n    throw new Error(`Part \"${part.id}\" is already registered`);\n  }\n  parts.set(part.id, part);\n}\n\n/**\n * Get a part definition by ID.\n *\n * @param id - The part ID to look up\n * @returns The part definition\n * @throws Error if the part ID is not found\n *\n * @example\n * ```typescript\n * import { getPart } from '@shared/parts/registry';\n *\n * const part = getPart('simple-plate');\n * console.log(part.name); // \"Simple Plate\"\n * ```\n */\nexport function getPart(id: string): PartDefinition {\n  const part = parts.get(id);\n  if (!part) {\n    throw new Error(`Part \"${id}\" not found in registry`);\n  }\n  return part;\n}\n\n/**\n * Check if a part ID is registered.\n *\n * @param id - The part ID to check\n * @returns true if the part is registered\n *\n * @example\n * ```typescript\n * if (hasPart('simple-plate')) {\n *   const part = getPart('simple-plate');\n * }\n * ```\n */\nexport function hasPart(id: string): boolean {\n  return parts.has(id);\n}\n\n/**\n * Get all registered part IDs.\n *\n * @returns Array of all registered part IDs\n *\n * @example\n * ```typescript\n * const ids = getAllPartIds();\n * console.log('Available parts:', ids.join(', '));\n * ```\n */\nexport function getAllPartIds(): string[] {\n  return Array.from(parts.keys());\n}\n\n/**\n * Get all registered part definitions.\n *\n * @returns Array of all registered part definitions\n *\n * @example\n * ```typescript\n * const parts = getAllParts();\n * parts.forEach(part => console.log(part.name));\n * ```\n */\nexport function getAllParts(): PartDefinition[] {\n  return Array.from(parts.values());\n}\n\n/**\n * Clear all registered parts.\n *\n * Primarily useful for testing.\n *\n * @example\n * ```typescript\n * beforeEach(() => clearRegistry());\n * ```\n */\nexport function clearRegistry(): void {\n  parts.clear();\n}\n","/**\n * Simple plate part definition.\n *\n * A basic rectangular static part used for foundational puzzle elements.\n *\n * @module\n */\n\nimport type { PartDefinition } from '@shared/types';\nimport { registerPart } from '../registry';\n\n/**\n * A simple rectangular metal plate.\n *\n * Static part that cannot move. Has 4 screw mount points at corners.\n */\nexport const simplePlate: PartDefinition = {\n  id: 'simple-plate',\n  name: 'Simple Plate',\n  asset: 'images/parts/simple-plate.png',\n  collision: { type: 'box', width: 200, height: 100 },\n  material: 'metal',\n  constraint: { type: 'static' },\n  screwMounts: [\n    { id: 'top-left', localPosition: { x: 20, y: 20 } },\n    { id: 'top-right', localPosition: { x: 180, y: 20 } },\n    { id: 'bottom-left', localPosition: { x: 20, y: 80 } },\n    { id: 'bottom-right', localPosition: { x: 180, y: 80 } },\n  ],\n};\n\nregisterPart(simplePlate);\n","/**\n * Sliding cover part definition.\n *\n * A panel that slides horizontally when screws are removed.\n *\n * @module\n */\n\nimport type { PartDefinition } from '@shared/types';\nimport { registerPart } from '../registry';\n\n/**\n * A sliding metal cover.\n *\n * Slides along the X axis when freed. Used to hide screws underneath.\n */\nexport const slidingCover: PartDefinition = {\n  id: 'sliding-cover',\n  name: 'Sliding Cover',\n  asset: 'images/parts/sliding-cover.png',\n  collision: { type: 'box', width: 150, height: 80 },\n  material: 'metal',\n  constraint: {\n    type: 'slider',\n    axis: 'x',\n    min: 0,\n    max: 100,\n  },\n  screwMounts: [\n    { id: 'left', localPosition: { x: 25, y: 40 } },\n    { id: 'center', localPosition: { x: 75, y: 40 } },\n    { id: 'right', localPosition: { x: 125, y: 40 } },\n  ],\n};\n\nregisterPart(slidingCover);\n","/**\n * Walnut square board part definition.\n *\n * A dark brown wooden square board used in puzzles.\n *\n * @module\n */\n\nimport type { PartDefinition } from '@shared/types';\nimport { registerPart } from '../registry';\n\n/**\n * A square walnut wood board.\n *\n * Has friction constraint - can move when screws are removed.\n * 4 screw mount points at corners.\n */\nexport const boardWalnutSquare: PartDefinition = {\n  id: 'board-walnut-square',\n  name: 'Walnut Square Board',\n  asset: 'images/parts/board-walnut-square.png',\n  collision: { type: 'box', width: 270, height: 260 },\n  material: 'wood',\n  constraint: { type: 'friction', screwThreshold: 1 },\n  screwMounts: [\n    { id: 'top-left', localPosition: { x: 30, y: 30 } },\n    { id: 'top-right', localPosition: { x: 240, y: 30 } },\n    { id: 'bottom-left', localPosition: { x: 30, y: 230 } },\n    { id: 'bottom-right', localPosition: { x: 240, y: 230 } },\n  ],\n};\n\nregisterPart(boardWalnutSquare);\n","/**\n * Oak horizontal board part definition.\n *\n * A light wooden horizontal rectangular board.\n *\n * @module\n */\n\nimport type { PartDefinition } from '@shared/types';\nimport { registerPart } from '../registry';\n\n/**\n * A horizontal oak wood board.\n *\n * Has friction constraint - can move when screws are removed.\n * 4 screw mount points at corners.\n */\nexport const boardOakHorizontal: PartDefinition = {\n  id: 'board-oak-horizontal',\n  name: 'Oak Horizontal Board',\n  asset: 'images/parts/board-oak-horizontal.png',\n  collision: { type: 'box', width: 755, height: 317 },\n  material: 'wood',\n  constraint: { type: 'friction', screwThreshold: 1 },\n  screwMounts: [\n    { id: 'top-left', localPosition: { x: 30, y: 30 } },\n    { id: 'top-right', localPosition: { x: 725, y: 30 } },\n    { id: 'bottom-left', localPosition: { x: 30, y: 287 } },\n    { id: 'bottom-right', localPosition: { x: 725, y: 287 } },\n  ],\n};\n\nregisterPart(boardOakHorizontal);\n","/**\n * Oak vertical board part definition.\n *\n * A light wooden vertical rectangular board.\n *\n * @module\n */\n\nimport type { PartDefinition } from '@shared/types';\nimport { registerPart } from '../registry';\n\n/**\n * A vertical oak wood board.\n *\n * Has friction constraint - can move when screws are removed.\n * 4 screw mount points at corners.\n */\nexport const boardOakVertical: PartDefinition = {\n  id: 'board-oak-vertical',\n  name: 'Oak Vertical Board',\n  asset: 'images/parts/board-oak-vertical.png',\n  collision: { type: 'box', width: 270, height: 417 },\n  material: 'wood',\n  constraint: { type: 'friction', screwThreshold: 1 },\n  screwMounts: [\n    { id: 'top-left', localPosition: { x: 30, y: 30 } },\n    { id: 'top-right', localPosition: { x: 240, y: 30 } },\n    { id: 'bottom-left', localPosition: { x: 30, y: 387 } },\n    { id: 'bottom-right', localPosition: { x: 240, y: 387 } },\n  ],\n};\n\nregisterPart(boardOakVertical);\n","/**\n * Birch square board part definition.\n *\n * A pale cream colored wooden square board.\n *\n * @module\n */\n\nimport type { PartDefinition } from '@shared/types';\nimport { registerPart } from '../registry';\n\n/**\n * A square birch wood board.\n *\n * Has friction constraint - can move when screws are removed.\n * 4 screw mount points at corners.\n */\nexport const boardBirchSquare: PartDefinition = {\n  id: 'board-birch-square',\n  name: 'Birch Square Board',\n  asset: 'images/parts/board-birch-square.png',\n  collision: { type: 'box', width: 270, height: 260 },\n  material: 'wood',\n  constraint: { type: 'friction', screwThreshold: 1 },\n  screwMounts: [\n    { id: 'top-left', localPosition: { x: 30, y: 30 } },\n    { id: 'top-right', localPosition: { x: 240, y: 30 } },\n    { id: 'bottom-left', localPosition: { x: 30, y: 230 } },\n    { id: 'bottom-right', localPosition: { x: 240, y: 230 } },\n  ],\n};\n\nregisterPart(boardBirchSquare);\n","/**\n * Mahogany square board part definition.\n *\n * A reddish-brown wooden square board.\n *\n * @module\n */\n\nimport type { PartDefinition } from '@shared/types';\nimport { registerPart } from '../registry';\n\n/**\n * A square mahogany wood board.\n *\n * Has friction constraint - can move when screws are removed.\n * 4 screw mount points at corners.\n */\nexport const boardMahoganySquare: PartDefinition = {\n  id: 'board-mahogany-square',\n  name: 'Mahogany Square Board',\n  asset: 'images/parts/board-mahogany-square.png',\n  collision: { type: 'box', width: 270, height: 260 },\n  material: 'wood',\n  constraint: { type: 'friction', screwThreshold: 1 },\n  screwMounts: [\n    { id: 'top-left', localPosition: { x: 30, y: 30 } },\n    { id: 'top-right', localPosition: { x: 240, y: 30 } },\n    { id: 'bottom-left', localPosition: { x: 30, y: 230 } },\n    { id: 'bottom-right', localPosition: { x: 240, y: 230 } },\n  ],\n};\n\nregisterPart(boardMahoganySquare);\n","/**\n * Pine horizontal board part definition.\n *\n * A light yellow wooden horizontal rectangular board.\n *\n * @module\n */\n\nimport type { PartDefinition } from '@shared/types';\nimport { registerPart } from '../registry';\n\n/**\n * A horizontal pine wood board.\n *\n * Has friction constraint - can move when screws are removed.\n * 4 screw mount points at corners.\n */\nexport const boardPineHorizontal: PartDefinition = {\n  id: 'board-pine-horizontal',\n  name: 'Pine Horizontal Board',\n  asset: 'images/parts/board-pine-horizontal.png',\n  collision: { type: 'box', width: 501, height: 317 },\n  material: 'wood',\n  constraint: { type: 'friction', screwThreshold: 1 },\n  screwMounts: [\n    { id: 'top-left', localPosition: { x: 30, y: 30 } },\n    { id: 'top-right', localPosition: { x: 471, y: 30 } },\n    { id: 'bottom-left', localPosition: { x: 30, y: 287 } },\n    { id: 'bottom-right', localPosition: { x: 471, y: 287 } },\n  ],\n};\n\nregisterPart(boardPineHorizontal);\n","/**\n * Geometry utilities for bounds checking.\n *\n * Used primarily for validating screw positions within part collision shapes.\n *\n * @module\n */\n\nimport type {\n  Position,\n  CollisionShape,\n  BoxCollisionShape,\n} from '@shared/types';\n\n/** Screw head radius in pixels for bounds checking */\nexport const SCREW_RADIUS = 40;\n\n/**\n * Check if a point is inside a box collision shape.\n *\n * @param point - Point to check\n * @param box - Box collision shape\n * @returns True if point is inside or on boundary\n * @example\n * const inside = isPointInBox({ x: 50, y: 50 }, { type: 'box', width: 100, height: 100 });\n */\nexport function isPointInBox(point: Position, box: BoxCollisionShape): boolean {\n  return (\n    point.x >= 0 &&\n    point.x <= box.width &&\n    point.y >= 0 &&\n    point.y <= box.height\n  );\n}\n\n/**\n * Check if a circle is fully inside a box collision shape.\n *\n * @param center - Circle center point\n * @param radius - Circle radius\n * @param box - Box collision shape\n * @returns True if circle is fully contained\n * @example\n * const inside = isCircleInBox({ x: 50, y: 50 }, 10, { type: 'box', width: 100, height: 100 });\n */\nexport function isCircleInBox(\n  center: Position,\n  radius: number,\n  box: BoxCollisionShape\n): boolean {\n  return (\n    center.x - radius >= 0 &&\n    center.x + radius <= box.width &&\n    center.y - radius >= 0 &&\n    center.y + radius <= box.height\n  );\n}\n\n/**\n * Check if a point is inside a polygon using ray casting algorithm.\n *\n * @param point - Point to check\n * @param polygon - Array of polygon vertices\n * @returns True if point is inside polygon\n * @example\n * const inside = isPointInPolygon({ x: 5, y: 5 }, [{ x: 0, y: 0 }, { x: 10, y: 0 }, { x: 10, y: 10 }, { x: 0, y: 10 }]);\n */\nexport function isPointInPolygon(\n  point: Position,\n  polygon: Position[]\n): boolean {\n  let inside = false;\n  const n = polygon.length;\n\n  for (let i = 0, j = n - 1; i < n; j = i++) {\n    const pi = polygon[i];\n    const pj = polygon[j];\n\n    if (pi === undefined || pj === undefined) continue;\n\n    if (\n      pi.y > point.y !== pj.y > point.y &&\n      point.x < ((pj.x - pi.x) * (point.y - pi.y)) / (pj.y - pi.y) + pi.x\n    ) {\n      inside = !inside;\n    }\n  }\n\n  return inside;\n}\n\n/**\n * Check if a circle is approximately inside a polygon.\n *\n * Uses 5-point approximation: center + 4 cardinal direction points.\n *\n * @param center - Circle center point\n * @param radius - Circle radius\n * @param polygon - Array of polygon vertices\n * @returns True if all test points are inside polygon\n * @example\n * const inside = isCircleInPolygon({ x: 50, y: 50 }, 10, polygon);\n */\nexport function isCircleInPolygon(\n  center: Position,\n  radius: number,\n  polygon: Position[]\n): boolean {\n  const testPoints: Position[] = [\n    center,\n    { x: center.x - radius, y: center.y },\n    { x: center.x + radius, y: center.y },\n    { x: center.x, y: center.y - radius },\n    { x: center.x, y: center.y + radius },\n  ];\n\n  return testPoints.every((point) => isPointInPolygon(point, polygon));\n}\n\n/**\n * Check if a screw at given position is within collision bounds.\n *\n * @param screwPosition - Screw center position (local to part)\n * @param collision - Part collision shape\n * @param radius - Screw radius (defaults to SCREW_RADIUS)\n * @returns True if screw is fully within bounds\n * @example\n * const valid = isScrewInBounds({ x: 100, y: 100 }, collision);\n */\nexport function isScrewInBounds(\n  screwPosition: Position,\n  collision: CollisionShape,\n  radius: number = SCREW_RADIUS\n): boolean {\n  if (collision.type === 'box') {\n    return isCircleInBox(screwPosition, radius, collision);\n  } else {\n    return isCircleInPolygon(screwPosition, radius, collision.points);\n  }\n}\n","/**\n * Play area utilities for coordinate transformation and validation.\n *\n * The play area uses a centered coordinate system where (0, 0) is the center.\n * Parts are positioned using local coordinates which are transformed to world\n * coordinates for rendering.\n *\n * @module\n */\n\nimport type { Position } from '@shared/types';\n\n/**\n * Play area configuration constants.\n *\n * The play area is the inner usable region inside the puzzle-base frame\n * where parts can be placed.\n */\nexport const PLAY_AREA = {\n  /** Inner play area width in pixels */\n  width: 815,\n\n  /** Inner play area height in pixels */\n  height: 860,\n\n  /** Play area center X in world coordinates */\n  centerX: 540,\n\n  /** Play area center Y in world coordinates */\n  centerY: 1199,\n\n  /** Local coordinate bounds (centered origin at 0,0) */\n  bounds: {\n    /** Minimum X coordinate (left edge) */\n    minX: -407,\n    /** Maximum X coordinate (right edge) */\n    maxX: 407,\n    /** Minimum Y coordinate (top edge) */\n    minY: -430,\n    /** Maximum Y coordinate (bottom edge) */\n    maxY: 430,\n  },\n} as const;\n\n/**\n * Convert local (centered) coordinates to world coordinates.\n *\n * Local coordinates use the play area center as origin (0, 0).\n * World coordinates use the screen top-left as origin.\n *\n * @param localPosition - Position in centered coordinate system\n * @returns Position in world coordinates\n *\n * @example\n * ```typescript\n * // Center of play area\n * localToWorld({ x: 0, y: 0 }); // => { x: 540, y: 1199 }\n *\n * // Top-left corner of play area\n * localToWorld({ x: -407, y: -430 }); // => { x: 133, y: 769 }\n * ```\n */\nexport function localToWorld(localPosition: Position): Position {\n  return {\n    x: PLAY_AREA.centerX + localPosition.x,\n    y: PLAY_AREA.centerY + localPosition.y,\n  };\n}\n\n/**\n * Convert world coordinates to local (centered) coordinates.\n *\n * @param worldPosition - Position in world coordinates\n * @returns Position in centered coordinate system\n *\n * @example\n * ```typescript\n * worldToLocal({ x: 540, y: 1199 }); // => { x: 0, y: 0 }\n * ```\n */\nexport function worldToLocal(worldPosition: Position): Position {\n  return {\n    x: worldPosition.x - PLAY_AREA.centerX,\n    y: worldPosition.y - PLAY_AREA.centerY,\n  };\n}\n\n/**\n * Check if a part's bounding box fits entirely within the play area.\n *\n * The part is represented by its center position (in local coordinates)\n * and its collision box dimensions. The function checks that all four\n * edges of the part stay within the play area bounds.\n *\n * @param localPosition - Part center position in local coordinates\n * @param width - Part collision box width in pixels\n * @param height - Part collision box height in pixels\n * @returns true if the part fits entirely within the play area\n *\n * @example\n * ```typescript\n * // Small part at center - fits\n * isPartInPlayArea({ x: 0, y: 0 }, 100, 100); // => true\n *\n * // Part too close to edge - doesn't fit\n * isPartInPlayArea({ x: 350, y: 0 }, 200, 100); // => false (right edge at 450 > 407)\n * ```\n */\nexport function isPartInPlayArea(\n  localPosition: Position,\n  width: number,\n  height: number\n): boolean {\n  const halfWidth = width / 2;\n  const halfHeight = height / 2;\n\n  const leftEdge = localPosition.x - halfWidth;\n  const rightEdge = localPosition.x + halfWidth;\n  const topEdge = localPosition.y - halfHeight;\n  const bottomEdge = localPosition.y + halfHeight;\n\n  return (\n    leftEdge >= PLAY_AREA.bounds.minX &&\n    rightEdge <= PLAY_AREA.bounds.maxX &&\n    topEdge >= PLAY_AREA.bounds.minY &&\n    bottomEdge <= PLAY_AREA.bounds.maxY\n  );\n}\n\n/** Detailed information about a part's position relative to play area bounds. */\nexport interface PartBoundsInfo {\n  leftEdge: number;\n  rightEdge: number;\n  topEdge: number;\n  bottomEdge: number;\n  exceedsLeft: boolean;\n  exceedsRight: boolean;\n  exceedsTop: boolean;\n  exceedsBottom: boolean;\n}\n\n/**\n * Get detailed information about why a part doesn't fit in the play area.\n *\n * @param localPosition - Part center position in local coordinates\n * @param width - Part collision box width in pixels\n * @param height - Part collision box height in pixels\n * @returns Object with edge positions and which bounds are exceeded\n *\n * @internal\n */\nexport function getPartBoundsInfo(\n  localPosition: Position,\n  width: number,\n  height: number\n): PartBoundsInfo {\n  const halfWidth = width / 2;\n  const halfHeight = height / 2;\n  const leftEdge = localPosition.x - halfWidth;\n  const rightEdge = localPosition.x + halfWidth;\n  const topEdge = localPosition.y - halfHeight;\n  const bottomEdge = localPosition.y + halfHeight;\n\n  return {\n    leftEdge,\n    rightEdge,\n    topEdge,\n    bottomEdge,\n    exceedsLeft: leftEdge < PLAY_AREA.bounds.minX,\n    exceedsRight: rightEdge > PLAY_AREA.bounds.maxX,\n    exceedsTop: topEdge < PLAY_AREA.bounds.minY,\n    exceedsBottom: bottomEdge > PLAY_AREA.bounds.maxY,\n  };\n}\n","/**\n * Level and region loading with validation.\n *\n * @module\n */\n\nimport type {\n  LevelDefinition,\n  RegionDefinition,\n  PartInstance,\n  ScrewPlacement,\n} from '@shared/types';\nimport { getPart, hasPart } from '@shared/parts';\nimport {\n  isScrewInBounds,\n  SCREW_RADIUS,\n  isPartInPlayArea,\n  getPartBoundsInfo,\n  PLAY_AREA,\n} from '@shared/utils';\n\n/**\n * Validation error with context.\n */\nexport interface ValidationError {\n  /** Error message */\n  message: string;\n  /** Path to the error location (e.g., \"parts[0].screws[1]\") */\n  path: string;\n}\n\n/**\n * Validation result.\n */\nexport interface ValidationResult {\n  /** Whether the validation passed */\n  valid: boolean;\n  /** List of errors (empty if valid) */\n  errors: ValidationError[];\n  /** List of warnings (non-fatal issues) */\n  warnings: ValidationError[];\n}\n\n/**\n * Validate a screw placement against its part definition.\n *\n * Checks that the screw position is within the part's collision bounds,\n * accounting for the screw radius.\n *\n * @param screw - The screw placement to validate\n * @param partInstance - The part instance containing this screw\n * @param screwIndex - Index of the screw in the part's screws array\n * @param partIndex - Index of the part in the level's parts array\n * @returns Validation error if invalid, null if valid\n *\n * @example\n * ```typescript\n * const error = validateScrewPlacement(screw, part, 0, 1);\n * if (error) console.error(error.message);\n * ```\n */\nfunction validateScrewPlacement(\n  screw: ScrewPlacement,\n  partInstance: PartInstance,\n  screwIndex: number,\n  partIndex: number\n): ValidationError | null {\n  const partDef = getPart(partInstance.partId);\n\n  if (!isScrewInBounds(screw.position, partDef.collision)) {\n    const boundsDesc =\n      partDef.collision.type === 'box'\n        ? `${String(partDef.collision.width)}x${String(partDef.collision.height)}`\n        : `${String(partDef.collision.points.length)}-point polygon`;\n\n    return {\n      message: `Screw at (${String(screw.position.x)}, ${String(screw.position.y)}) extends beyond part bounds (${boundsDesc}). Screw radius is ${String(SCREW_RADIUS)}px.`,\n      path: `parts[${String(partIndex)}].screws[${String(screwIndex)}].position`,\n    };\n  }\n\n  return null;\n}\n\n/**\n * Get collision box dimensions from a part definition.\n * @param partId - The part ID to look up\n * @returns Width and height of the part's collision box\n * @example\n */\nfunction getPartDimensions(partId: string): { width: number; height: number } {\n  const partDef = getPart(partId);\n  if (partDef.collision.type === 'box') {\n    return { width: partDef.collision.width, height: partDef.collision.height };\n  }\n  // For polygon collisions, calculate bounding box\n  const points = partDef.collision.points;\n  const xs = points.map((p) => p.x);\n  const ys = points.map((p) => p.y);\n  return {\n    width: Math.max(...xs) - Math.min(...xs),\n    height: Math.max(...ys) - Math.min(...ys),\n  };\n}\n\n/**\n * Format exceeded bounds into human-readable strings.\n * @param info - Bounds info from getPartBoundsInfo\n * @returns Array of exceeded boundary descriptions\n * @example\n */\nfunction formatExceededBounds(\n  info: ReturnType<typeof getPartBoundsInfo>\n): string[] {\n  const result: string[] = [];\n  if (info.exceedsLeft)\n    result.push(\n      `left (${String(info.leftEdge)} < ${String(PLAY_AREA.bounds.minX)})`\n    );\n  if (info.exceedsRight)\n    result.push(\n      `right (${String(info.rightEdge)} > ${String(PLAY_AREA.bounds.maxX)})`\n    );\n  if (info.exceedsTop)\n    result.push(\n      `top (${String(info.topEdge)} < ${String(PLAY_AREA.bounds.minY)})`\n    );\n  if (info.exceedsBottom)\n    result.push(\n      `bottom (${String(info.bottomEdge)} > ${String(PLAY_AREA.bounds.maxY)})`\n    );\n  return result;\n}\n\n/**\n * Validate that a part instance fits within the play area boundaries.\n * @param part - The part instance to validate\n * @param partIndex - Index of the part in the level's parts array\n * @returns Validation error if part exceeds boundaries, null if valid\n * @example\n */\nfunction validatePartPlayAreaBounds(\n  part: PartInstance,\n  partIndex: number\n): ValidationError | null {\n  const { width, height } = getPartDimensions(part.partId);\n  if (isPartInPlayArea(part.position, width, height)) return null;\n\n  const boundsInfo = getPartBoundsInfo(part.position, width, height);\n  const exceeded = formatExceededBounds(boundsInfo);\n  const pos = `(${String(part.position.x)}, ${String(part.position.y)})`;\n  const size = `${String(width)}x${String(height)}`;\n\n  return {\n    message: `Part \"${part.partId}\" at ${pos} with size ${size} exceeds play area bounds. Exceeded: ${exceeded.join(', ')}`,\n    path: `parts[${String(partIndex)}].position`,\n  };\n}\n\n/** Result type for part instance validation. */\ninterface PartValidationResult {\n  errors: ValidationError[];\n  warnings: ValidationError[];\n}\n\n/**\n * Validate a part instance for unknown parts, play area bounds, and screw positions.\n * @param part - The part instance to validate\n * @param partIndex - Index of the part in the level's parts array\n * @returns Object containing errors and warnings arrays\n * @example\n */\nfunction validatePartInstance(\n  part: PartInstance,\n  partIndex: number\n): PartValidationResult {\n  const errors: ValidationError[] = [];\n  const warnings: ValidationError[] = [];\n\n  if (!hasPart(part.partId)) {\n    const path = `parts[${String(partIndex)}].partId`;\n    errors.push({ message: `Unknown part \"${part.partId}\"`, path });\n    return { errors, warnings };\n  }\n\n  const boundsError = validatePartPlayAreaBounds(part, partIndex);\n  if (boundsError) errors.push(boundsError);\n\n  const usedPositions = new Set<string>();\n  part.screws.forEach((screw, i) => {\n    const screwError = validateScrewPlacement(screw, part, i, partIndex);\n    if (screwError) errors.push(screwError);\n\n    const posKey = `${String(screw.position.x)},${String(screw.position.y)}`;\n    if (usedPositions.has(posKey)) {\n      const path = `parts[${String(partIndex)}].screws[${String(i)}].position`;\n      const msg = `Multiple screws at position (${String(screw.position.x)}, ${String(screw.position.y)})`;\n      warnings.push({ message: msg, path });\n    }\n    usedPositions.add(posKey);\n  });\n\n  return { errors, warnings };\n}\n\n/**\n * Validate tray capacities in a level.\n *\n * @param level - The level to validate\n * @returns Array of validation errors for invalid tray capacities\n *\n * @example\n * ```typescript\n * const errors = validateTrayCapacities(level);\n * ```\n */\nfunction validateTrayCapacities(level: LevelDefinition): ValidationError[] {\n  const errors: ValidationError[] = [];\n  level.trays.forEach((tray, i) => {\n    if (tray.capacity < 1 || tray.capacity > 4) {\n      errors.push({\n        message: `Tray capacity must be 1-4, got ${String(tray.capacity)}`,\n        path: `trays[${String(i)}].capacity`,\n      });\n    }\n  });\n  return errors;\n}\n\n/**\n * Validate parts in a level and detect layer conflicts.\n *\n * @param level - The level to validate\n * @returns Object with errors and warnings arrays\n *\n * @example\n * ```typescript\n * const result = validateLevelParts(level);\n * ```\n */\nfunction validateLevelParts(level: LevelDefinition): {\n  errors: ValidationError[];\n  warnings: ValidationError[];\n} {\n  const errors: ValidationError[] = [];\n  const warnings: ValidationError[] = [];\n  const layerCounts = new Map<number, number>();\n\n  level.parts.forEach((part, i) => {\n    const partResult = validatePartInstance(part, i);\n    errors.push(...partResult.errors);\n    warnings.push(...partResult.warnings);\n    const count = layerCounts.get(part.layer) ?? 0;\n    layerCounts.set(part.layer, count + 1);\n  });\n\n  for (const [layer, count] of layerCounts) {\n    if (count > 1) {\n      warnings.push({\n        message: `${String(count)} parts share layer ${String(layer)} - occlusion order may be ambiguous`,\n        path: 'parts',\n      });\n    }\n  }\n\n  return { errors, warnings };\n}\n\n/**\n * Validate win condition references in a level.\n *\n * @param level - The level to validate\n * @returns Array of validation errors for invalid win conditions\n *\n * @example\n * ```typescript\n * const errors = validateWinCondition(level);\n * ```\n */\nfunction validateWinCondition(level: LevelDefinition): ValidationError[] {\n  const errors: ValidationError[] = [];\n\n  if (level.win.type === 'partsRemoved') {\n    for (const partIndex of level.win.partIndices) {\n      if (partIndex < 0 || partIndex >= level.parts.length) {\n        errors.push({\n          message: `Invalid part index ${String(partIndex)} in win condition (valid: 0-${String(level.parts.length - 1)})`,\n          path: 'win.partIndices',\n        });\n      }\n    }\n  } else if (level.win.type === 'targetFreed') {\n    const { targetPartIndex } = level.win;\n    if (targetPartIndex < 0 || targetPartIndex >= level.parts.length) {\n      errors.push({\n        message: `Invalid target part index ${String(targetPartIndex)} in win condition`,\n        path: 'win.targetPartIndex',\n      });\n    }\n  }\n\n  return errors;\n}\n\n/**\n * Validate a level definition.\n *\n * @param level - The level to validate\n * @returns Validation result with errors and warnings\n *\n * @example\n * ```typescript\n * const result = validateLevel(level);\n * if (!result.valid) {\n *   console.error('Level validation failed:', result.errors);\n * }\n * ```\n */\nexport function validateLevel(level: LevelDefinition): ValidationResult {\n  const errors: ValidationError[] = [];\n  const warnings: ValidationError[] = [];\n\n  errors.push(...validateTrayCapacities(level));\n\n  if (level.bufferCapacity !== undefined && level.bufferCapacity < 1) {\n    errors.push({\n      message: `Buffer capacity must be at least 1, got ${String(level.bufferCapacity)}`,\n      path: 'bufferCapacity',\n    });\n  }\n\n  const partsResult = validateLevelParts(level);\n  errors.push(...partsResult.errors);\n  warnings.push(...partsResult.warnings);\n\n  errors.push(...validateWinCondition(level));\n\n  return { valid: errors.length === 0, errors, warnings };\n}\n\n/**\n * Append level validation results with path prefix.\n *\n * @param levelResult - Result from validateLevel\n * @param index - Level index for path prefixing\n * @param errors - Errors array to append to\n * @param warnings - Warnings array to append to\n *\n * @example\n * ```typescript\n * appendLevelResults(validateLevel(level), 0, errors, warnings);\n * ```\n */\nfunction appendLevelResults(\n  levelResult: ValidationResult,\n  index: number,\n  errors: ValidationError[],\n  warnings: ValidationError[]\n): void {\n  for (const error of levelResult.errors) {\n    errors.push({\n      message: error.message,\n      path: `levels[${String(index)}].${error.path}`,\n    });\n  }\n  for (const warning of levelResult.warnings) {\n    warnings.push({\n      message: warning.message,\n      path: `levels[${String(index)}].${warning.path}`,\n    });\n  }\n}\n\n/**\n * Validate individual levels within a region.\n *\n * @param region - The region to validate\n * @returns Object with errors and warnings arrays\n *\n * @example\n * ```typescript\n * const result = validateRegionLevelContents(region);\n * ```\n */\nfunction validateRegionLevelContents(region: RegionDefinition): {\n  errors: ValidationError[];\n  warnings: ValidationError[];\n} {\n  const errors: ValidationError[] = [];\n  const warnings: ValidationError[] = [];\n  const levelIds = new Set<string>();\n\n  region.levels.forEach((level, i) => {\n    if (levelIds.has(level.id)) {\n      errors.push({\n        message: `Duplicate level ID \"${level.id}\"`,\n        path: `levels[${String(i)}].id`,\n      });\n    }\n    levelIds.add(level.id);\n    appendLevelResults(validateLevel(level), i, errors, warnings);\n  });\n\n  return { errors, warnings };\n}\n\n/**\n * Validate a region definition.\n *\n * @param region - The region to validate\n * @returns Validation result with errors and warnings\n *\n * @example\n * ```typescript\n * const result = validateRegion(region);\n * if (!result.valid) {\n *   console.error('Region validation failed:', result.errors);\n * }\n * ```\n */\nexport function validateRegion(region: RegionDefinition): ValidationResult {\n  const warnings: ValidationError[] = [];\n\n  if (region.levels.length !== 10) {\n    warnings.push({\n      message: `Expected 10 levels, got ${String(region.levels.length)}`,\n      path: 'levels',\n    });\n  }\n\n  const levelContents = validateRegionLevelContents(region);\n\n  return {\n    valid: levelContents.errors.length === 0,\n    errors: levelContents.errors,\n    warnings: [...warnings, ...levelContents.warnings],\n  };\n}\n\n/**\n * Load and validate a region from a JSON file.\n *\n * @param path - Path to the region JSON file\n * @returns The validated region definition\n * @throws Error if loading or validation fails\n *\n * @example\n * ```typescript\n * const region = await loadRegion('regions/region-1.json');\n * console.log(`Loaded region \"${region.name}\"`);\n * ```\n */\nexport async function loadRegion(path: string): Promise<RegionDefinition> {\n  const response = await fetch(path);\n  if (!response.ok) {\n    throw new Error(\n      `Failed to load region from ${path}: ${String(response.status)}`\n    );\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  const region: RegionDefinition = await response.json();\n  const result = validateRegion(region);\n\n  if (!result.valid) {\n    const errorMessages = result.errors\n      .map((e) => `  ${e.path}: ${e.message}`)\n      .join('\\n');\n    throw new Error(\n      `Region \"${region.id}\" validation failed:\\n${errorMessages}`\n    );\n  }\n\n  return region;\n}\n\n/**\n * Get a specific level from a region by ID.\n *\n * @param region - The region to search\n * @param levelId - The level ID to find\n * @returns The level definition\n * @throws Error if level is not found\n *\n * @example\n * ```typescript\n * const level = getLevelById(region, 'workshop-01');\n * console.log(level.name);\n * ```\n */\nexport function getLevelById(\n  region: RegionDefinition,\n  levelId: string\n): LevelDefinition {\n  const level = region.levels.find((l) => l.id === levelId);\n  if (!level) {\n    throw new Error(`Level \"${levelId}\" not found in region \"${region.id}\"`);\n  }\n  return level;\n}\n\n/**\n * Get a specific level from a region by index.\n *\n * @param region - The region to search\n * @param index - The level index (0-based)\n * @returns The level definition\n * @throws Error if index is out of bounds\n *\n * @example\n * ```typescript\n * const level = getLevelByIndex(region, 0);\n * console.log(level.name);\n * ```\n */\nexport function getLevelByIndex(\n  region: RegionDefinition,\n  index: number\n): LevelDefinition {\n  const level = region.levels[index];\n  if (level === undefined) {\n    throw new Error(\n      `Level index ${String(index)} out of bounds (0-${String(region.levels.length - 1)})`\n    );\n  }\n  return level;\n}\n","/**\n * Type definitions for puzzle parts.\n *\n * Parts are defined in TypeScript code (not JSON) because they contain\n * constant properties like shapes, physics constraints, and materials.\n *\n * @module\n */\n\nimport type { Position } from './game.types';\n\n/**\n * Available screw colors.\n *\n * String enum for JSON readability and debuggability.\n */\nexport enum ScrewColor {\n  Red = 'red',\n  Blue = 'blue',\n  Green = 'green',\n  Yellow = 'yellow',\n}\n\n/**\n * Static constraint - part cannot move.\n */\nexport interface StaticConstraintDef {\n  type: 'static';\n}\n\n/**\n * Slider constraint - linear motion along an axis.\n */\nexport interface SliderConstraintDef {\n  type: 'slider';\n  /** Movement axis relative to part */\n  axis: 'x' | 'y';\n  /** Minimum travel distance in pixels */\n  min: number;\n  /** Maximum travel distance in pixels */\n  max: number;\n}\n\n/**\n * Hinge constraint - rotation around a pivot point.\n */\nexport interface HingeConstraintDef {\n  type: 'hinge';\n  /** Pivot point relative to part origin */\n  pivot: Position;\n  /** Minimum angle in degrees */\n  minAngle: number;\n  /** Maximum angle in degrees */\n  maxAngle: number;\n}\n\n/**\n * Spring constraint - tension release behavior.\n */\nexport interface SpringConstraintDef {\n  type: 'spring';\n  /** Direction spring pulls toward when released */\n  direction: 'open' | 'closed';\n  /** Animation duration in milliseconds */\n  duration: number;\n}\n\n/**\n * Friction constraint - resistance until screw threshold is met.\n */\nexport interface FrictionConstraintDef {\n  type: 'friction';\n  /** Number of screws that must be removed before part can move */\n  screwThreshold: number;\n}\n\n/**\n * Union of all constraint types.\n */\nexport type ConstraintDef =\n  | StaticConstraintDef\n  | SliderConstraintDef\n  | HingeConstraintDef\n  | SpringConstraintDef\n  | FrictionConstraintDef;\n\n/**\n * Box collision shape.\n */\nexport interface BoxCollisionShape {\n  type: 'box';\n  /** Width in pixels */\n  width: number;\n  /** Height in pixels */\n  height: number;\n}\n\n/**\n * Polygon collision shape.\n */\nexport interface PolygonCollisionShape {\n  type: 'polygon';\n  /** Vertices relative to part origin */\n  points: Position[];\n}\n\n/**\n * Union of all collision shapes.\n */\nexport type CollisionShape = BoxCollisionShape | PolygonCollisionShape;\n\n/**\n * Visual material types.\n */\nexport type MaterialType = 'metal' | 'wood' | 'plastic' | 'rubber' | 'glass';\n\n/**\n * Screw mount point on a part.\n *\n * Defines where a screw CAN be attached. The level JSON specifies\n * which mounts are actually used and what color each screw is.\n */\nexport interface ScrewMountDef {\n  /** Unique identifier within the part (e.g., 'top-left', 'center') */\n  id: string;\n  /** Position relative to part origin */\n  localPosition: Position;\n}\n\n/**\n * Part definition - the \"blueprint\" for a puzzle part.\n *\n * Defined in TypeScript code, not JSON. Contains all properties\n * that are constant for every instance of this part type.\n */\nexport interface PartDefinition {\n  /** Unique identifier (e.g., 'simple-plate', 'sliding-cover') */\n  id: string;\n  /** Display name for debugging/tools */\n  name: string;\n  /** Asset path for sprite, or null for procedural geometry */\n  asset: string | null;\n  /** Collision shape for physics */\n  collision: CollisionShape;\n  /** Visual material type */\n  material: MaterialType;\n  /** Physics constraint behavior */\n  constraint: ConstraintDef;\n  /** Available screw mount points */\n  screwMounts: ScrewMountDef[];\n  /** Custom pivot point (defaults to center of collision bounds) */\n  pivot?: Position;\n}\n","import type { Component, ComponentClass } from '@play-co/odie';\n\n/**\n * Creates a component class with reduced boilerplate.\n *\n * This helper function generates a fully-typed ODIE component class from\n * a name and default values, eliminating the need to manually write\n * interfaces, classes, static NAME properties, and init methods.\n *\n * @template T - The shape of the component data (inferred from defaults)\n * @param name - Component identifier (must be unique, used as key in entity data)\n * @param defaults - Default values for component properties\n * @returns A ComponentClass ready for use with DefineEntity and createEntity\n *\n * @example\n * // Define a simple health component (4 lines instead of ~18)\n * export const HealthComponent = defineComponent('health', {\n *   current: 100,\n *   max: 100,\n * });\n *\n * // Use with entity definition\n * import { DefineEntity, Entity2D } from '@play-co/odie';\n * const PlayerEntity = DefineEntity(Entity2D, HealthComponent);\n *\n * // Create entity with component data\n * import { createEntity } from '@play-co/odie';\n * const player = createEntity(PlayerEntity, {\n *   health: { current: 50, max: 100 }\n * });\n *\n * @example\n * // Define a velocity component for movement\n * export const VelocityComponent = defineComponent('velocity', {\n *   x: 0,\n *   y: 0,\n *   speed: 5,\n * });\n *\n * @example\n * // Access component data from an entity\n * const health = player.c.health as ReturnType<typeof HealthComponent.prototype.init>;\n * console.log(health.current); // 50\n * health.current -= 10; // Take damage\n *\n * @example\n * // Define a tag component (empty data)\n * export const PlayerTagComponent = defineComponent('playerTag', {});\n */\nexport function defineComponent<T extends Record<string, unknown>>(\n  name: string,\n  defaults: T\n): ComponentClass<T, Component<T> & T> {\n  // Create a class that implements Component<T>\n  const ComponentImpl = class implements Component<T> {\n    static readonly NAME = name;\n\n    constructor() {\n      // Initialize with default values\n      Object.assign(this, structuredClone(defaults));\n    }\n\n    init(data: T): void {\n      // Merge provided data with defaults\n      Object.assign(this, data);\n    }\n\n    reset(): void {\n      // Reset to default values\n      Object.assign(this, structuredClone(defaults));\n    }\n  };\n\n  // Copy default properties to prototype for type inference\n  Object.keys(defaults).forEach((key) => {\n    Object.defineProperty(ComponentImpl.prototype, key, {\n      value: defaults[key],\n      writable: true,\n      enumerable: true,\n      configurable: true,\n    });\n  });\n\n  return ComponentImpl as unknown as ComponentClass<T, Component<T> & T>;\n}\n\n/**\n * Type helper to extract the data type from a component created with defineComponent.\n *\n * @example\n * const HealthComponent = defineComponent('health', { current: 100, max: 100 });\n * type HealthData = ComponentData<typeof HealthComponent>;\n * // HealthData = { current: number; max: number }\n */\nexport type ComponentData<C extends ComponentClass<unknown>> =\n  C extends ComponentClass<infer D> ? D : never;\n","import { defineComponent } from '@shared/ecs';\nimport { ScrewColor } from '@shared/types';\n\n/**\n * Screw state types.\n */\nexport type ScrewState = 'inBoard' | 'inTray' | 'inBuffer' | 'dragging';\n\n/**\n * Component for screw entities.\n *\n * Stores the screw's color, state, and relationship to its parent part.\n *\n * @example\n * const entity = createEntity(ScrewEntity, {\n *   screw: { color: ScrewColor.Red, partEntityId: '123' }\n * });\n */\nexport const ScrewComponent = defineComponent('screw', {\n  /** Screw color - determines which tray it goes to */\n  color: ScrewColor.Red as ScrewColor,\n  /** ID of the parent part entity (empty string if removed) */\n  partEntityId: '',\n  /** Current state of the screw */\n  state: 'inBoard' as ScrewState,\n  /** ID of the tray entity this screw is in (empty if in board) */\n  trayEntityId: '',\n  /** Slot index in the tray (0-based, -1 if not in tray) */\n  slotIndex: -1,\n  /** Whether the screw is currently animating (locked for interaction) */\n  isAnimating: false,\n});\n\n/** Data interface for ScrewComponent */\nexport interface ScrewComponentData {\n  color: ScrewColor;\n  partEntityId: string;\n  state: ScrewState;\n  trayEntityId: string;\n  slotIndex: number;\n  isAnimating: boolean;\n}\n","import { defineComponent } from '@shared/ecs';\n\n/**\n * Part state types.\n */\nexport type PartState = 'static' | 'constrained' | 'free';\n\n/**\n * Component for part/board entities.\n *\n * Stores the part's definition reference, layer order, and state.\n *\n * @example\n * const entity = createEntity(PartEntity, {\n *   part: { partDefinitionId: 'board-walnut-square', layer: 1 }\n * });\n */\nexport const PartComponent = defineComponent('part', {\n  /** ID referencing the PartDefinition in the registry */\n  partDefinitionId: '',\n  /** Z-order layer for occlusion (higher = on top) */\n  layer: 0,\n  /** Number of screws currently attached */\n  screwCount: 0,\n  /** Current movement state */\n  state: 'static' as PartState,\n});\n\n/** Data interface for PartComponent */\nexport interface PartComponentData {\n  partDefinitionId: string;\n  layer: number;\n  screwCount: number;\n  state: PartState;\n}\n","import { defineComponent } from '@shared/ecs';\n\nimport type { BodyType } from '@physics';\n\n/**\n * Component for physics body association.\n *\n * Links an entity to a Planck.js physics body managed by PhysicsWorldManager.\n *\n * @example\n * const entity = createEntity(PartEntity, {\n *   physicsBody: { bodyId: 0, bodyType: 'static' }\n * });\n */\nexport const PhysicsBodyComponent = defineComponent('physicsBody', {\n  /** Reference ID to the Planck.js body in PhysicsWorldManager */\n  bodyId: -1,\n  /** Current body type (static or dynamic) */\n  bodyType: 'static' as BodyType,\n  /** Whether the physics body is sleeping (at rest) */\n  isSleeping: true,\n  /** Whether physics is enabled for this body */\n  enabled: true,\n});\n\n/** Data interface for PhysicsBodyComponent */\nexport interface PhysicsBodyComponentData {\n  bodyId: number;\n  bodyType: BodyType;\n  isSleeping: boolean;\n  enabled: boolean;\n}\n","import { defineComponent } from '@shared/ecs';\nimport { ScrewColor } from '@shared/types';\n\n/**\n * Component for colored tray entities.\n *\n * Stores the tray's color, capacity, and current screw count.\n * Screws of matching color are placed here when removed from parts.\n *\n * The displayOrder property (0-4) determines visibility:\n * - 0-1: Visible trays in left-to-right order\n * - 2-4: Hidden trays (below the visible area, covered)\n *\n * @example\n * const entity = createEntity(TrayEntity, {\n *   tray: { color: ScrewColor.Blue, capacity: 3, displayOrder: 0 }\n * });\n */\nexport const TrayComponent = defineComponent('tray', {\n  /** Tray color - only matching screws can be placed here */\n  color: ScrewColor.Red as ScrewColor,\n  /** Maximum number of screws this tray can hold */\n  capacity: 3,\n  /** Current number of screws in the tray */\n  screwCount: 0,\n  /** Display order (0-4): 0-1 are visible, 2-4 are hidden */\n  displayOrder: 0,\n  /** Whether the tray is currently animating (block interactions) */\n  isAnimating: false,\n});\n\n/** Data interface for TrayComponent */\nexport interface TrayComponentData {\n  color: ScrewColor;\n  capacity: number;\n  screwCount: number;\n  displayOrder: number;\n  isAnimating: boolean;\n}\n","import { defineComponent } from '@shared/ecs';\n\n/**\n * Component for the buffer tray entity.\n *\n * The buffer tray holds screws temporarily when the matching colored tray\n * is full. Screws are auto-transferred when space becomes available.\n *\n * @example\n * const entity = createEntity(BufferTrayEntity, {\n *   bufferTray: { capacity: 5 }\n * });\n */\nexport const BufferTrayComponent = defineComponent('bufferTray', {\n  /** Maximum number of screws the buffer can hold */\n  capacity: 5,\n  /** IDs of screws in FIFO order for auto-transfer */\n  screwIds: [] as string[],\n});\n\n/** Data interface for BufferTrayComponent */\nexport interface BufferTrayComponentData {\n  capacity: number;\n  screwIds: string[];\n}\n","import { defineComponent } from '@shared/ecs';\n\n/**\n * Game phase types.\n */\nexport type GamePhase = 'playing' | 'won' | 'stuck';\n\n/**\n * Component for tracking overall game state.\n *\n * This is a singleton component attached to a single entity that\n * tracks the game's progress through the current level.\n *\n * @example\n * const entity = createEntity(GameStateEntity, {\n *   gameState: { totalScrews: 6, winConditionType: 'allScrewsRemoved' }\n * });\n */\nexport const GameStateComponent = defineComponent('gameState', {\n  /** Current game phase */\n  phase: 'playing' as GamePhase,\n  /** Total screws in the level (set at load) */\n  totalScrews: 0,\n  /** Number of screws removed from puzzle */\n  removedScrews: 0,\n  /** Type of win condition for this level */\n  winConditionType: 'allScrewsRemoved' as string,\n});\n\n/** Data interface for GameStateComponent */\nexport interface GameStateComponentData {\n  phase: GamePhase;\n  totalScrews: number;\n  removedScrews: number;\n  winConditionType: string;\n}\n","import { DefineEntity, Entity2D } from '@play-co/odie';\nimport { ScrewComponent } from '../components';\n\n/**\n * Entity type definition for a screw.\n *\n * This entity combines Entity2D (providing position, scale, rotation, and view)\n * with ScrewComponent (providing color, state, and part relationship data).\n *\n * @example\n * // Create using the factory function (recommended)\n * import { createScrewEntity } from '@scenes/game/factories';\n *\n * const screw = await createScrewEntity({\n *   color: ScrewColor.Blue,\n *   position: { x: 100, y: 100 }\n * });\n * scene.addChild(screw);\n */\nexport const ScrewEntity = DefineEntity(Entity2D, ScrewComponent);\n","import { DefineEntity, Entity2D } from '@play-co/odie';\nimport { PartComponent, PhysicsBodyComponent } from '../components';\n\n/**\n * Entity type definition for a puzzle part (board).\n *\n * This entity combines Entity2D (providing position, scale, rotation, and view)\n * with PartComponent (providing part definition reference, layer, and state)\n * and PhysicsBodyComponent (providing physics body association).\n *\n * @example\n * // Create using the factory function (recommended)\n * import { createPartEntity } from '@scenes/game/factories';\n *\n * const board = await createPartEntity({\n *   partDefinitionId: 'board-walnut-square',\n *   position: { x: 200, y: 300 },\n *   layer: 1\n * });\n * scene.addChild(board);\n */\nexport const PartEntity = DefineEntity(\n  Entity2D,\n  PartComponent,\n  PhysicsBodyComponent\n);\n","import { DefineEntity, Entity2D } from '@play-co/odie';\nimport { TrayComponent } from '../components';\n\n/**\n * Entity type definition for a colored tray.\n *\n * This entity combines Entity2D (providing position, scale, rotation, and view)\n * with TrayComponent (providing color, capacity, and screw count).\n *\n * @example\n * // Create using the factory function (recommended)\n * import { createTrayEntity } from '@scenes/game/factories';\n *\n * const tray = await createTrayEntity({\n *   color: ScrewColor.Red,\n *   position: { x: 48, y: 175 },\n *   capacity: 3\n * });\n * scene.addChild(tray);\n */\nexport const TrayEntity = DefineEntity(Entity2D, TrayComponent);\n","import { DefineEntity, Entity2D } from '@play-co/odie';\nimport { BufferTrayComponent } from '../components';\n\n/**\n * Entity type definition for the buffer tray.\n *\n * This entity combines Entity2D (providing position, scale, rotation, and view)\n * with BufferTrayComponent (providing capacity and screw IDs).\n *\n * @example\n * // Create using the factory function (recommended)\n * import { createBufferTrayEntity } from '@scenes/game/factories';\n *\n * const buffer = await createBufferTrayEntity({\n *   position: { x: 136, y: 405 },\n *   capacity: 5\n * });\n * scene.addChild(buffer);\n */\nexport const BufferTrayEntity = DefineEntity(Entity2D, BufferTrayComponent);\n","/**\n * Factory functions for creating game entities (screws, parts, trays).\n *\n * These factories encapsulate the entity creation, visual setup, and positioning\n * in a single call, reducing boilerplate and centralizing entity creation logic.\n *\n * @module\n */\n\nimport { createEntity, type Entity2D } from '@play-co/odie';\nimport { Assets, type Container, Sprite, type Texture } from 'pixi.js';\n\nimport type { Position } from '@shared/types';\nimport { ScrewColor } from '@shared/types';\nimport { PhysicsWorldManager } from '@physics';\nimport { ScrewEntity } from '../entities/ScrewEntity';\nimport { PartEntity } from '../entities/PartEntity';\nimport { TrayEntity } from '../entities/TrayEntity';\nimport { BufferTrayEntity } from '../entities/BufferTrayEntity';\nimport type { ScrewState } from '../components';\n\n/**\n * WeakMap registry for storing visual references.\n */\nconst gameVisualRegistry = new WeakMap<Entity2D, Container>();\n\n/**\n * Gets the visual display object from a game entity.\n *\n * @param entity - The entity to get the visual from\n * @returns The visual container or undefined if not found\n *\n * @example\n * const screw = await createScrewEntity({ color: ScrewColor.Blue, position: { x: 0, y: 0 } });\n * const sprite = getGameVisual(screw) as Sprite;\n */\nexport function getGameVisual(entity: Entity2D): Container | undefined {\n  return gameVisualRegistry.get(entity);\n}\n\n/**\n * Maps screw color to short screw asset alias (used when screw is in board).\n */\nconst SHORT_SCREW_ASSET_MAP: Record<ScrewColor, string> = {\n  [ScrewColor.Red]: 'short-screw-red',\n  [ScrewColor.Yellow]: 'short-screw-yellow',\n  [ScrewColor.Green]: 'short-screw-green',\n  [ScrewColor.Blue]: 'short-screw-blue',\n};\n\n/**\n * Maps screw color to long screw asset alias (used when screw is removed).\n */\nconst LONG_SCREW_ASSET_MAP: Record<ScrewColor, string> = {\n  [ScrewColor.Red]: 'screw-red',\n  [ScrewColor.Yellow]: 'screw-yellow',\n  [ScrewColor.Green]: 'screw-green',\n  [ScrewColor.Blue]: 'screw-blue',\n};\n\n/**\n * Maps screw color to tray asset alias.\n */\nconst TRAY_ASSET_MAP: Record<ScrewColor, string> = {\n  [ScrewColor.Red]: 'tray-red',\n  [ScrewColor.Yellow]: 'tray-yellow',\n  [ScrewColor.Green]: 'tray-green',\n  [ScrewColor.Blue]: 'tray-blue',\n};\n\n/**\n * Maps screw color to placeholder asset alias.\n */\nconst PLACEHOLDER_ASSET_MAP: Record<ScrewColor, string> = {\n  [ScrewColor.Red]: 'placeholder-red',\n  [ScrewColor.Yellow]: 'placeholder-yellow',\n  [ScrewColor.Green]: 'placeholder-green',\n  [ScrewColor.Blue]: 'placeholder-blue',\n};\n\n/**\n * Tray sprite width for centering calculations.\n * Updated for new Figma design (was 200, now 185).\n */\nconst TRAY_WIDTH = 185;\n\n/**\n * Placeholder display width (new assets are 40x50, no scaling needed).\n */\nconst PLACEHOLDER_DISPLAY_WIDTH = 40;\n\n/**\n * Spacing between placeholder sprite centers.\n * Adjusted for smaller tray width.\n */\nconst PLACEHOLDER_SPACING = 40;\n\n/**\n * Y position for placeholders within tray.\n * Centered vertically in 150px tray height.\n */\nconst PLACEHOLDER_Y = 75;\n\n/**\n * WeakMap registry for storing placeholder sprite references.\n */\nconst placeholderRegistry = new WeakMap<Entity2D, Sprite[]>();\n\n/**\n * Gets the placeholder sprites from a tray entity.\n *\n * @param entity - The tray entity to get placeholders from\n * @returns Array of placeholder sprites or undefined if not found\n *\n * @example\n * const placeholders = getTrayPlaceholders(trayEntity);\n * if (placeholders) placeholders[0].alpha = 0; // Hide first placeholder\n */\nexport function getTrayPlaceholders(entity: Entity2D): Sprite[] | undefined {\n  return placeholderRegistry.get(entity);\n}\n\n// ============================================================================\n// Screw Entity Factory\n// ============================================================================\n\n/**\n * Options for creating a screw entity.\n */\nexport interface ScrewEntityOptions {\n  /** Screw color */\n  color: ScrewColor;\n  /** Position to place the screw (world coordinates) */\n  position: Position;\n  /** Initial state (defaults to 'inBoard') */\n  state?: ScrewState;\n  /** ID of the parent part entity */\n  partEntityId?: string;\n}\n\n/**\n * Creates a screw entity with its sprite.\n *\n * @param options - Entity configuration\n * @returns Promise resolving to the created entity\n *\n * @example\n * const screw = await createScrewEntity({\n *   color: ScrewColor.Blue,\n *   position: { x: 100, y: 100 }\n * });\n * scene.addChild(screw);\n */\nexport async function createScrewEntity(\n  options: ScrewEntityOptions\n): Promise<Entity2D> {\n  const state = options.state ?? 'inBoard';\n\n  // Use short screw when in board, long screw when removed\n  const assetMap =\n    state === 'inBoard' ? SHORT_SCREW_ASSET_MAP : LONG_SCREW_ASSET_MAP;\n  const assetAlias = assetMap[options.color];\n  const texture = await Assets.load<Texture>(assetAlias);\n\n  const entity = createEntity(ScrewEntity, {\n    screw: {\n      color: options.color,\n      state,\n      partEntityId: options.partEntityId ?? '',\n    },\n  });\n\n  const sprite = new Sprite(texture);\n  sprite.anchor.set(0.5); // Center anchor for rotation\n\n  gameVisualRegistry.set(entity, sprite);\n  entity.view.addChild(sprite);\n  entity.position.set(options.position.x, options.position.y);\n\n  return entity;\n}\n\n// ============================================================================\n// Part Entity Factory\n// ============================================================================\n\n/**\n * Options for creating a part entity.\n */\nexport interface PartEntityOptions {\n  /** Asset alias for the part sprite */\n  assetAlias: string;\n  /** Part definition ID (for component data) */\n  partDefinitionId: string;\n  /** Position to place the part */\n  position: Position;\n  /** Z-order layer (defaults to 0) */\n  layer?: number;\n  /** Part dimensions for physics body (optional) */\n  dimensions?: { width: number; height: number };\n}\n\n/**\n * Creates a part (board) entity with its sprite.\n *\n * @param options - Entity configuration\n * @returns Promise resolving to the created entity\n *\n * @example\n * const board = await createPartEntity({\n *   assetAlias: 'board-walnut-square',\n *   partDefinitionId: 'board-walnut-square',\n *   position: { x: 200, y: 300 },\n *   layer: 1\n * });\n * scene.addChild(board);\n */\nexport async function createPartEntity(\n  options: PartEntityOptions\n): Promise<Entity2D> {\n  const texture = await Assets.load<Texture>(options.assetAlias);\n  const width = options.dimensions?.width ?? texture.width;\n  const height = options.dimensions?.height ?? texture.height;\n  const layer = options.layer ?? 0;\n\n  const entity = createPartEntityBase(options);\n  setupPartSprite(entity, texture);\n  entity.position.set(options.position.x, options.position.y);\n  attachPhysicsBody(entity, width, height, layer);\n\n  return entity;\n}\n\n/**\n * Create the base part entity with components.\n *\n * @param options - Entity options\n * @returns Created entity\n * @example\n * const entity = createPartEntityBase(options);\n */\nfunction createPartEntityBase(options: PartEntityOptions): Entity2D {\n  return createEntity(PartEntity, {\n    part: {\n      partDefinitionId: options.partDefinitionId,\n      layer: options.layer ?? 0,\n      screwCount: 0,\n      state: 'static',\n    },\n    physicsBody: {\n      bodyId: -1,\n      bodyType: 'static',\n      isSleeping: true,\n      enabled: true,\n    },\n  });\n}\n\n/**\n * Setup the sprite for a part entity.\n *\n * @param entity - The entity to setup\n * @param texture - The texture to use\n * @example\n * setupPartSprite(entity, texture);\n */\nfunction setupPartSprite(entity: Entity2D, texture: Texture): void {\n  const sprite = new Sprite(texture);\n  sprite.anchor.set(0.5);\n  sprite.eventMode = 'static';\n  gameVisualRegistry.set(entity, sprite);\n  entity.view.addChild(sprite);\n}\n\n/**\n * Attach a physics body to a part entity.\n *\n * @param entity - The entity to attach physics to\n * @param width - Width in pixels\n * @param height - Height in pixels\n * @param layer - Visual layer for collision filtering\n * @example\n * attachPhysicsBody(entity, 100, 50, 1);\n */\nfunction attachPhysicsBody(\n  entity: Entity2D,\n  width: number,\n  height: number,\n  layer: number\n): void {\n  const physicsManager = PhysicsWorldManager.getInstance();\n  const bodyId = physicsManager.createBodyForPart(\n    entity,\n    width,\n    height,\n    true,\n    layer\n  );\n  (entity.c.physicsBody as { bodyId: number }).bodyId = bodyId;\n}\n\n// ============================================================================\n// Tray Entity Factory\n// ============================================================================\n\n/**\n * Options for creating a tray entity.\n */\nexport interface TrayEntityOptions {\n  /** Tray color */\n  color: ScrewColor;\n  /** Position to place the tray */\n  position: Position;\n  /** Maximum screw capacity (defaults to 3) */\n  capacity?: number;\n  /** Display order (0-3): 0-1 are visible, 2-3 are hidden */\n  displayOrder?: number;\n}\n\n/**\n * Creates a colored tray entity with its sprite and placeholder sprites.\n *\n * Placeholders are semi-transparent screw outlines that show where screws\n * should be placed. They fade out when a screw is placed in their slot.\n *\n * @param options - Entity configuration\n * @returns Promise resolving to the created entity\n *\n * @example\n * const tray = await createTrayEntity({\n *   color: ScrewColor.Red,\n *   position: { x: 48, y: 175 },\n *   capacity: 3,\n *   displayOrder: 0\n * });\n * scene.addChild(tray);\n */\nexport async function createTrayEntity(\n  options: TrayEntityOptions\n): Promise<Entity2D> {\n  const capacity = options.capacity ?? 3;\n  const displayOrder = options.displayOrder ?? 0;\n\n  const [trayTexture, placeholderTexture] = await loadTrayTextures(\n    options.color\n  );\n  const entity = createTrayEntityWithComponent(\n    options.color,\n    capacity,\n    displayOrder\n  );\n  setupTraySprite(entity, trayTexture);\n  setupPlaceholders(entity, placeholderTexture, capacity);\n  entity.position.set(options.position.x, options.position.y);\n\n  return entity;\n}\n\nfunction loadTrayTextures(color: ScrewColor): Promise<[Texture, Texture]> {\n  return Promise.all([\n    Assets.load<Texture>(TRAY_ASSET_MAP[color]),\n    Assets.load<Texture>(PLACEHOLDER_ASSET_MAP[color]),\n  ]);\n}\n\nfunction createTrayEntityWithComponent(\n  color: ScrewColor,\n  capacity: number,\n  displayOrder: number\n): Entity2D {\n  return createEntity(TrayEntity, {\n    tray: { color, capacity, screwCount: 0, displayOrder, isAnimating: false },\n  });\n}\n\nfunction setupTraySprite(entity: Entity2D, texture: Texture): void {\n  const traySprite = new Sprite(texture);\n  gameVisualRegistry.set(entity, traySprite);\n  entity.view.addChild(traySprite);\n}\n\nfunction setupPlaceholders(\n  entity: Entity2D,\n  texture: Texture,\n  capacity: number\n): void {\n  const placeholders: Sprite[] = [];\n\n  // Calculate centered positions for placeholders within tray\n  const totalWidth =\n    (capacity - 1) * PLACEHOLDER_SPACING + PLACEHOLDER_DISPLAY_WIDTH;\n  const startX = (TRAY_WIDTH - totalWidth) / 2 + PLACEHOLDER_DISPLAY_WIDTH / 2;\n\n  for (let i = 0; i < capacity; i++) {\n    const placeholder = new Sprite(texture);\n    placeholder.anchor.set(0.5);\n    // No scaling needed - new assets are already 40x50\n    placeholder.position.set(startX + i * PLACEHOLDER_SPACING, PLACEHOLDER_Y);\n    placeholder.alpha = 0.7;\n    entity.view.addChild(placeholder);\n    placeholders.push(placeholder);\n  }\n  placeholderRegistry.set(entity, placeholders);\n}\n\n// ============================================================================\n// Buffer Tray Entity Factory\n// ============================================================================\n\n/**\n * Options for creating a buffer tray entity.\n */\nexport interface BufferTrayEntityOptions {\n  /** Position to place the buffer tray */\n  position: Position;\n  /** Maximum screw capacity (defaults to 5) */\n  capacity?: number;\n}\n\n/**\n * Creates a buffer tray entity with its sprite.\n *\n * @param options - Entity configuration\n * @returns Promise resolving to the created entity\n *\n * @example\n * const buffer = await createBufferTrayEntity({\n *   position: { x: 136, y: 405 },\n *   capacity: 5\n * });\n * scene.addChild(buffer);\n */\nexport async function createBufferTrayEntity(\n  options: BufferTrayEntityOptions\n): Promise<Entity2D> {\n  const texture = await Assets.load<Texture>('buffer-tray-frame');\n\n  const entity = createEntity(BufferTrayEntity, {\n    bufferTray: {\n      capacity: options.capacity ?? 5,\n      screwIds: [],\n    },\n  });\n\n  const sprite = new Sprite(texture);\n\n  gameVisualRegistry.set(entity, sprite);\n  entity.view.addChild(sprite);\n  entity.position.set(options.position.x, options.position.y);\n\n  return entity;\n}\n","import { DefineEntity, Entity2D } from '@play-co/odie';\nimport { GameStateComponent } from '../components/GameStateComponent';\n\n/**\n * Entity type definition for game state.\n *\n * This is a singleton entity that tracks the overall game progress.\n * It should be created once per level and holds the win condition state.\n *\n * @example\n * import { createEntity } from '@play-co/odie';\n *\n * const gameState = createEntity(GameStateEntity, {\n *   gameState: {\n *     phase: 'playing',\n *     totalScrews: 6,\n *     removedScrews: 0,\n *     winConditionType: 'allScrewsRemoved'\n *   }\n * });\n * scene.addChild(gameState);\n */\nexport const GameStateEntity = DefineEntity(Entity2D, GameStateComponent);\n","import type {\n  System,\n  Entity,\n  Scene2D,\n  Time,\n  QueryResults,\n} from '@play-co/odie';\n\n/**\n * Abstract base class for ODIE systems with convenience methods.\n *\n * This class provides a foundation for building game systems with:\n * - Typed access to scene and query results\n * - Helper method for iterating over entities in a query\n * - Proper TypeScript typing for Entity2D-based entities\n *\n * Systems are the \"S\" in ECS (Entity-Component-System). They contain the game\n * logic that operates on entities with specific components.\n *\n * @example\n * // Create a movement system\n * import { BaseSystem } from './BaseSystem';\n * import { VelocityComponent } from '../components';\n *\n * export class MovementSystem extends BaseSystem {\n *   static readonly NAME = 'movement';\n *   static Queries = {\n *     movable: { components: [VelocityComponent] }\n *   };\n *\n *   update(time: Time): void {\n *     this.forEachEntity('movable', (entity) => {\n *       const velocity = entity.c.velocity;\n *       entity.position.x += velocity.x * time.deltaTime;\n *       entity.position.y += velocity.y * time.deltaTime;\n *     });\n *   }\n * }\n *\n * @example\n * // Register the system with a scene\n * import { MovementSystem } from './systems/MovementSystem';\n *\n * // In your scene setup:\n * scene.addSystem(MovementSystem);\n *\n * @example\n * // Create a collision system with multiple queries\n * export class CollisionSystem extends BaseSystem {\n *   static readonly NAME = 'collision';\n *   static Queries = {\n *     players: { components: [PlayerComponent, ColliderComponent] },\n *     enemies: { components: [EnemyComponent, ColliderComponent] }\n *   };\n *\n *   update(_time: Time): void {\n *     this.forEachEntity('players', (player) => {\n *       this.forEachEntity('enemies', (enemy) => {\n *         if (this.checkCollision(player, enemy)) {\n *           // Handle collision\n *         }\n *       });\n *     });\n *   }\n *\n *   private checkCollision(a: Entity, b: Entity): boolean {\n *     // Collision detection logic\n *     return false;\n *   }\n * }\n */\nexport abstract class BaseSystem implements System<unknown, Scene2D> {\n  /**\n   * Reference to the scene this system is attached to.\n   * Automatically injected by ODIE when the system is added to a scene.\n   * @readonly\n   */\n  declare readonly scene: Scene2D;\n\n  /**\n   * Query results containing entities that match each defined query.\n   * Automatically populated by ODIE based on the static Queries definition.\n   * @readonly\n   */\n  declare readonly queries: QueryResults;\n\n  /**\n   * Iterates over all entities matching a named query.\n   *\n   * This is a convenience method that safely handles cases where the query\n   * might not exist or be empty.\n   *\n   * @param queryName - The name of the query (as defined in static Queries)\n   * @param callback - Function to call for each entity\n   *\n   * @example\n   * this.forEachEntity('movable', (entity) => {\n   *   entity.position.x += 1;\n   * });\n   */\n  protected forEachEntity(\n    queryName: string,\n    callback: (entity: Entity) => void\n  ): void {\n    const query = this.queries[queryName];\n    if (query) {\n      query.forEach(callback);\n    }\n  }\n\n  /**\n   * Gets all entities matching a named query.\n   *\n   * @param queryName - The name of the query (as defined in static Queries)\n   * @returns Array of entities, or empty array if query doesn't exist\n   *\n   * @example\n   * const enemies = this.getEntities('enemies');\n   * console.log(`${enemies.length} enemies in scene`);\n   */\n  protected getEntities(queryName: string): Entity[] {\n    const query = this.queries[queryName];\n    return query?.entities ?? [];\n  }\n\n  /**\n   * Gets the first entity matching a named query.\n   *\n   * Useful for singleton entities like player or camera.\n   *\n   * @param queryName - The name of the query (as defined in static Queries)\n   * @returns The first entity or undefined if query is empty\n   *\n   * @example\n   * const player = this.getFirstEntity('players');\n   * if (player) {\n   *   // Update player\n   * }\n   */\n  protected getFirstEntity(queryName: string): Entity | undefined {\n    const query = this.queries[queryName];\n    return query?.first;\n  }\n\n  /**\n   * Gets the count of entities matching a named query.\n   *\n   * @param queryName - The name of the query (as defined in static Queries)\n   * @returns Number of entities matching the query\n   *\n   * @example\n   * const enemyCount = this.getEntityCount('enemies');\n   * if (enemyCount === 0) {\n   *   this.spawnWave();\n   * }\n   */\n  protected getEntityCount(queryName: string): number {\n    const query = this.queries[queryName];\n    return query?.entities.length ?? 0;\n  }\n\n  /**\n   * Gets typed component access for an entity.\n   *\n   * ODIE's Entity.c is loosely typed (Map<string, unknown>). This helper\n   * provides a cleaner way to access components with proper typing,\n   * reducing the need for `as unknown as` casts throughout systems.\n   *\n   * @template T - The component access interface (e.g., ScrewComponentAccess)\n   * @param entity - The entity to get components from\n   * @param _typeHint - Optional type hint parameter (unused, for type inference)\n   * @returns The entity's component map cast to the specified type\n   *\n   * @example\n   * import type { ScrewComponentAccess } from '../types/component-access';\n   *\n   * const screw = this.getComponents<ScrewComponentAccess>(entity).screw;\n   */\n  protected getComponents<T>(entity: Entity, _typeHint?: T): T {\n    return entity.c as unknown as T;\n  }\n\n  /**\n   * Called each frame to update the system.\n   * Override this method to implement your game logic.\n   *\n   * @param time - Time information including deltaTime and elapsed time\n   */\n  abstract update(time: Time): void;\n}\n","/**\n * Precise layout measurements for the colored tray frame.\n *\n * All values in pixels, measured from Figma design (node 34:141).\n * The frame contains 5 slot positions for trays/covers.\n *\n * Visual structure:\n * ```\n * |<-------------- 1015px frame width ------------->|\n * +------------------------------------------------+\n * | [slot0] [slot1] [slot2] [slot3] [slot4]        |\n * +------------------------------------------------+\n * ```\n *\n * Behind the frame is a dark gray background (990x190) that shows\n * through the slot openings.\n */\nexport const TRAY_FRAME_LAYOUT = {\n  /** Frame asset dimensions (colored-tray-frame.png) */\n  frame: {\n    width: 1015,\n    height: 210,\n  },\n\n  /** Frame position in game world */\n  framePosition: {\n    x: 32,\n    y: 187,\n  },\n\n  /** Background layer (dark gray under slots) */\n  background: {\n    width: 990,\n    height: 190,\n    offsetX: 15, // Relative to frame top-left\n    offsetY: 10,\n    color: 0x535353,\n  },\n\n  /** Tray sprite dimensions */\n  traySprite: {\n    width: 185,\n    height: 150,\n  },\n\n  /** Cover sprite dimensions */\n  coverSprite: {\n    width: 180,\n    height: 145,\n  },\n\n  /** Screw placeholder dimensions */\n  placeholder: {\n    width: 40,\n    height: 50,\n  },\n\n  /**\n   * Slot positions relative to frame origin (0,0).\n   * These are the top-left corners of each tray/cover position.\n   *\n   * Measured from Figma \"most_common_case_2_slots_visible\" frame.\n   * Slot spacing is approximately 195px (tray width 185 + 10px gap).\n   */\n  slotOffsets: [\n    { x: 25, y: 16 }, // Slot 0 (leftmost)\n    { x: 220, y: 16 }, // Slot 1\n    { x: 419, y: 19 }, // Slot 2\n    { x: 614, y: 18 }, // Slot 3\n    { x: 808, y: 18 }, // Slot 4 (rightmost)\n  ],\n\n  /** Average slot spacing (center-to-center) */\n  slotSpacing: 195,\n} as const;\n\n/**\n * Calculate world position for a slot's top-left corner.\n * @param slotIndex - Index 0-4\n * @returns World position {x, y}\n * @example\n * const pos = getSlotWorldPosition(0); // { x: 57, y: 203 }\n */\nexport function getSlotWorldPosition(slotIndex: number): {\n  x: number;\n  y: number;\n} {\n  const offset = TRAY_FRAME_LAYOUT.slotOffsets[slotIndex];\n  if (!offset) {\n    throw new Error(`Invalid slot index: ${String(slotIndex)}`);\n  }\n  return {\n    x: TRAY_FRAME_LAYOUT.framePosition.x + offset.x,\n    y: TRAY_FRAME_LAYOUT.framePosition.y + offset.y,\n  };\n}\n\n/**\n * Calculate position for placing a tray sprite in a slot.\n * Tray position is the same as slot position (top-left alignment).\n *\n * @param slotIndex - Index 0-4\n * @returns World position for tray top-left corner\n * @example\n * const pos = getTrayPositionForBucket(1);\n */\nexport function getTrayPositionForBucket(slotIndex: number): {\n  x: number;\n  y: number;\n} {\n  return getSlotWorldPosition(slotIndex);\n}\n\n/**\n * Calculate position for a cover sprite in a slot.\n * Cover position is the same as slot position (top-left alignment).\n *\n * @param slotIndex - Index 0-4\n * @returns World position for cover top-left corner\n * @example\n * const pos = getCoverPositionForBucket(2);\n */\nexport function getCoverPositionForBucket(slotIndex: number): {\n  x: number;\n  y: number;\n} {\n  return getSlotWorldPosition(slotIndex);\n}\n\n// Legacy export for backwards compatibility\nexport const getBucketWorldPosition = getSlotWorldPosition;\n","/**\n * Precise layout measurements for the buffer tray.\n *\n * All values in pixels, measured from Figma design (node 36:648).\n * The buffer tray holds temporary screws before they go to colored trays.\n *\n * Visual structure:\n * ```\n * |<-------------- 780px frame width ------------->|\n * +------------------------------------------------+\n * | [slot0] [slot1] [slot2] [slot3] [slot4]        |\n * +------------------------------------------------+\n * ```\n *\n * This follows the same pattern as TRAY_FRAME_LAYOUT for consistency.\n */\nexport const BUFFER_TRAY_LAYOUT = {\n  /** Frame position and dimensions */\n  frame: {\n    x: 150,\n    y: 438,\n    width: 780,\n    height: 212,\n  },\n\n  /**\n   * Buffer slot positions (center-anchored for screws).\n   *\n   * Calculated from Figma top-left positions with screw center offset:\n   * - Screw display size: 56x70 at 0.5 scale (from 112x140 texture)\n   * - Center offset: +28, +35 from top-left\n   *\n   * Slot spacing is approximately 140-150px between centers.\n   */\n  slotPositions: [\n    { x: 257, y: 524 }, // slot 0: top-left(229, 489) + center offset(28, 35)\n    { x: 409, y: 524 }, // slot 1: top-left(381, 489) + center offset(28, 35)\n    { x: 540, y: 524 }, // slot 2: top-left(512, 489) + center offset(28, 35)\n    { x: 676, y: 524 }, // slot 3: top-left(648, 489) + center offset(28, 35)\n    { x: 821, y: 524 }, // slot 4: top-left(793, 489) + center offset(28, 35)\n  ],\n\n  /** Number of slots in the buffer tray */\n  capacity: 5,\n} as const;\n","import type { Entity2D } from '@play-co/odie';\nimport type { Position } from '@shared/types';\nimport { TRAY_FRAME_LAYOUT, getSlotWorldPosition } from './trayFrameLayout';\nimport { BUFFER_TRAY_LAYOUT } from './bufferTrayLayout';\n\n/**\n * Display positions for the 5 colored tray slots.\n * Calculated from TRAY_FRAME_LAYOUT slot positions.\n * displayOrder 0-1 are visible, 2-4 are hidden initially.\n */\nexport const TRAY_DISPLAY_POSITIONS: Position[] =\n  TRAY_FRAME_LAYOUT.slotOffsets.map((_, index) => getSlotWorldPosition(index));\n\n/**\n * Y position for hidden trays (below the visible tray frame).\n */\nexport const TRAY_HIDDEN_Y = 450;\n\n/**\n * X position for trays entering from under the rightmost cover.\n * This is the slot 4 position where the tray is hidden by a cover,\n * then slides left into its target slot.\n * Slot 4 X = frame.x(32) + slotOffsets[4].x(808) = 840\n */\nexport const TRAY_SPAWN_X =\n  TRAY_FRAME_LAYOUT.framePosition.x + TRAY_FRAME_LAYOUT.slotOffsets[4].x;\n\n/**\n * Tray sprite width for centering calculations.\n * Uses value from TRAY_FRAME_LAYOUT for consistency.\n */\nconst TRAY_WIDTH = TRAY_FRAME_LAYOUT.traySprite.width;\n\n/**\n * Slot display width (matches placeholder width).\n */\nconst SLOT_DISPLAY_WIDTH = TRAY_FRAME_LAYOUT.placeholder.width;\n\n/**\n * Spacing between slot centers in colored trays.\n */\nconst COLORED_TRAY_SLOT_SPACING = 40;\n\n/**\n * Y offset for slots within a colored tray.\n * Centered vertically in tray height.\n */\nconst COLORED_TRAY_Y_OFFSET = 75;\n\n/**\n * Calculate the world position for a screw slot in a tray.\n *\n * For colored trays, screws are centered horizontally based on capacity.\n * For buffer trays, screws go to predefined slot positions.\n *\n * @param trayEntity - The tray entity\n * @param slotIndex - The slot index (0-based)\n * @param isBuffer - Whether this is a buffer tray\n * @param trayCapacity - The tray's capacity (needed for centering calculation)\n * @returns The world position for the slot\n *\n * @example\n * const pos = getTraySlotPosition(redTray, 2, false, 3);\n * // Returns position for third slot in a 3-capacity red tray\n */\nexport function getTraySlotPosition(\n  trayEntity: Entity2D,\n  slotIndex: number,\n  isBuffer: boolean,\n  trayCapacity?: number\n): Position {\n  if (isBuffer) {\n    // Buffer tray uses predefined slot positions\n    const slot = BUFFER_TRAY_LAYOUT.slotPositions[slotIndex];\n    if (slot) {\n      return { x: slot.x, y: slot.y };\n    }\n    // Fallback for overflow (shouldn't happen with capacity 5)\n    const fallbackSlot = BUFFER_TRAY_LAYOUT.slotPositions[0];\n    return {\n      x: fallbackSlot.x + slotIndex * 80,\n      y: fallbackSlot.y,\n    };\n  }\n\n  // Colored tray: calculate centered position based on capacity\n  const capacity = trayCapacity ?? 3;\n  const totalWidth =\n    (capacity - 1) * COLORED_TRAY_SLOT_SPACING + SLOT_DISPLAY_WIDTH;\n  const startX = (TRAY_WIDTH - totalWidth) / 2 + SLOT_DISPLAY_WIDTH / 2;\n\n  return {\n    x: trayEntity.position.x + startX + slotIndex * COLORED_TRAY_SLOT_SPACING,\n    y: trayEntity.position.y + COLORED_TRAY_Y_OFFSET,\n  };\n}\n\n/**\n * Calculate the target (final) position for a screw slot in a colored tray.\n *\n * Unlike getTraySlotPosition which uses the tray's current position,\n * this function uses the tray's displayOrder to calculate where the tray\n * WILL be after animations complete. Use this when you need the final\n * position even if the tray is currently animating.\n *\n * @param displayOrder - The tray's display order (0-4)\n * @param slotIndex - The slot index within the tray (0-based)\n * @param trayCapacity - The tray's capacity (needed for centering calculation)\n * @returns The target world position for the slot\n *\n * @example\n * const pos = getTraySlotTargetPosition(0, 1, 3);\n * // Returns final position for slot 1 in a 3-capacity tray at displayOrder 0\n */\nexport function getTraySlotTargetPosition(\n  displayOrder: number,\n  slotIndex: number,\n  trayCapacity: number\n): Position {\n  // Get the fixed position for this display slot\n  const trayPosition = TRAY_DISPLAY_POSITIONS[displayOrder];\n  if (!trayPosition) {\n    throw new Error(`Invalid displayOrder: ${String(displayOrder)}`);\n  }\n\n  // Calculate centered slot position based on capacity\n  const totalWidth =\n    (trayCapacity - 1) * COLORED_TRAY_SLOT_SPACING + SLOT_DISPLAY_WIDTH;\n  const startX = (TRAY_WIDTH - totalWidth) / 2 + SLOT_DISPLAY_WIDTH / 2;\n\n  return {\n    x: trayPosition.x + startX + slotIndex * COLORED_TRAY_SLOT_SPACING,\n    y: trayPosition.y + COLORED_TRAY_Y_OFFSET,\n  };\n}\n\n/**\n * Get the next available buffer slot position.\n *\n * @param slotIndex - The slot index (0-based)\n * @returns The world position for the buffer slot\n * @example\n * const pos = getBufferSlotPosition(0); // { x: 219, y: 470 }\n */\nexport function getBufferSlotPosition(slotIndex: number): Position {\n  const slot = BUFFER_TRAY_LAYOUT.slotPositions[slotIndex];\n  if (slot) {\n    return { x: slot.x, y: slot.y };\n  }\n  // Fallback for out-of-range index\n  const fallbackSlot = BUFFER_TRAY_LAYOUT.slotPositions[0];\n  return {\n    x: fallbackSlot.x + slotIndex * 80,\n    y: fallbackSlot.y,\n  };\n}\n","/**\n * Simple event bus for game events.\n *\n * Provides a centralized pub/sub mechanism for game systems to communicate\n * without direct dependencies.\n *\n * @example\n * // Subscribe to an event\n * gameEvents.on('screw:startRemoval', (data) => {\n *   console.log('Screw removal started', data);\n * });\n *\n * // Emit an event\n * gameEvents.emit('screw:startRemoval', { screwEntity, targetTray });\n *\n * // Unsubscribe\n * gameEvents.off('screw:startRemoval', handler);\n */\n\ntype EventHandler<T = unknown> = (data: T) => void;\n\nclass GameEventBus {\n  private listeners = new Map<string, Set<EventHandler>>();\n\n  /**\n   * Subscribe to an event.\n   *\n   * @param event - Event name\n   * @param handler - Handler function\n   * @example\n   * gameEvents.on('screw:removed', (data) => console.log(data));\n   */\n  on<T = unknown>(event: string, handler: EventHandler<T>): void {\n    let handlers = this.listeners.get(event);\n    if (!handlers) {\n      handlers = new Set();\n      this.listeners.set(event, handlers);\n    }\n    handlers.add(handler as EventHandler);\n  }\n\n  /**\n   * Unsubscribe from an event.\n   *\n   * @param event - Event name\n   * @param handler - Handler function to remove\n   * @example\n   * gameEvents.off('screw:removed', myHandler);\n   */\n  off<T = unknown>(event: string, handler: EventHandler<T>): void {\n    const handlers = this.listeners.get(event);\n    if (handlers) {\n      handlers.delete(handler as EventHandler);\n    }\n  }\n\n  /**\n   * Emit an event to all subscribers.\n   *\n   * @param event - Event name\n   * @param data - Event data\n   * @example\n   * gameEvents.emit('screw:removed', { screwId: '123' });\n   */\n  emit(event: string, data?: unknown): void {\n    const handlers = this.listeners.get(event);\n    if (handlers) {\n      for (const handler of handlers) {\n        handler(data);\n      }\n    }\n  }\n\n  /**\n   * Remove all listeners for a specific event or all events.\n   *\n   * @param event - Optional event name. If omitted, clears all listeners.\n   * @example\n   * gameEvents.clear('screw:removed'); // Clear specific event\n   * gameEvents.clear(); // Clear all events\n   */\n  clear(event?: string): void {\n    if (event) {\n      this.listeners.delete(event);\n    } else {\n      this.listeners.clear();\n    }\n  }\n}\n\n/** Singleton instance for game events */\nexport const gameEvents = new GameEventBus();\n","/**\n * Registry for layer containers used by animation system.\n *\n * This module provides a way for GameScene to register its layer containers\n * so that AnimationSystem can access them without direct coupling.\n */\n\nimport type { Container } from 'pixi.js';\n\nlet animationLayer: Container | null = null;\nlet coloredTrayLayer: Container | null = null;\n\n/**\n * Register the animation layer container.\n * Called by GameScene during initialization.\n *\n * @param layer - The animation layer container\n * @example\n * registerAnimationLayer(container);\n */\nexport function registerAnimationLayer(layer: Container): void {\n  animationLayer = layer;\n}\n\n/**\n * Register the colored tray layer container.\n * Called by GameScene during initialization.\n *\n * @param layer - The colored tray layer container\n * @example\n * registerColoredTrayLayer(container);\n */\nexport function registerColoredTrayLayer(layer: Container): void {\n  coloredTrayLayer = layer;\n}\n\n/**\n * Get the animation layer container.\n * Used by AnimationSystem to move screws to top during animation.\n *\n * @returns The animation layer container or null if not registered\n * @example\n * const layer = getAnimationLayer();\n * if (layer) layer.addChild(sprite);\n */\nexport function getAnimationLayer(): Container | null {\n  return animationLayer;\n}\n\n/**\n * Get the colored tray layer container.\n * Used by AnimationSystem to move screws to correct layer after animation.\n *\n * @returns The colored tray layer container or null if not registered\n * @example\n * const layer = getColoredTrayLayer();\n * if (layer) layer.addChild(sprite);\n */\nexport function getColoredTrayLayer(): Container | null {\n  return coloredTrayLayer;\n}\n\n/**\n * Clear the layer registry.\n * Called when GameScene is destroyed.\n * @example\n * clearLayerRegistry();\n */\nexport function clearLayerRegistry(): void {\n  animationLayer = null;\n  coloredTrayLayer = null;\n}\n","/**\n * Layout coordinates from Figma design (1080x1920).\n * Updated from Figma node 28:14 using Layer image sizes.\n *\n * @module\n */\n\nimport {\n  TRAY_FRAME_LAYOUT,\n  getCoverPositionForBucket,\n} from './trayFrameLayout';\nimport { BUFFER_TRAY_LAYOUT } from './bufferTrayLayout';\n\n/**\n * Main game layout coordinates.\n */\nexport const GAME_LAYOUT = {\n  // Background\n  background: { x: 0, y: 0, width: 1080, height: 1920 },\n\n  // Puzzle base (metal frame)\n  puzzleBase: { x: 32, y: 676, width: 1015, height: 1090 },\n\n  // Restart button\n  restartButton: { x: 918, y: 21, width: 140, height: 140 },\n\n  // Colored tray area (from TRAY_FRAME_LAYOUT)\n  coloredTrayFrame: {\n    x: TRAY_FRAME_LAYOUT.framePosition.x,\n    y: TRAY_FRAME_LAYOUT.framePosition.y,\n    width: TRAY_FRAME_LAYOUT.frame.width,\n    height: TRAY_FRAME_LAYOUT.frame.height,\n  },\n\n  // Covers for hidden tray slots (displayOrder 2, 3, 4)\n  // Positions calculated from TRAY_FRAME_LAYOUT bucket positions\n  trayCovers: [\n    getCoverPositionForBucket(2), // covers bucket 2\n    getCoverPositionForBucket(3), // covers bucket 3\n    getCoverPositionForBucket(4), // covers bucket 4\n  ],\n\n  // Buffer tray (from BUFFER_TRAY_LAYOUT)\n  bufferTrayFrame: BUFFER_TRAY_LAYOUT.frame,\n  bufferSlots: BUFFER_TRAY_LAYOUT.slotPositions,\n} as const;\n","/**\n * Central tick counter for deterministic debug logging.\n *\n * Provides a frame-based tick counter that all systems can use for logging.\n * This enables deterministic reproduction of bugs from error logs by\n * replaying actions at specific tick numbers.\n *\n * @example\n * // In a system's update method\n * gameTick.update();\n *\n * // Log with tick number\n * gameTick.log('TAP', `(${x}, ${y})  ${color} screw`);\n * // Output: [T42] TAP: (100, 200)  red screw\n *\n * // Get current tick for E2E replay\n * const tick = gameTick.current;\n */\n\n/** Current tick number, incremented each frame */\nlet currentTick = 0;\n\n/** Whether debug logging is enabled */\nlet loggingEnabled = true;\n\n/**\n * Game tick counter singleton.\n *\n * The tick counter provides a consistent frame reference for all debug logs,\n * making it possible to deterministically reproduce bugs by replaying\n * input sequences at specific tick numbers.\n */\nexport const gameTick = {\n  /**\n   * Get the current tick number.\n   * @returns The current frame tick\n   */\n  get current(): number {\n    return currentTick;\n  },\n\n  /**\n   * Increment the tick counter. Call this once per frame in the main update loop.\n   * Should be called by a single system (typically a TickSystem or the scene).\n   * @example\n   * gameTick.update(); // Call in TickSystem.update()\n   */\n  update(): void {\n    currentTick++;\n  },\n\n  /**\n   * Reset the tick counter to zero.\n   * Useful for level restarts or E2E test setup.\n   * @example\n   * gameTick.reset(); // Called when loading a new level\n   */\n  reset(): void {\n    currentTick = 0;\n  },\n\n  /**\n   * Enable or disable logging output.\n   * @param enabled - Whether to enable logging\n   * @example\n   * gameTick.setLoggingEnabled(false); // Disable logging in production\n   */\n  setLoggingEnabled(enabled: boolean): void {\n    loggingEnabled = enabled;\n  },\n\n  /**\n   * Log a message with the current tick number prefix.\n   *\n   * Format: `[T{tick}] {category}: {message}`\n   *\n   * @param category - Log category (e.g., 'TAP', 'TRAY', 'TRANSFER')\n   * @param message - The log message\n   *\n   * @example\n   * gameTick.log('TAP', '(100, 200)  red screw  colored tray [slot 0]');\n   * // Output: [T42] TAP: (100, 200)  red screw  colored tray [slot 0]\n   */\n  log(category: string, message: string): void {\n    if (loggingEnabled) {\n      // eslint-disable-next-line no-console\n      console.log(`[T${String(currentTick)}] ${category}: ${message}`);\n    }\n  },\n\n  /**\n   * Log a debug message without category (simpler format).\n   *\n   * Format: `[T{tick}] {message}`\n   *\n   * @param message - The log message\n   *\n   * @example\n   * gameTick.debug('Animation complete');\n   * // Output: [T42] Animation complete\n   */\n  debug(message: string): void {\n    if (loggingEnabled) {\n      // eslint-disable-next-line no-console\n      console.log(`[T${String(currentTick)}] ${message}`);\n    }\n  },\n\n  /**\n   * Log a warning message with the current tick number prefix.\n   * Uses console.warn for higher visibility in developer tools.\n   *\n   * Format: `[T{tick}] {category}: {message}`\n   *\n   * @param category - Warning category (e.g., 'SNAP_CORRECTION')\n   * @param message - The warning message\n   *\n   * @example\n   * gameTick.warn('SNAP_CORRECTION', 'screw at (100, 200) snapped to (105, 200)');\n   * // Output: [T42] SNAP_CORRECTION: screw at (100, 200) snapped to (105, 200)\n   */\n  warn(category: string, message: string): void {\n    if (loggingEnabled) {\n      // eslint-disable-next-line no-console\n      console.warn(`[T${String(currentTick)}] ${category}: ${message}`);\n    }\n  },\n};\n","import type { Entity, Entity2D, Time } from '@play-co/odie';\nimport { BaseSystem } from './BaseSystem';\nimport { TrayComponent, ScrewComponent } from '../components';\nimport { gameEvents, gameTick } from '../utils';\nimport type {\n  ScrewRemovalCompleteEvent,\n  ScrewTransferCompleteEvent,\n} from './AnimationSystem';\nimport type { TrayComponentAccess } from '../types';\n\n/**\n * Event data emitted when a tray should start hiding.\n */\nexport interface TrayHideEvent {\n  /** The tray entity to hide */\n  trayEntity: Entity;\n}\n\n/**\n * Event data emitted when tray hide animation completes.\n */\nexport interface TrayHideCompleteEvent {\n  /** The tray entity that was hidden */\n  trayEntity: Entity;\n  /** Screws that were in the tray (for cleanup) */\n  screwsInTray: Entity[];\n}\n\n/**\n * Event data emitted when a tray should shift to a new position.\n */\nexport interface TrayShiftEvent {\n  /** The tray entity to shift */\n  trayEntity: Entity;\n  /** The new display order (position) */\n  newDisplayOrder: number;\n}\n\n/**\n * Event data emitted when a tray should reveal.\n */\nexport interface TrayRevealEvent {\n  /** The tray entity to reveal */\n  trayEntity: Entity;\n  /** The display order where it should appear */\n  displayOrder: number;\n}\n\n/**\n * Event data emitted when a tray has finished revealing.\n */\nexport interface TrayRevealedEvent {\n  /** The tray entity that was revealed */\n  trayEntity: Entity;\n}\n\n/**\n * System for managing tray visibility transitions.\n *\n * When a tray is filled to capacity, this system orchestrates:\n * 1. Hiding the full tray (slide down)\n * 2. Shifting remaining visible trays left\n * 3. Revealing the next hidden tray\n *\n * Uses a queue to handle rapid tray completions sequentially.\n *\n * Listens for:\n * - `screw:removalComplete` - Check if tray is now full\n *\n * Emits:\n * - `tray:startHide` - Trigger hide animation\n * - `tray:startShift` - Trigger shift animation\n * - `tray:startReveal` - Trigger reveal animation\n * - `tray:revealed` - Tray has finished revealing (triggers auto-transfer)\n */\nexport class TrayManagementSystem extends BaseSystem {\n  static readonly NAME = 'trayManagement';\n  static Queries = {\n    trays: { components: [TrayComponent] },\n    screws: { components: [ScrewComponent] },\n  };\n\n  /** Queue of full trays waiting to be processed */\n  private transitionQueue: Entity[] = [];\n\n  /** Whether a transition is currently in progress */\n  private isTransitioning = false;\n\n  /**\n   * Check if the system is currently processing or has pending transitions.\n   * Used by AutoTransferSystem to avoid starting transfers during tray animations.\n   * @returns True if transitions are in progress or queued\n   * @example\n   * if (trayManagementSystem.isBusy()) return;\n   */\n  public isBusy(): boolean {\n    return this.isTransitioning || this.transitionQueue.length > 0;\n  }\n\n  /**\n   * Initialize event listeners.\n   * @example\n   * system.init(); // Called automatically by ECS\n   */\n  init(): void {\n    gameEvents.on<ScrewRemovalCompleteEvent>(\n      'screw:removalComplete',\n      this.handleScrewRemovalComplete\n    );\n    // Also check tray fullness when buffer transfers complete\n    gameEvents.on<ScrewTransferCompleteEvent>(\n      'screw:transferComplete',\n      this.handleScrewTransferComplete\n    );\n\n    // Listen for animation completion events\n    gameEvents.on('tray:hideComplete', this.handleAnimationComplete);\n    gameEvents.on('tray:shiftComplete', this.handleAnimationComplete);\n    gameEvents.on('tray:revealComplete', this.handleRevealComplete);\n  }\n\n  /**\n   * Handle screw removal completion - check if tray is now full.\n   * @param event - The screw removal complete event\n   * @example\n   * // Called via event listener\n   */\n  private handleScrewRemovalComplete = (\n    event: ScrewRemovalCompleteEvent\n  ): void => {\n    const screw = event.screwEntity;\n    // Get the screw's tray entity ID\n    const screwComponent = this.getComponents<{\n      screw: { trayEntityId: string; state: string };\n    }>(screw).screw;\n\n    // Only check colored trays (not buffer)\n    if (screwComponent.state !== 'inTray') {\n      return;\n    }\n\n    // Find the tray this screw was placed in\n    const trayEntityId = screwComponent.trayEntityId;\n    const tray = this.findTrayByUID(trayEntityId);\n    if (!tray) return;\n\n    const trayComponent = this.getComponents<TrayComponentAccess>(tray).tray;\n\n    // Check if tray is now full AND no screws are still in-flight to this tray\n    // We must wait for all in-flight screws to land before hiding the tray,\n    // otherwise those screws won't be reparented and will remain visible\n    if (trayComponent.screwCount >= trayComponent.capacity) {\n      const inFlightToThisTray = this.countScrewsInFlightToTray(trayEntityId);\n      if (inFlightToThisTray > 0) {\n        gameTick.log(\n          'TRAY',\n          `${trayComponent.color} tray full but ${String(inFlightToThisTray)} screws still in-flight, waiting...`\n        );\n        return;\n      }\n      this.queueTransition(tray);\n    }\n  };\n\n  /**\n   * Handle screw transfer completion - check if target tray is now full.\n   * Buffer transfers also fill tray slots, so we need to check for hide.\n   * @param event - The screw transfer complete event\n   * @example\n   * // Called via event listener\n   */\n  private handleScrewTransferComplete = (\n    event: ScrewTransferCompleteEvent\n  ): void => {\n    // Reuse the same logic as removal complete\n    this.handleScrewRemovalComplete(event);\n  };\n\n  /**\n   * Count screws currently animating toward a specific tray.\n   * These are screws with state='dragging', isAnimating=true, and trayEntityId matching.\n   * @param trayUID - The tray entity UID\n   * @returns Number of screws in-flight to this tray\n   * @example\n   * const inFlight = this.countScrewsInFlightToTray('123');\n   */\n  private countScrewsInFlightToTray(trayUID: string): number {\n    const screws = this.getEntities('screws');\n    return screws.filter((entity) => {\n      const screw = this.getComponents<{\n        screw: { trayEntityId: string; state: string; isAnimating: boolean };\n      }>(entity).screw;\n      return (\n        screw.isAnimating &&\n        screw.state === 'dragging' &&\n        screw.trayEntityId === trayUID\n      );\n    }).length;\n  }\n\n  /**\n   * Find a tray entity by its UID.\n   * @param uid - The entity UID as a string\n   * @returns The tray entity, or undefined if not found\n   * @example\n   * const tray = this.findTrayByUID('123');\n   */\n  private findTrayByUID(uid: string): Entity | undefined {\n    const trays = this.getEntities('trays');\n    return trays.find((t) => String(t.UID) === uid);\n  }\n\n  /**\n   * Queue a tray transition for processing.\n   * @param tray - The tray entity to queue\n   * @example\n   * this.queueTransition(trayEntity);\n   */\n  private queueTransition(tray: Entity): void {\n    // Don't queue if already in queue\n    if (this.transitionQueue.includes(tray)) {\n      return;\n    }\n\n    this.transitionQueue.push(tray);\n    void this.processNextTransition();\n  }\n\n  /**\n   * Process the next tray transition in the queue.\n   * @example\n   * await this.processNextTransition();\n   */\n  private async processNextTransition(): Promise<void> {\n    if (this.isTransitioning || this.transitionQueue.length === 0) {\n      return;\n    }\n\n    this.isTransitioning = true;\n    const fullTray = this.transitionQueue.shift();\n    if (!fullTray) {\n      this.isTransitioning = false;\n      return;\n    }\n\n    const fullTrayComponent =\n      this.getComponents<TrayComponentAccess>(fullTray).tray;\n    fullTrayComponent.isAnimating = true;\n\n    const sortedTrays = this.getSortedTrays();\n    const nextHiddenTray = this.findNextHiddenTray(sortedTrays, fullTray);\n\n    // Hide the full tray\n    await this.hideTray(fullTray);\n\n    // Shift and reveal trays\n    const traysToShift = this.findTraysToShift(\n      sortedTrays,\n      fullTrayComponent.displayOrder,\n      fullTray\n    );\n    await this.shiftAndRevealTrays(traysToShift, nextHiddenTray);\n\n    // Finalize transition\n    this.finalizeTransition(fullTrayComponent, traysToShift, nextHiddenTray);\n    void this.processNextTransition();\n  }\n\n  /**\n   * Get all trays sorted by display order.\n   * @returns Array of tray entities sorted by display order\n   * @example\n   * const sorted = this.getSortedTrays();\n   */\n  private getSortedTrays(): Entity[] {\n    const allTrays = this.getEntities('trays');\n    return allTrays.sort((a, b) => {\n      const aOrder =\n        this.getComponents<TrayComponentAccess>(a).tray.displayOrder;\n      const bOrder =\n        this.getComponents<TrayComponentAccess>(b).tray.displayOrder;\n      return aOrder - bOrder;\n    });\n  }\n\n  /**\n   * Find the next hidden tray to reveal.\n   * @param sortedTrays - Trays sorted by display order\n   * @param fullTray - The tray that is being hidden\n   * @returns The next hidden tray, or undefined if none\n   * @example\n   * const next = this.findNextHiddenTray(sortedTrays, fullTray);\n   */\n  private findNextHiddenTray(\n    sortedTrays: Entity[],\n    fullTray: Entity\n  ): Entity | undefined {\n    return sortedTrays.find((t) => {\n      const comp = this.getComponents<TrayComponentAccess>(t).tray;\n      return comp.displayOrder >= 2 && t !== fullTray;\n    });\n  }\n\n  /**\n   * Hide a tray, wait for animation, then clean up entities.\n   * @param tray - The tray to hide\n   * @example\n   * await this.hideTray(trayEntity);\n   */\n  private async hideTray(tray: Entity): Promise<void> {\n    const trayComp = this.getComponents<TrayComponentAccess>(tray).tray;\n    gameTick.log('TRAY', `${trayComp.color} tray hidden (was full)`);\n\n    gameEvents.emit('tray:startHide', { trayEntity: tray } as TrayHideEvent);\n    const event =\n      await this.waitForEventWithData<TrayHideCompleteEvent>(\n        'tray:hideComplete'\n      );\n\n    // Clean up screw entities from scene\n    for (const screw of event.screwsInTray) {\n      this.scene.removeChild(screw as Entity2D);\n    }\n\n    // Clean up tray entity from scene\n    this.scene.removeChild(tray as Entity2D);\n  }\n\n  /**\n   * Find trays that need to shift left.\n   * @param sortedTrays - Trays sorted by display order\n   * @param currentDisplayOrder - Display order of the hiding tray\n   * @param fullTray - The tray that is being hidden\n   * @returns Array of trays that need to shift\n   * @example\n   * const toShift = this.findTraysToShift(sorted, 0, fullTray);\n   */\n  private findTraysToShift(\n    sortedTrays: Entity[],\n    currentDisplayOrder: number,\n    fullTray: Entity\n  ): Entity[] {\n    return sortedTrays.filter((t) => {\n      const comp = this.getComponents<TrayComponentAccess>(t).tray;\n      return (\n        comp.displayOrder > currentDisplayOrder &&\n        comp.displayOrder < 2 &&\n        t !== fullTray\n      );\n    });\n  }\n\n  /**\n   * Shift trays left and reveal next hidden tray.\n   * @param traysToShift - Trays to shift left\n   * @param nextHiddenTray - Next tray to reveal (if any)\n   * @example\n   * await this.shiftAndRevealTrays(toShift, nextTray);\n   */\n  private async shiftAndRevealTrays(\n    traysToShift: Entity[],\n    nextHiddenTray: Entity | undefined\n  ): Promise<void> {\n    const shiftPromises = this.emitShiftEvents(traysToShift);\n    const revealPromise = this.emitRevealEvent(nextHiddenTray);\n\n    const allPromises = revealPromise\n      ? [...shiftPromises, revealPromise]\n      : shiftPromises;\n    if (allPromises.length > 0) {\n      await Promise.all(allPromises);\n    }\n  }\n\n  /**\n   * Emit shift events for trays.\n   * @param traysToShift - Trays to shift\n   * @returns Array of promises that resolve when shifts complete\n   * @example\n   * const promises = this.emitShiftEvents(toShift);\n   */\n  private emitShiftEvents(traysToShift: Entity[]): Promise<void>[] {\n    const promises: Promise<void>[] = [];\n    for (const tray of traysToShift) {\n      const comp = this.getComponents<TrayComponentAccess>(tray).tray;\n      const newOrder = comp.displayOrder - 1;\n      comp.displayOrder = newOrder;\n      comp.isAnimating = true;\n\n      promises.push(this.waitForEvent('tray:shiftComplete'));\n      gameEvents.emit('tray:startShift', {\n        trayEntity: tray,\n        newDisplayOrder: newOrder,\n      } as TrayShiftEvent);\n    }\n    return promises;\n  }\n\n  /**\n   * Emit reveal event for the next hidden tray.\n   * @param nextHiddenTray - Tray to reveal (if any)\n   * @returns Promise that resolves when reveal completes, or null if no tray\n   * @example\n   * const promise = this.emitRevealEvent(nextTray);\n   */\n  private emitRevealEvent(\n    nextHiddenTray: Entity | undefined\n  ): Promise<void> | null {\n    if (!nextHiddenTray) return null;\n\n    const nextComp =\n      this.getComponents<TrayComponentAccess>(nextHiddenTray).tray;\n    const newDisplayOrder = 1;\n    nextComp.displayOrder = newDisplayOrder;\n    nextComp.isAnimating = true;\n\n    gameTick.log(\n      'TRAY',\n      `${nextComp.color} tray revealed at position ${String(newDisplayOrder)}`\n    );\n\n    const promise = this.waitForEvent('tray:revealComplete');\n    gameEvents.emit('tray:startReveal', {\n      trayEntity: nextHiddenTray,\n      displayOrder: newDisplayOrder,\n    } as TrayRevealEvent);\n\n    return promise;\n  }\n\n  /**\n   * Finalize the transition by resetting flags and emitting events.\n   * @param fullTrayComponent - Component of the hidden tray\n   * @param traysToShift - Trays that were shifted\n   * @param nextHiddenTray - Tray that was revealed (if any)\n   * @example\n   * this.finalizeTransition(comp, shifted, revealed);\n   */\n  // eslint-disable-next-line max-lines-per-function -- debug logging adds lines\n  private finalizeTransition(\n    fullTrayComponent: TrayComponentAccess['tray'],\n    traysToShift: Entity[],\n    nextHiddenTray: Entity | undefined\n  ): void {\n    gameTick.log(\n      'TRAY_FINALIZE',\n      `queueLen=${String(this.transitionQueue.length)} isTransitioning=${String(this.isTransitioning)}`\n    );\n\n    fullTrayComponent.displayOrder = 99;\n    fullTrayComponent.isAnimating = false;\n\n    for (const tray of traysToShift) {\n      const comp = this.getComponents<TrayComponentAccess>(tray).tray;\n      comp.isAnimating = false;\n    }\n\n    if (nextHiddenTray) {\n      const nextComp =\n        this.getComponents<TrayComponentAccess>(nextHiddenTray).tray;\n      nextComp.isAnimating = false;\n    }\n\n    // Mark transition complete BEFORE emitting tray:revealed\n    // This ensures AutoTransferSystem.checkAutoTransfer() doesn't skip the transfer\n    this.isTransitioning = false;\n\n    gameTick.log(\n      'TRAY_FINALIZE',\n      ' isTransitioning=false, emitting tray:revealed, then processNextTransition'\n    );\n\n    if (nextHiddenTray) {\n      gameEvents.emit('tray:revealed', {\n        trayEntity: nextHiddenTray,\n      } as TrayRevealedEvent);\n    }\n  }\n\n  /**\n   * Wait for a specific event to fire.\n   * @param eventName - The name of the event to wait for\n   * @example\n   * await this.waitForEvent('tray:hideComplete');\n   */\n  private waitForEvent(eventName: string): Promise<void> {\n    return new Promise((resolve) => {\n      const handler = (): void => {\n        gameEvents.off(eventName, handler);\n        resolve();\n      };\n      gameEvents.on(eventName, handler);\n    });\n  }\n\n  /**\n   * Wait for a specific event and return its data.\n   * @param eventName - The name of the event to wait for\n   * @returns Promise resolving to the event data\n   * @example\n   * const event = await this.waitForEventWithData<TrayHideCompleteEvent>('tray:hideComplete');\n   */\n  private waitForEventWithData<T>(eventName: string): Promise<T> {\n    return new Promise((resolve) => {\n      const handler = (data: T): void => {\n        gameEvents.off(eventName, handler);\n        resolve(data);\n      };\n      gameEvents.on(eventName, handler);\n    });\n  }\n\n  /**\n   * Handle animation completion events.\n   * @example\n   * // Called via event listener\n   */\n  private handleAnimationComplete = (): void => {\n    // Events are used for promise resolution in waitForEvent\n  };\n\n  /**\n   * Handle reveal completion event.\n   * @example\n   * // Called via event listener\n   */\n  private handleRevealComplete = (): void => {\n    // Events are used for promise resolution in waitForEvent\n  };\n\n  /**\n   * Update is a no-op for this system.\n   * @param _time - The game time (unused)\n   * @example\n   * system.update(time); // Called automatically by ECS\n   */\n  update(_time: Time): void {\n    // No per-frame updates needed - transitions are event-driven\n  }\n\n  /**\n   * Clean up when system is destroyed.\n   * @example\n   * system.destroy(); // Called automatically by ECS\n   */\n  destroy(): void {\n    gameEvents.off('screw:removalComplete', this.handleScrewRemovalComplete);\n    gameEvents.off('screw:transferComplete', this.handleScrewTransferComplete);\n    gameEvents.off('tray:hideComplete', this.handleAnimationComplete);\n    gameEvents.off('tray:shiftComplete', this.handleAnimationComplete);\n    gameEvents.off('tray:revealComplete', this.handleRevealComplete);\n    this.transitionQueue = [];\n    this.isTransitioning = false;\n  }\n}\n","import type { Entity, Time } from '@play-co/odie';\nimport { BaseSystem } from './BaseSystem';\nimport {\n  ScrewComponent,\n  TrayComponent,\n  BufferTrayComponent,\n} from '../components';\nimport type { ScrewColor } from '@shared/types';\nimport type {\n  ScrewComponentAccess,\n  TrayComponentAccess,\n  BufferTrayComponentAccess,\n} from '../types';\nimport { TrayManagementSystem } from './TrayManagementSystem';\nimport { gameTick } from '../utils';\n\n/**\n * Placement target information.\n */\nexport interface PlacementTarget {\n  /** Type of target tray */\n  type: 'colored' | 'buffer';\n  /** The tray entity */\n  tray: Entity;\n  /** Slot index in the tray (0-based) */\n  slotIndex: number;\n}\n\n/**\n * System for determining screw placement in trays.\n *\n * This system provides the logic for finding valid placement targets\n * for screws and managing tray occupancy. It does not handle animations\n * or user interaction - those are handled by other systems.\n *\n * Placement priority:\n * 1. Matching colored tray (if visible and has space)\n * 2. Buffer tray (if has space)\n * 3. No valid placement (soft lock)\n *\n * @example\n * // In another system\n * const placement = this.scene.getSystem(ScrewPlacementSystem);\n * const target = placement.findPlacementTarget(ScrewColor.Red);\n * if (target) {\n *   placement.reserveSlot(target, screwEntity);\n * }\n */\nexport class ScrewPlacementSystem extends BaseSystem {\n  static readonly NAME = 'screwPlacement';\n  static Queries = {\n    coloredTrays: { components: [TrayComponent] },\n    bufferTrays: { components: [BufferTrayComponent] },\n    screws: { components: [ScrewComponent] },\n  };\n\n  /**\n   * Find a valid placement target for a screw of the given color.\n   *\n   * Visible trays have displayOrder < 2 (positions 0 and 1).\n   * During tray animations, screws are forced to buffer to prevent misplacement.\n   *\n   * @param color - The screw color to find placement for\n   * @returns PlacementTarget if found, null if no valid placement\n   * @example\n   * const target = system.findPlacementTarget(ScrewColor.Red);\n   */\n  // eslint-disable-next-line max-lines-per-function -- debug logging adds lines\n  findPlacementTarget(color: ScrewColor): PlacementTarget | null {\n    const animating = this.anyTrayAnimating();\n    const busy = this.trayManagementBusy();\n\n    gameTick.log(\n      'PLACEMENT',\n      `${color} screw  animating=${String(animating)} busy=${String(busy)}`\n    );\n\n    // During tray animations OR transition queue processing, force buffer-only\n    // This prevents race conditions when transitions are queued but not yet started\n    if (!animating && !busy) {\n      const coloredTarget = this.findColoredTrayTarget(color);\n      if (coloredTarget) {\n        const tray = this.getComponents<TrayComponentAccess>(\n          coloredTarget.tray\n        ).tray;\n\n        // Check for position race condition: if target is at displayOrder 1 and\n        // displayOrder 0 is about to fill, the shift will move our target mid-flight.\n        // Redirect to buffer instead to avoid visual glitch.\n        if (tray.displayOrder === 1 && this.willDisplayOrder0Fill()) {\n          gameTick.log(\n            'PLACEMENT',\n            ` ${tray.color} tray at displayOrder 1 would race, redirecting to buffer`\n          );\n        } else {\n          gameTick.log(\n            'PLACEMENT',\n            ` ${tray.color} tray [slot ${String(coloredTarget.slotIndex)}]`\n          );\n          return coloredTarget;\n        }\n      }\n    }\n\n    const bufferTarget = this.findBufferTrayTarget();\n    if (bufferTarget) {\n      gameTick.log(\n        'PLACEMENT',\n        ` buffer [slot ${String(bufferTarget.slotIndex)}]`\n      );\n    } else {\n      gameTick.log('PLACEMENT', ' NO VALID TARGET');\n    }\n    return bufferTarget;\n  }\n\n  /**\n   * Check if TrayManagementSystem is processing or has pending transitions.\n   * @returns True if tray management is busy\n   * @example\n   * if (system.trayManagementBusy()) { ... }\n   */\n  trayManagementBusy(): boolean {\n    const trayManagement = this.scene.getSystem(TrayManagementSystem);\n    return trayManagement.isBusy();\n  }\n\n  /**\n   * Check if any colored tray is currently animating.\n   * When true, screws should go to buffer instead of colored trays.\n   * @returns True if any tray is animating\n   * @example\n   * if (system.anyTrayAnimating()) { ... }\n   */\n  anyTrayAnimating(): boolean {\n    const coloredTrays = this.getEntities('coloredTrays');\n    return coloredTrays.some((entity) => {\n      const tray = this.getComponents<TrayComponentAccess>(entity).tray;\n      return tray.isAnimating;\n    });\n  }\n\n  /**\n   * Check if buffer tray is full, including screws in-flight to buffer.\n   * Counts both screws already in buffer AND screws animating toward it.\n   * @returns True if buffer cannot accept more screws\n   * @example\n   * if (system.isBufferFull()) { ... }\n   */\n  isBufferFull(): boolean {\n    const bufferTray = this.getFirstEntity('bufferTrays');\n    if (!bufferTray) return true;\n\n    const buffer =\n      this.getComponents<BufferTrayComponentAccess>(bufferTray).bufferTray;\n    const inBuffer = buffer.screwIds.length;\n    const inFlight = this.countScrewsAnimatingToBuffer();\n\n    return inBuffer + inFlight >= buffer.capacity;\n  }\n\n  /**\n   * Count screws currently animating toward the buffer tray.\n   * @returns Number of screws in-flight to buffer\n   * @example\n   * const inFlight = this.countScrewsAnimatingToBuffer();\n   */\n  private countScrewsAnimatingToBuffer(): number {\n    const bufferTray = this.getFirstEntity('bufferTrays');\n    if (!bufferTray) return 0;\n\n    const bufferUid = String(bufferTray.UID);\n    const screws = this.getEntities('screws');\n\n    return screws.filter((entity) => {\n      const screw = this.getComponents<ScrewComponentAccess>(entity).screw;\n      return (\n        screw.isAnimating &&\n        screw.state === 'dragging' &&\n        screw.trayEntityId === bufferUid\n      );\n    }).length;\n  }\n\n  /**\n   * Find a matching colored tray with space.\n   * @param color - The screw color\n   * @returns Placement target or null if none found\n   * @example\n   * const target = this.findColoredTrayTarget(ScrewColor.Blue);\n   */\n  private findColoredTrayTarget(color: ScrewColor): PlacementTarget | null {\n    const coloredTrays = this.getEntities('coloredTrays');\n    const matchingTray = coloredTrays.find((entity) => {\n      const tray = this.getComponents<TrayComponentAccess>(entity).tray;\n      return (\n        tray.color === color &&\n        tray.displayOrder < 2 &&\n        !tray.isAnimating &&\n        tray.screwCount < tray.capacity\n      );\n    });\n\n    if (!matchingTray) return null;\n    const tray = this.getComponents<TrayComponentAccess>(matchingTray).tray;\n    return { type: 'colored', tray: matchingTray, slotIndex: tray.screwCount };\n  }\n\n  /**\n   * Find the buffer tray if it has space.\n   * @returns Placement target or null if buffer is full\n   * @example\n   * const target = this.findBufferTrayTarget();\n   */\n  private findBufferTrayTarget(): PlacementTarget | null {\n    const bufferTray = this.getFirstEntity('bufferTrays');\n    if (!bufferTray) return null;\n\n    const buffer =\n      this.getComponents<BufferTrayComponentAccess>(bufferTray).bufferTray;\n    if (buffer.screwIds.length >= buffer.capacity) return null;\n\n    return {\n      type: 'buffer',\n      tray: bufferTray,\n      slotIndex: buffer.screwIds.length,\n    };\n  }\n\n  /**\n   * Reserve a slot in the target tray for a screw.\n   *\n   * This should be called immediately when a screw starts its removal\n   * animation to prevent race conditions with multiple screws.\n   *\n   * @param target - The placement target from findPlacementTarget\n   * @param screwEntity - The screw entity being placed\n   * @example\n   * system.reserveSlot(target, screwEntity);\n   */\n  reserveSlot(target: PlacementTarget, screwEntity: Entity): void {\n    const screw = this.getComponents<ScrewComponentAccess>(screwEntity).screw;\n\n    if (target.type === 'colored') {\n      // Increment colored tray count\n      const tray = this.getComponents<TrayComponentAccess>(target.tray).tray;\n      tray.screwCount++;\n    } else {\n      // Add to buffer tray FIFO list\n      const buffer = this.getComponents<BufferTrayComponentAccess>(\n        target.tray\n      ).bufferTray;\n      buffer.screwIds.push(String(screwEntity.UID));\n    }\n\n    // Update screw component\n    screw.trayEntityId = String(target.tray.UID);\n    screw.slotIndex = target.slotIndex;\n  }\n\n  /**\n   * Find a colored tray with available space for the given color.\n   *\n   * Used by AutoTransferSystem to check if buffer screws can be moved.\n   * Only considers visible trays (displayOrder < 2) that are not animating.\n   *\n   * @param color - The screw color to find a tray for\n   * @returns The tray entity if found, null otherwise\n   * @example\n   * const tray = system.findAvailableColoredTray(ScrewColor.Green);\n   */\n  findAvailableColoredTray(color: ScrewColor): Entity | null {\n    const coloredTrays = this.getEntities('coloredTrays');\n    return (\n      coloredTrays.find((entity) => {\n        const tray = this.getComponents<TrayComponentAccess>(entity).tray;\n        return (\n          tray.color === color &&\n          tray.displayOrder < 2 && // Only visible trays\n          !tray.isAnimating &&\n          tray.screwCount < tray.capacity\n        );\n      }) ?? null\n    );\n  }\n\n  /**\n   * Find a screw entity by its UID.\n   *\n   * @param uid - The entity UID as a string\n   * @returns The screw entity if found, undefined otherwise\n   * @example\n   * const screw = system.findScrewByUid('123');\n   */\n  findScrewByUid(uid: string): Entity | undefined {\n    const screws = this.getEntities('screws');\n    return screws.find((entity) => String(entity.UID) === uid);\n  }\n\n  /**\n   * Check if any valid moves are available.\n   *\n   * Used by WinConditionSystem to detect soft lock state.\n   *\n   * @returns true if at least one screw in board can be placed\n   * @example\n   * const canMove = system.hasValidMoves();\n   */\n  hasValidMoves(): boolean {\n    const screws = this.getEntities('screws');\n\n    return screws.some((entity) => {\n      const screw = this.getComponents<ScrewComponentAccess>(entity).screw;\n      if (screw.state !== 'inBoard' || screw.isAnimating) {\n        return false;\n      }\n      return this.findPlacementTarget(screw.color) !== null;\n    });\n  }\n\n  /**\n   * Check if a tray at displayOrder 0 will fill soon, triggering a shift.\n   * Used to block placements to displayOrder 1 trays that would be affected by shift.\n   *\n   * @returns true if the tray at displayOrder 0 will fill with pending in-flight screws\n   * @example\n   * if (system.willDisplayOrder0Fill()) {\n   *   // Block placement to displayOrder 1 trays\n   * }\n   */\n  willDisplayOrder0Fill(): boolean {\n    const coloredTrays = this.getEntities('coloredTrays');\n    const screws = this.getEntities('screws');\n\n    for (const trayEntity of coloredTrays) {\n      const tray = this.getComponents<TrayComponentAccess>(trayEntity).tray;\n      // Only check the tray at displayOrder 0 (front position)\n      if (tray.displayOrder !== 0) continue;\n\n      const trayUid = String(trayEntity.UID);\n      const inFlightCount = screws.filter((entity) => {\n        const screw = this.getComponents<ScrewComponentAccess>(entity).screw;\n        return (\n          screw.isAnimating &&\n          screw.state === 'dragging' &&\n          screw.trayEntityId === trayUid\n        );\n      }).length;\n\n      if (tray.screwCount + inFlightCount >= tray.capacity) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Update is a no-op for this system.\n   * All logic is triggered by other systems calling methods directly.\n   * @param _time - Frame time info (unused)\n   * @example\n   * system.update(time); // Called automatically by ECS\n   */\n  update(_time: Time): void {\n    // No per-frame updates needed\n  }\n}\n","import type { Entity, Entity2D, Time } from '@play-co/odie';\nimport { TouchInput } from '@play-co/astro';\nimport { BaseSystem } from './BaseSystem';\nimport { ScrewComponent, GameStateComponent } from '../components';\nimport { ScrewPlacementSystem } from './ScrewPlacementSystem';\nimport { gameEvents, gameTick } from '../utils';\nimport type {\n  ScrewComponentAccess,\n  GameStateComponentAccess,\n  TrayComponentAccess,\n} from '../types';\n\n// Re-export component access types for use in other systems\nexport type { ScrewComponentAccess, GameStateComponentAccess };\n\n/**\n * Event data emitted when a screw removal starts.\n */\nexport interface ScrewRemovalEvent {\n  /** The screw entity being removed */\n  screwEntity: Entity;\n  /** The target tray entity */\n  targetTray: Entity;\n  /** Slot index in the target tray */\n  slotIndex: number;\n  /** Whether the target is a buffer tray */\n  isBuffer: boolean;\n}\n\n/**\n * System for handling screw tap interactions.\n *\n * This system attaches TouchInput handlers to screw entities and\n * initiates the removal sequence when a screw is tapped.\n *\n * Emits:\n * - `screw:startRemoval` - When a valid screw tap initiates removal\n *\n * @example\n * scene.addSystem(ScrewInteractionSystem);\n *\n * // Listen for removal events\n * scene.on('screw:startRemoval', (event: ScrewRemovalEvent) => {\n *   console.log('Removing screw to slot', event.slotIndex);\n * });\n */\nexport class ScrewInteractionSystem extends BaseSystem {\n  static readonly NAME = 'screwInteraction';\n  static Queries = {\n    screws: { components: [ScrewComponent] },\n    gameState: { components: [GameStateComponent] },\n  };\n\n  /** TouchInput instances for each screw entity */\n  private touchInputs = new Map<number, TouchInput>();\n\n  /** Flag to track if system has been initialized */\n  private initialized = false;\n\n  /**\n   * Initialize touch inputs for all existing screw entities.\n   * Called on first update to ensure entities are ready.\n   * @example\n   * this.initTouchInputs();\n   */\n  private initTouchInputs(): void {\n    if (this.initialized) return;\n    this.initialized = true;\n\n    this.forEachEntity('screws', (entity) => {\n      this.setupTouchInput(entity);\n    });\n  }\n\n  /**\n   * Set up touch input for a single screw entity.\n   * @param entity - The screw entity\n   * @example\n   * this.setupTouchInput(screwEntity);\n   */\n  private setupTouchInput(entity: Entity): void {\n    // Skip if already set up\n    if (this.touchInputs.has(entity.UID)) return;\n\n    const entity2d = entity as Entity2D;\n    const view = entity2d.view;\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition -- view may be null during entity creation\n    if (!view) return;\n\n    // Make interactive\n    view.eventMode = 'static';\n    view.cursor = 'pointer';\n\n    const input = new TouchInput(view);\n    input.onTap = (): Promise<void> => {\n      this.handleScrewTap(entity);\n      return Promise.resolve();\n    };\n\n    this.touchInputs.set(entity.UID, input);\n  }\n\n  /**\n   * Handle a tap on a screw entity.\n   * @param entity - The screw entity\n   * @example\n   * this.handleScrewTap(screwEntity);\n   */\n  private handleScrewTap(entity: Entity): void {\n    const screw = this.getComponents<ScrewComponentAccess>(entity).screw;\n    if (!this.canInteractWithScrew(screw)) return;\n\n    const placementSystem = this.scene.getSystem(ScrewPlacementSystem);\n    const target = placementSystem.findPlacementTarget(screw.color);\n    if (!target) return;\n\n    // Block interaction based on system state\n    if (this.isInteractionBlocked(placementSystem)) return;\n\n    this.logTapAction(entity, screw.color, target);\n\n    placementSystem.reserveSlot(target, entity);\n    screw.isAnimating = true;\n    screw.state = 'dragging';\n\n    gameEvents.emit('screw:startRemoval', {\n      screwEntity: entity,\n      targetTray: target.tray,\n      slotIndex: target.slotIndex,\n      isBuffer: target.type === 'buffer',\n    } as ScrewRemovalEvent);\n  }\n\n  /**\n   * Check if interaction is blocked.\n   *\n   * Blocking rule: Buffer full + trays animating/busy  block all (soft lock prevention)\n   *\n   * Note: Position race conditions (displayOrder 1 target + shift imminent) are handled\n   * by findPlacementTarget, which redirects to buffer instead of blocking.\n   *\n   * @param placementSystem - The placement system\n   * @returns True if interaction should be blocked\n   * @example\n   * if (this.isInteractionBlocked(placementSystem)) return;\n   */\n  private isInteractionBlocked(placementSystem: ScrewPlacementSystem): boolean {\n    const bufferFull = placementSystem.isBufferFull();\n    const traysAnimating = placementSystem.anyTrayAnimating();\n    const traysBusy = placementSystem.trayManagementBusy();\n\n    // Buffer full + trays in transition  block all\n    if (bufferFull && (traysAnimating || traysBusy)) {\n      gameTick.log(\n        'BLOCKED',\n        `bufferFull=${String(bufferFull)} animating=${String(traysAnimating)} busy=${String(traysBusy)}`\n      );\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Log tap action for debugging/test reproduction.\n   * @param entity - The screw entity\n   * @param color - The screw color\n   * @param target - The placement target\n   * @param target.type - The target type (colored or buffer)\n   * @param target.tray - The target tray entity\n   * @param target.slotIndex - The slot index in the tray\n   * @example\n   * this.logTapAction(entity, screw.color, target);\n   */\n  private logTapAction(\n    entity: Entity,\n    color: string,\n    target: { type: string; tray: Entity; slotIndex: number }\n  ): void {\n    const entity2d = entity as Entity2D;\n    const x = Math.round(entity2d.position.x);\n    const y = Math.round(entity2d.position.y);\n    const trayColor =\n      target.type === 'colored'\n        ? this.getComponents<TrayComponentAccess>(target.tray).tray.color\n        : 'buffer';\n    gameTick.log(\n      'TAP',\n      `(${String(x)}, ${String(y)})  ${color} screw  ${trayColor} tray [slot ${String(target.slotIndex)}]`\n    );\n  }\n\n  /**\n   * Check if a screw can be interacted with.\n   * @param screw - The screw component data\n   * @returns True if screw can be interacted with\n   * @example\n   * const canInteract = this.canInteractWithScrew(screw);\n   */\n  private canInteractWithScrew(screw: ScrewComponentAccess['screw']): boolean {\n    if (screw.state !== 'inBoard' || screw.isAnimating) return false;\n\n    const gameStateEntity = this.getFirstEntity('gameState');\n    if (gameStateEntity) {\n      const gameState =\n        this.getComponents<GameStateComponentAccess>(gameStateEntity).gameState;\n      if (gameState.phase !== 'playing') return false;\n    }\n    return true;\n  }\n\n  /**\n   * Clean up touch input for a screw entity.\n   * @param entity - The screw entity\n   * @example\n   * this.cleanupTouchInput(screwEntity);\n   */\n  private cleanupTouchInput(entity: Entity): void {\n    const input = this.touchInputs.get(entity.UID);\n    if (input) {\n      input.enabled = false;\n      this.touchInputs.delete(entity.UID);\n    }\n  }\n\n  /**\n   * Update checks for new screws and initializes them.\n   * @param _time - Frame time info (unused)\n   * @example\n   * system.update(time); // Called automatically by ECS\n   */\n  update(_time: Time): void {\n    // Initialize on first update\n    if (!this.initialized) {\n      this.initTouchInputs();\n      return;\n    }\n\n    // Check for any new screws that need touch input setup\n    this.forEachEntity('screws', (entity) => {\n      if (!this.touchInputs.has(entity.UID)) {\n        this.setupTouchInput(entity);\n      }\n    });\n  }\n\n  /**\n   * Clean up all touch inputs when system is destroyed.\n   * @example\n   * system.destroy(); // Called automatically by ECS\n   */\n  destroy(): void {\n    for (const [uid] of this.touchInputs) {\n      const entity = this.getEntities('screws').find((e) => e.UID === uid);\n      if (entity) {\n        this.cleanupTouchInput(entity);\n      }\n    }\n    this.touchInputs.clear();\n    this.initialized = false;\n  }\n}\n","import type { Entity, Entity2D } from '@play-co/odie';\nimport type { Container, Sprite } from 'pixi.js';\nimport { ScrewColor } from '@shared/types';\n\n/**\n * Event data emitted when a screw removal animation completes.\n */\nexport interface ScrewRemovalCompleteEvent {\n  /** The screw entity that was removed */\n  screwEntity: Entity;\n}\n\n/**\n * Event data emitted when a screw transfer animation completes.\n */\nexport interface ScrewTransferCompleteEvent {\n  /** The screw entity that was transferred */\n  screwEntity: Entity;\n}\n\n/**\n * Event data for screw transfer animation (buffer to colored tray).\n */\nexport interface ScrewTransferEvent {\n  /** The screw entity being transferred */\n  screwEntity: Entity;\n  /** The target colored tray entity */\n  targetTray: Entity;\n  /** Slot index in the target tray */\n  slotIndex: number;\n}\n\n/**\n * Animation parameters for bezier curve flight.\n */\nexport interface FlightParams {\n  startX: number;\n  startY: number;\n  controlX: number;\n  controlY: number;\n  endX: number;\n  endY: number;\n  startScale: number;\n  endScale: number;\n}\n\n/**\n * Maps screw color to long screw asset alias.\n */\nexport const LONG_SCREW_ASSET_MAP: Record<ScrewColor, string> = {\n  [ScrewColor.Red]: 'screw-red',\n  [ScrewColor.Yellow]: 'screw-yellow',\n  [ScrewColor.Green]: 'screw-green',\n  [ScrewColor.Blue]: 'screw-blue',\n};\n\n/**\n * Scale factor for screws in colored tray slots.\n * Long screw is 80x100, tray slot is 50x50, so ~0.5 scale fits well.\n */\nexport const TRAY_SLOT_SCALE = 0.5;\n\n/**\n * Scale factor for screws in buffer tray.\n * Long screw is 80x100, Figma shows 56x70, so 0.7 scale.\n */\nexport const BUFFER_SLOT_SCALE = 0.7;\n\n/** Pop-out animation height in pixels. */\nexport const POP_OUT_HEIGHT = 20;\n\n/** Scale during pop-out phase. */\nexport const POP_OUT_SCALE = 0.8;\n\n/** Arc height offset for bezier control point. */\nexport const REMOVAL_ARC_HEIGHT = 130;\n\n/** Arc height offset for transfer bezier control point. */\nexport const TRANSFER_ARC_HEIGHT = 80;\n\n/**\n * Component access type for screw entities.\n */\nexport interface ScrewComponentData {\n  color: ScrewColor;\n  state: string;\n  trayEntityId?: string;\n  slotIndex?: number;\n  isAnimating: boolean;\n}\n\n/**\n * Component access type for tray entities.\n */\nexport interface TrayComponentData {\n  color: ScrewColor;\n  capacity: number;\n  displayOrder: number;\n  isAnimating: boolean;\n}\n\n/**\n * Context provided to animator classes for accessing system resources.\n */\nexport interface AnimatorContext {\n  /** Set of active GSAP timelines for cleanup tracking */\n  activeTimelines: Set<GSAPTimeline>;\n  /** Get screws currently in a specific tray by UID */\n  getScrewsInTray: (trayUID: string) => Entity[];\n  /** Get typed component access for an entity */\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-parameters\n  getComponents: <T>(entity: Entity) => T;\n  /** Get animation layer container */\n  getAnimationLayer: () => Container | null;\n  /** Get colored tray layer container */\n  getColoredTrayLayer: () => Container | null;\n  /** Get visual sprite for an entity */\n  getGameVisual: (entity: Entity2D) => Sprite | null;\n  /** Get tray slot placeholders */\n  getTrayPlaceholders: (entity: Entity2D) => Sprite[] | null;\n  /** Get target position based on tray's displayOrder */\n  getTraySlotTargetPosition: (\n    displayOrder: number,\n    slotIndex: number,\n    capacity: number\n  ) => { x: number; y: number };\n  /** Get slot position from tray entity position */\n  getTraySlotPosition: (\n    trayEntity: Entity2D,\n    slotIndex: number,\n    isBuffer: boolean,\n    capacity?: number\n  ) => { x: number; y: number };\n}\n","import type { FlightParams } from './types';\nimport { POP_OUT_HEIGHT, POP_OUT_SCALE } from './types';\n\n/**\n * Calculate quadratic bezier position at parameter t.\n * @param t - Parameter from 0 to 1\n * @param p0 - Start point\n * @param p1 - Control point\n * @param p2 - End point\n * @returns Position at parameter t\n * @example\n * const x = bezierPosition(0.5, 0, 100, 200); // Returns 100\n */\nexport function bezierPosition(\n  t: number,\n  p0: number,\n  p1: number,\n  p2: number\n): number {\n  const invT = 1 - t;\n  return invT * invT * p0 + 2 * invT * t * p1 + t * t * p2;\n}\n\n/**\n * Create flight parameters for bezier animation.\n * @param start - Start position with x and y coordinates\n * @param start.x - Start X coordinate\n * @param start.y - Start Y coordinate\n * @param end - End position with x and y coordinates\n * @param end.x - End X coordinate\n * @param end.y - End Y coordinate\n * @param endScale - Target scale\n * @param arcHeight - Arc height offset\n * @returns Flight parameters\n * @example\n * const params = createFlightParams({ x: 0, y: 0 }, { x: 100, y: 100 }, 0.5, 130);\n */\nexport function createFlightParams(\n  start: { x: number; y: number },\n  end: { x: number; y: number },\n  endScale: number,\n  arcHeight: number\n): FlightParams {\n  const flightStartY = start.y - POP_OUT_HEIGHT;\n  return {\n    startX: start.x,\n    startY: flightStartY,\n    controlX: (start.x + end.x) / 2,\n    controlY: Math.min(flightStartY, end.y) - arcHeight,\n    endX: end.x,\n    endY: end.y,\n    startScale: POP_OUT_SCALE,\n    endScale,\n  };\n}\n","/**\n * Base class for animator modules.\n *\n * Provides shared animation utilities like timeline setup, flight animation,\n * and settle effects used by screw and tray animators.\n *\n * @module\n */\n\n/* eslint-disable jsdoc/require-example */\n\nimport type { Entity2D } from '@play-co/odie';\nimport type { Sprite } from 'pixi.js';\nimport gsap from 'gsap';\nimport type { AnimatorContext, FlightParams } from './types';\nimport { bezierPosition } from './bezier';\n\n/**\n * Abstract base class providing shared animation functionality.\n *\n * Animators extend this class to inherit common utilities for:\n * - GSAP timeline setup and tracking\n * - Bezier flight animations\n * - Settle/bounce effects\n * - Placeholder visibility\n *\n * @example\n * class MyAnimator extends AnimatorBase {\n *   constructor(ctx: AnimatorContext) {\n *     super(ctx);\n *   }\n *\n *   async animate(entity: Entity2D): Promise<void> {\n *     const timeline = this.setupAnimationTimeline(entity);\n *     // ... use timeline\n *   }\n * }\n */\nexport abstract class AnimatorBase {\n  protected ctx: AnimatorContext;\n\n  constructor(ctx: AnimatorContext) {\n    this.ctx = ctx;\n  }\n\n  /**\n   * Setup animation timeline and move entity to animation layer.\n   * @param entity - The entity to animate\n   * @returns GSAP timeline tracked in activeTimelines\n   * @example\n   */\n  protected setupAnimationTimeline(entity: Entity2D): gsap.core.Timeline {\n    const timeline = gsap.timeline();\n    this.ctx.activeTimelines.add(timeline);\n\n    const animationLayer = this.ctx.getAnimationLayer();\n    if (animationLayer) {\n      animationLayer.addChild(entity.view);\n    }\n\n    return timeline;\n  }\n\n  /**\n   * Remove timeline from tracking after animation completes.\n   * @param timeline - The timeline to cleanup\n   * @example\n   */\n  protected cleanupTimeline(timeline: gsap.core.Timeline): void {\n    this.ctx.activeTimelines.delete(timeline);\n  }\n\n  /**\n   * Animate flight along bezier curve with scale interpolation.\n   * @param timeline - GSAP timeline\n   * @param entity - The entity to animate\n   * @param sprite - The sprite visual\n   * @param params - Flight parameters\n   * @param duration - Animation duration in seconds\n   * @example\n   */\n  protected async animateFlight(\n    timeline: gsap.core.Timeline,\n    entity: Entity2D,\n    sprite: Sprite,\n    params: FlightParams,\n    duration: number\n  ): Promise<void> {\n    const progress = { t: 0 };\n    const updatePosition = (): void => {\n      this.updateFlightPosition(progress.t, entity, sprite, params);\n    };\n    await timeline.to(progress, {\n      t: 1,\n      duration,\n      ease: 'power2.inOut',\n      onUpdate: updatePosition,\n    });\n  }\n\n  /**\n   * Update entity position and scale during flight animation.\n   * @param t - Animation progress (0-1)\n   * @param entity - The entity to move\n   * @param sprite - The sprite to scale\n   * @param params - Flight parameters\n   * @example\n   */\n  protected updateFlightPosition(\n    t: number,\n    entity: Entity2D,\n    sprite: Sprite,\n    params: FlightParams\n  ): void {\n    entity.position.x = bezierPosition(\n      t,\n      params.startX,\n      params.controlX,\n      params.endX\n    );\n    entity.position.y = bezierPosition(\n      t,\n      params.startY,\n      params.controlY,\n      params.endY\n    );\n    sprite.scale.set(\n      params.startScale + (params.endScale - params.startScale) * t\n    );\n  }\n\n  /**\n   * Animate settle bounce at end of flight.\n   * @param timeline - GSAP timeline\n   * @param sprite - The sprite visual\n   * @param scale - Target scale\n   * @example\n   */\n  protected async animateSettle(\n    timeline: gsap.core.Timeline,\n    sprite: Sprite,\n    scale: number\n  ): Promise<void> {\n    await timeline.to(sprite.scale, {\n      x: scale,\n      y: scale,\n      duration: 0.1,\n      ease: 'bounce.out',\n    });\n  }\n\n  /**\n   * Hide a placeholder sprite when a screw fills that slot.\n   * @param trayEntity - The tray entity\n   * @param slotIndex - The slot index that was filled\n   * @example\n   */\n  protected hidePlaceholder(trayEntity: Entity2D, slotIndex: number): void {\n    const placeholders = this.ctx.getTrayPlaceholders(trayEntity);\n    const placeholder = placeholders?.[slotIndex];\n    if (placeholder) {\n      gsap.to(placeholder, { alpha: 0, duration: 0.15, ease: 'linear' });\n    }\n  }\n}\n","/**\n * Screw removal animation handler.\n *\n * Handles the screw:startRemoval event to animate screws being removed\n * from parts and flying to their target tray (buffer or colored).\n *\n * @module\n */\n\n/* eslint-disable jsdoc/require-returns, jsdoc/require-param, jsdoc/require-example */\n\nimport type { Entity, Entity2D } from '@play-co/odie';\nimport { Assets, type Sprite, type Texture } from 'pixi.js';\nimport { AnimatorBase } from './AnimatorBase';\nimport type { FlightParams } from './types';\nimport {\n  LONG_SCREW_ASSET_MAP,\n  TRAY_SLOT_SCALE,\n  BUFFER_SLOT_SCALE,\n  POP_OUT_SCALE,\n  POP_OUT_HEIGHT,\n  REMOVAL_ARC_HEIGHT,\n} from './types';\nimport { gameEvents, gameTick } from '../../utils';\nimport type { ScrewRemovalEvent } from '../ScrewInteractionSystem';\nimport type { ScrewColor } from '@shared/types';\n\n/** Component access type for screw entities */\ninterface ScrewComponentAccess {\n  screw: {\n    color: ScrewColor;\n    state: string;\n    trayEntityId?: string;\n    slotIndex?: number;\n    isAnimating: boolean;\n  };\n}\n\n/** Component access type for tray entities */\ninterface TrayComponentAccess {\n  tray: {\n    displayOrder: number;\n    capacity: number;\n    color: string;\n    isAnimating: boolean;\n  };\n}\n\n/**\n * Animator for screw removal (unscrew and fly to tray).\n *\n * Animation sequence:\n * 1. Swap texture from short screw to long screw\n * 2. Arc flight along bezier curve to target tray slot\n * 3. Settle bounce effect at landing\n *\n * Can target either buffer tray (when no matching colored tray is visible)\n * or colored tray (when a matching tray has space).\n *\n * Emits `screw:removalComplete` when animation finishes.\n *\n * @example\n * const animator = new ScrewRemovalAnimator(ctx);\n * await animator.handle(event);\n */\nexport class ScrewRemovalAnimator extends AnimatorBase {\n  /**\n   * Handle screw removal animation.\n   * @param event - The removal event data\n   */\n  async handle(event: ScrewRemovalEvent): Promise<void> {\n    const { screwEntity, targetTray, slotIndex, isBuffer } = event;\n    const screwEntity2D = screwEntity as Entity2D;\n    const visual = this.ctx.getGameVisual(screwEntity2D);\n\n    // Disable pointer events during animation\n    screwEntity2D.view.eventMode = 'none';\n\n    if (!visual) {\n      this.complete(screwEntity, isBuffer, targetTray, slotIndex);\n      return;\n    }\n\n    await this.animateRemoval(screwEntity2D, visual, event);\n    this.complete(screwEntity, isBuffer, targetTray, slotIndex);\n  }\n\n  /** Perform the removal animation sequence. */\n  private async animateRemoval(\n    entity: Entity2D,\n    sprite: Sprite,\n    event: ScrewRemovalEvent\n  ): Promise<void> {\n    const timeline = this.setupAnimationTimeline(entity);\n\n    try {\n      await this.executeAnimation(entity, sprite, event, timeline);\n    } finally {\n      this.cleanupTimeline(timeline);\n    }\n  }\n\n  /** Execute the removal animation phases. */\n  private async executeAnimation(\n    entity: Entity2D,\n    sprite: Sprite,\n    event: ScrewRemovalEvent,\n    timeline: gsap.core.Timeline\n  ): Promise<void> {\n    const { targetTray, slotIndex, isBuffer } = event;\n    const screw = this.ctx.getComponents<ScrewComponentAccess>(entity).screw;\n    await this.swapToLongScrew(sprite, screw.color);\n\n    const startPos = { x: entity.position.x, y: entity.position.y };\n    // For colored trays, use displayOrder-based target to handle tray shifts during flight\n    // For buffer trays, use current tray position (buffer doesn't shift)\n    const targetPos = isBuffer\n      ? this.getSlotTargetPosition(targetTray, slotIndex, isBuffer)\n      : this.getColoredTrayTargetPosition(targetTray, slotIndex);\n\n    const endScale = isBuffer ? BUFFER_SLOT_SCALE : TRAY_SLOT_SCALE;\n    const params = this.createFlightParams(\n      startPos,\n      targetPos,\n      endScale,\n      REMOVAL_ARC_HEIGHT\n    );\n\n    await this.animateFlight(timeline, entity, sprite, params, 0.45);\n    await this.animateSettle(timeline, sprite, endScale);\n  }\n\n  /** Swap screw texture to long screw variant. */\n  private async swapToLongScrew(\n    sprite: Sprite,\n    color: ScrewColor\n  ): Promise<void> {\n    sprite.scale.set(POP_OUT_SCALE);\n    const longTexture = await Assets.load<Texture>(LONG_SCREW_ASSET_MAP[color]);\n    sprite.texture = longTexture;\n  }\n\n  /** Create flight parameters for bezier animation. */\n  private createFlightParams(\n    start: { x: number; y: number },\n    end: { x: number; y: number },\n    endScale: number,\n    arcHeight: number\n  ): FlightParams {\n    const flightStartY = start.y - POP_OUT_HEIGHT;\n    return {\n      startX: start.x,\n      startY: flightStartY,\n      controlX: (start.x + end.x) / 2,\n      controlY: Math.min(flightStartY, end.y) - arcHeight,\n      endX: end.x,\n      endY: end.y,\n      startScale: POP_OUT_SCALE,\n      endScale,\n    };\n  }\n\n  /** Get target position for colored tray using displayOrder. */\n  private getColoredTrayTargetPosition(\n    targetTray: Entity,\n    slotIndex: number\n  ): { x: number; y: number } {\n    const tray = this.ctx.getComponents<TrayComponentAccess>(targetTray).tray;\n    return this.ctx.getTraySlotTargetPosition(\n      tray.displayOrder,\n      slotIndex,\n      tray.capacity\n    );\n  }\n\n  /** Get the target position for a slot in a tray. */\n  private getSlotTargetPosition(\n    targetTray: Entity,\n    slotIndex: number,\n    isBuffer: boolean\n  ): { x: number; y: number } {\n    const trayCapacity = isBuffer\n      ? undefined\n      : this.ctx.getComponents<TrayComponentAccess>(targetTray).tray.capacity;\n    return this.ctx.getTraySlotPosition(\n      targetTray as Entity2D,\n      slotIndex,\n      isBuffer,\n      trayCapacity\n    );\n  }\n\n  /** Complete the removal and emit event. */\n  private complete(\n    screwEntity: Entity,\n    isBuffer: boolean,\n    targetTray?: Entity,\n    slotIndex?: number\n  ): void {\n    const screw =\n      this.ctx.getComponents<ScrewComponentAccess>(screwEntity).screw;\n    screw.state = isBuffer ? 'inBuffer' : 'inTray';\n    screw.isAnimating = false;\n\n    const screwEntity2D = screwEntity as Entity2D;\n    if (!isBuffer) {\n      // Colored tray: move to layer and snap to final position\n      const coloredTrayLayer = this.ctx.getColoredTrayLayer();\n      if (coloredTrayLayer) {\n        coloredTrayLayer.addChild(screwEntity2D.view);\n      }\n      if (targetTray && slotIndex !== undefined) {\n        this.checkScrewPosition(screwEntity2D, targetTray, slotIndex);\n        this.hidePlaceholder(targetTray as Entity2D, slotIndex);\n      }\n    }\n    // Buffer tray: leave in animation layer (above uiLayer)\n\n    gameEvents.emit('screw:removalComplete', { screwEntity });\n  }\n\n  /** Check if screw position matches expected slot position. */\n  private checkScrewPosition(\n    screwEntity: Entity2D,\n    targetTray: Entity,\n    slotIndex: number\n  ): void {\n    const screw =\n      this.ctx.getComponents<ScrewComponentAccess>(screwEntity).screw;\n    const tray = this.ctx.getComponents<TrayComponentAccess>(targetTray).tray;\n    const expected = this.ctx.getTraySlotTargetPosition(\n      tray.displayOrder,\n      slotIndex,\n      tray.capacity\n    );\n    const dX = Math.abs(screwEntity.position.x - expected.x);\n    const dY = Math.abs(screwEntity.position.y - expected.y);\n\n    if (dX > 0.5 || dY > 0.5) {\n      gameTick.warn(\n        'POSITION_MISMATCH',\n        `${screw.color} screw at (${screwEntity.position.x.toFixed(1)}, ${screwEntity.position.y.toFixed(1)}) ` +\n          `expected (${String(expected.x)}, ${String(expected.y)}) ` +\n          `delta=(${dX.toFixed(1)}, ${dY.toFixed(1)}) ` +\n          `tray.displayOrder=${String(tray.displayOrder)} tray.isAnimating=${String(tray.isAnimating)}`\n      );\n    }\n  }\n}\n","/**\n * Screw transfer animation handler.\n *\n * Handles the screw:startTransfer event to animate screws moving from\n * the buffer tray to a colored tray when a matching tray becomes available.\n *\n * @module\n */\n\n/* eslint-disable jsdoc/require-returns, jsdoc/require-param, jsdoc/require-example */\n\nimport type { Entity, Entity2D } from '@play-co/odie';\nimport type { Sprite } from 'pixi.js';\nimport { AnimatorBase } from './AnimatorBase';\nimport type { FlightParams, ScrewTransferEvent } from './types';\nimport {\n  BUFFER_SLOT_SCALE,\n  TRAY_SLOT_SCALE,\n  TRANSFER_ARC_HEIGHT,\n} from './types';\nimport { gameEvents, gameTick } from '../../utils';\n\n/** Component access type for screw entities */\ninterface ScrewComponentAccess {\n  screw: {\n    color: string;\n    state: string;\n    trayEntityId?: string;\n    slotIndex?: number;\n    isAnimating: boolean;\n  };\n}\n\n/** Component access type for tray entities */\ninterface TrayComponentAccess {\n  tray: {\n    displayOrder: number;\n    capacity: number;\n    color: string;\n    isAnimating: boolean;\n  };\n}\n\n/**\n * Animator for screw transfer (buffer to colored tray).\n *\n * When a screw is in the buffer tray and its matching colored tray becomes\n * available, this animator handles the arc flight animation to move the\n * screw from buffer to the colored tray slot.\n *\n * Uses a faster animation (0.27s) than removal since the screw is already\n * in its long form and doesn't need texture swapping.\n *\n * Emits `screw:transferComplete` when animation finishes.\n *\n * @example\n * const animator = new ScrewTransferAnimator(ctx);\n * await animator.handle(event);\n */\nexport class ScrewTransferAnimator extends AnimatorBase {\n  /**\n   * Handle screw transfer animation (buffer to colored tray).\n   * @param event - The transfer event data\n   */\n  async handle(event: ScrewTransferEvent): Promise<void> {\n    const { screwEntity, targetTray, slotIndex } = event;\n    const screwEntity2D = screwEntity as Entity2D;\n    const visual = this.ctx.getGameVisual(screwEntity2D);\n\n    // Disable pointer events during animation\n    screwEntity2D.view.eventMode = 'none';\n\n    if (!visual) {\n      this.complete(screwEntity, targetTray, slotIndex);\n      return;\n    }\n\n    const timeline = this.setupAnimationTimeline(screwEntity2D);\n\n    try {\n      await this.executeAnimation(screwEntity2D, visual, event, timeline);\n    } finally {\n      this.cleanupTimeline(timeline);\n    }\n\n    this.complete(screwEntity, targetTray, slotIndex);\n  }\n\n  /** Execute the transfer animation phases. */\n  private async executeAnimation(\n    entity: Entity2D,\n    sprite: Sprite,\n    event: ScrewTransferEvent,\n    timeline: gsap.core.Timeline\n  ): Promise<void> {\n    const { targetTray, slotIndex } = event;\n    const startPos = { x: entity.position.x, y: entity.position.y };\n\n    // Use displayOrder-based targeting for correct position even during shifts\n    const tray = this.ctx.getComponents<TrayComponentAccess>(targetTray).tray;\n    const targetPos = this.ctx.getTraySlotTargetPosition(\n      tray.displayOrder,\n      slotIndex,\n      tray.capacity\n    );\n    const params = this.createTransferFlightParams(startPos, targetPos);\n\n    // Transfer animation: 1.5x faster than removal (0.4 / 1.5  0.27s)\n    await this.animateFlight(timeline, entity, sprite, params, 0.27);\n    await this.animateSettle(timeline, sprite, TRAY_SLOT_SCALE);\n  }\n\n  /** Create flight parameters for transfer animation (no pop-out). */\n  private createTransferFlightParams(\n    start: { x: number; y: number },\n    end: { x: number; y: number }\n  ): FlightParams {\n    return {\n      startX: start.x,\n      startY: start.y,\n      controlX: (start.x + end.x) / 2,\n      controlY: Math.min(start.y, end.y) - TRANSFER_ARC_HEIGHT,\n      endX: end.x,\n      endY: end.y,\n      startScale: BUFFER_SLOT_SCALE,\n      endScale: TRAY_SLOT_SCALE,\n    };\n  }\n\n  /** Complete the transfer and emit event. */\n  private complete(\n    screwEntity: Entity,\n    targetTray: Entity,\n    slotIndex: number\n  ): void {\n    const screw =\n      this.ctx.getComponents<ScrewComponentAccess>(screwEntity).screw;\n    screw.state = 'inTray';\n    screw.trayEntityId = String(targetTray.UID);\n    screw.slotIndex = slotIndex;\n    screw.isAnimating = false;\n\n    const screwEntity2D = screwEntity as Entity2D;\n\n    // Move screw view to coloredTrayLayer after animation\n    const coloredTrayLayer = this.ctx.getColoredTrayLayer();\n    if (coloredTrayLayer) {\n      coloredTrayLayer.addChild(screwEntity2D.view);\n    }\n\n    // Check if position matches expected - logs warning if mismatch\n    this.checkScrewPosition(screwEntity2D, targetTray, slotIndex);\n\n    // Hide placeholder when screw lands in colored tray\n    this.hidePlaceholder(targetTray as Entity2D, slotIndex);\n\n    gameEvents.emit('screw:transferComplete', { screwEntity });\n  }\n\n  /** Check if screw position matches expected slot position. */\n  private checkScrewPosition(\n    screwEntity: Entity2D,\n    targetTray: Entity,\n    slotIndex: number\n  ): void {\n    const screw =\n      this.ctx.getComponents<ScrewComponentAccess>(screwEntity).screw;\n    const tray = this.ctx.getComponents<TrayComponentAccess>(targetTray).tray;\n    const expected = this.ctx.getTraySlotTargetPosition(\n      tray.displayOrder,\n      slotIndex,\n      tray.capacity\n    );\n    const dX = Math.abs(screwEntity.position.x - expected.x);\n    const dY = Math.abs(screwEntity.position.y - expected.y);\n\n    if (dX > 0.5 || dY > 0.5) {\n      gameTick.warn(\n        'POSITION_MISMATCH',\n        `${screw.color} screw at (${screwEntity.position.x.toFixed(1)}, ${screwEntity.position.y.toFixed(1)}) ` +\n          `expected (${String(expected.x)}, ${String(expected.y)}) ` +\n          `delta=(${dX.toFixed(1)}, ${dY.toFixed(1)}) ` +\n          `tray.displayOrder=${String(tray.displayOrder)} tray.isAnimating=${String(tray.isAnimating)}`\n      );\n    }\n  }\n}\n","/**\n * Tray hide animation handler.\n *\n * Handles the tray:startHide event to scale down and hide a filled tray.\n * Reparents screws to the tray view so they scale together during the\n * hide animation.\n *\n * @module\n */\n\n/* eslint-disable jsdoc/require-example */\n\nimport type { Entity, Entity2D } from '@play-co/odie';\nimport gsap from 'gsap';\nimport type { AnimatorContext } from './types';\nimport { gameEvents } from '../../utils';\nimport type { TrayHideEvent } from '../TrayManagementSystem';\n\n/**\n * Animator for tray hide (scale down and disappear).\n *\n * When a tray fills up completely, it animates out with a scale-to-zero\n * effect. The screws in the tray are reparented to the tray's view so\n * they shrink together as a unit.\n *\n * Emits `tray:hideComplete` when animation finishes.\n *\n * @example\n * const animator = new TrayHideAnimator(ctx);\n * await animator.handle(event);\n */\nexport class TrayHideAnimator {\n  private ctx: AnimatorContext;\n\n  constructor(ctx: AnimatorContext) {\n    this.ctx = ctx;\n  }\n\n  /**\n   * Handle tray hide animation with scale-down effect.\n   * @param event - The tray hide event data\n   * @example\n   */\n  async handle(event: TrayHideEvent): Promise<void> {\n    const { trayEntity } = event;\n    const entity2D = trayEntity as Entity2D;\n    const screwsInTray = this.ctx.getScrewsInTray(String(trayEntity.UID));\n\n    this.reparentScrewsToTray(screwsInTray, entity2D);\n    this.setupPivotForCenterScale(entity2D);\n    await this.animateScaleDown(entity2D);\n\n    gameEvents.emit('tray:hideComplete', { trayEntity, screwsInTray });\n  }\n\n  /**\n   * Set up tray pivot for center-based scaling animation.\n   * Adjusts position to compensate for pivot change.\n   * @param entity - The tray entity\n   * @example\n   */\n  private setupPivotForCenterScale(entity: Entity2D): void {\n    // Tray dimensions: 185x150\n    const pivotX = 185 / 2;\n    const pivotY = 150 / 2;\n    entity.view.pivot.set(pivotX, pivotY);\n    entity.position.x += pivotX;\n    entity.position.y += pivotY;\n  }\n\n  /**\n   * Animate tray scale-down smoothly from 1 to 0.\n   * @param entity - The tray entity to animate\n   * @example\n   */\n  private async animateScaleDown(entity: Entity2D): Promise<void> {\n    const timeline = gsap.timeline();\n    this.ctx.activeTimelines.add(timeline);\n\n    try {\n      // Single smooth scale animation from 1  0\n      await timeline.to(entity.scale, {\n        x: 0,\n        y: 0,\n        duration: 0.4,\n        ease: 'power2.in',\n      });\n    } finally {\n      this.ctx.activeTimelines.delete(timeline);\n    }\n  }\n\n  /**\n   * Reparent screw visuals to tray view so they scale together.\n   * Converts screw positions to tray-local coordinates.\n   * @param screws - Array of screw entities to reparent\n   * @param trayEntity - The tray entity to parent screws to\n   * @example\n   */\n  private reparentScrewsToTray(screws: Entity[], trayEntity: Entity2D): void {\n    // Use trayEntity.view (the container) instead of the tray sprite\n    // This is because we scale trayEntity.scale, not the sprite\n    const trayView = trayEntity.view;\n\n    for (const screwEntity of screws) {\n      const screwEntity2D = screwEntity as Entity2D;\n      const screwVisual = this.ctx.getGameVisual(screwEntity2D);\n      if (!screwVisual) continue;\n\n      // Calculate local position relative to tray\n      // Screw is at entity world position, tray is at tray entity position\n      // Local position = screw world position - tray world position\n      const localX = screwEntity2D.position.x - trayEntity.position.x;\n      const localY = screwEntity2D.position.y - trayEntity.position.y;\n\n      // Remove from current parent first to avoid PixiJS warning\n      if (screwVisual.parent) {\n        screwVisual.parent.removeChild(screwVisual);\n      }\n\n      // Reparent visual to tray view container\n      screwVisual.position.set(localX, localY);\n      trayView.addChild(screwVisual);\n    }\n  }\n}\n","/**\n * Tray shift animation handler.\n *\n * Handles the tray:startShift event to slide a tray left to a new display\n * position when another tray hides. Also moves any screws in the tray so\n * they stay aligned.\n *\n * @module\n */\n\n/* eslint-disable jsdoc/require-example */\n\nimport type { Entity, Entity2D } from '@play-co/odie';\nimport gsap from 'gsap';\nimport type { AnimatorContext } from './types';\nimport { gameEvents, TRAY_DISPLAY_POSITIONS } from '../../utils';\nimport type { TrayShiftEvent } from '../TrayManagementSystem';\n\n/**\n * Animator for tray shift (slide left to new position).\n *\n * When a tray at displayOrder 0 hides, the tray at displayOrder 1 shifts\n * left to take its place. This animator handles both the tray movement\n * and any screws currently in that tray.\n *\n * Emits `tray:shiftComplete` when animation finishes.\n *\n * @example\n * const animator = new TrayShiftAnimator(ctx);\n * await animator.handle(event);\n */\nexport class TrayShiftAnimator {\n  private ctx: AnimatorContext;\n\n  constructor(ctx: AnimatorContext) {\n    this.ctx = ctx;\n  }\n\n  /**\n   * Handle tray shift animation (slide left to new position).\n   * @param event - The tray shift event data\n   * @example\n   */\n  async handle(event: TrayShiftEvent): Promise<void> {\n    const { trayEntity, newDisplayOrder } = event;\n    const entity2D = trayEntity as Entity2D;\n    const targetPos = TRAY_DISPLAY_POSITIONS[newDisplayOrder];\n\n    if (!targetPos) {\n      gameEvents.emit('tray:shiftComplete', { trayEntity });\n      return;\n    }\n\n    const screwsInTray = this.ctx.getScrewsInTray(String(trayEntity.UID));\n    const deltaX = targetPos.x - entity2D.position.x;\n\n    const timeline = gsap.timeline();\n    this.ctx.activeTimelines.add(timeline);\n\n    try {\n      this.addShiftAnimations(\n        timeline,\n        entity2D,\n        targetPos.x,\n        screwsInTray,\n        deltaX\n      );\n      await timeline;\n    } finally {\n      this.ctx.activeTimelines.delete(timeline);\n    }\n\n    gameEvents.emit('tray:shiftComplete', { trayEntity });\n  }\n\n  /**\n   * Add tray and screw shift animations to a timeline.\n   * @param timeline - GSAP timeline\n   * @param trayEntity - The tray entity to animate\n   * @param targetX - Target X position for tray\n   * @param screws - Screws in the tray to move\n   * @param deltaX - X distance to move\n   * @example\n   */\n  private addShiftAnimations(\n    timeline: gsap.core.Timeline,\n    trayEntity: Entity2D,\n    targetX: number,\n    screws: Entity[],\n    deltaX: number\n  ): void {\n    timeline.to(\n      trayEntity.position,\n      { x: targetX, duration: 0.3, ease: 'power2.inOut' },\n      0\n    );\n\n    for (const screwEntity of screws) {\n      const screw2D = screwEntity as Entity2D;\n      timeline.to(\n        screw2D.position,\n        { x: screw2D.position.x + deltaX, duration: 0.3, ease: 'power2.inOut' },\n        0\n      );\n    }\n  }\n}\n","/**\n * Tray reveal animation handler.\n *\n * Handles the tray:startReveal event to slide a tray in from the right\n * when a hidden tray needs to become visible after another tray is filled.\n *\n * @module\n */\n\n/* eslint-disable jsdoc/require-example */\n\nimport type { Entity2D } from '@play-co/odie';\nimport gsap from 'gsap';\nimport type { AnimatorContext } from './types';\nimport { gameEvents, TRAY_DISPLAY_POSITIONS, TRAY_SPAWN_X } from '../../utils';\nimport type { TrayRevealEvent } from '../TrayManagementSystem';\n\n/**\n * Animator for tray reveal (slide in from right).\n *\n * When a tray fills up and hides, the next hidden tray slides in from the\n * right side to take its place. This animator handles that transition.\n *\n * Emits `tray:revealComplete` when animation finishes.\n *\n * @example\n * const animator = new TrayRevealAnimator(ctx);\n * await animator.handle(event);\n */\nexport class TrayRevealAnimator {\n  private ctx: AnimatorContext;\n\n  constructor(ctx: AnimatorContext) {\n    this.ctx = ctx;\n  }\n\n  /**\n   * Handle tray reveal animation (slide in from right).\n   * @param event - The tray reveal event data\n   * @example\n   */\n  async handle(event: TrayRevealEvent): Promise<void> {\n    const { trayEntity, displayOrder } = event;\n    const entity2D = trayEntity as Entity2D;\n    const targetPos = TRAY_DISPLAY_POSITIONS[displayOrder];\n\n    if (!targetPos) {\n      gameEvents.emit('tray:revealComplete', { trayEntity });\n      return;\n    }\n\n    // Start tray at rightmost covered slot position (hidden under cover)\n    entity2D.position.x = TRAY_SPAWN_X;\n    entity2D.position.y = targetPos.y;\n\n    const timeline = gsap.timeline();\n    this.ctx.activeTimelines.add(timeline);\n\n    try {\n      await timeline.to(entity2D.position, {\n        x: targetPos.x,\n        duration: 0.3,\n        ease: 'power2.out',\n      });\n    } finally {\n      this.ctx.activeTimelines.delete(timeline);\n    }\n\n    gameEvents.emit('tray:revealComplete', { trayEntity });\n  }\n}\n","import type { Entity, Entity2D, Time } from '@play-co/odie';\nimport type { Sprite } from 'pixi.js';\nimport gsap from 'gsap';\nimport { BaseSystem } from './BaseSystem';\nimport { ScrewComponent } from '../components';\nimport { getGameVisual, getTrayPlaceholders } from '../factories';\nimport {\n  getTraySlotPosition,\n  getTraySlotTargetPosition,\n  gameEvents,\n  getAnimationLayer,\n  getColoredTrayLayer,\n} from '../utils';\nimport type { ScrewRemovalEvent } from './ScrewInteractionSystem';\nimport type {\n  TrayHideEvent,\n  TrayShiftEvent,\n  TrayRevealEvent,\n} from './TrayManagementSystem';\nimport type { ScrewComponentAccess } from '../types';\nimport {\n  type AnimatorContext,\n  type ScrewTransferEvent,\n  ScrewRemovalAnimator,\n  ScrewTransferAnimator,\n  TrayHideAnimator,\n  TrayShiftAnimator,\n  TrayRevealAnimator,\n} from './animation';\n\n// Re-export types for external use\nexport type {\n  ScrewRemovalCompleteEvent,\n  ScrewTransferCompleteEvent,\n  ScrewTransferEvent,\n} from './animation';\n\n/**\n * System for coordinating all game animations.\n *\n * This system acts as a coordinator that delegates animation work to\n * specialized animator classes. It manages the shared resources (timeline\n * tracking, layer access) and event listener registration.\n *\n * Animation types:\n * - Screw removal: Unscrew and fly to target tray\n * - Screw transfer: Move from buffer to colored tray\n * - Tray hide: Scale down and disappear when full\n * - Tray shift: Slide left when another tray hides\n * - Tray reveal: Slide in from right to replace hidden tray\n *\n * Listens for:\n * - `screw:startRemoval` - Begin removal animation\n * - `screw:startTransfer` - Begin transfer animation\n * - `tray:startHide` - Begin tray hide animation\n * - `tray:startShift` - Begin tray shift animation\n * - `tray:startReveal` - Begin tray reveal animation\n *\n * Emits (via animators):\n * - `screw:removalComplete`\n * - `screw:transferComplete`\n * - `tray:hideComplete`\n * - `tray:shiftComplete`\n * - `tray:revealComplete`\n */\nexport class AnimationSystem extends BaseSystem {\n  static readonly NAME = 'animation';\n  static Queries = {\n    screws: { components: [ScrewComponent] },\n  };\n\n  /** Active GSAP timelines for cleanup */\n  private activeTimelines = new Set<gsap.core.Timeline>();\n\n  /** Screw removal animator */\n  private screwRemoval!: ScrewRemovalAnimator;\n\n  /** Screw transfer animator */\n  private screwTransfer!: ScrewTransferAnimator;\n\n  /** Tray hide animator */\n  private trayHide!: TrayHideAnimator;\n\n  /** Tray shift animator */\n  private trayShift!: TrayShiftAnimator;\n\n  /** Tray reveal animator */\n  private trayReveal!: TrayRevealAnimator;\n\n  // Bound event handlers\n  private handleRemovalEvent = (event: ScrewRemovalEvent): void => {\n    void this.screwRemoval.handle(event);\n  };\n\n  private handleTransferEvent = (event: ScrewTransferEvent): void => {\n    void this.screwTransfer.handle(event);\n  };\n\n  private handleTrayHideEvent = (event: TrayHideEvent): void => {\n    void this.trayHide.handle(event);\n  };\n\n  private handleTrayShiftEvent = (event: TrayShiftEvent): void => {\n    void this.trayShift.handle(event);\n  };\n\n  private handleTrayRevealEvent = (event: TrayRevealEvent): void => {\n    void this.trayReveal.handle(event);\n  };\n\n  /**\n   * Initialize animators and event listeners.\n   * @example\n   * system.init(); // Called automatically by ECS\n   */\n  init(): void {\n    // Create animator context with shared resources\n    const ctx = this.createAnimatorContext();\n\n    // Initialize all animators\n    this.screwRemoval = new ScrewRemovalAnimator(ctx);\n    this.screwTransfer = new ScrewTransferAnimator(ctx);\n    this.trayHide = new TrayHideAnimator(ctx);\n    this.trayShift = new TrayShiftAnimator(ctx);\n    this.trayReveal = new TrayRevealAnimator(ctx);\n\n    // Register event listeners\n    gameEvents.on<ScrewRemovalEvent>(\n      'screw:startRemoval',\n      this.handleRemovalEvent\n    );\n    gameEvents.on<ScrewTransferEvent>(\n      'screw:startTransfer',\n      this.handleTransferEvent\n    );\n    gameEvents.on<TrayHideEvent>('tray:startHide', this.handleTrayHideEvent);\n    gameEvents.on<TrayShiftEvent>('tray:startShift', this.handleTrayShiftEvent);\n    gameEvents.on<TrayRevealEvent>(\n      'tray:startReveal',\n      this.handleTrayRevealEvent\n    );\n  }\n\n  /**\n   * Create the animator context with shared resources.\n   * @returns Context object for animators\n   * @example\n   */\n  private createAnimatorContext(): AnimatorContext {\n    return {\n      activeTimelines: this.activeTimelines,\n      getScrewsInTray: (trayUID) => this.getScrewsInTray(trayUID),\n      getComponents: (entity) => this.getComponents(entity),\n      getAnimationLayer: () => getAnimationLayer(),\n      getColoredTrayLayer: () => getColoredTrayLayer(),\n      getGameVisual: (entity) => getGameVisual(entity) as Sprite | null,\n      getTrayPlaceholders: (entity) => getTrayPlaceholders(entity) ?? null,\n      getTraySlotTargetPosition: (displayOrder, slotIndex, capacity) =>\n        getTraySlotTargetPosition(displayOrder, slotIndex, capacity),\n      getTraySlotPosition: (trayEntity, slotIndex, isBuffer, capacity) =>\n        getTraySlotPosition(trayEntity, slotIndex, isBuffer, capacity),\n    };\n  }\n\n  /**\n   * Find all screw entities currently in a specific tray.\n   * @param trayUID - The UID of the tray to search\n   * @returns Array of screw entities in the tray\n   * @example\n   */\n  private getScrewsInTray(trayUID: string): Entity[] {\n    const screws: Entity[] = [];\n    this.forEachEntity('screws', (entity) => {\n      const screw = this.getComponents<ScrewComponentAccess>(entity).screw;\n      if (screw.state === 'inTray' && screw.trayEntityId === trayUID) {\n        screws.push(entity);\n      }\n    });\n    return screws;\n  }\n\n  /**\n   * Hide a placeholder sprite when a screw fills that slot.\n   * @param trayEntity - The tray entity\n   * @param slotIndex - The slot index that was filled\n   * @example\n   * animationSystem.hidePlaceholder(trayEntity, 0);\n   */\n  public hidePlaceholder(trayEntity: Entity2D, slotIndex: number): void {\n    const placeholders = getTrayPlaceholders(trayEntity);\n    const placeholder = placeholders?.[slotIndex];\n    if (placeholder) {\n      gsap.to(placeholder, { alpha: 0, duration: 0.15, ease: 'linear' });\n    }\n  }\n\n  /**\n   * Update is a no-op for this system.\n   * @param _time - Frame time info (unused)\n   * @example\n   * // Called automatically by ECS each frame\n   * system.update(time);\n   */\n  update(_time: Time): void {\n    // No per-frame updates needed - animations run via GSAP\n  }\n\n  /**\n   * Clean up event listeners and active timelines when system is destroyed.\n   * @example\n   * system.destroy(); // Called automatically by ECS\n   */\n  destroy(): void {\n    // Unregister event listeners\n    gameEvents.off('screw:startRemoval', this.handleRemovalEvent);\n    gameEvents.off('screw:startTransfer', this.handleTransferEvent);\n    gameEvents.off('tray:startHide', this.handleTrayHideEvent);\n    gameEvents.off('tray:startShift', this.handleTrayShiftEvent);\n    gameEvents.off('tray:startReveal', this.handleTrayRevealEvent);\n\n    // Kill active timelines\n    for (const timeline of this.activeTimelines) {\n      timeline.kill();\n    }\n    this.activeTimelines.clear();\n  }\n}\n","import type { Entity, Time } from '@play-co/odie';\nimport { BaseSystem } from './BaseSystem';\nimport {\n  ScrewComponent,\n  TrayComponent,\n  BufferTrayComponent,\n} from '../components';\nimport { ScrewPlacementSystem } from './ScrewPlacementSystem';\nimport { TrayManagementSystem } from './TrayManagementSystem';\nimport type { ScrewTransferEvent } from './AnimationSystem';\nimport type { TrayRevealedEvent } from './TrayManagementSystem';\nimport { gameEvents, gameTick } from '../utils';\nimport type {\n  ScrewComponentAccess,\n  TrayComponentAccess,\n  BufferTrayComponentAccess,\n} from '../types';\n\n/**\n * System for automatically transferring screws from buffer to colored trays.\n *\n * When a screw is removed and placed in a colored tray (or when a new tray\n * is revealed), this system checks if any screws in the buffer can now be\n * moved to their matching colored tray.\n *\n * Transfer rules:\n * - Screws are processed in FIFO order (first in, first out)\n * - Only one transfer happens at a time for visual clarity\n * - Transfer only occurs if the colored tray has space and is visible\n *\n * Listens for:\n * - `screw:removalComplete` - Check for auto-transfer opportunity\n * - `screw:transferComplete` - Check for more transfers\n * - `tray:revealed` - New tray revealed, check for matching buffer screws\n *\n * Emits:\n * - `screw:startTransfer` - Begin transfer animation\n */\nexport class AutoTransferSystem extends BaseSystem {\n  static readonly NAME = 'autoTransfer';\n  static Queries = {\n    coloredTrays: { components: [TrayComponent] },\n    bufferTrays: { components: [BufferTrayComponent] },\n    screws: { components: [ScrewComponent] },\n  };\n\n  /** Flag to prevent multiple simultaneous transfers */\n  private isTransferring = false;\n\n  /**\n   * Bound handler for screw:removalComplete event.\n   * Defers check to allow TrayManagementSystem to process first.\n   * @internal\n   */\n  private handleRemovalComplete = (): void => {\n    // Defer to allow TrayManagementSystem to set isTransitioning first\n    // Both systems listen to screw:removalComplete - if a tray fills,\n    // we need TrayManagement to mark itself busy before we check\n    queueMicrotask(() => {\n      this.checkAutoTransfer();\n    });\n  };\n\n  /**\n   * Bound handler for screw:transferComplete event.\n   * Defers check to allow TrayManagementSystem to process first.\n   * @internal\n   */\n  private handleTransferComplete = (): void => {\n    // Defer to allow TrayManagementSystem to process tray fullness first\n    queueMicrotask(() => {\n      this.onTransferComplete();\n    });\n  };\n\n  /**\n   * Bound handler for tray:revealed event.\n   * Defers check to allow TrayManagementSystem to finalize first.\n   * @internal\n   */\n  private handleTrayRevealed = (): void => {\n    // Defer to ensure tray animations are fully complete\n    queueMicrotask(() => {\n      this.checkAutoTransfer();\n    });\n  };\n\n  /**\n   * Initialize event listeners.\n   * @example\n   * system.init(); // Called automatically by ECS\n   */\n  init(): void {\n    gameEvents.on('screw:removalComplete', this.handleRemovalComplete);\n    gameEvents.on('screw:transferComplete', this.handleTransferComplete);\n    gameEvents.on<TrayRevealedEvent>('tray:revealed', this.handleTrayRevealed);\n  }\n\n  /**\n   * Clean up event listeners.\n   * @example\n   * system.destroy(); // Called automatically by ECS\n   */\n  destroy(): void {\n    gameEvents.off('screw:removalComplete', this.handleRemovalComplete);\n    gameEvents.off('screw:transferComplete', this.handleTransferComplete);\n    gameEvents.off('tray:revealed', this.handleTrayRevealed);\n    this.isTransferring = false;\n  }\n\n  /**\n   * Called when a transfer animation completes.\n   * @example\n   * this.onTransferComplete(); // Called via event\n   */\n  private onTransferComplete(): void {\n    this.isTransferring = false;\n    // Check for more transfers\n    this.checkAutoTransfer();\n  }\n\n  /**\n   * Check if any screws in the buffer can be transferred to colored trays.\n   * @example\n   * this.checkAutoTransfer();\n   */\n  private checkAutoTransfer(): void {\n    if (this.shouldSkipTransferCheck()) return;\n\n    const bufferTray = this.getFirstEntity('bufferTrays');\n    if (!bufferTray) return;\n\n    const buffer =\n      this.getComponents<BufferTrayComponentAccess>(bufferTray).bufferTray;\n    if (buffer.screwIds.length === 0) {\n      gameTick.log('AUTO_TRANSFER_CHECK', ' skipped (buffer empty)');\n      return;\n    }\n\n    this.processBufferScrews(buffer.screwIds, bufferTray);\n  }\n\n  /**\n   * Check if transfer check should be skipped and log reason.\n   * @returns True if should skip\n   * @example\n   * if (this.shouldSkipTransferCheck()) return;\n   */\n  private shouldSkipTransferCheck(): boolean {\n    const transferring = this.isTransferring;\n    const animating = this.anyTrayAnimating();\n    const busy = this.trayManagementBusy();\n\n    gameTick.log(\n      'AUTO_TRANSFER_CHECK',\n      `transferring=${String(transferring)} animating=${String(animating)} busy=${String(busy)}`\n    );\n\n    if (transferring) {\n      gameTick.log('AUTO_TRANSFER_CHECK', ' skipped (already transferring)');\n      return true;\n    }\n    if (animating) {\n      gameTick.log('AUTO_TRANSFER_CHECK', ' skipped (trays animating)');\n      return true;\n    }\n    if (busy) {\n      gameTick.log('AUTO_TRANSFER_CHECK', ' skipped (tray management busy)');\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Process buffer screws in FIFO order, initiating transfer if possible.\n   * @param screwIds - Array of screw UIDs in buffer\n   * @param bufferTray - The buffer tray entity\n   * @example\n   * this.processBufferScrews(buffer.screwIds, bufferTray);\n   */\n  private processBufferScrews(screwIds: string[], bufferTray: Entity): void {\n    gameTick.log(\n      'AUTO_TRANSFER_CHECK',\n      `buffer has ${String(screwIds.length)} screws`\n    );\n\n    for (const screwId of screwIds) {\n      if (this.tryTransferScrew(screwId, bufferTray)) {\n        return; // Only one transfer at a time\n      }\n    }\n  }\n\n  /**\n   * Attempt to transfer a single screw from buffer to colored tray.\n   * @param screwId - The screw UID to transfer\n   * @param bufferTray - The buffer tray entity\n   * @returns True if transfer was initiated\n   * @example\n   * if (this.tryTransferScrew(screwId, bufferTray)) return;\n   */\n  private tryTransferScrew(screwId: string, bufferTray: Entity): boolean {\n    const placementSystem = this.scene.getSystem(ScrewPlacementSystem);\n    const screwEntity = placementSystem.findScrewByUid(screwId);\n\n    if (!screwEntity) {\n      gameTick.log('AUTO_TRANSFER_CHECK', ` screw ${screwId} not found`);\n      return false;\n    }\n\n    const screw = this.getComponents<ScrewComponentAccess>(screwEntity).screw;\n    if (screw.isAnimating) {\n      gameTick.log(\n        'AUTO_TRANSFER_CHECK',\n        ` ${screw.color} screw still animating`\n      );\n      return false;\n    }\n\n    const matchingTray = placementSystem.findAvailableColoredTray(screw.color);\n    if (matchingTray) {\n      this.initiateTransfer(screwEntity, matchingTray, bufferTray);\n      return true;\n    }\n\n    gameTick.log(\n      'AUTO_TRANSFER_CHECK',\n      ` ${screw.color} screw has no matching visible tray`\n    );\n    return false;\n  }\n\n  /**\n   * Check if any colored tray is currently animating.\n   * Used to prevent transfers while trays are shifting/revealing.\n   * @returns True if any tray is animating\n   * @example\n   * if (this.anyTrayAnimating()) return;\n   */\n  private anyTrayAnimating(): boolean {\n    const coloredTrays = this.getEntities('coloredTrays');\n    for (const tray of coloredTrays) {\n      const trayComp = this.getComponents<TrayComponentAccess>(tray).tray;\n      if (trayComp.isAnimating) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Check if TrayManagementSystem is processing or has pending transitions.\n   * This prevents starting transfers when more tray shifts may occur.\n   * @returns True if tray management is busy\n   * @example\n   * if (this.trayManagementBusy()) return;\n   */\n  private trayManagementBusy(): boolean {\n    const trayManagement = this.scene.getSystem(TrayManagementSystem);\n    return trayManagement.isBusy();\n  }\n\n  /**\n   * Start the transfer animation for a screw.\n   * @param screwEntity - The screw entity\n   * @param targetTray - The target tray entity\n   * @param bufferTray - The buffer tray entity\n   * @example\n   * this.initiateTransfer(screwEntity, coloredTray, bufferTray);\n   */\n  private initiateTransfer(\n    screwEntity: Entity,\n    targetTray: Entity,\n    bufferTray: Entity\n  ): void {\n    this.isTransferring = true;\n\n    const buffer =\n      this.getComponents<BufferTrayComponentAccess>(bufferTray).bufferTray;\n    const tray = this.getComponents<TrayComponentAccess>(targetTray).tray;\n    const screw = this.getComponents<ScrewComponentAccess>(screwEntity).screw;\n\n    // Remove from buffer\n    const screwUid = String(screwEntity.UID);\n    const bufferIndex = buffer.screwIds.indexOf(screwUid);\n    if (bufferIndex >= 0) {\n      buffer.screwIds.splice(bufferIndex, 1);\n    }\n\n    // Reserve slot in colored tray\n    const slotIndex = tray.screwCount;\n    tray.screwCount++;\n\n    // Log transfer action for debugging/test reproduction\n    gameTick.log(\n      'TRANSFER',\n      `${screw.color} screw from buffer  ${tray.color} tray [slot ${String(slotIndex)}]`\n    );\n\n    // Update screw state\n    screw.isAnimating = true;\n\n    // Emit transfer event for AnimationSystem\n    const event: ScrewTransferEvent = {\n      screwEntity,\n      targetTray,\n      slotIndex,\n    };\n\n    gameEvents.emit('screw:startTransfer', event);\n  }\n\n  /**\n   * Update is a no-op for this system.\n   * @param _time - Frame time info (unused)\n   * @example\n   * system.update(time); // Called automatically by ECS\n   */\n  update(_time: Time): void {\n    // No per-frame updates needed - all logic is event-driven\n  }\n}\n","import type { Time } from '@play-co/odie';\nimport { BaseSystem } from './BaseSystem';\nimport { ScrewComponent, GameStateComponent } from '../components';\nimport { ScrewPlacementSystem } from './ScrewPlacementSystem';\nimport { gameEvents } from '../utils';\nimport type { ScrewComponentAccess, GameStateComponentAccess } from '../types';\n\n/**\n * System for detecting win and stuck conditions.\n *\n * This system monitors the game state after each screw removal and\n * determines if the player has won or is stuck (soft lock).\n *\n * Win conditions:\n * - `allScrewsRemoved`: All screws have been removed from the puzzle\n *\n * Stuck condition:\n * - No valid moves available (buffer full and no matching tray space)\n *\n * Listens for:\n * - `screw:removalComplete` - Check win/stuck after removal\n * - `screw:transferComplete` - Re-check stuck condition after transfer\n *\n * Emits:\n * - `game:won` - Player has won the level\n * - `game:stuck` - Player is stuck (soft lock)\n */\nexport class WinConditionSystem extends BaseSystem {\n  static readonly NAME = 'winCondition';\n  static Queries = {\n    gameState: { components: [GameStateComponent] },\n    screws: { components: [ScrewComponent] },\n  };\n\n  /**\n   * Bound handler for screw:removalComplete event.\n   * @internal\n   */\n  private handleRemovalComplete = (): void => {\n    this.checkConditions();\n  };\n\n  /**\n   * Bound handler for screw:transferComplete event.\n   * @internal\n   */\n  private handleTransferComplete = (): void => {\n    this.checkStuckCondition();\n  };\n\n  /**\n   * Initialize event listeners.\n   * @example\n   * system.init(); // Called automatically by ECS\n   */\n  init(): void {\n    gameEvents.on('screw:removalComplete', this.handleRemovalComplete);\n    gameEvents.on('screw:transferComplete', this.handleTransferComplete);\n  }\n\n  /**\n   * Clean up event listeners.\n   * @example\n   * system.destroy(); // Called automatically by ECS\n   */\n  destroy(): void {\n    gameEvents.off('screw:removalComplete', this.handleRemovalComplete);\n    gameEvents.off('screw:transferComplete', this.handleTransferComplete);\n  }\n\n  /**\n   * Check both win and stuck conditions.\n   * @example\n   * this.checkConditions();\n   */\n  private checkConditions(): void {\n    const gameStateEntity = this.getFirstEntity('gameState');\n    if (!gameStateEntity) return;\n\n    const gameState =\n      this.getComponents<GameStateComponentAccess>(gameStateEntity).gameState;\n\n    // Skip if game is already over\n    if (gameState.phase !== 'playing') return;\n\n    // Update removed count\n    gameState.removedScrews++;\n\n    // Check win condition\n    if (this.checkWinCondition(gameState.winConditionType)) {\n      gameState.phase = 'won';\n      gameEvents.emit('game:won');\n      return;\n    }\n\n    // Check stuck condition\n    this.checkStuckCondition();\n  }\n\n  /**\n   * Check if the win condition is met.\n   * @param winType - The type of win condition to check\n   * @returns True if the win condition is met\n   * @example\n   * const won = this.checkWinCondition('allScrewsRemoved');\n   */\n  private checkWinCondition(winType: string): boolean {\n    switch (winType) {\n      case 'allScrewsRemoved':\n        return this.checkAllScrewsRemoved();\n\n      // Future win conditions can be added here\n      // case 'partsRemoved':\n      // case 'targetFreed':\n\n      default:\n        return this.checkAllScrewsRemoved();\n    }\n  }\n\n  /**\n   * Count how many screws are still in the board.\n   * @returns Number of screws with state 'inBoard'\n   * @example\n   * const remaining = this.countInBoardScrews();\n   */\n  private countInBoardScrews(): number {\n    return this.getEntities('screws').filter(\n      (entity) =>\n        this.getComponents<ScrewComponentAccess>(entity).screw.state ===\n        'inBoard'\n    ).length;\n  }\n\n  /**\n   * Check if all screws have been removed from the puzzle.\n   * @returns True if no screws remain in the board\n   * @example\n   * const allRemoved = this.checkAllScrewsRemoved();\n   */\n  private checkAllScrewsRemoved(): boolean {\n    return this.countInBoardScrews() === 0;\n  }\n\n  /**\n   * Check if the player is stuck (no valid moves).\n   * @example\n   * this.checkStuckCondition();\n   */\n  private checkStuckCondition(): void {\n    const gameStateEntity = this.getFirstEntity('gameState');\n    if (!gameStateEntity) return;\n\n    const gameState =\n      this.getComponents<GameStateComponentAccess>(gameStateEntity).gameState;\n\n    // Skip if game is already over\n    if (gameState.phase !== 'playing') return;\n\n    // Get placement system to check valid moves\n    const placementSystem = this.scene.getSystem(ScrewPlacementSystem);\n\n    if (!placementSystem.hasValidMoves()) {\n      // Only stuck if there are screws remaining\n      if (this.countInBoardScrews() > 0) {\n        gameState.phase = 'stuck';\n        gameEvents.emit('game:stuck');\n      }\n    }\n  }\n\n  /**\n   * Update is a no-op for this system.\n   * @param _time - Frame time info (unused)\n   * @example\n   * system.update(time); // Called automatically by ECS\n   */\n  update(_time: Time): void {\n    // No per-frame updates needed - all logic is event-driven\n  }\n}\n","/**\n * Global Error Capture for Test Harness\n *\n * This module sets up global error handlers that capture all uncaught\n * errors and unhandled promise rejections into the test harness.\n * This enables E2E tests to verify that no errors occurred during test runs.\n *\n * @example\n * // Verify no errors in E2E test\n * const errors = await page.evaluate(() => window.__gameTest?.errors);\n * expect(errors).toHaveLength(0);\n *\n * @module\n */\n\n/**\n * Sets up global error handlers to capture errors into the test harness.\n *\n * Captures:\n * - Uncaught exceptions (window 'error' event)\n * - Unhandled promise rejections (window 'unhandledrejection' event)\n *\n * Errors are stored in `window.__gameTest.errors` with:\n * - Error message\n * - Stack trace (if available)\n * - Timestamp\n * - Source location\n *\n * This function is called automatically by `initTestHarness()`.\n *\n * @example\n * // Already called by initTestHarness, but can be called directly\n * import { setupErrorCapture } from './errorCapture';\n *\n * setupErrorCapture();\n *\n * @example\n * // In E2E test, check for errors after an action\n * await page.click('#dangerousButton');\n *\n * const errors = await page.evaluate(() => window.__gameTest?.errors);\n * if (errors && errors.length > 0) {\n *   console.error('Errors occurred:', errors);\n *   throw new Error(`Found ${errors.length} error(s)`);\n * }\n */\nexport function setupErrorCapture(): void {\n  // Capture uncaught errors\n  window.addEventListener('error', (event) => {\n    const error: unknown = event.error;\n    if (window.__gameTest) {\n      window.__gameTest.captureError(\n        error instanceof Error ? error : new Error(event.message),\n        `${event.filename}:${String(event.lineno)}:${String(event.colno)}`\n      );\n    }\n  });\n\n  // Capture unhandled promise rejections\n  window.addEventListener('unhandledrejection', (event) => {\n    if (window.__gameTest) {\n      const reason: unknown = event.reason;\n      window.__gameTest.captureError(\n        reason instanceof Error ? reason : new Error(String(reason)),\n        'unhandledrejection'\n      );\n    }\n  });\n}\n","/**\n * URL Parameter Utilities for Test Configuration\n *\n * This module provides functions to parse URL parameters that control\n * test behavior. These parameters allow E2E tests to configure the game\n * for deterministic, reproducible testing.\n *\n * @example\n * // Common test URLs:\n * // Basic test mode\n * // http://localhost:5173/?testMode\n *\n * // Skip intro and mute audio\n * // http://localhost:5173/?testMode&skipIntro&muteAudio\n *\n * // Deterministic seed for randomness\n * // http://localhost:5173/?testMode&seed=12345\n *\n * // Skip to specific scene\n * // http://localhost:5173/?testMode&scene=BossLevel\n *\n * @module\n */\n\n/**\n * Configuration parameters parsed from the URL query string.\n *\n * These parameters control test behavior and can be used to make\n * tests more deterministic and faster.\n *\n * @example\n * // Check parameters in game code\n * import { getTestParams } from '@shared/debug';\n *\n * const params = getTestParams();\n * if (params.muteAudio) {\n *   // Don't play audio\n * }\n * if (params.skipIntro) {\n *   // Skip splash screen\n * }\n * if (params.seed !== undefined) {\n *   // Use seed for deterministic random\n *   Math.seedrandom(params.seed);\n * }\n */\nexport interface TestParams {\n  /** True if running in test mode (testMode param present) */\n  testMode: boolean;\n  /** Random seed for deterministic randomness */\n  seed?: number | undefined;\n  /** Scene name to skip directly to */\n  scene?: string | undefined;\n  /** True to mute all audio (muteAudio param present) */\n  muteAudio: boolean;\n  /** True to skip intro/splash screens (skipIntro param present) */\n  skipIntro: boolean;\n  /** Region ID to load (e.g., 'test' loads regions/region-test.json) */\n  region?: string | undefined;\n  /** Level index within the region (0-based) */\n  level?: number | undefined;\n}\n\n/**\n * Parses URL query parameters for test configuration.\n *\n * Supported parameters:\n * - `testMode` - Enables test mode and harness\n * - `seed=<number>` - Sets random seed for determinism\n * - `scene=<name>` - Skip to specific scene\n * - `muteAudio` - Disables all audio\n * - `skipIntro` - Skips intro/splash screens\n *\n * @returns Parsed test parameters with defaults\n *\n * @example\n * import { getTestParams } from '@shared/debug';\n *\n * // URL: /?testMode&seed=42&skipIntro\n * const params = getTestParams();\n * // params = {\n * //   testMode: true,\n * //   seed: 42,\n * //   scene: undefined,\n * //   muteAudio: false,\n * //   skipIntro: true\n * // }\n *\n * @example\n * // Use in game initialization\n * const params = getTestParams();\n *\n * if (params.scene) {\n *   // Skip to the specified scene\n *   screens.show(params.scene);\n * } else if (params.skipIntro) {\n *   // Skip intro, go directly to game\n *   screens.show('GameScreen');\n * } else {\n *   // Normal flow\n *   screens.show('IntroScreen');\n * }\n */\nexport function getTestParams(): TestParams {\n  const params = new URLSearchParams(window.location.search);\n  const seedParam = params.get('seed');\n  const levelParam = params.get('level');\n\n  return {\n    testMode: params.has('testMode') || params.get('testMode') === '1',\n    seed: seedParam !== null ? parseInt(seedParam, 10) : undefined,\n    scene: params.get('scene') ?? undefined,\n    muteAudio: params.has('muteAudio') || params.get('muteAudio') === '1',\n    skipIntro: params.has('skipIntro') || params.get('skipIntro') === '1',\n    region: params.get('region') ?? undefined,\n    level: levelParam !== null ? parseInt(levelParam, 10) : undefined,\n  };\n}\n\n/**\n * Checks if the application is running in test mode.\n *\n * Test mode is enabled when either:\n * - The `testMode` URL parameter is present\n * - Running with Vite's test mode (`import.meta.env.MODE === 'test'`)\n *\n * @returns True if in test mode\n *\n * @example\n * import { isTestMode } from '@shared/debug';\n *\n * if (isTestMode()) {\n *   // Disable animations for faster tests\n *   gsap.globalTimeline.timeScale(100);\n * }\n *\n * @example\n * // Conditional test-only features\n * if (isTestMode()) {\n *   // Register scene with test harness\n *   window.__gameTest?.registerScene(this.scene);\n * }\n */\nexport function isTestMode(): boolean {\n  return getTestParams().testMode || import.meta.env.MODE === 'test';\n}\n","/**\n * ECS Access Layer for Test Harness\n *\n * This module provides the ECS access implementation that allows E2E tests\n * to inspect ODIE entities and their components. It handles serialization\n * of entity state to plain objects for cross-context access.\n *\n * @example\n * // In E2E tests, access via the harness\n * const entities = await page.evaluate(() =>\n *   window.__gameTest?.ecs.getEntities()\n * );\n *\n * @module\n */\n\nimport type { EntitySnapshot, ECSAccess } from '../types';\n\n/**\n * Internal interface for ECS access that includes the scene setter.\n *\n * The `_setScene` method is used internally by the harness when a scene\n * is registered. Application code should use `registerScene()` on the\n * harness instead.\n */\nexport interface ECSAccessInternal extends ECSAccess {\n  /**\n   * Internal method to set the scene reference.\n   * @internal\n   */\n  _setScene(scene: unknown): void;\n}\n\n/**\n * Checks if a property should be skipped during serialization.\n *\n * @param key - Property key\n * @param value - Property value\n * @returns True if the property should be skipped\n *\n * @example\n * shouldSkipProperty('_internal', {}); // true\n */\n/** Properties to skip entirely during component serialization */\nconst SKIP_PROPERTIES = new Set([\n  'constructor',\n  'entity', // Circular ref: component  entity (not needed, entity ID is in parent)\n  'scene', // Circular ref to scene\n  'parent', // Circular ref to parent container\n  'children', // Can be huge and redundant with display tree\n]);\n\n/** Properties to convert to UID references */\nconst UID_REF_PROPERTIES = new Set([\n  'view', // Convert view (display object) to viewUid reference\n]);\n\nfunction shouldSkipProperty(key: string, value: unknown): boolean {\n  return (\n    typeof value === 'function' ||\n    key.startsWith('_') ||\n    SKIP_PROPERTIES.has(key)\n  );\n}\n\n/**\n * Extracts serializable value from a property.\n * @param v - The value to extract\n * @param depth - Current recursion depth\n * @returns Object with include flag and extracted value\n * @example\n */\nfunction extractPropertyValue(\n  v: unknown,\n  depth: number\n): { include: boolean; value: unknown } {\n  if (v === null || v === undefined) return { include: true, value: v };\n  if (typeof v !== 'object') return { include: true, value: v };\n  if (Array.isArray(v) && (v.length === 0 || typeof v[0] !== 'object')) {\n    return { include: true, value: v };\n  }\n  if (!Array.isArray(v)) {\n    const nested = serializeObjectValue(v, depth + 1);\n    if (nested !== '[max depth]') return { include: true, value: nested };\n  }\n  return { include: false, value: null };\n}\n\n/**\n * Serializes an object value with fallback handling.\n * For complex objects that can't be directly serialized, extracts primitive values.\n *\n * @param value - The object to serialize\n * @param depth - Current recursion depth (max 3)\n * @returns Serialized representation of the value\n *\n * @example\n * serializeObjectValue({ x: 1, y: 2 }); // { x: 1, y: 2 }\n */\nfunction serializeObjectValue(value: unknown, depth = 0): unknown {\n  if (depth > 3) return '[max depth]';\n\n  // Try direct JSON serialization first\n  try {\n    return JSON.parse(JSON.stringify(value)) as unknown;\n  } catch {\n    // Fall through to manual extraction\n  }\n\n  if (typeof value !== 'object' || value === null) return value;\n\n  const obj = value as Record<string, unknown>;\n  const result: Record<string, unknown> = {};\n\n  for (const key of Object.keys(obj)) {\n    if (shouldSkipProperty(key, obj[key])) continue;\n    const { include, value: v } = extractPropertyValue(obj[key], depth);\n    if (include) result[key] = v;\n  }\n\n  return Object.keys(result).length > 0 ? result : '[complex object]';\n}\n\n/**\n * Extracts UID from a display object if available.\n * @param obj - The object to extract UID from\n * @returns The UID string or null\n * @example\n */\nfunction extractUid(obj: unknown): string | null {\n  if (obj && typeof obj === 'object') {\n    const o = obj as Record<string, unknown>;\n    const uid = o.uid ?? o.UID;\n    if (typeof uid === 'string') return uid;\n    if (typeof uid === 'number') return uid.toString();\n  }\n  return null;\n}\n\n/**\n * Serializes a component instance to a plain object.\n *\n * @param component - The component instance to serialize\n * @returns Plain object with component data\n *\n * @example\n * serializeComponent({ health: 100, _internal: {} }); // { health: 100 }\n */\nfunction serializeComponent(component: unknown): unknown {\n  if (component === null || component === undefined) {\n    return null;\n  }\n\n  const result: Record<string, unknown> = {};\n  const comp = component as Record<string, unknown>;\n\n  for (const key of Object.keys(comp)) {\n    const value = comp[key];\n    if (shouldSkipProperty(key, value)) {\n      continue;\n    }\n    // Convert view to viewUid reference\n    if (UID_REF_PROPERTIES.has(key)) {\n      const uid = extractUid(value);\n      if (uid !== null) {\n        result[`${key}Uid`] = uid;\n      }\n      continue;\n    }\n    if (value === null || typeof value !== 'object') {\n      result[key] = value;\n    } else if (Array.isArray(value)) {\n      result[key] = value;\n    } else {\n      result[key] = serializeObjectValue(value);\n    }\n  }\n\n  return result;\n}\n\n/** Entity shape for type casting. */\ninterface EntityShape {\n  UID?: string;\n  uid?: string;\n  constructor?: { name: string };\n  position?: { x: number; y: number };\n  scale?: { x: number; y: number };\n  rotation?: number;\n  visible?: boolean;\n  alpha?: number;\n  view?: {\n    getBounds?: () => { x: number; y: number; width: number; height: number };\n    children?: unknown[];\n  };\n  c?: Map<string, unknown> | Record<string, unknown>;\n  components?: Map<string, unknown> | Record<string, unknown>;\n}\n\n/**\n * Extracts and serializes components from an entity.\n *\n * @param e - The entity shape\n * @returns Serialized components object\n *\n * @example\n * const components = extractComponents(entity);\n */\nfunction extractComponents(e: EntityShape): Record<string, unknown> {\n  const components: Record<string, unknown> = {};\n  const source = e.c ?? e.components;\n  if (source instanceof Map) {\n    source.forEach((c, name) => {\n      components[name] = serializeComponent(c);\n    });\n  } else if (source && typeof source === 'object') {\n    for (const [name, c] of Object.entries(source)) {\n      components[name] = serializeComponent(c);\n    }\n  }\n  return components;\n}\n\n/**\n * Gets the bounds of an entity's view safely.\n *\n * @param e - The entity shape\n * @returns Bounds object or null\n *\n * @example\n * const bounds = getEntityBounds(entity);\n */\nfunction getEntityBounds(e: EntityShape): EntitySnapshot['bounds'] {\n  try {\n    if (e.view?.getBounds) {\n      const b = e.view.getBounds();\n      return { x: b.x, y: b.y, width: b.width, height: b.height };\n    }\n  } catch {\n    // Bounds calculation may fail\n  }\n  return null;\n}\n\n/**\n * Serializes an ODIE Entity2D to an EntitySnapshot.\n *\n * @param entity - The ODIE entity to serialize\n * @returns EntitySnapshot with serialized entity state\n *\n * @example\n * const snapshot = serializeEntity(entity);\n */\nfunction serializeEntity(entity: unknown): EntitySnapshot {\n  const e = entity as EntityShape;\n  return {\n    id: e.UID ?? e.uid ?? 'unknown',\n    type: e.constructor?.name ?? 'Entity',\n    position: { x: e.position?.x ?? 0, y: e.position?.y ?? 0 },\n    scale: { x: e.scale?.x ?? 1, y: e.scale?.y ?? 1 },\n    rotation: e.rotation ?? 0,\n    visible: e.visible ?? true,\n    alpha: e.alpha ?? 1,\n    bounds: getEntityBounds(e),\n    components: extractComponents(e),\n    childCount: e.view?.children?.length ?? 0,\n  };\n}\n\n/**\n * Gets all entities from a scene reference.\n *\n * @param sceneRef - The scene reference\n * @returns Array of serialized entity snapshots\n *\n * @example\n * const entities = getAllEntities(sceneRef);\n */\nfunction getAllEntities(sceneRef: unknown): EntitySnapshot[] {\n  if (!sceneRef) {\n    return [];\n  }\n  const scene = sceneRef as { allEntities?: { children?: unknown[] } };\n  const entities = scene.allEntities?.children ?? [];\n  return entities.map((entity) => serializeEntity(entity));\n}\n\n/**\n * Extracts system names from a Scene2D reference.\n *\n * ODIE Scene2D stores systems in an internal map. This function\n * attempts to extract system names via the NAME static property.\n *\n * @param sceneRef - The scene reference\n * @returns Array of system names, or empty array if unavailable\n *\n * @example\n * const systems = getSystemNames(sceneRef);\n * // Returns: ['screwPlacement', 'animation', 'screwInteraction', ...]\n */\nfunction getSystemNames(sceneRef: unknown): string[] {\n  if (!sceneRef) {\n    return [];\n  }\n\n  // ODIE Scene2D has a systems Map<string, System>\n  const scene = sceneRef as { systems?: Map<string, unknown> };\n  if (!scene.systems || !(scene.systems instanceof Map)) {\n    return [];\n  }\n\n  // The Map keys are the system names\n  return Array.from(scene.systems.keys());\n}\n\n/**\n * Creates an ECS access layer for the test harness.\n *\n * @returns ECSAccessInternal instance with query methods and scene setter\n *\n * @example\n * const ecsAccess = createECSAccess();\n * ecsAccess._setScene(scene);\n * const entities = ecsAccess.getEntities();\n */\nexport function createECSAccess(): ECSAccessInternal {\n  let sceneRef: unknown = null;\n\n  const getEntities = (): EntitySnapshot[] => getAllEntities(sceneRef);\n\n  const getEntity = (id: string): EntitySnapshot | null =>\n    getEntities().find((e) => String(e.id) === id) ?? null;\n\n  return {\n    getScene: (): unknown => sceneRef,\n    getEntities,\n    getEntity,\n    queryByComponent: (name: string): EntitySnapshot[] =>\n      getEntities().filter((e) => name in e.components),\n    getEntityCount: (): number => getEntities().length,\n    hasEntity: (id: string): boolean => getEntity(id) !== null,\n    getSystems: (): string[] => getSystemNames(sceneRef),\n    _setScene: (scene: unknown): void => {\n      sceneRef = scene;\n    },\n  };\n}\n","/**\n * Render Signature Generation\n *\n * This module creates deterministic snapshots of the render state that can\n * be used to detect changes between frames. The signature includes all\n * entity state and a hash for quick comparison.\n *\n * @example\n * // Check if render state changed\n * const sig1 = harness.getRenderSignature();\n * // ... perform action ...\n * const sig2 = harness.getRenderSignature();\n *\n * if (sig1.hash !== sig2.hash) {\n *   console.log('Render state changed');\n * }\n *\n * @module\n */\n\nimport type { EntitySnapshot, RenderSignature } from '../types';\n\n/** Frame counter for tracking render iterations */\nlet frameCounter = 0;\n\n/**\n * Creates a simple hash from a string using the djb2 algorithm.\n *\n * This provides fast, reasonably distributed hashes suitable for\n * quick equality comparisons (not cryptographic use).\n *\n * @param str - String to hash\n * @returns Hexadecimal hash string\n * @internal\n */\nfunction simpleHash(str: string): string {\n  let hash = 5381;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = (hash << 5) + hash + char; // hash * 33 + char\n    hash = hash & hash; // Convert to 32bit integer\n  }\n  // Convert to unsigned and then to hex\n  return (hash >>> 0).toString(16);\n}\n\n/**\n * Converts an entity snapshot to a deterministic string for hashing.\n *\n * The string includes all entity properties in a consistent order\n * to ensure the same entity state always produces the same string.\n *\n * @param entity - Entity snapshot to convert\n * @returns Deterministic string representation\n * @internal\n */\nfunction entityToHashString(entity: EntitySnapshot): string {\n  const pos = `${entity.position.x.toFixed(2)},${entity.position.y.toFixed(2)}`;\n  const scale = `${entity.scale.x.toFixed(2)},${entity.scale.y.toFixed(2)}`;\n  const rot = entity.rotation.toFixed(4);\n  const vis = entity.visible ? '1' : '0';\n  const alpha = entity.alpha.toFixed(2);\n\n  // Sort component keys for determinism\n  const componentKeys = Object.keys(entity.components).sort();\n  const componentsStr = componentKeys\n    .map((k) => `${k}:${JSON.stringify(entity.components[k])}`)\n    .join(';');\n\n  const idStr =\n    typeof entity.id === 'number' ? entity.id.toString() : entity.id;\n  return `${idStr}|${entity.type}|${pos}|${scale}|${rot}|${vis}|${alpha}|${componentsStr}`;\n}\n\n/**\n * Creates a render signature generator function.\n *\n * The generator captures the current state of all entities and produces\n * a RenderSignature object with a deterministic hash. This can be used\n * to detect state changes between calls.\n *\n * @param getEntities - Function that returns all entity snapshots\n * @param getSceneState - Function that returns current scene state\n * @param getSystems - Optional function that returns system names\n * @returns Function that generates RenderSignature on each call\n *\n * @example\n * const getRenderSignature = createRenderSignatureGenerator(\n *   () => ecsAccess.getEntities(),\n *   () => sceneState,\n *   () => ecsAccess.getSystems()\n * );\n *\n * const sig = getRenderSignature();\n * console.log(`Frame ${sig.frame}: ${sig.entityCount} entities, hash=${sig.hash}`);\n */\nexport function createRenderSignatureGenerator(\n  getEntities: () => EntitySnapshot[],\n  getSceneState: () => 'running' | 'paused' | 'stopped',\n  getSystems?: () => string[]\n): () => RenderSignature {\n  return (): RenderSignature => {\n    const entities = getEntities();\n    const timestamp = performance.now();\n    const currentFrame = frameCounter++;\n\n    // Sort entities by ID for deterministic ordering\n    // Handle both string and numeric IDs\n    const sortedEntities = [...entities].sort((a, b) => {\n      const aId = typeof a.id === 'number' ? a.id.toString() : a.id;\n      const bId = typeof b.id === 'number' ? b.id.toString() : b.id;\n      return aId.localeCompare(bId);\n    });\n\n    // Generate deterministic hash from entity state\n    const hashInput = sortedEntities.map(entityToHashString).join('||');\n    const hash = simpleHash(hashInput);\n\n    return {\n      timestamp,\n      frame: currentFrame,\n      entityCount: entities.length,\n      entities: sortedEntities,\n      systems: getSystems?.() ?? [],\n      sceneState: getSceneState(),\n      hash,\n    };\n  };\n}\n\n/**\n * Resets the frame counter to zero.\n *\n * Useful for unit tests that need deterministic frame numbers.\n * Not typically needed in E2E tests.\n *\n * @example\n * // In unit test setup\n * beforeEach(() => {\n *   resetFrameCounter();\n * });\n */\nexport function resetFrameCounter(): void {\n  frameCounter = 0;\n}\n","/**\n * Action DSL Executor for Test Harness\n *\n * This module implements the action execution system that allows E2E tests\n * to manipulate game state and simulate user input. Actions are declarative\n * objects that describe what should happen.\n *\n * Supported action types:\n * - Entity manipulation: setPosition, setComponent, setVisible, destroyEntity\n * - Scene control: pause, resume, tick\n * - Input simulation: pointerDown, pointerUp, pointerMove, keyDown, keyUp\n * - Timing: wait\n *\n * @example\n * // Move an entity and wait\n * await harness.actMany([\n *   { type: 'setPosition', entityId: '123', x: 100, y: 200 },\n *   { type: 'wait', ms: 100 }\n * ]);\n *\n * @module\n */\n\nimport type { TestAction, ActionResult, RecordedAction } from '../types';\n\n// ============================================================================\n// Action Recording for Bug Reports\n// ============================================================================\n\n/** Maximum number of actions to retain in the recording buffer */\nconst MAX_RECORDED_ACTIONS = 200;\n\n/** Storage for recorded actions */\nlet recordedActions: RecordedAction[] = [];\n\n/**\n * Record an action for later inclusion in bug reports.\n * Only records pointer and keyboard actions (not entity manipulation).\n *\n * @param action - The action that was executed\n * @internal\n */\nfunction recordAction(action: TestAction): void {\n  // Only record user input actions, not entity manipulation\n  const inputTypes = [\n    'pointerDown',\n    'pointerUp',\n    'pointerMove',\n    'keyDown',\n    'keyUp',\n  ];\n  if (!inputTypes.includes(action.type)) {\n    return;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  const tick = window.__gameTest?.tick?.current ?? -1;\n  const entry: RecordedAction = {\n    action,\n    tick,\n    timestamp: performance.now(),\n  };\n\n  recordedActions.push(entry);\n\n  // Trim to max size (circular buffer behavior)\n  if (recordedActions.length > MAX_RECORDED_ACTIONS) {\n    recordedActions = recordedActions.slice(-MAX_RECORDED_ACTIONS);\n  }\n}\n\n/**\n * Get a copy of all recorded actions.\n * Used for including user input history in bug reports.\n *\n * @returns Array of recorded action entries\n *\n * @example\n * const actions = getRecordedActions();\n * console.log(`Recorded ${actions.length} user actions`);\n */\nexport function getRecordedActions(): RecordedAction[] {\n  return [...recordedActions];\n}\n\n/**\n * Clear all recorded actions.\n *\n * @example\n * // Clear after submitting bug report\n * clearRecordedActions();\n */\nexport function clearRecordedActions(): void {\n  recordedActions = [];\n}\n\n/**\n * Finds an entity by ID in the ODIE scene.\n *\n * @param scene - ODIE Scene2D instance\n * @param entityId - Entity ID to find\n * @returns Entity or null if not found\n *\n * @example\n * const entity = findEntity(scene, '123');\n */\nfunction findEntity(scene: unknown, entityId: string | number): unknown {\n  const s = scene as { allEntities?: { children?: unknown[] } };\n  const entities = s.allEntities?.children ?? [];\n  const targetId =\n    typeof entityId === 'number' ? entityId.toString() : entityId;\n\n  return (\n    entities.find((e: unknown) => {\n      const entity = e as { UID?: string | number; uid?: string };\n      const id = entity.UID ?? entity.uid;\n      const idStr = typeof id === 'number' ? id.toString() : id;\n      return idStr === targetId;\n    }) ?? null\n  );\n}\n\n/**\n * Gets a component from an entity by name.\n *\n * @param entity - The entity to query\n * @param componentName - Name of the component\n * @returns The component or null if not found\n *\n * @example\n * const health = getEntityComponent(entity, 'health');\n */\nfunction getEntityComponent(entity: unknown, componentName: string): unknown {\n  const e = entity as {\n    c?: Record<string, unknown>;\n    components?: Map<string, unknown>;\n  };\n  const source = e.c ?? e.components;\n  if (!source) {\n    return null;\n  }\n  if (source instanceof Map) {\n    return source.get(componentName) ?? null;\n  }\n  return source[componentName] ?? null;\n}\n\n/**\n * Executes a setPosition action on an entity.\n *\n * @param scene - The ODIE scene\n * @param entityId - Target entity ID\n * @param x - New X position\n * @param y - New Y position\n * @returns Action result indicating success or failure\n *\n * @example\n * executeSetPosition(scene, '123', 100, 200);\n */\nfunction executeSetPosition(\n  scene: unknown,\n  entityId: string,\n  x: number,\n  y: number\n): ActionResult {\n  if (!scene) {\n    return { success: false, error: 'Scene not available' };\n  }\n  const entity = findEntity(scene, entityId);\n  if (!entity) {\n    return { success: false, error: `Entity ${entityId} not found` };\n  }\n  const e = entity as { position?: { set: (x: number, y: number) => void } };\n  if (!e.position?.set) {\n    return { success: false, error: 'Entity has no position property' };\n  }\n  e.position.set(x, y);\n  return { success: true };\n}\n\n/**\n * Executes a setComponent action to update component data.\n *\n * @param scene - The ODIE scene\n * @param entityId - Target entity ID\n * @param componentName - Name of the component to update\n * @param data - Data to merge into the component\n * @returns Action result indicating success or failure\n *\n * @example\n * executeSetComponent(scene, '123', 'health', { current: 50 });\n */\nfunction executeSetComponent(\n  scene: unknown,\n  entityId: string,\n  componentName: string,\n  data: Record<string, unknown>\n): ActionResult {\n  if (!scene) {\n    return { success: false, error: 'Scene not available' };\n  }\n  const entity = findEntity(scene, entityId);\n  if (!entity) {\n    return { success: false, error: `Entity ${entityId} not found` };\n  }\n  const component = getEntityComponent(entity, componentName);\n  if (!component) {\n    return { success: false, error: `Component ${componentName} not found` };\n  }\n  Object.assign(component, data);\n  return { success: true };\n}\n\n/**\n * Executes a setVisible action on an entity.\n *\n * @param scene - The ODIE scene\n * @param entityId - Target entity ID\n * @param visible - New visibility state\n * @returns Action result indicating success or failure\n *\n * @example\n * executeSetVisible(scene, '123', false);\n */\nfunction executeSetVisible(\n  scene: unknown,\n  entityId: string,\n  visible: boolean\n): ActionResult {\n  if (!scene) {\n    return { success: false, error: 'Scene not available' };\n  }\n  const entity = findEntity(scene, entityId);\n  if (!entity) {\n    return { success: false, error: `Entity ${entityId} not found` };\n  }\n  (entity as { visible?: boolean }).visible = visible;\n  return { success: true };\n}\n\n/**\n * Executes a destroyEntity action.\n *\n * @param scene - The ODIE scene\n * @param entityId - Target entity ID to destroy\n * @returns Action result indicating success or failure\n *\n * @example\n * executeDestroyEntity(scene, '123');\n */\nfunction executeDestroyEntity(scene: unknown, entityId: string): ActionResult {\n  if (!scene) {\n    return { success: false, error: 'Scene not available' };\n  }\n  const entity = findEntity(scene, entityId);\n  if (!entity) {\n    return { success: false, error: `Entity ${entityId} not found` };\n  }\n  const s = scene as { removeChild?: (entity: unknown) => void };\n  if (!s.removeChild) {\n    return { success: false, error: 'Scene has no removeChild method' };\n  }\n  s.removeChild(entity);\n  return { success: true };\n}\n\n/**\n * Executes a pause action on the scene.\n *\n * @param scene - The ODIE scene to pause\n * @returns Action result indicating success or failure\n *\n * @example\n * executePause(scene);\n */\nfunction executePause(scene: unknown): ActionResult {\n  if (!scene) {\n    return { success: false, error: 'Scene not available' };\n  }\n  (scene as { paused?: boolean }).paused = true;\n  return { success: true };\n}\n\n/**\n * Executes a resume action on the scene.\n *\n * @param scene - The ODIE scene to resume\n * @returns Action result indicating success or failure\n *\n * @example\n * executeResume(scene);\n */\nfunction executeResume(scene: unknown): ActionResult {\n  if (!scene) {\n    return { success: false, error: 'Scene not available' };\n  }\n  (scene as { paused?: boolean }).paused = false;\n  return { success: true };\n}\n\n/**\n * Executes a tick action to manually advance the scene.\n *\n * @param scene - The ODIE scene\n * @param deltaMs - Time delta in milliseconds\n * @returns Action result indicating success or failure\n *\n * @example\n * executeTick(scene, 16.67);\n */\nfunction executeTick(scene: unknown, deltaMs: number): ActionResult {\n  if (!scene) {\n    return { success: false, error: 'Scene not available' };\n  }\n  const s = scene as { update?: (delta: number) => void };\n  if (!s.update) {\n    return { success: false, error: 'Scene has no update method' };\n  }\n  s.update(deltaMs);\n  return { success: true };\n}\n\n/**\n * Executes a pointer event on the canvas.\n *\n * Coordinates are in game-space (logical canvas coordinates). These are\n * automatically scaled to screen-space based on the canvas's display size\n * vs its logical dimensions.\n *\n * @param eventType - Type of pointer event\n * @param canvas - Target canvas element\n * @param x - X coordinate in game-space (logical canvas coordinates)\n * @param y - Y coordinate in game-space (logical canvas coordinates)\n * @param button - Mouse button (default 0)\n * @returns Action result indicating success or failure\n *\n * @example\n * executePointerEvent('pointerdown', canvas, 100, 200, 0);\n */\nfunction executePointerEvent(\n  eventType: 'pointerdown' | 'pointerup' | 'pointermove',\n  canvas: HTMLCanvasElement | null,\n  x: number,\n  y: number,\n  button?: number\n): ActionResult {\n  if (!canvas) {\n    return { success: false, error: 'Canvas not available' };\n  }\n  const rect = canvas.getBoundingClientRect();\n\n  // Scale game-space coordinates to screen-space\n  // canvas.width/height = logical (game) dimensions\n  // rect.width/height = actual display dimensions\n  const scaleX = rect.width / canvas.width;\n  const scaleY = rect.height / canvas.height;\n  const screenX = x * scaleX;\n  const screenY = y * scaleY;\n\n  const event = new PointerEvent(eventType, {\n    bubbles: true,\n    cancelable: true,\n    clientX: rect.left + screenX,\n    clientY: rect.top + screenY,\n    button: button ?? 0,\n    pointerType: 'mouse',\n  });\n  canvas.dispatchEvent(event);\n  return { success: true };\n}\n\n/**\n * Executes a keyboard event.\n *\n * @param eventType - Type of keyboard event\n * @param key - The key value\n * @param code - The key code\n * @returns Action result indicating success or failure\n *\n * @example\n * executeKeyEvent('keydown', ' ', 'Space');\n */\nfunction executeKeyEvent(\n  eventType: 'keydown' | 'keyup',\n  key: string,\n  code: string\n): ActionResult {\n  const event = new KeyboardEvent(eventType, {\n    bubbles: true,\n    cancelable: true,\n    key,\n    code,\n  });\n  window.dispatchEvent(event);\n  return { success: true };\n}\n\n/**\n * Dispatches entity-related actions.\n *\n * @param action - The entity action to dispatch\n * @param scene - The current scene\n * @returns Action result or null if not an entity action\n *\n * @example\n * const result = dispatchEntityAction(action, scene);\n */\nfunction dispatchEntityAction(\n  action: TestAction,\n  scene: unknown\n): ActionResult | null {\n  switch (action.type) {\n    case 'setPosition':\n      return executeSetPosition(scene, action.entityId, action.x, action.y);\n    case 'setComponent':\n      return executeSetComponent(\n        scene,\n        action.entityId,\n        action.component,\n        action.data\n      );\n    case 'setVisible':\n      return executeSetVisible(scene, action.entityId, action.visible);\n    case 'destroyEntity':\n      return executeDestroyEntity(scene, action.entityId);\n    case 'pause':\n      return executePause(scene);\n    case 'resume':\n      return executeResume(scene);\n    case 'tick':\n      return executeTick(scene, action.deltaMs);\n    default:\n      return null;\n  }\n}\n\n/**\n * Dispatches pointer actions to the canvas.\n *\n * @param action - The pointer action\n * @param canvas - The canvas element\n * @returns Action result or null if not a pointer action\n * @internal\n */\nfunction dispatchPointerAction(\n  action: TestAction,\n  canvas: HTMLCanvasElement | null\n): ActionResult | null {\n  switch (action.type) {\n    case 'pointerDown':\n      return executePointerEvent(\n        'pointerdown',\n        canvas,\n        action.x,\n        action.y,\n        action.button\n      );\n    case 'pointerUp':\n      return executePointerEvent(\n        'pointerup',\n        canvas,\n        action.x,\n        action.y,\n        action.button\n      );\n    case 'pointerMove':\n      return executePointerEvent('pointermove', canvas, action.x, action.y, 0);\n    default:\n      return null;\n  }\n}\n\n/**\n * Dispatches input-related actions.\n *\n * @param action - The input action to dispatch\n * @param canvas - The canvas element\n * @returns Action result or null if not an input action\n *\n * @example\n * const result = await dispatchInputAction(action, canvas);\n */\nasync function dispatchInputAction(\n  action: TestAction,\n  canvas: HTMLCanvasElement | null\n): Promise<ActionResult | null> {\n  const pointerResult = dispatchPointerAction(action, canvas);\n  if (pointerResult) {\n    return pointerResult;\n  }\n  switch (action.type) {\n    case 'keyDown':\n      return executeKeyEvent('keydown', action.key, action.code);\n    case 'keyUp':\n      return executeKeyEvent('keyup', action.key, action.code);\n    case 'wait':\n      await new Promise((resolve) => setTimeout(resolve, action.ms));\n      return { success: true };\n    default:\n      return null;\n  }\n}\n\n/**\n * Dispatches an action to the appropriate executor.\n *\n * @param action - The action to dispatch\n * @param getScene - Function to get the current scene\n * @param getCanvas - Function to get the canvas element\n * @returns Promise resolving to action result\n *\n * @example\n * const result = await dispatchAction(action, getScene, getCanvas);\n */\nasync function dispatchAction(\n  action: TestAction,\n  getScene: () => unknown,\n  getCanvas: () => HTMLCanvasElement | null\n): Promise<ActionResult> {\n  const entityResult = dispatchEntityAction(action, getScene());\n  if (entityResult) {\n    return entityResult;\n  }\n  const inputResult = await dispatchInputAction(action, getCanvas());\n  if (inputResult) {\n    return inputResult;\n  }\n  return { success: false, error: `Unknown action type: ${action.type}` };\n}\n\n/**\n * Creates an action executor function for the test harness.\n *\n * The executor handles all TestAction types, executing them against\n * the scene and canvas. Each action returns an ActionResult indicating\n * success or failure.\n *\n * @param getScene - Function that returns the ODIE scene\n * @param getCanvas - Function that returns the game canvas element\n * @returns Async function that executes TestActions\n *\n * @example\n * const executeAction = createActionExecutor(\n *   () => ecsAccess.getScene(),\n *   () => document.querySelector('canvas')\n * );\n *\n * const result = await executeAction({ type: 'pause' });\n * if (!result.success) {\n *   console.error('Failed:', result.error);\n * }\n */\nexport function createActionExecutor(\n  getScene: () => unknown,\n  getCanvas: () => HTMLCanvasElement | null\n): (action: TestAction) => Promise<ActionResult> {\n  return async (action: TestAction): Promise<ActionResult> => {\n    try {\n      // Record action for bug reports (only records user input actions)\n      recordAction(action);\n      return await dispatchAction(action, getScene, getCanvas);\n    } catch (err) {\n      return {\n        success: false,\n        error: err instanceof Error ? err.message : String(err),\n      };\n    }\n  };\n}\n","/**\n * Physics Access Implementation\n *\n * Provides test harness access to the Planck.js physics world\n * for deterministic E2E testing.\n *\n * @module\n */\n\nimport { PhysicsWorldManager } from '@physics';\n\nimport type { PhysicsAccess } from '../types';\n\n/**\n * Creates a PhysicsAccess implementation for the test harness.\n *\n * @returns PhysicsAccess interface for physics control and inspection\n *\n * @example\n * // Add to test harness\n * const physicsAccess = createPhysicsAccess();\n * harness.physics = physicsAccess;\n */\nexport function createPhysicsAccess(): PhysicsAccess {\n  return {\n    pause(): void {\n      PhysicsWorldManager.getInstance().pause();\n    },\n\n    resume(): void {\n      PhysicsWorldManager.getInstance().resume();\n    },\n\n    step(deltaMs: number): void {\n      PhysicsWorldManager.getInstance().stepExact(deltaMs);\n    },\n\n    getBodyPosition(bodyId: number): { x: number; y: number } | null {\n      return PhysicsWorldManager.getInstance().getBodyPosition(bodyId);\n    },\n\n    isBodySleeping(bodyId: number): boolean {\n      return PhysicsWorldManager.getInstance().isBodySleeping(bodyId);\n    },\n\n    reset(): void {\n      PhysicsWorldManager.getInstance().reset();\n    },\n  };\n}\n","/**\n * Console Log Capture System\n *\n * This module captures all console output (log, warn, error) into an array\n * for inclusion in bug reports. Each log entry includes the message type,\n * timestamp, current game tick, and stringified arguments.\n *\n * @example\n * // Initialize early in app startup\n * initConsoleCapture();\n *\n * // Later, get all captured logs\n * const logs = getCapturedLogs();\n *\n * @module\n */\n\n/* eslint-disable jsdoc/require-returns, jsdoc/require-param, jsdoc/require-example */\n/* eslint-disable no-console */\n\n/**\n * Represents a captured console log entry.\n */\nexport interface CapturedLog {\n  /** Log type: log, warn, or error */\n  type: 'log' | 'warn' | 'error';\n  /** Performance timestamp when the log occurred (ms since page load) */\n  timestamp: number;\n  /** Game tick number when the log occurred (-1 if not available) */\n  tick: number;\n  /** Stringified log arguments */\n  args: string[];\n}\n\n/** Maximum number of logs to retain */\nconst MAX_LOGS = 1000;\n\n/** Storage for captured logs */\nlet capturedLogs: CapturedLog[] = [];\n\n/** Original console methods (saved before override) */\nlet originalConsole: {\n  log: typeof console.log;\n  warn: typeof console.warn;\n  error: typeof console.error;\n} | null = null;\n\n/** Whether capture has been initialized */\nlet isInitialized = false;\n\n/**\n * Safely stringify a value for logging.\n * Handles circular references and non-serializable values.\n */\nfunction safeStringify(obj: unknown): string {\n  try {\n    if (typeof obj === 'object' && obj !== null) {\n      return JSON.stringify(obj, null, 2);\n    }\n    return String(obj);\n  } catch {\n    // Handle circular references\n    return Object.prototype.toString.call(obj);\n  }\n}\n\n/**\n * Get the current game tick from the test harness.\n * Returns -1 if not available.\n */\nfunction getCurrentTick(): number {\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  return window.__gameTest?.tick?.current ?? -1;\n}\n\n/**\n * Add a log entry to the captured logs array.\n * Removes oldest entries if exceeding MAX_LOGS.\n */\nfunction addLog(type: CapturedLog['type'], args: unknown[]): void {\n  const entry: CapturedLog = {\n    type,\n    timestamp: performance.now(),\n    tick: getCurrentTick(),\n    args: args.map(safeStringify),\n  };\n\n  capturedLogs.push(entry);\n\n  // Trim to max size\n  if (capturedLogs.length > MAX_LOGS) {\n    capturedLogs = capturedLogs.slice(-MAX_LOGS);\n  }\n}\n\n/**\n * Initialize console capture by overriding console methods.\n * Safe to call multiple times - only initializes once.\n *\n * @example\n * // Call early in app initialization\n * initConsoleCapture();\n */\nexport function initConsoleCapture(): void {\n  if (isInitialized) {\n    return;\n  }\n\n  // Save original methods\n  originalConsole = {\n    log: console.log.bind(console),\n    warn: console.warn.bind(console),\n    error: console.error.bind(console),\n  };\n\n  // Override console.log\n  console.log = (...args: unknown[]): void => {\n    originalConsole?.log(...args);\n    addLog('log', args);\n  };\n\n  // Override console.warn\n  console.warn = (...args: unknown[]): void => {\n    originalConsole?.warn(...args);\n    addLog('warn', args);\n  };\n\n  // Override console.error\n  console.error = (...args: unknown[]): void => {\n    originalConsole?.error(...args);\n    addLog('error', args);\n  };\n\n  isInitialized = true;\n}\n\n/**\n * Get a copy of all captured logs.\n *\n * @returns Array of captured log entries\n *\n * @example\n * const logs = getCapturedLogs();\n * console.log(`Captured ${logs.length} log entries`);\n */\nexport function getCapturedLogs(): CapturedLog[] {\n  return [...capturedLogs];\n}\n\n/**\n * Clear all captured logs.\n *\n * @example\n * // Clear logs after submitting bug report\n * clearCapturedLogs();\n */\nexport function clearCapturedLogs(): void {\n  capturedLogs = [];\n}\n\n/**\n * Get the original console methods (for direct logging that bypasses capture).\n * Returns null if capture hasn't been initialized.\n *\n * @example\n * const original = getOriginalConsole();\n * original?.log('This will not be captured');\n */\nexport function getOriginalConsole(): typeof originalConsole {\n  return originalConsole;\n}\n\n/**\n * Format captured logs as a text string for saving to file.\n *\n * @returns Formatted log text with timestamps and tick numbers\n *\n * @example\n * const logText = formatLogsAsText();\n * await fs.writeFile('console-log.txt', logText);\n */\nexport function formatLogsAsText(): string {\n  return capturedLogs\n    .map((log) => {\n      const tickStr = log.tick >= 0 ? `T${String(log.tick)}` : '---';\n      const timeStr = log.timestamp.toFixed(0).padStart(8);\n      const typeStr = log.type.toUpperCase().padEnd(5);\n      const message = log.args.join(' ');\n      return `[${timeStr}ms] [${tickStr}] [${typeStr}] ${message}`;\n    })\n    .join('\\n');\n}\n","/**\n * Bug Report Client\n *\n * This module provides functions to capture game state, screenshots, and logs,\n * then submit them to the Vite dev server for saving as bug reports.\n *\n * @example\n * // Show the bug report modal when user clicks \"Report Bug\"\n * import { showBugReportModal } from '@shared/debug/bugReport';\n * reportButton.onclick = () => showBugReportModal();\n *\n * @module\n */\n\n/* eslint-disable jsdoc/require-returns, jsdoc/require-param, jsdoc/require-example */\n/* eslint-disable max-lines-per-function */\n/* eslint-disable @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-call */\n/* eslint-disable @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-return */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport type { RecordedAction } from './types';\nimport { getCapturedLogs, type CapturedLog } from './consoleCapture';\nimport { getRecordedActions } from './harness/actionDsl';\n\n/**\n * Snapshot of a display object from the PixiJS render tree.\n */\nexport interface DisplayObjectSnapshot {\n  /** Type of the display object */\n  type: string;\n  /** PixiJS internal uid for this display object */\n  uid?: string;\n  /** Label/identifier (if available) */\n  label?: string;\n  /** Entity UID if this display object is an ODIE Entity2D */\n  entityUid?: string;\n  /** Position in world coordinates */\n  position: { x: number; y: number };\n  /** Scale */\n  scale: { x: number; y: number };\n  /** Rotation in radians */\n  rotation: number;\n  /** Visibility */\n  visible: boolean;\n  /** Alpha/opacity */\n  alpha: number;\n  /** Bounds (if calculable) */\n  bounds?: { x: number; y: number; width: number; height: number };\n  /** Texture key/path (for sprites) */\n  texture?: string;\n  /** Child display objects */\n  children?: DisplayObjectSnapshot[];\n}\n\n/**\n * Full render state including display tree and ECS entities.\n */\nexport interface RenderState {\n  /** Performance timestamp */\n  timestamp: number;\n  /** Display object hierarchy */\n  displayTree: DisplayObjectSnapshot;\n  /** Number of display objects in tree */\n  displayObjectCount: number;\n  /** ECS entity data (if test harness available) */\n  entities?: {\n    id: string;\n    type: string;\n    position: { x: number; y: number };\n    components: Record<string, unknown>;\n  }[];\n  /** Scene state */\n  sceneState: 'running' | 'paused' | 'stopped' | 'unknown';\n}\n\n/**\n * Complete bug report data structure.\n */\nexport interface BugReport {\n  /** ISO timestamp when the report was created */\n  timestamp: string;\n  /** Current URL including query parameters */\n  url: string;\n  /** Optional user description of the bug */\n  description?: string;\n  /** Base64-encoded PNG screenshot */\n  screenshot: string;\n  /** Full render state including display tree */\n  gameState: RenderState | null;\n  /** Captured console logs */\n  consoleLogs: CapturedLog[];\n  /** Recorded user actions */\n  userActions: RecordedAction[];\n}\n\n/**\n * Response from the bug report API endpoint.\n */\nexport interface BugReportResponse {\n  /** Whether the report was saved successfully */\n  success: boolean;\n  /** Path where the report was saved (on success) */\n  path?: string;\n  /** Error message (on failure) */\n  error?: string;\n}\n\n/**\n * Get the PixiJS renderer from the Astro app.\n * Dynamically imports to avoid circular dependency issues.\n */\nasync function getPixiRenderer(): Promise<any> {\n  try {\n    const { getApp } = await import('@app/bootstrap');\n    const { StagePlugin } = await import('@play-co/astro');\n    const app = getApp();\n    if (!app) return null;\n    const stage = app.get(StagePlugin);\n    return (stage as any).renderer ?? null;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Get the PixiJS stage from the Astro app.\n */\nasync function getPixiStage(): Promise<any> {\n  try {\n    const { getApp } = await import('@app/bootstrap');\n    const { StagePlugin } = await import('@play-co/astro');\n    const app = getApp();\n    if (!app) return null;\n    const stage = app.get(StagePlugin);\n    return (stage as any).stage ?? null;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Capture a screenshot of the game canvas using PixiJS extract.\n *\n * Uses renderer.extract.base64() for proper WebGL screenshot capture.\n * Falls back to canvas.toDataURL() if extract is unavailable.\n *\n * @returns Base64-encoded PNG data URL\n * @throws Error if canvas is not found\n *\n * @example\n * const screenshot = await captureScreenshot();\n */\nexport async function captureScreenshot(): Promise<string> {\n  // Try PixiJS renderer extract first (works with WebGL)\n  const renderer = await getPixiRenderer();\n  const stage = await getPixiStage();\n\n  if (renderer?.extract && stage) {\n    try {\n      // Use PixiJS extract to get base64 PNG\n      const base64 = await renderer.extract.base64(stage, 'image/png');\n      return base64;\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        '[BugReport] Extract failed, falling back to toDataURL:',\n        error\n      );\n    }\n  }\n\n  // Fallback to direct canvas access\n  const canvas = document.querySelector<HTMLCanvasElement>('canvas');\n  if (!canvas) {\n    throw new Error('Canvas not found');\n  }\n\n  return canvas.toDataURL('image/png');\n}\n\n/**\n * Snapshot a PixiJS display object to a plain object.\n */\nfunction snapshotDisplayObject(\n  displayObject: any,\n  depth = 0,\n  maxDepth = 10\n): DisplayObjectSnapshot | null {\n  if (!displayObject || depth > maxDepth) return null;\n\n  const snapshot: DisplayObjectSnapshot = {\n    type: displayObject.constructor?.name ?? 'Unknown',\n    position: {\n      x: displayObject.x ?? 0,\n      y: displayObject.y ?? 0,\n    },\n    scale: {\n      x: displayObject.scale?.x ?? 1,\n      y: displayObject.scale?.y ?? 1,\n    },\n    rotation: displayObject.rotation ?? 0,\n    visible: displayObject.visible ?? true,\n    alpha: displayObject.alpha ?? 1,\n  };\n\n  // Add PixiJS internal uid for correlation with view2d.viewUid\n  if (displayObject.uid !== undefined) {\n    snapshot.uid = String(displayObject.uid);\n  }\n\n  // Add label if available\n  if (displayObject.label) {\n    snapshot.label = displayObject.label;\n  }\n\n  // Add entity UID if this is an ODIE Entity2D (has UID property)\n  if (displayObject.UID !== undefined) {\n    snapshot.entityUid = String(displayObject.UID);\n  }\n\n  // Try to get bounds\n  try {\n    if (typeof displayObject.getBounds === 'function') {\n      const b = displayObject.getBounds();\n      if (b && typeof b.x === 'number') {\n        snapshot.bounds = {\n          x: b.x,\n          y: b.y,\n          width: b.width,\n          height: b.height,\n        };\n      }\n    }\n  } catch {\n    // Ignore bounds errors\n  }\n\n  // Get texture info for sprites\n  if (displayObject.texture) {\n    const tex = displayObject.texture;\n    snapshot.texture = tex.label ?? tex.uid ?? 'texture';\n  }\n\n  // Process children\n  if (displayObject.children && displayObject.children.length > 0) {\n    const children: DisplayObjectSnapshot[] = [];\n    for (const child of displayObject.children) {\n      const childSnapshot = snapshotDisplayObject(child, depth + 1, maxDepth);\n      if (childSnapshot) {\n        children.push(childSnapshot);\n      }\n    }\n    if (children.length > 0) {\n      snapshot.children = children;\n    }\n  }\n\n  return snapshot;\n}\n\n/**\n * Count total display objects in a snapshot tree.\n */\nfunction countDisplayObjects(snapshot: DisplayObjectSnapshot): number {\n  let count = 1;\n  if (snapshot.children) {\n    for (const child of snapshot.children) {\n      count += countDisplayObjects(child);\n    }\n  }\n  return count;\n}\n\n/**\n * Capture the full render state including display tree.\n */\nasync function captureRenderState(): Promise<RenderState | null> {\n  const stage = await getPixiStage();\n  if (!stage) {\n    return null;\n  }\n\n  // Capture display tree\n  const displayTree = snapshotDisplayObject(stage);\n  if (!displayTree) {\n    return null;\n  }\n\n  // Get entity data from test harness if available\n  let entities: RenderState['entities'];\n  let sceneState: RenderState['sceneState'] = 'unknown';\n\n  if (window.__gameTest) {\n    const sig = window.__gameTest.getRenderSignature();\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (sig) {\n      sceneState = sig.sceneState;\n      entities = sig.entities.map((e) => ({\n        id: String(e.id),\n        type: e.type,\n        position: e.position,\n        components: e.components,\n      }));\n    }\n  }\n\n  const renderState: RenderState = {\n    timestamp: performance.now(),\n    displayTree,\n    displayObjectCount: countDisplayObjects(displayTree),\n    sceneState,\n  };\n\n  // Only add entities if they exist\n  if (entities) {\n    renderState.entities = entities;\n  }\n\n  return renderState;\n}\n\n/**\n * Collect all bug report data.\n *\n * @param description - Optional user description of the bug\n * @returns Complete bug report data\n *\n * @example\n * const report = await collectBugReport('Red screw went to wrong tray');\n */\nexport async function collectBugReport(\n  description?: string\n): Promise<BugReport> {\n  // Pause the game to capture stable state\n  await window.__gameTest?.act({ type: 'pause' });\n\n  // Capture screenshot using PixiJS extract\n  let screenshot = '';\n  try {\n    screenshot = await captureScreenshot();\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error('[BugReport] Failed to capture screenshot:', error);\n  }\n\n  // Capture full render state including display tree\n  const gameState = await captureRenderState();\n\n  // Get console logs\n  const consoleLogs = getCapturedLogs();\n\n  // Get recorded user actions\n  const userActions = getRecordedActions();\n\n  // Resume the game\n  await window.__gameTest?.act({ type: 'resume' });\n\n  const report: BugReport = {\n    timestamp: new Date().toISOString(),\n    url: window.location.href,\n    screenshot,\n    gameState,\n    consoleLogs,\n    userActions,\n  };\n\n  // Only add description if provided\n  if (description) {\n    report.description = description;\n  }\n\n  return report;\n}\n\n/**\n * Submit a bug report to the dev server.\n *\n * @param report - The bug report to submit\n * @returns API response indicating success or failure\n *\n * @example\n * const report = await collectBugReport('Bug description');\n * const result = await submitBugReport(report);\n * if (result.success) {\n *   console.log('Report saved to:', result.path);\n * }\n */\nexport async function submitBugReport(\n  report: BugReport\n): Promise<BugReportResponse> {\n  try {\n    const response = await fetch('/__bug-report', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(report),\n    });\n\n    const result = (await response.json()) as BugReportResponse;\n    return result;\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : String(error),\n    };\n  }\n}\n\n// ============================================================================\n// Bug Report Modal UI\n// ============================================================================\n\n/** Reference to the current modal element */\nlet currentModal: HTMLElement | null = null;\n\n/**\n * Create the modal overlay element.\n */\nfunction createModalOverlay(): HTMLDivElement {\n  const overlay = document.createElement('div');\n  overlay.style.cssText = `\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.7);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 10000;\n  `;\n  return overlay;\n}\n\n/**\n * Create the modal content container.\n */\nfunction createModalContent(): HTMLDivElement {\n  const content = document.createElement('div');\n  content.style.cssText = `\n    background: #1a1a1a;\n    border: 1px solid #333;\n    border-radius: 8px;\n    padding: 20px;\n    width: 400px;\n    max-width: 90vw;\n    color: #fff;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  `;\n  return content;\n}\n\n/**\n * Create the modal title.\n */\nfunction createModalTitle(): HTMLHeadingElement {\n  const title = document.createElement('h2');\n  title.textContent = 'Report Bug';\n  title.style.cssText = `\n    margin: 0 0 16px 0;\n    font-size: 18px;\n    font-weight: 600;\n  `;\n  return title;\n}\n\n/**\n * Create the description textarea.\n */\nfunction createDescriptionTextarea(): HTMLTextAreaElement {\n  const textarea = document.createElement('textarea');\n  textarea.placeholder = 'Describe the bug (optional)...';\n  textarea.style.cssText = `\n    width: 100%;\n    height: 100px;\n    padding: 10px;\n    border: 1px solid #444;\n    border-radius: 4px;\n    background: #222;\n    color: #fff;\n    font-family: inherit;\n    font-size: 14px;\n    resize: vertical;\n    box-sizing: border-box;\n  `;\n  return textarea;\n}\n\n/**\n * Create a button element.\n */\nfunction createButton(text: string, isPrimary: boolean): HTMLButtonElement {\n  const button = document.createElement('button');\n  button.textContent = text;\n  button.style.cssText = `\n    padding: 8px 16px;\n    border: none;\n    border-radius: 4px;\n    font-size: 14px;\n    cursor: pointer;\n    transition: background 0.2s;\n    ${\n      isPrimary\n        ? 'background: #4CAF50; color: white;'\n        : 'background: #444; color: #ddd;'\n    }\n  `;\n  button.onmouseenter = (): void => {\n    button.style.background = isPrimary ? '#45a049' : '#555';\n  };\n  button.onmouseleave = (): void => {\n    button.style.background = isPrimary ? '#4CAF50' : '#444';\n  };\n  return button;\n}\n\n/**\n * Create the button container.\n */\nfunction createButtonContainer(): HTMLDivElement {\n  const container = document.createElement('div');\n  container.style.cssText = `\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n    margin-top: 16px;\n  `;\n  return container;\n}\n\n/**\n * Create the status message element.\n */\nfunction createStatusMessage(): HTMLDivElement {\n  const status = document.createElement('div');\n  status.style.cssText = `\n    margin-top: 12px;\n    padding: 10px;\n    border-radius: 4px;\n    font-size: 14px;\n    display: none;\n  `;\n  return status;\n}\n\n/**\n * Show a status message in the modal.\n */\nfunction showStatus(\n  element: HTMLDivElement,\n  message: string,\n  isError: boolean\n): void {\n  element.textContent = message;\n  element.style.display = 'block';\n  element.style.background = isError ? '#5c2020' : '#1e3a1e';\n  element.style.color = isError ? '#ff8080' : '#80ff80';\n}\n\n/**\n * Close and remove the modal.\n */\nfunction closeModal(): void {\n  if (currentModal) {\n    currentModal.remove();\n    currentModal = null;\n  }\n}\n\n/**\n * Show the bug report modal.\n * Allows user to add an optional description before submitting.\n *\n * @example\n * // Show modal when user clicks Report Bug button\n * reportButton.onclick = () => showBugReportModal();\n */\nexport function showBugReportModal(): void {\n  // Close any existing modal\n  closeModal();\n\n  // Create modal elements\n  const overlay = createModalOverlay();\n  const content = createModalContent();\n  const title = createModalTitle();\n  const textarea = createDescriptionTextarea();\n  const buttonContainer = createButtonContainer();\n  const cancelButton = createButton('Cancel', false);\n  const submitButton = createButton('Submit Report', true);\n  const statusMessage = createStatusMessage();\n\n  // Assemble modal\n  buttonContainer.appendChild(cancelButton);\n  buttonContainer.appendChild(submitButton);\n  content.appendChild(title);\n  content.appendChild(textarea);\n  content.appendChild(buttonContainer);\n  content.appendChild(statusMessage);\n  overlay.appendChild(content);\n\n  // Handle cancel\n  cancelButton.onclick = closeModal;\n  overlay.onclick = (e): void => {\n    if (e.target === overlay) {\n      closeModal();\n    }\n  };\n\n  // Handle submit\n  submitButton.onclick = async (): Promise<void> => {\n    // Disable buttons during submission\n    submitButton.disabled = true;\n    cancelButton.disabled = true;\n    submitButton.textContent = 'Submitting...';\n    submitButton.style.background = '#666';\n\n    try {\n      // Collect and submit report\n      const description = textarea.value.trim() || undefined;\n      const report = await collectBugReport(description);\n      const result = await submitBugReport(report);\n\n      if (result.success) {\n        showStatus(\n          statusMessage,\n          `Report saved to: ${result.path ?? 'unknown'}`,\n          false\n        );\n        // Auto-close after success\n        setTimeout(closeModal, 2000);\n      } else {\n        showStatus(\n          statusMessage,\n          `Error: ${result.error ?? 'Unknown error'}`,\n          true\n        );\n        // Re-enable buttons on error\n        submitButton.disabled = false;\n        cancelButton.disabled = false;\n        submitButton.textContent = 'Submit Report';\n        submitButton.style.background = '#4CAF50';\n      }\n    } catch (error) {\n      showStatus(\n        statusMessage,\n        `Error: ${error instanceof Error ? error.message : String(error)}`,\n        true\n      );\n      // Re-enable buttons on error\n      submitButton.disabled = false;\n      cancelButton.disabled = false;\n      submitButton.textContent = 'Submit Report';\n      submitButton.style.background = '#4CAF50';\n    }\n  };\n\n  // Add to DOM and focus textarea\n  document.body.appendChild(overlay);\n  currentModal = overlay;\n  textarea.focus();\n}\n","/**\n * Debug Console UI Component\n *\n * A floating, draggable debug console panel that displays console logs\n * and provides buttons for Copy, Clear, and Report Bug actions.\n *\n * @example\n * // Initialize in dev/test mode\n * import { createDebugConsole } from '@shared/debug/ui/debugConsole';\n *\n * const console = createDebugConsole();\n * document.body.appendChild(console);\n *\n * @module\n */\n\n/* eslint-disable max-lines-per-function */\n/* eslint-disable no-console */\n\nimport {\n  initConsoleCapture,\n  clearCapturedLogs,\n  getOriginalConsole,\n} from '../consoleCapture';\nimport { showBugReportModal } from '../bugReport';\n\n// ============================================================================\n// Constants\n// ============================================================================\n\nconst STORAGE_KEY = 'debugConsole';\nconst DEFAULT_WIDTH = 350;\nconst DEFAULT_HEIGHT = 200;\nconst HEADER_HEIGHT = 30;\nconst FOOTER_HEIGHT = 36;\n\n// ============================================================================\n// State Management\n// ============================================================================\n\ninterface ConsoleState {\n  x: number;\n  y: number;\n  minimized: boolean;\n  visible: boolean;\n}\n\nfunction loadState(): ConsoleState {\n  try {\n    const saved = localStorage.getItem(STORAGE_KEY);\n    if (saved) {\n      return JSON.parse(saved) as ConsoleState;\n    }\n  } catch {\n    // Ignore localStorage errors\n  }\n  return {\n    x: 10,\n    y: window.innerHeight - DEFAULT_HEIGHT - 10,\n    minimized: false,\n    visible: true,\n  };\n}\n\nfunction saveState(state: ConsoleState): void {\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));\n  } catch {\n    // Ignore localStorage errors\n  }\n}\n\n// ============================================================================\n// DOM Creation Helpers\n// ============================================================================\n\nfunction createContainer(state: ConsoleState): HTMLDivElement {\n  const container = document.createElement('div');\n  container.id = 'debug-console';\n  const height = state.minimized ? HEADER_HEIGHT : DEFAULT_HEIGHT;\n  container.style.cssText = `\n    position: fixed;\n    left: ${String(state.x)}px;\n    top: ${String(state.y)}px;\n    width: ${String(DEFAULT_WIDTH)}px;\n    height: ${String(height)}px;\n    background: rgba(17, 17, 17, 0.95);\n    border: 1px solid #333;\n    border-radius: 6px;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 11px;\n    z-index: 9999;\n    display: ${state.visible ? 'flex' : 'none'};\n    flex-direction: column;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n    overflow: hidden;\n  `;\n  return container;\n}\n\nfunction createHeader(): HTMLDivElement {\n  const header = document.createElement('div');\n  header.style.cssText = `\n    height: ${String(HEADER_HEIGHT)}px;\n    background: #222;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 0 8px;\n    cursor: move;\n    user-select: none;\n    border-bottom: 1px solid #333;\n    flex-shrink: 0;\n  `;\n  return header;\n}\n\nfunction createHeaderTitle(): HTMLSpanElement {\n  const title = document.createElement('span');\n  title.textContent = 'Debug Console';\n  title.style.cssText = `\n    color: #888;\n    font-size: 12px;\n    font-weight: 500;\n  `;\n  return title;\n}\n\nfunction createHeaderButtons(): HTMLDivElement {\n  const buttons = document.createElement('div');\n  buttons.style.cssText = `\n    display: flex;\n    gap: 6px;\n  `;\n  return buttons;\n}\n\nfunction createHeaderButton(\n  symbol: string,\n  title: string,\n  onClick: () => void\n): HTMLButtonElement {\n  const button = document.createElement('button');\n  button.textContent = symbol;\n  button.title = title;\n  button.style.cssText = `\n    width: 20px;\n    height: 20px;\n    background: #333;\n    border: none;\n    border-radius: 3px;\n    color: #888;\n    font-size: 14px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    line-height: 1;\n  `;\n  button.onmouseenter = (): void => {\n    button.style.background = '#444';\n    button.style.color = '#fff';\n  };\n  button.onmouseleave = (): void => {\n    button.style.background = '#333';\n    button.style.color = '#888';\n  };\n  button.onclick = (e): void => {\n    e.stopPropagation();\n    onClick();\n  };\n  return button;\n}\n\nfunction createLogArea(): HTMLDivElement {\n  const logArea = document.createElement('div');\n  logArea.style.cssText = `\n    flex: 1;\n    overflow-y: auto;\n    overflow-x: hidden;\n    padding: 6px 8px;\n    color: #0f0;\n  `;\n  return logArea;\n}\n\nfunction createFooter(): HTMLDivElement {\n  const footer = document.createElement('div');\n  footer.style.cssText = `\n    height: ${String(FOOTER_HEIGHT)}px;\n    background: #222;\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    padding: 0 8px;\n    gap: 8px;\n    border-top: 1px solid #333;\n    flex-shrink: 0;\n  `;\n  return footer;\n}\n\nfunction createFooterButton(\n  text: string,\n  isPrimary: boolean,\n  onClick: () => void\n): HTMLButtonElement {\n  const button = document.createElement('button');\n  button.textContent = text;\n  button.style.cssText = `\n    padding: 4px 10px;\n    background: ${isPrimary ? '#2a5a2a' : '#333'};\n    border: 1px solid ${isPrimary ? '#3d7a3d' : '#444'};\n    border-radius: 4px;\n    color: ${isPrimary ? '#6f6' : '#aaa'};\n    font-family: inherit;\n    font-size: 11px;\n    cursor: pointer;\n  `;\n  button.onmouseenter = (): void => {\n    button.style.background = isPrimary ? '#3d7a3d' : '#444';\n    button.style.color = isPrimary ? '#8f8' : '#fff';\n  };\n  button.onmouseleave = (): void => {\n    button.style.background = isPrimary ? '#2a5a2a' : '#333';\n    button.style.color = isPrimary ? '#6f6' : '#aaa';\n  };\n  button.onclick = onClick;\n  return button;\n}\n\nfunction createLogLine(\n  type: 'log' | 'warn' | 'error',\n  message: string\n): HTMLDivElement {\n  const line = document.createElement('div');\n  line.style.cssText = `\n    color: ${type === 'error' ? '#f66' : type === 'warn' ? '#ff0' : '#0f0'};\n    word-wrap: break-word;\n    white-space: pre-wrap;\n    margin-bottom: 2px;\n    line-height: 1.4;\n  `;\n  const prefix = type === 'error' ? 'ERR' : type === 'warn' ? 'WRN' : 'LOG';\n  line.textContent = `[${prefix}] ${message}`;\n  return line;\n}\n\n// ============================================================================\n// Drag Handling\n// ============================================================================\n\nfunction setupDragging(\n  container: HTMLDivElement,\n  header: HTMLDivElement,\n  state: ConsoleState\n): void {\n  let isDragging = false;\n  let dragOffsetX = 0;\n  let dragOffsetY = 0;\n\n  // Helper to start drag\n  const startDrag = (clientX: number, clientY: number): void => {\n    isDragging = true;\n    dragOffsetX = clientX - state.x;\n    dragOffsetY = clientY - state.y;\n    document.body.style.userSelect = 'none';\n  };\n\n  // Helper to move during drag\n  const moveDrag = (clientX: number, clientY: number): void => {\n    if (!isDragging) return;\n    const newX = clientX - dragOffsetX;\n    const newY = clientY - dragOffsetY;\n\n    // Constrain to viewport\n    const maxX = window.innerWidth - container.offsetWidth;\n    const maxY = window.innerHeight - container.offsetHeight;\n    state.x = Math.max(0, Math.min(newX, maxX));\n    state.y = Math.max(0, Math.min(newY, maxY));\n\n    container.style.left = `${String(state.x)}px`;\n    container.style.top = `${String(state.y)}px`;\n  };\n\n  // Helper to end drag\n  const endDrag = (): void => {\n    if (isDragging) {\n      isDragging = false;\n      document.body.style.userSelect = '';\n      saveState(state);\n    }\n  };\n\n  // Mouse events (desktop)\n  header.addEventListener('mousedown', (e: MouseEvent): void => {\n    if ((e.target as HTMLElement).tagName === 'BUTTON') return;\n    e.preventDefault();\n    startDrag(e.clientX, e.clientY);\n  });\n\n  document.addEventListener('mousemove', (e: MouseEvent) => {\n    moveDrag(e.clientX, e.clientY);\n  });\n\n  document.addEventListener('mouseup', endDrag);\n\n  // Touch events (mobile/device emulation)\n  header.addEventListener(\n    'touchstart',\n    (e: TouchEvent): void => {\n      if ((e.target as HTMLElement).tagName === 'BUTTON') return;\n      const touch = e.touches[0];\n      if (!touch) return;\n      e.preventDefault();\n      startDrag(touch.clientX, touch.clientY);\n    },\n    { passive: false }\n  );\n\n  document.addEventListener(\n    'touchmove',\n    (e: TouchEvent) => {\n      if (!isDragging) return;\n      const touch = e.touches[0];\n      if (!touch) return;\n      e.preventDefault();\n      moveDrag(touch.clientX, touch.clientY);\n    },\n    { passive: false }\n  );\n\n  document.addEventListener('touchend', endDrag);\n  document.addEventListener('touchcancel', endDrag);\n}\n\n// ============================================================================\n// Keyboard Shortcut\n// ============================================================================\n\nfunction setupKeyboardShortcut(\n  container: HTMLDivElement,\n  state: ConsoleState\n): void {\n  document.addEventListener('keydown', (e) => {\n    // Backtick key toggles visibility\n    if (e.key === '`' && !e.ctrlKey && !e.metaKey && !e.altKey) {\n      const target = e.target as HTMLElement;\n      // Don't toggle if user is typing in an input/textarea\n      if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA') {\n        return;\n      }\n      state.visible = !state.visible;\n      container.style.display = state.visible ? 'flex' : 'none';\n      saveState(state);\n    }\n  });\n}\n\n// ============================================================================\n// Log Display Management\n// ============================================================================\n\ninterface LogDisplayManager {\n  addLog: (type: 'log' | 'warn' | 'error', message: string) => void;\n  clear: () => void;\n  getLogText: () => string;\n}\n\nfunction createLogDisplayManager(logArea: HTMLDivElement): LogDisplayManager {\n  const logLines: HTMLDivElement[] = [];\n  const MAX_DISPLAY_LOGS = 500;\n\n  return {\n    addLog(type: 'log' | 'warn' | 'error', message: string): void {\n      const line = createLogLine(type, message);\n      logArea.appendChild(line);\n      logLines.push(line);\n\n      // Trim old logs\n      while (logLines.length > MAX_DISPLAY_LOGS) {\n        const oldLine = logLines.shift();\n        oldLine?.remove();\n      }\n\n      // Auto-scroll to bottom\n      logArea.scrollTop = logArea.scrollHeight;\n    },\n\n    clear(): void {\n      logArea.innerHTML = '';\n      logLines.length = 0;\n    },\n\n    getLogText(): string {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      return logLines.map((line) => line.textContent ?? '').join('\\n');\n    },\n  };\n}\n\n// ============================================================================\n// Console Override Integration\n// ============================================================================\n\nfunction setupConsoleIntegration(logManager: LogDisplayManager): void {\n  // Initialize console capture first\n  initConsoleCapture();\n\n  // Get original console for our own logging\n  const original = getOriginalConsole();\n\n  // Now override again to also update the display\n  const prevLog = console.log;\n  const prevWarn = console.warn;\n  const prevError = console.error;\n\n  console.log = (...args: unknown[]): void => {\n    prevLog(...args);\n    const msg = args.map((a) => safeStringify(a)).join(' ');\n    logManager.addLog('log', msg);\n  };\n\n  console.warn = (...args: unknown[]): void => {\n    prevWarn(...args);\n    const msg = args.map((a) => safeStringify(a)).join(' ');\n    logManager.addLog('warn', msg);\n  };\n\n  console.error = (...args: unknown[]): void => {\n    prevError(...args);\n    const msg = args.map((a) => safeStringify(a)).join(' ');\n    logManager.addLog('error', msg);\n  };\n\n  // Log to original console that we're initialized\n  original?.log('[DebugConsole] Initialized - Press ` to toggle');\n}\n\nfunction safeStringify(obj: unknown): string {\n  try {\n    if (typeof obj === 'object' && obj !== null) {\n      return JSON.stringify(obj, null, 2);\n    }\n    return String(obj);\n  } catch {\n    return Object.prototype.toString.call(obj);\n  }\n}\n\n// ============================================================================\n// Main Export\n// ============================================================================\n\n/**\n * Create and return the debug console element.\n * Should be appended to document.body.\n *\n * @returns The debug console container element\n *\n * @example\n * if (import.meta.env.DEV || isTestMode()) {\n *   const console = createDebugConsole();\n *   document.body.appendChild(console);\n * }\n */\nexport function createDebugConsole(): HTMLDivElement {\n  // Load saved state\n  const state = loadState();\n\n  // Create DOM structure\n  const container = createContainer(state);\n  const header = createHeader();\n  const headerTitle = createHeaderTitle();\n  const headerButtons = createHeaderButtons();\n  const logArea = createLogArea();\n  const footer = createFooter();\n\n  // Create log manager\n  const logManager = createLogDisplayManager(logArea);\n\n  // Create header buttons\n  const minimizeBtn = createHeaderButton(\n    state.minimized ? '+' : '-',\n    'Minimize/Expand',\n    () => {\n      state.minimized = !state.minimized;\n      container.style.height = state.minimized\n        ? `${String(HEADER_HEIGHT)}px`\n        : `${String(DEFAULT_HEIGHT)}px`;\n      minimizeBtn.textContent = state.minimized ? '+' : '-';\n      logArea.style.display = state.minimized ? 'none' : 'block';\n      footer.style.display = state.minimized ? 'none' : 'flex';\n      saveState(state);\n    }\n  );\n\n  const closeBtn = createHeaderButton('x', 'Close (` to reopen)', () => {\n    state.visible = false;\n    container.style.display = 'none';\n    saveState(state);\n  });\n\n  // Create footer buttons\n  const copyBtn = createFooterButton('Copy', false, () => {\n    const text = logManager.getLogText();\n    void navigator.clipboard.writeText(text).then(() => {\n      const originalText = copyBtn.textContent;\n      copyBtn.textContent = 'Copied!';\n      setTimeout(() => {\n        copyBtn.textContent = originalText;\n      }, 1000);\n    });\n  });\n\n  const clearBtn = createFooterButton('Clear', false, () => {\n    logManager.clear();\n    clearCapturedLogs();\n  });\n\n  const reportBtn = createFooterButton('Report Bug', true, () => {\n    showBugReportModal();\n  });\n\n  // Assemble header\n  headerButtons.appendChild(minimizeBtn);\n  headerButtons.appendChild(closeBtn);\n  header.appendChild(headerTitle);\n  header.appendChild(headerButtons);\n\n  // Assemble footer\n  footer.appendChild(copyBtn);\n  footer.appendChild(clearBtn);\n  footer.appendChild(reportBtn);\n\n  // Assemble container\n  container.appendChild(header);\n  container.appendChild(logArea);\n  container.appendChild(footer);\n\n  // Apply minimized state\n  if (state.minimized) {\n    logArea.style.display = 'none';\n    footer.style.display = 'none';\n  }\n\n  // Setup behaviors\n  setupDragging(container, header, state);\n  setupKeyboardShortcut(container, state);\n  setupConsoleIntegration(logManager);\n\n  return container;\n}\n","/**\n * Game Test Harness Module\n *\n * Provides E2E testing infrastructure for the game application. The test harness\n * exposes game state and action simulation capabilities via `window.__gameTest`\n * for use with Playwright or other E2E testing frameworks.\n *\n * The harness is automatically initialized in dev mode or when the `testMode`\n * URL parameter is present.\n *\n * @example\n * // Initialize the harness in your app bootstrap\n * import { initTestHarness, markGameReady } from '@shared/debug';\n *\n * // Call early in bootstrap\n * initTestHarness();\n *\n * // ... initialize game ...\n *\n * // Call when game is ready\n * markGameReady('GameScene');\n *\n * @example\n * // Use in Playwright E2E tests\n * import { test, expect } from '@playwright/test';\n *\n * test('game initializes correctly', async ({ page }) => {\n *   await page.goto('/?testMode');\n *\n *   // Wait for game to be ready\n *   await page.waitForFunction(() => window.__gameTest?.ready);\n *\n *   // Verify no errors\n *   const errors = await page.evaluate(() => window.__gameTest?.errors);\n *   expect(errors).toHaveLength(0);\n *\n *   // Query entities\n *   const entities = await page.evaluate(() =>\n *     window.__gameTest?.ecs.getEntities()\n *   );\n *   expect(entities?.length).toBeGreaterThan(0);\n * });\n *\n * @module\n */\n\nimport type {\n  GameTestHarness,\n  GameTestError,\n  TestAction,\n  ActionResult,\n  TickAccess,\n} from './types';\nimport { setupErrorCapture } from './errorCapture';\nimport { isTestMode, getTestParams } from './urlParams';\nimport {\n  createECSAccess,\n  createRenderSignatureGenerator,\n  createActionExecutor,\n  createPhysicsAccess,\n} from './harness';\n\n/** Reference to gameTick, set via registerTickCounter */\nlet tickCounterRef: TickAccess | null = null;\n\n/**\n * Creates a tick access wrapper.\n * Returns a proxy that delegates to the registered tick counter.\n * @returns TickAccess interface\n * @example\n * const tick = createTickAccess();\n * console.log(tick.current); // 42\n */\nfunction createTickAccess(): TickAccess {\n  return {\n    get current(): number {\n      return tickCounterRef?.current ?? 0;\n    },\n    reset(): void {\n      tickCounterRef?.reset();\n    },\n    setLoggingEnabled(enabled: boolean): void {\n      tickCounterRef?.setLoggingEnabled(enabled);\n    },\n  };\n}\n\n/**\n * Register the gameTick counter with the test harness.\n * Called by GameScene or TickSystem to expose tick counter to E2E tests.\n *\n * @param tick - The gameTick object from game utils\n *\n * @example\n * import { registerTickCounter } from '@shared/debug';\n * import { gameTick } from './utils';\n *\n * registerTickCounter(gameTick);\n */\nexport function registerTickCounter(tick: TickAccess): void {\n  tickCounterRef = tick;\n}\n\nexport type {\n  GameTestHarness,\n  GameTestError,\n  TestAction,\n  ActionResult,\n  EntitySnapshot,\n  RenderSignature,\n  ECSAccess,\n  TickAccess,\n  RecordedAction,\n} from './types';\nexport { getTestParams, isTestMode } from './urlParams';\n\n// Console capture exports\nexport {\n  initConsoleCapture,\n  getCapturedLogs,\n  clearCapturedLogs,\n  formatLogsAsText,\n  type CapturedLog,\n} from './consoleCapture';\n\n// Action recording exports\nexport { getRecordedActions, clearRecordedActions } from './harness/actionDsl';\n\n// Bug report exports\nexport {\n  captureScreenshot,\n  collectBugReport,\n  submitBugReport,\n  showBugReportModal,\n  type BugReport,\n  type BugReportResponse,\n  type RenderState,\n  type DisplayObjectSnapshot,\n} from './bugReport';\n\n// Debug console UI\nexport { createDebugConsole } from './ui/debugConsole';\n\n/** Internal state for the harness. */\ninterface HarnessState {\n  errors: GameTestError[];\n  ready: boolean;\n  scene: string;\n  bootStartTime: number;\n  bootEndTime: number | undefined;\n  sceneState: 'running' | 'paused' | 'stopped';\n}\n\n/**\n * Creates harness action methods.\n *\n * @param state - The harness state object\n * @param executeAction - Action executor function\n * @returns Object with action methods\n *\n * @example\n * const actions = createActionMethods(state, executeAction);\n */\nfunction createActionMethods(\n  state: HarnessState,\n  executeAction: (action: TestAction) => Promise<ActionResult>\n): Pick<GameTestHarness, 'act' | 'actMany'> {\n  const act = async (action: TestAction): Promise<ActionResult> => {\n    if (action.type === 'pause') {\n      state.sceneState = 'paused';\n    } else if (action.type === 'resume') {\n      state.sceneState = 'running';\n    }\n    return executeAction(action);\n  };\n\n  return {\n    act,\n    async actMany(actions: TestAction[]): Promise<ActionResult[]> {\n      const results: ActionResult[] = [];\n      for (const a of actions) {\n        results.push(await act(a));\n      }\n      return results;\n    },\n  };\n}\n\n/**\n * Creates snapshot and error capture methods.\n *\n * @param state - The harness state\n * @returns Object with snapshot and captureError methods\n * @internal\n */\nfunction createSnapshotMethods(\n  state: HarnessState\n): Pick<GameTestHarness, 'captureError' | 'snapshot'> {\n  return {\n    captureError(error: Error | string, source?: string): void {\n      state.errors.push({\n        message: error instanceof Error ? error.message : error,\n        stack: error instanceof Error ? error.stack : undefined,\n        timestamp: performance.now(),\n        source,\n      });\n    },\n    snapshot: () => ({\n      ready: state.ready,\n      scene: state.scene,\n      errors: [...state.errors],\n      bootTimeMs: state.bootEndTime\n        ? state.bootEndTime - state.bootStartTime\n        : undefined,\n    }),\n  };\n}\n\n/**\n * Creates harness lifecycle methods.\n *\n * @param state - The harness state\n * @param ecsAccess - The ECS access layer\n * @returns Object with lifecycle methods\n *\n * @example\n * const lifecycle = createLifecycleMethods(state, ecsAccess);\n */\nfunction createLifecycleMethods(\n  state: HarnessState,\n  ecsAccess: ReturnType<typeof createECSAccess>\n): Pick<\n  GameTestHarness,\n  'markReady' | 'captureError' | 'snapshot' | 'registerScene'\n> {\n  return {\n    markReady(sceneName: string): void {\n      state.ready = true;\n      state.scene = sceneName;\n      state.sceneState = 'running';\n      state.bootEndTime = performance.now();\n    },\n    ...createSnapshotMethods(state),\n    registerScene(sceneInstance: unknown): void {\n      ecsAccess._setScene(sceneInstance);\n    },\n  };\n}\n\n/**\n * Defines reactive state getters on the harness object.\n *\n * Using Object.defineProperties ensures getters remain reactive\n * (object spread would capture static values at spread time).\n *\n * @private\n * @param harness - The harness object to define getters on\n * @param state - The state to read from\n */\nfunction defineStateGetters(\n  harness: GameTestHarness,\n  state: HarnessState\n): void {\n  Object.defineProperties(harness, {\n    ready: { get: () => state.ready, enumerable: true },\n    scene: { get: () => state.scene, enumerable: true },\n    bootStartTime: { get: () => state.bootStartTime, enumerable: true },\n    bootEndTime: { get: () => state.bootEndTime, enumerable: true },\n    errors: { get: () => state.errors, enumerable: true },\n  });\n}\n\n/**\n * Creates initial harness state.\n *\n * @private\n * @returns Fresh harness state object\n */\nfunction createInitialState(): HarnessState {\n  return {\n    errors: [],\n    ready: false,\n    scene: '',\n    bootStartTime: performance.now(),\n    bootEndTime: undefined,\n    sceneState: 'stopped',\n  };\n}\n\n/**\n * Creates the test harness instance.\n *\n * @returns Configured GameTestHarness\n *\n * @example\n * const harness = createHarness();\n */\nfunction createHarness(): GameTestHarness {\n  const state = createInitialState();\n  const ecsAccess = createECSAccess();\n  const executeAction = createActionExecutor(\n    () => ecsAccess.getScene(),\n    () => document.querySelector<HTMLCanvasElement>('canvas')\n  );\n\n  const harness = {\n    ...createActionMethods(state, executeAction),\n    ...createLifecycleMethods(state, ecsAccess),\n    metrics: {},\n    ecs: ecsAccess,\n    tick: createTickAccess(),\n    physics: createPhysicsAccess(),\n    getRenderSignature: createRenderSignatureGenerator(\n      () => ecsAccess.getEntities(),\n      () => state.sceneState,\n      () => ecsAccess.getSystems()\n    ),\n    // Placeholders - overwritten by defineStateGetters\n    ready: false,\n    scene: '',\n    bootStartTime: 0,\n    bootEndTime: undefined,\n    errors: [],\n  } as GameTestHarness;\n\n  defineStateGetters(harness, state);\n  return harness;\n}\n\n/**\n * Initializes the test harness if running in dev or test mode.\n *\n * This function should be called early in the application bootstrap process,\n * before any game logic runs. It creates the `window.__gameTest` object and\n * sets up global error capture.\n *\n * The harness is only created when:\n * - Running in Vite dev mode (`import.meta.env.DEV`)\n * - The `testMode` URL parameter is present\n *\n * @example\n * // In app bootstrap\n * import { initTestHarness } from '@shared/debug';\n *\n * async function bootstrap() {\n *   // Initialize harness first\n *   initTestHarness();\n *\n *   // Then bootstrap the app...\n *   const app = new Application();\n *   await app.start();\n * }\n *\n * @example\n * // Access via URL parameter\n * // http://localhost:5173/?testMode\n * // http://localhost:5173/?testMode&skipIntro&muteAudio\n */\nexport function initTestHarness(): void {\n  // Only initialize in dev mode or when testMode param is present\n  if (import.meta.env.DEV || isTestMode()) {\n    // eslint-disable-next-line no-console\n    console.log('[TestHarness] Initializing test harness...');\n\n    window.__gameTest = createHarness();\n    setupErrorCapture();\n\n    const params = getTestParams();\n    // eslint-disable-next-line no-console\n    console.log('[TestHarness] Test params:', params);\n  }\n}\n\n/**\n * Marks the game as ready for testing.\n *\n * Call this function after all initialization is complete and the game is\n * in a stable state for E2E tests to begin. This sets `harness.ready = true`\n * and records the boot time.\n *\n * In E2E tests, you typically wait for this:\n * ```typescript\n * await page.waitForFunction(() => window.__gameTest?.ready === true);\n * ```\n *\n * @param scene - Name of the current scene/screen (e.g., 'GameScene')\n *\n * @example\n * // In your screen's onShow method\n * import { markGameReady } from '@shared/debug';\n *\n * class GameScreen implements Screen {\n *   async onEnter(): Promise<void> {\n *     await this.gameScene.init();\n *     this.gameScene.start();\n *\n *     // Signal that game is ready for testing\n *     markGameReady('GameScene');\n *   }\n * }\n */\nexport function markGameReady(scene: string): void {\n  if (window.__gameTest) {\n    window.__gameTest.markReady(scene);\n  }\n}\n","import type { Time } from '@play-co/odie';\n\nimport { BaseSystem } from './BaseSystem';\nimport { gameTick } from '../utils';\nimport { registerTickCounter } from '@shared/debug';\n\n/**\n * System that increments the global tick counter each frame.\n *\n * This system should be registered first to ensure the tick counter\n * is updated before other systems run their update logic.\n *\n * The tick counter enables deterministic debug logging by providing\n * a frame reference for all log messages.\n *\n * @example\n * // Register in GameScene\n * scene.addSystem(TickSystem);\n *\n * // In other systems, use gameTick.log() for tick-prefixed logs\n * gameTick.log('TAP', `(${x}, ${y})  ${color} screw`);\n */\nexport class TickSystem extends BaseSystem {\n  static readonly NAME = 'tick';\n\n  /** Whether the tick counter has been registered with test harness */\n  private registered = false;\n\n  /**\n   * Update tick counter each frame.\n   * @param _time - Frame time info (unused)\n   * @example\n   * system.update(time); // Called automatically by ECS\n   */\n  update(_time: Time): void {\n    // Register gameTick with test harness on first update\n    if (!this.registered) {\n      registerTickCounter(gameTick);\n      this.registered = true;\n    }\n    gameTick.update();\n  }\n}\n","/**\n * PartStateSystem - Monitors screw removal and updates part state.\n *\n * This system:\n * - Listens for screw:startRemoval events\n * - Decrements the parent part's screwCount with a delay\n * - When screwCount reaches 0, transitions part to 'free' state\n * - Emits part:freed event for physics system to handle\n *\n * @example\n * // System registration\n * scene.addSystem(PartStateSystem);\n *\n * // Listen for freed parts\n * gameEvents.on('part:freed', ({ partEntity, partId }) => {\n *   console.log(`Part ${partId} is now free!`);\n * });\n */\n\nimport type { Time, Entity } from '@play-co/odie';\n\nimport { PartComponent } from '../components';\nimport { gameEvents } from '../utils';\n\nimport { BaseSystem } from './BaseSystem';\n\nimport type { ScrewRemovalEvent } from './ScrewInteractionSystem';\n\n/** Delay in milliseconds before part starts falling after screw tap. */\nconst FALL_DELAY_MS = 100;\n\n/** Event data for part:freed */\nexport interface PartFreedEvent {\n  partEntity: Entity;\n  partId: string;\n}\n\n/** Part component data for internal use */\ninterface PartComponentData {\n  screwCount: number;\n  state: string;\n  partDefinitionId: string;\n}\n\n/**\n * System that monitors screw removal and updates part state.\n *\n * @example\n * scene.addSystem(PartStateSystem);\n */\nexport class PartStateSystem extends BaseSystem {\n  static readonly NAME = 'partState';\n\n  static Queries = {\n    parts: { components: [PartComponent] },\n  };\n\n  private boundHandleScrewRemoval: (data: ScrewRemovalEvent) => void;\n\n  /** Pending timeouts for delayed part freeing. */\n  private pendingTimeouts = new Set<ReturnType<typeof setTimeout>>();\n\n  constructor() {\n    super();\n    this.boundHandleScrewRemoval = this.handleScrewRemoval.bind(this);\n  }\n\n  /**\n   * Initialize the system and subscribe to events.\n   *\n   * @example\n   * system.init();\n   */\n  init(): void {\n    gameEvents.on<ScrewRemovalEvent>(\n      'screw:startRemoval',\n      this.boundHandleScrewRemoval\n    );\n  }\n\n  /**\n   * Cleanup event subscriptions.\n   *\n   * @example\n   * system.destroy();\n   */\n  destroy(): void {\n    gameEvents.off('screw:startRemoval', this.boundHandleScrewRemoval);\n    // Clear any pending timeouts\n    for (const timeout of this.pendingTimeouts) {\n      clearTimeout(timeout);\n    }\n    this.pendingTimeouts.clear();\n  }\n\n  /**\n   * Handle screw removal event.\n   *\n   * @param data - The screw removal event data\n   * @example\n   * // Called internally via event subscription\n   */\n  private handleScrewRemoval(data: ScrewRemovalEvent): void {\n    const partEntity = this.findPartEntityForScrew(data.screwEntity);\n    if (!partEntity) return;\n\n    const part = this.getPartComponent(partEntity);\n    if (part.state === 'free') return;\n\n    part.screwCount = Math.max(0, part.screwCount - 1);\n\n    if (part.screwCount === 0) {\n      // Delay part freeing so fall starts shortly after tap\n      const timeout = setTimeout(() => {\n        this.pendingTimeouts.delete(timeout);\n        // Re-check state in case something changed\n        if (part.state !== 'free') {\n          this.freePart(partEntity, part);\n        }\n      }, FALL_DELAY_MS);\n      this.pendingTimeouts.add(timeout);\n    }\n  }\n\n  /**\n   * Find the part entity that owns the given screw.\n   *\n   * @param screwEntity - The screw entity to find parent for\n   * @returns The parent part entity or undefined\n   * @example\n   * const part = this.findPartEntityForScrew(screwEntity);\n   */\n  private findPartEntityForScrew(screwEntity: Entity): Entity | undefined {\n    const screw = this.getComponents<{ screw: { partEntityId?: string } }>(\n      screwEntity\n    ).screw;\n    if (!screw.partEntityId) return undefined;\n\n    let partEntity: Entity | undefined;\n    this.forEachEntity('parts', (entity) => {\n      if (String(entity.UID) === screw.partEntityId) {\n        partEntity = entity;\n      }\n    });\n    return partEntity;\n  }\n\n  /**\n   * Get the part component from an entity.\n   *\n   * @param entity - The entity to get component from\n   * @returns The part component data\n   * @example\n   * const part = this.getPartComponent(entity);\n   */\n  private getPartComponent(entity: Entity): PartComponentData {\n    return this.getComponents<{ part: PartComponentData }>(entity).part;\n  }\n\n  /**\n   * Transition part to free state and emit event.\n   *\n   * @param partEntity - The part entity to free\n   * @param part - The part component data to update\n   * @example\n   * this.freePart(partEntity, part);\n   */\n  private freePart(partEntity: Entity, part: PartComponentData): void {\n    part.state = 'free';\n    gameEvents.emit('part:freed', {\n      partEntity,\n      partId: part.partDefinitionId,\n    } satisfies PartFreedEvent);\n  }\n\n  /**\n   * Update is a no-op - this system is event-driven.\n   *\n   * @param _time - Frame time (unused)\n   * @example\n   * // Called automatically by ODIE each frame\n   */\n  update(_time: Time): void {\n    // Event-driven system, no per-frame updates needed\n  }\n}\n","/**\n * PhysicsSystem - Manages physics simulation for game entities.\n *\n * This system:\n * - Steps the Planck.js physics world each frame\n * - Listens for part:freed events and converts bodies to dynamic\n * - Syncs physics body positions back to entity positions\n * - Fades out falling parts and destroys them when off-screen\n *\n * @example\n * // System registration (after PartStateSystem)\n * scene.addSystem(PhysicsSystem);\n */\n\nimport type { Time, Entity, Entity2D } from '@play-co/odie';\n\nimport { PhysicsWorldManager, PHYSICS_CONFIG } from '@physics';\n\nimport { PhysicsBodyComponent } from '../components';\nimport { gameEvents } from '../utils';\n\nimport { BaseSystem } from './BaseSystem';\n\nimport type { PartFreedEvent } from './PartStateSystem';\nimport type { PhysicsBodyComponentAccess } from '../types/component-access';\n\n/** Distance in pixels for fade-out effect. */\nconst FADE_DISTANCE = 400;\n\n/** Y position threshold for destroying off-screen parts. */\nconst DESTROY_Y_THRESHOLD = PHYSICS_CONFIG.playArea.maxY + 200;\n\n/** Event data for part:settled */\nexport interface PartSettledEvent {\n  partEntity: Entity;\n}\n\n/**\n * Type assertion helper for Entity2D.\n *\n * @param entity - Base entity to cast\n * @returns The entity cast as Entity2D\n * @example\n * const entity2d = asEntity2D(baseEntity);\n */\nfunction asEntity2D(entity: Entity): Entity2D {\n  return entity as unknown as Entity2D;\n}\n\n/**\n * System that manages physics simulation for game entities.\n *\n * @example\n * scene.addSystem(PhysicsSystem);\n */\nexport class PhysicsSystem extends BaseSystem {\n  static readonly NAME = 'physics';\n\n  static Queries = {\n    physicsBodies: { components: [PhysicsBodyComponent] },\n  };\n\n  private physicsManager: PhysicsWorldManager;\n  private boundHandlePartFreed: (data: PartFreedEvent) => void;\n\n  /** Tracks falling parts with their starting Y position for fade calculation. */\n  private fallingParts = new Map<number, number>();\n\n  /** Entities queued for destruction after update loop. */\n  private entitiesToDestroy: Entity2D[] = [];\n\n  constructor() {\n    super();\n    this.physicsManager = PhysicsWorldManager.getInstance();\n    this.boundHandlePartFreed = this.handlePartFreed.bind(this);\n  }\n\n  /**\n   * Initialize the system and subscribe to events.\n   *\n   * @example\n   * system.init();\n   */\n  init(): void {\n    gameEvents.on<PartFreedEvent>('part:freed', this.boundHandlePartFreed);\n  }\n\n  /**\n   * Cleanup event subscriptions.\n   *\n   * @example\n   * system.destroy();\n   */\n  destroy(): void {\n    gameEvents.off('part:freed', this.boundHandlePartFreed);\n  }\n\n  /**\n   * Handle part:freed event by converting physics body to dynamic.\n   *\n   * @param data - The part freed event data\n   * @example\n   * // Called internally via event subscription\n   */\n  private handlePartFreed(data: PartFreedEvent): void {\n    const { partEntity } = data;\n    const entity2d = asEntity2D(partEntity);\n    const physicsBody =\n      this.getComponents<PhysicsBodyComponentAccess>(partEntity).physicsBody;\n\n    if (physicsBody.bodyId < 0) return;\n\n    this.physicsManager.setBodyDynamic(physicsBody.bodyId);\n    physicsBody.bodyType = 'dynamic';\n    physicsBody.isSleeping = false;\n\n    // Track starting position for fade calculation\n    this.fallingParts.set(partEntity.UID, entity2d.position.y);\n  }\n\n  /**\n   * Step physics and sync positions each frame.\n   *\n   * @param time - Frame time info\n   * @example\n   * // Called automatically by ODIE each frame\n   */\n  update(time: Time): void {\n    this.physicsManager.step(time.deltaTime);\n    this.forEachEntity('physicsBodies', (baseEntity) => {\n      this.syncEntityPhysics(asEntity2D(baseEntity));\n    });\n\n    // Destroy queued entities after iteration\n    this.processEntityDestruction();\n  }\n\n  /**\n   * Process queued entity destruction.\n   *\n   * @example\n   * this.processEntityDestruction();\n   */\n  private processEntityDestruction(): void {\n    for (const entity of this.entitiesToDestroy) {\n      this.destroyFallingPart(entity);\n    }\n    this.entitiesToDestroy = [];\n  }\n\n  /**\n   * Destroy a falling part entity and clean up physics.\n   *\n   * @param entity - The entity to destroy\n   * @example\n   * this.destroyFallingPart(entity);\n   */\n  private destroyFallingPart(entity: Entity2D): void {\n    const physicsBody =\n      this.getComponents<PhysicsBodyComponentAccess>(entity).physicsBody;\n\n    if (physicsBody.bodyId >= 0) {\n      this.physicsManager.removeBody(physicsBody.bodyId);\n    }\n\n    this.fallingParts.delete(entity.UID);\n    this.scene.removeChild(entity);\n  }\n\n  /**\n   * Sync physics state to entity position.\n   *\n   * @param entity - The entity to sync\n   * @example\n   * this.syncEntityPhysics(entity);\n   */\n  private syncEntityPhysics(entity: Entity2D): void {\n    const physicsBody =\n      this.getComponents<PhysicsBodyComponentAccess>(entity).physicsBody;\n    if (\n      !physicsBody.enabled ||\n      physicsBody.bodyId < 0 ||\n      physicsBody.bodyType === 'static'\n    )\n      return;\n\n    this.updateEntityPosition(entity, physicsBody.bodyId);\n    this.updateEntityRotation(entity, physicsBody.bodyId);\n\n    // Handle falling parts: fade and destruction\n    if (this.fallingParts.has(entity.UID)) {\n      this.updateFallingPart(entity);\n    } else {\n      this.checkSettled(entity, physicsBody);\n    }\n  }\n\n  /**\n   * Update a falling part's opacity and check for destruction.\n   *\n   * @param entity - The falling entity\n   * @example\n   * this.updateFallingPart(entity);\n   */\n  private updateFallingPart(entity: Entity2D): void {\n    const currentY = entity.position.y;\n    const fadeStartY = PHYSICS_CONFIG.playArea.maxY;\n\n    // Check if entity should be destroyed\n    if (currentY > DESTROY_Y_THRESHOLD) {\n      this.entitiesToDestroy.push(entity);\n      return;\n    }\n\n    // Apply fade when below play area\n    if (currentY > fadeStartY) {\n      const fadeProgress = Math.min((currentY - fadeStartY) / FADE_DISTANCE, 1);\n      entity.view.alpha = 1 - fadeProgress;\n    }\n  }\n\n  /**\n   * Update entity position from physics.\n   *\n   * @param entity - The entity to update\n   * @param bodyId - The physics body ID\n   * @example\n   * this.updateEntityPosition(entity, bodyId);\n   */\n  private updateEntityPosition(entity: Entity2D, bodyId: number): void {\n    const position = this.physicsManager.getBodyPosition(bodyId);\n    if (position) {\n      entity.position.x = position.x;\n      entity.position.y = position.y;\n    }\n  }\n\n  /**\n   * Update entity rotation from physics.\n   *\n   * @param entity - The entity to update\n   * @param bodyId - The physics body ID\n   * @example\n   * this.updateEntityRotation(entity, bodyId);\n   */\n  private updateEntityRotation(entity: Entity2D, bodyId: number): void {\n    entity.view.rotation = this.physicsManager.getBodyRotation(bodyId);\n  }\n\n  /**\n   * Check if body has settled and emit event.\n   *\n   * @param entity - The entity to check\n   * @param physicsBody - The physics body component\n   * @example\n   * this.checkSettled(entity, physicsBody);\n   */\n  private checkSettled(\n    entity: Entity2D,\n    physicsBody: PhysicsBodyComponentAccess['physicsBody']\n  ): void {\n    const wasSleeping = physicsBody.isSleeping;\n    const isSleeping = this.physicsManager.isBodySleeping(physicsBody.bodyId);\n    physicsBody.isSleeping = isSleeping;\n\n    if (!wasSleeping && isSleeping) {\n      gameEvents.emit('part:settled', {\n        partEntity: entity,\n      } satisfies PartSettledEvent);\n    }\n  }\n}\n","import { Scene2D, createEntity, type Entity2D } from '@play-co/odie';\nimport { TouchInput } from '@play-co/astro';\nimport { Assets, Container, Graphics, Sprite, type Texture } from 'pixi.js';\n\nimport { PhysicsWorldManager } from '@physics';\nimport { loadRegion, getLevelByIndex } from '@shared/levels';\nimport { getPart } from '@shared/parts';\nimport type {\n  LevelDefinition,\n  ScrewColor,\n  PartInstance,\n  PartDefinition,\n  Position,\n} from '@shared/types';\nimport { localToWorld } from '@shared/utils';\n\nimport {\n  createTrayEntity,\n  createPartEntity,\n  createScrewEntity,\n  createBufferTrayEntity,\n} from './factories';\nimport { GameStateEntity } from './entities';\nimport {\n  TickSystem,\n  ScrewPlacementSystem,\n  ScrewInteractionSystem,\n  AnimationSystem,\n  AutoTransferSystem,\n  WinConditionSystem,\n  TrayManagementSystem,\n  PartStateSystem,\n  PhysicsSystem,\n} from './systems';\nimport {\n  gameEvents,\n  gameTick,\n  TRAY_DISPLAY_POSITIONS,\n  TRAY_HIDDEN_Y,\n  TRAY_FRAME_LAYOUT,\n  GAME_LAYOUT,\n  registerAnimationLayer,\n  registerColoredTrayLayer,\n  clearLayerRegistry,\n} from './utils';\n\n/**\n * Configuration options for creating a GameScene.\n */\nexport interface GameSceneOptions {\n  /** The PixiJS container to use as the scene's stage */\n  stage: Container;\n}\n\n/**\n * Main game scene implementing the Figma design.\n *\n * GameScene manages the complete game UI including:\n * - Background and puzzle base\n * - Colored trays for sorted screws\n * - Buffer tray for temporary storage\n * - Restart button\n * - Puzzle area with boards and screws\n *\n * @example\n * const stage = new Container();\n * const gameScene = new GameScene({ stage });\n * await gameScene.init();\n * gameScene.start();\n */\nexport class GameScene {\n  private scene: Scene2D;\n  private isInitialized = false;\n\n  // UI layer containers\n  private backgroundLayer: Container;\n  private uiLayer: Container;\n  private puzzleLayer: Container;\n  private coloredTrayLayer: Container; // For colored tray entities (between bg and covers)\n  private animationLayer: Container; // For animated screws (on top of everything)\n\n  // UI sprites\n  private restartButton: Sprite | null = null;\n  private restartInput: TouchInput | null = null;\n  private trayCovers: Sprite[] = [];\n\n  // Entity references\n  private trayEntities = new Map<ScrewColor, Entity2D>();\n  private bufferTrayEntity: Entity2D | null = null;\n  private gameStateEntity: Entity2D | null = null;\n  private partEntities: Entity2D[] = [];\n  private screwEntities: Entity2D[] = [];\n  private currentLevel: LevelDefinition | null = null;\n  private currentRegionPath: string | null = null;\n  private currentLevelIndex = 0;\n\n  constructor(options: GameSceneOptions) {\n    this.scene = new Scene2D({\n      stage: options.stage,\n    });\n\n    // Create layer containers\n    this.backgroundLayer = new Container();\n    this.uiLayer = new Container();\n    this.puzzleLayer = new Container();\n    this.coloredTrayLayer = new Container();\n    this.animationLayer = new Container();\n\n    // Add layers to scene stage in order\n    options.stage.addChild(this.backgroundLayer);\n    options.stage.addChild(this.puzzleLayer);\n    options.stage.addChild(this.uiLayer);\n    // animationLayer added on top in fixLayerOrder() after entityContainer is available\n  }\n\n  /**\n   * Initializes the game scene.\n   *\n   * Loads all assets and creates the UI layout.\n   *\n   * @example\n   * await gameScene.init();\n   */\n  public async init(): Promise<void> {\n    if (this.isInitialized) {\n      return;\n    }\n\n    // Register scene with test harness for ECS access (even in dev mode for bug reports)\n    if (window.__gameTest) {\n      window.__gameTest.registerScene(this.scene);\n    }\n\n    // Load assets and create UI\n    await this.loadAssets();\n    await this.createBackground();\n    await this.createTrayArea();\n    await this.createBufferTray();\n    await this.createRestartButton();\n\n    // Fix z-ordering: Move View2DSystem's entity container above puzzleLayer\n    // The puzzleLayer contains background elements (puzzle base)\n    // Entity views should render on top of the puzzle base but below the UI\n    this.fixLayerOrder();\n\n    // Register gameplay systems\n    this.registerSystems();\n\n    // Set up game event listeners\n    this.setupGameEvents();\n\n    this.isInitialized = true;\n  }\n\n  /**\n   * Registers all gameplay systems with the scene.\n   * @private\n   */\n  private registerSystems(): void {\n    // TickSystem must be first to update tick counter before other systems\n    this.scene.addSystem(TickSystem);\n    // Order matters: placement system first (no dependencies)\n    this.scene.addSystem(ScrewPlacementSystem);\n    this.scene.addSystem(AnimationSystem);\n    this.scene.addSystem(ScrewInteractionSystem);\n    // PartStateSystem listens for screw:removalComplete to track part state\n    this.scene.addSystem(PartStateSystem);\n    // PhysicsSystem runs after PartStateSystem to handle part:freed events\n    this.scene.addSystem(PhysicsSystem);\n    this.scene.addSystem(AutoTransferSystem);\n    this.scene.addSystem(WinConditionSystem);\n    this.scene.addSystem(TrayManagementSystem);\n  }\n\n  /**\n   * Sets up game event listeners.\n   * @private\n   */\n  private setupGameEvents(): void {\n    gameEvents.on('game:won', () => {\n      this.handleGameWon();\n    });\n    gameEvents.on('game:stuck', () => {\n      this.handleGameStuck();\n    });\n  }\n\n  /**\n   * Handles the game won event.\n   * @private\n   */\n  private handleGameWon(): void {\n    gameTick.log('WIN', 'Level complete! You won!');\n    // TODO: Show win UI, transition to next level, etc.\n  }\n\n  /**\n   * Handles the game stuck event (soft lock).\n   * @private\n   */\n  private handleGameStuck(): void {\n    gameTick.log('STUCK', 'No moves available. Tap restart to try again.');\n    // TODO: Show stuck UI with restart prompt\n  }\n\n  /**\n   * Fixes z-ordering of stage children.\n   *\n   * Ensures entity views (managed by View2DSystem) render above the puzzleLayer\n   * but below the uiLayer. Animation layer is on top for animated screws.\n   * @private\n   */\n  private fixLayerOrder(): void {\n    const stage = this.scene.view2d.stage;\n    const entityContainer = this.scene.view2d.innerContainer;\n\n    // Remove and re-add in correct order:\n    // 1. backgroundLayer (bottom)\n    // 2. puzzleLayer (puzzle base background)\n    // 3. entityContainer (parts and screws from View2DSystem)\n    // 4. uiLayer (UI frames, covers, buttons)\n    // 5. animationLayer (animated screws on top of everything)\n    stage.removeChild(this.backgroundLayer);\n    stage.removeChild(this.puzzleLayer);\n    stage.removeChild(entityContainer);\n    stage.removeChild(this.uiLayer);\n\n    stage.addChild(this.backgroundLayer);\n    stage.addChild(this.puzzleLayer);\n    stage.addChild(entityContainer);\n    stage.addChild(this.uiLayer);\n    stage.addChild(this.animationLayer);\n\n    // Register layers for AnimationSystem access\n    registerAnimationLayer(this.animationLayer);\n    registerColoredTrayLayer(this.coloredTrayLayer);\n  }\n\n  /**\n   * Registers asset bundles and loads them.\n   * @private\n   */\n  private async loadAssets(): Promise<void> {\n    this.registerAssetBundles();\n    await Assets.loadBundle([\n      'common',\n      'ui',\n      'trays',\n      'screws',\n      'placeholders',\n    ]);\n  }\n\n  /**\n   * Registers all asset bundles.\n   * @private\n   */\n  private registerAssetBundles(): void {\n    this.registerCommonBundle();\n    this.registerUIBundle();\n    this.registerPlaceholderBundle();\n    this.registerTrayBundle();\n    this.registerScrewBundle();\n  }\n\n  private registerCommonBundle(): void {\n    Assets.addBundle('common', [\n      {\n        alias: 'scene-background',\n        src: 'images/backgrounds/scene-background.png',\n      },\n      { alias: 'puzzle-base', src: 'images/ui/puzzle-base.png' },\n    ]);\n  }\n\n  private registerUIBundle(): void {\n    Assets.addBundle('ui', [\n      { alias: 'restart-button', src: 'images/ui/restart-button.png' },\n      { alias: 'colored-tray-frame', src: 'images/ui/colored-tray-frame.png' },\n      { alias: 'buffer-tray-frame', src: 'images/ui/buffer-tray-frame.png' },\n      { alias: 'tray-cover', src: 'images/ui/tray-cover.png' },\n    ]);\n  }\n\n  private registerPlaceholderBundle(): void {\n    Assets.addBundle('placeholders', [\n      {\n        alias: 'placeholder-red',\n        src: 'images/placeholders/placeholder-red.png',\n      },\n      {\n        alias: 'placeholder-yellow',\n        src: 'images/placeholders/placeholder-yellow.png',\n      },\n      {\n        alias: 'placeholder-green',\n        src: 'images/placeholders/placeholder-green.png',\n      },\n      {\n        alias: 'placeholder-blue',\n        src: 'images/placeholders/placeholder-blue.png',\n      },\n    ]);\n  }\n\n  private registerTrayBundle(): void {\n    Assets.addBundle('trays', [\n      { alias: 'tray-red', src: 'images/trays/tray-red.png' },\n      { alias: 'tray-yellow', src: 'images/trays/tray-yellow.png' },\n      { alias: 'tray-green', src: 'images/trays/tray-green.png' },\n      { alias: 'tray-blue', src: 'images/trays/tray-blue.png' },\n    ]);\n  }\n\n  private registerScrewBundle(): void {\n    Assets.addBundle('screws', [\n      { alias: 'short-screw-red', src: 'images/screws/short-screw-red.png' },\n      {\n        alias: 'short-screw-yellow',\n        src: 'images/screws/short-screw-yellow.png',\n      },\n      {\n        alias: 'short-screw-green',\n        src: 'images/screws/short-screw-green.png',\n      },\n      { alias: 'short-screw-blue', src: 'images/screws/short-screw-blue.png' },\n      { alias: 'screw-red', src: 'images/screws/screw-red.png' },\n      { alias: 'screw-yellow', src: 'images/screws/screw-yellow.png' },\n      { alias: 'screw-green', src: 'images/screws/screw-green.png' },\n      { alias: 'screw-blue', src: 'images/screws/screw-blue.png' },\n    ]);\n  }\n\n  /**\n   * Creates the background and puzzle base.\n   * @private\n   */\n  private async createBackground(): Promise<void> {\n    // Scene background\n    const bgTexture = await Assets.load<Texture>('scene-background');\n    const background = new Sprite(bgTexture);\n    background.position.set(GAME_LAYOUT.background.x, GAME_LAYOUT.background.y);\n    this.backgroundLayer.addChild(background);\n\n    // Puzzle base (metal frame)\n    const baseTexture = await Assets.load<Texture>('puzzle-base');\n    const puzzleBase = new Sprite(baseTexture);\n    puzzleBase.position.set(GAME_LAYOUT.puzzleBase.x, GAME_LAYOUT.puzzleBase.y);\n    this.puzzleLayer.addChild(puzzleBase);\n  }\n\n  /**\n   * Creates the colored tray area frame and cover.\n   * Tray entities are created dynamically per level in createLevelTrays().\n   *\n   * Z-order (bottom to top):\n   * 1. Background (dark gray behind slots)\n   * 2. Colored tray layer (tray entity views added here)\n   * 3. Covers (behind frame, on top of colored trays)\n   * 4. Frame (always on top)\n   * @private\n   */\n  private async createTrayArea(): Promise<void> {\n    // 1. Background layer (dark gray behind slot openings) - bottom\n    const bg = new Graphics();\n    bg.rect(\n      0,\n      0,\n      TRAY_FRAME_LAYOUT.background.width,\n      TRAY_FRAME_LAYOUT.background.height\n    );\n    bg.fill({ color: TRAY_FRAME_LAYOUT.background.color });\n    bg.position.set(\n      GAME_LAYOUT.coloredTrayFrame.x + TRAY_FRAME_LAYOUT.background.offsetX,\n      GAME_LAYOUT.coloredTrayFrame.y + TRAY_FRAME_LAYOUT.background.offsetY\n    );\n    this.uiLayer.addChild(bg);\n\n    // 2. Colored tray layer (tray entity views will be added here in createLevelTrays)\n    this.uiLayer.addChild(this.coloredTrayLayer);\n\n    // 3. Tray covers (for hidden tray slots) - behind frame, on top of colored trays\n    const coverTexture = await Assets.load<Texture>('tray-cover');\n    for (const coverPos of GAME_LAYOUT.trayCovers) {\n      const cover = new Sprite(coverTexture);\n      cover.position.set(coverPos.x, coverPos.y);\n      this.uiLayer.addChild(cover);\n      this.trayCovers.push(cover);\n    }\n\n    // 4. Tray frame (always on top)\n    const frameTexture = await Assets.load<Texture>('colored-tray-frame');\n    const frame = new Sprite(frameTexture);\n    frame.position.set(\n      GAME_LAYOUT.coloredTrayFrame.x,\n      GAME_LAYOUT.coloredTrayFrame.y\n    );\n    this.uiLayer.addChild(frame);\n  }\n\n  /**\n   * Creates tray entities based on level configuration.\n   * Array order in level.trays determines displayOrder:\n   * - Index 0-1: Visible trays (displayOrder 0-1)\n   * - Index 2-4: Hidden trays below visible area (displayOrder 2-4)\n   * Levels can have 4-5 trays.\n   *\n   * Tray views are added to coloredTrayLayer for proper z-ordering\n   * (between background and covers).\n   * @param level - The level definition containing tray configs\n   * @private\n   */\n  private async createLevelTrays(level: LevelDefinition): Promise<void> {\n    const trayConfigs = level.trays;\n\n    for (let i = 0; i < trayConfigs.length; i++) {\n      const config = trayConfigs[i];\n      if (!config) continue;\n\n      const displayOrder = i;\n      const isVisible = displayOrder < 2;\n\n      // Visible trays use display positions, hidden trays start below\n      const displayPosition = TRAY_DISPLAY_POSITIONS[displayOrder];\n      const position = isVisible\n        ? { x: displayPosition?.x ?? 40, y: displayPosition?.y ?? 202 }\n        : { x: displayPosition?.x ?? 40, y: TRAY_HIDDEN_Y };\n\n      const tray = await createTrayEntity({\n        color: config.color,\n        position,\n        capacity: config.capacity,\n        displayOrder,\n      });\n      // Add entity to scene for ECS management\n      this.scene.addChild(tray);\n      this.trayEntities.set(config.color, tray);\n\n      // Move tray view to coloredTrayLayer for proper z-ordering\n      // (between background and covers in uiLayer)\n      this.coloredTrayLayer.addChild(tray.view);\n    }\n  }\n\n  /**\n   * Creates the buffer tray area.\n   * @private\n   */\n  private async createBufferTray(): Promise<void> {\n    const frameTexture = await Assets.load<Texture>('buffer-tray-frame');\n    const frame = new Sprite(frameTexture);\n    frame.position.set(\n      GAME_LAYOUT.bufferTrayFrame.x,\n      GAME_LAYOUT.bufferTrayFrame.y\n    );\n    this.uiLayer.addChild(frame);\n  }\n\n  /**\n   * Creates the restart button.\n   * @private\n   */\n  private async createRestartButton(): Promise<void> {\n    const texture = await Assets.load<Texture>('restart-button');\n    this.restartButton = new Sprite(texture);\n    this.restartButton.position.set(\n      GAME_LAYOUT.restartButton.x,\n      GAME_LAYOUT.restartButton.y\n    );\n\n    // Make interactive\n    this.restartButton.eventMode = 'static';\n    this.restartButton.cursor = 'pointer';\n\n    this.restartInput = new TouchInput(this.restartButton);\n    this.restartInput.onTap = (): Promise<void> => {\n      this.handleRestartClick();\n      return Promise.resolve();\n    };\n\n    this.uiLayer.addChild(this.restartButton);\n  }\n\n  /**\n   * Handles restart button click.\n   * @private\n   */\n  private handleRestartClick(): void {\n    if (this.currentRegionPath && this.currentLevel) {\n      gameTick.log('RESTART', 'Restarting level...');\n      void this.loadLevel(this.currentRegionPath, this.currentLevelIndex);\n    }\n  }\n\n  /**\n   * Gets a tray entity by color.\n   *\n   * @param color - The screw color to get the tray for\n   * @returns The tray entity or undefined if not found\n   *\n   * @example\n   * const redTray = gameScene.getTrayByColor(ScrewColor.Red);\n   */\n  public getTrayByColor(color: ScrewColor): Entity2D | undefined {\n    return this.trayEntities.get(color);\n  }\n\n  /**\n   * Gets the animation layer container.\n   * Used by AnimationSystem to move screws to top during animation.\n   *\n   * @returns The animation layer container\n   * @example\n   * const layer = gameScene.getAnimationLayer();\n   * layer.addChild(screwSprite);\n   */\n  public getAnimationLayer(): Container {\n    return this.animationLayer;\n  }\n\n  /**\n   * Gets the colored tray layer container.\n   * Used by AnimationSystem to move screws to correct layer after animation.\n   *\n   * @returns The colored tray layer container\n   * @example\n   * const layer = gameScene.getColoredTrayLayer();\n   * layer.addChild(screwSprite);\n   */\n  public getColoredTrayLayer(): Container {\n    return this.coloredTrayLayer;\n  }\n\n  /**\n   * Gets the currently loaded level.\n   *\n   * @returns The current level definition or null if no level is loaded\n   * @example\n   * const level = gameScene.getCurrentLevel();\n   * if (level) console.log(level.parts.length);\n   */\n  public getCurrentLevel(): LevelDefinition | null {\n    return this.currentLevel;\n  }\n\n  /**\n   * Loads a level from a region file.\n   *\n   * Creates part and screw entities based on the level definition.\n   * Clears any existing level entities before loading.\n   *\n   * @param regionPath - Path to the region JSON file\n   * @param levelIndex - Index of the level within the region (0-based)\n   *\n   * @example\n   * await gameScene.loadLevel('regions/region-test.json', 0);\n   */\n  public async loadLevel(\n    regionPath: string,\n    levelIndex: number\n  ): Promise<void> {\n    this.clearLevel();\n\n    // Store for restart\n    this.currentRegionPath = regionPath;\n    this.currentLevelIndex = levelIndex;\n\n    const region = await loadRegion(regionPath);\n    const level = getLevelByIndex(region, levelIndex);\n    this.currentLevel = level;\n\n    await this.loadPartAssets(level);\n    await this.createLevelEntities(level);\n  }\n\n  /**\n   * Creates part and screw entities for a level.\n   * @param level - The level definition to create entities from\n   * @private\n   */\n  private async createLevelEntities(level: LevelDefinition): Promise<void> {\n    this.createGameStateEntity(level);\n    await this.createLevelTrays(level);\n    await this.createBufferTrayEntity(level);\n    await this.createPartsAndScrews(level);\n  }\n\n  /**\n   * Creates the game state entity for tracking level progress.\n   * @param level - The level definition\n   * @example\n   * this.createGameStateEntity(level);\n   */\n  private createGameStateEntity(level: LevelDefinition): void {\n    const totalScrews = level.parts.reduce(\n      (sum, part) => sum + part.screws.length,\n      0\n    );\n    this.gameStateEntity = createEntity(GameStateEntity, {\n      gameState: {\n        phase: 'playing',\n        totalScrews,\n        removedScrews: 0,\n        winConditionType: level.win.type,\n      },\n    });\n    this.scene.addChild(this.gameStateEntity);\n  }\n\n  /**\n   * Creates the buffer tray entity for the level.\n   * @param level - The level definition\n   * @example\n   * await this.createBufferTrayEntity(level);\n   */\n  private async createBufferTrayEntity(level: LevelDefinition): Promise<void> {\n    this.bufferTrayEntity = await createBufferTrayEntity({\n      position: {\n        x: GAME_LAYOUT.bufferTrayFrame.x,\n        y: GAME_LAYOUT.bufferTrayFrame.y,\n      },\n      capacity: level.bufferCapacity ?? 5,\n    });\n    this.scene.addChild(this.bufferTrayEntity);\n  }\n\n  /**\n   * Creates part and screw entities from level definition.\n   *\n   * Level data uses centered local coordinates where (0,0) is the center\n   * of the play area. This method transforms those coordinates to world\n   * coordinates for rendering.\n   *\n   * @param level - The level definition\n   * @example\n   * await this.createPartsAndScrews(level);\n   */\n  private async createPartsAndScrews(level: LevelDefinition): Promise<void> {\n    // Sort parts by layer (low to high) so higher layers render on top and block clicks\n    const sortedParts = [...level.parts].sort((a, b) => a.layer - b.layer);\n\n    for (const partInstance of sortedParts) {\n      const partDef = getPart(partInstance.partId);\n      const partWorldPosition = localToWorld(partInstance.position);\n\n      const partEntity = await createPartEntity({\n        assetAlias: partDef.id,\n        partDefinitionId: partDef.id,\n        position: partWorldPosition,\n        layer: partInstance.layer,\n      });\n      this.scene.addChild(partEntity);\n      this.partEntities.push(partEntity);\n\n      await this.createScrewsForPart(\n        partInstance,\n        partDef,\n        partWorldPosition,\n        partEntity\n      );\n    }\n  }\n\n  /**\n   * Creates screw entities for a part instance.\n   * @param partInstance - The part instance from level data\n   * @param partDef - The part definition\n   * @param partWorldPosition - The part's world position\n   * @param partEntity - The created part entity\n   * @internal\n   */\n  private async createScrewsForPart(\n    partInstance: PartInstance,\n    partDef: PartDefinition,\n    partWorldPosition: Position,\n    partEntity: Entity2D\n  ): Promise<void> {\n    // Get part dimensions - screws are relative to part's top-left corner\n    const partWidth =\n      partDef.collision.type === 'box' ? partDef.collision.width : 0;\n    const partHeight =\n      partDef.collision.type === 'box' ? partDef.collision.height : 0;\n\n    for (const screw of partInstance.screws) {\n      // Convert to world position: partCenter - halfSize + screwLocal\n      const screwWorldPosition = {\n        x: partWorldPosition.x - partWidth / 2 + screw.position.x,\n        y: partWorldPosition.y - partHeight / 2 + screw.position.y,\n      };\n      const screwEntity = await createScrewEntity({\n        color: screw.color,\n        position: screwWorldPosition,\n        partEntityId: String(partEntity.UID),\n      });\n      this.scene.addChild(screwEntity);\n      this.screwEntities.push(screwEntity);\n    }\n\n    // Set the part's screw count after creating all screws\n    const part = partEntity.c.part as { screwCount: number };\n    part.screwCount = partInstance.screws.length;\n  }\n\n  /**\n   * Clears all level entities (parts, screws, trays, game state, buffer tray).\n   * @private\n   */\n  private clearLevel(): void {\n    // Reset tick counter for new level\n    gameTick.reset();\n\n    // Reset physics world for clean slate\n    PhysicsWorldManager.getInstance().reset();\n\n    // Remove game state entity\n    if (this.gameStateEntity) {\n      this.scene.removeChild(this.gameStateEntity);\n      this.gameStateEntity = null;\n    }\n\n    // Remove buffer tray entity\n    if (this.bufferTrayEntity) {\n      this.scene.removeChild(this.bufferTrayEntity);\n      this.bufferTrayEntity = null;\n    }\n\n    // Remove tray entities (they're recreated per level)\n    // Clear the coloredTrayLayer which holds tray views\n    this.coloredTrayLayer.removeChildren();\n    for (const tray of this.trayEntities.values()) {\n      this.scene.removeChild(tray);\n    }\n    this.trayEntities.clear();\n\n    // Remove part entities\n    for (const entity of this.partEntities) {\n      this.scene.removeChild(entity);\n    }\n\n    // Remove screw entities\n    for (const entity of this.screwEntities) {\n      this.scene.removeChild(entity);\n    }\n\n    // Clear animation layer (screws in buffer tray are left here after animation)\n    this.animationLayer.removeChildren();\n\n    this.partEntities = [];\n    this.screwEntities = [];\n    this.currentLevel = null;\n  }\n\n  /** Tracks which part asset bundles have been registered */\n  private loadedPartBundles = new Set<string>();\n\n  /**\n   * Loads asset bundles for parts used in the level.\n   * @param level - The level definition containing parts to load assets for\n   * @private\n   */\n  private async loadPartAssets(level: LevelDefinition): Promise<void> {\n    // Collect unique part IDs\n    const partIds = new Set(level.parts.map((p) => p.partId));\n\n    // Filter to only parts that haven't been loaded yet\n    const assets: { alias: string; src: string }[] = [];\n    for (const partId of partIds) {\n      if (this.loadedPartBundles.has(partId)) continue;\n\n      const partDef = getPart(partId);\n      if (partDef.asset) {\n        assets.push({ alias: partDef.id, src: partDef.asset });\n        this.loadedPartBundles.add(partId);\n      }\n    }\n\n    if (assets.length > 0) {\n      // Use unique bundle name to avoid overwrite warnings\n      const bundleName = `level-parts-${String(Date.now())}`;\n      Assets.addBundle(bundleName, assets);\n      await Assets.loadBundle(bundleName);\n    }\n  }\n\n  /**\n   * Starts the game scene.\n   *\n   * @example\n   * gameScene.start();\n   */\n  public start(): void {\n    this.scene.start();\n  }\n\n  /**\n   * Pauses the game scene.\n   *\n   * @example\n   * gameScene.pause();\n   */\n  public pause(): void {\n    this.scene.paused = true;\n  }\n\n  /**\n   * Resumes a paused game scene.\n   *\n   * @example\n   * gameScene.resume();\n   */\n  public resume(): void {\n    this.scene.paused = false;\n  }\n\n  /**\n   * Updates the game scene.\n   *\n   * @param _deltaTime - Time elapsed since last frame in seconds\n   *\n   * @example\n   * gameScene.update(0.016);\n   */\n  public update(_deltaTime: number): void {\n    // Scene updates automatically via View2DSystem\n  }\n\n  /**\n   * Destroys the game scene and cleans up resources.\n   *\n   * @example\n   * gameScene.destroy();\n   */\n  public destroy(): void {\n    // Cleanup touch input\n    if (this.restartInput) {\n      this.restartInput.enabled = false;\n      this.restartInput = null;\n    }\n\n    this.restartButton = null;\n    this.trayEntities.clear();\n\n    // Clear layers\n    this.backgroundLayer.removeChildren();\n    this.uiLayer.removeChildren();\n    this.puzzleLayer.removeChildren();\n    this.animationLayer.removeChildren();\n\n    // Clear layer registry\n    clearLayerRegistry();\n\n    this.scene.reset();\n  }\n}\n","import { BaseScreen } from './BaseScreen';\nimport { GameScene } from '@scenes/game/GameScene';\nimport { getTestParams } from '@shared/debug';\n\n/**\n * Game screen that hosts the main ODIE ECS game scene.\n *\n * This screen manages the lifecycle of a GameScene, bridging the Astro\n * screen system with ODIE's Scene2D. It handles:\n * - Scene initialization during `onPrepare()`\n * - Starting the scene on `onShow()`\n * - Pausing/resuming on visibility changes\n * - Cleanup on `onHidden()`\n *\n * @augments {BaseScreen}\n *\n * @example\n * // Registering the screen (typically done in bootstrap)\n * import { ScreensPlugin } from '@play-co/astro';\n * import { GameScreen } from '@ui/screens';\n *\n * const screens = app.get(ScreensPlugin);\n * screens.main.add(GameScreen, undefined, 'game');\n * await screens.main.show('game');\n *\n * @example\n * // Navigating to the game screen from another screen\n * import { getApp } from '@app';\n * import { ScreensPlugin } from '@play-co/astro';\n *\n * const app = getApp();\n * if (app) {\n *   const screens = app.get(ScreensPlugin);\n *   await screens.main.show('game');\n * }\n */\nexport class GameScreen extends BaseScreen {\n  /**\n   * The ODIE game scene instance.\n   * Created during onPrepare() and destroyed during onHidden().\n   */\n  private gameScene: GameScene | null = null;\n\n  /**\n   * Prepares the screen before it becomes visible.\n   *\n   * Creates and initializes the ODIE GameScene.\n   * If URL params specify a region and level, loads that level.\n   * @protected\n   */\n  protected override async onPrepare(): Promise<void> {\n    this.gameScene = new GameScene({\n      stage: this.view,\n    });\n\n    await this.gameScene.init();\n\n    // Load level from URL params, defaulting to test region\n    const params = getTestParams();\n    const region = params.region ?? 'test';\n    const regionPath = `regions/region-${region}.json`;\n    const levelIndex = params.level ?? 0;\n    await this.gameScene.loadLevel(regionPath, levelIndex);\n  }\n\n  /**\n   * Called when the screen becomes visible.\n   *\n   * Starts the game scene game loop.\n   * @protected\n   */\n  protected override onShow(): void {\n    this.gameScene?.start();\n  }\n\n  /**\n   * Called each frame while the screen is visible.\n   *\n   * @param dt - Delta time since last frame in seconds\n   * @protected\n   */\n  protected override onUpdate(dt: number): void {\n    this.gameScene?.update(dt);\n  }\n\n  /**\n   * Called when the screen starts hiding.\n   *\n   * Pauses the game scene.\n   * @protected\n   */\n  protected override onHide(): void {\n    this.gameScene?.pause();\n  }\n\n  /**\n   * Called when the screen is fully hidden.\n   *\n   * Destroys the game scene and cleans up resources.\n   * @protected\n   */\n  protected override onHidden(): void {\n    this.gameScene?.destroy();\n    this.gameScene = null;\n  }\n\n  /**\n   * Called when the app is paused (e.g., tab loses focus).\n   * @protected\n   */\n  protected override onPause(): void {\n    this.gameScene?.pause();\n  }\n\n  /**\n   * Called when the app is resumed (e.g., tab gains focus).\n   * @protected\n   */\n  protected override onResume(): void {\n    this.gameScene?.resume();\n  }\n}\n","/**\n * Application configuration constants.\n *\n * These values configure the game's display settings and are used during\n * bootstrap. The configuration is immutable (defined with `as const`).\n *\n * @property width - Canvas width in pixels (default: 1080)\n * @property height - Canvas height in pixels (default: 1920)\n * @property backgroundColor - Background color as hex number (default: 0x1a1a2e - dark blue)\n * @property antialias - Enable antialiasing for smoother graphics (default: true)\n *\n * @example\n * // Centering an entity on screen\n * import { APP_CONFIG } from '@app';\n *\n * entity.position.set(\n *   APP_CONFIG.width / 2,\n *   APP_CONFIG.height / 2\n * );\n *\n * @example\n * // Creating a full-screen background\n * import { APP_CONFIG } from '@app';\n * import { Graphics } from 'pixi.js';\n *\n * const bg = new Graphics();\n * bg.rect(0, 0, APP_CONFIG.width, APP_CONFIG.height);\n * bg.fill({ color: APP_CONFIG.backgroundColor });\n *\n * @example\n * // Using in resize calculations\n * import { APP_CONFIG } from '@app';\n *\n * const aspectRatio = APP_CONFIG.width / APP_CONFIG.height;\n * const scale = Math.min(\n *   window.innerWidth / APP_CONFIG.width,\n *   window.innerHeight / APP_CONFIG.height\n * );\n */\nexport const APP_CONFIG = {\n  width: 1080,\n  height: 1920,\n  backgroundColor: 0x1a1a2e,\n  antialias: true,\n} as const;\n\n/**\n * Type representing the application configuration shape.\n *\n * Use this type when you need to accept or pass configuration values\n * that match the APP_CONFIG structure.\n *\n * @example\n * import type { AppConfig } from '@app';\n *\n * function logConfig(config: AppConfig): void {\n *   console.log(`Game size: ${config.width}x${config.height}`);\n * }\n */\nexport type AppConfig = typeof APP_CONFIG;\n","/**\n * Application bootstrap module.\n *\n * This module initializes and configures the Astro application with all\n * necessary plugins and the initial game screen.\n *\n * @module\n */\n\nimport {\n  Application,\n  StagePlugin,\n  ResizePlugin,\n  ScreensPlugin,\n  KeyboardPlugin,\n  ResourcePlugin,\n  aspectResize,\n} from '@play-co/astro';\n\nimport { GameScreen } from '@ui/screens/GameScreen';\nimport { markGameReady } from '@shared/debug';\n\nimport { APP_CONFIG } from './config';\n\n/** Singleton application instance */\nlet app: Application | null = null;\n\n/**\n * Initializes and starts the game application.\n *\n * This function performs the following setup:\n * 1. Creates the Astro Application instance\n * 2. Configures core plugins:\n *    - **StagePlugin** - PixiJS renderer and canvas management\n *    - **ResizePlugin** - Responsive viewport scaling\n *    - **ResourcePlugin** - Asset loading via PixiJS Assets\n *    - **KeyboardPlugin** - Keyboard input handling\n *    - **ScreensPlugin** - Screen management with main/overlay layers\n * 3. Mounts the canvas to the DOM (#app element)\n * 4. Shows the initial GameScreen\n * 5. Marks the game as ready for the test harness\n *\n * The function is idempotent - calling it multiple times returns the\n * same Application instance.\n *\n * @returns A promise resolving to the initialized Application instance\n * @throws {Error} If the app container element (#app) is not found in the DOM\n *\n * @example\n * // Basic usage in main.ts\n * import { bootstrap } from '@app';\n *\n * async function main(): Promise<void> {\n *   const app = await bootstrap();\n *   console.log('Game started!');\n * }\n *\n * main().catch(console.error);\n *\n * @example\n * // Accessing plugins after bootstrap\n * import { bootstrap, getApp } from '@app';\n * import { ScreensPlugin, KeyboardPlugin } from '@play-co/astro';\n *\n * await bootstrap();\n *\n * const app = getApp();\n * if (app) {\n *   // Access screen management\n *   const screens = app.get(ScreensPlugin);\n *   await screens.main.show('menu');\n *\n *   // Bind keyboard controls\n *   const keyboard = app.get(KeyboardPlugin);\n *   keyboard.bindKeyDown('Space', () => {\n *     console.log('Space pressed!');\n *   });\n * }\n *\n * @example\n * // Using ResourcePlugin for asset loading\n * import { getApp } from '@app';\n * import { ResourcePlugin } from '@play-co/astro';\n * import { Assets } from 'pixi.js';\n *\n * const app = getApp();\n * if (app) {\n *   // ResourcePlugin initializes PixiJS Assets automatically\n *   const texture = await Assets.load('images/player.png');\n * }\n */\nexport async function bootstrap(): Promise<Application> {\n  if (app !== null) {\n    return app;\n  }\n\n  app = new Application();\n\n  configurePlugins(app);\n  await app.init();\n  mountToDOM(app);\n  await showInitialScreen(app);\n\n  return app;\n}\n\n/**\n * Configures all core plugins for the application.\n *\n * @param application - The Astro Application instance to configure\n *\n * @example\n * const app = new Application();\n * configurePlugins(app);\n */\nfunction configurePlugins(application: Application): void {\n  application.add(StagePlugin, {\n    backgroundColor: APP_CONFIG.backgroundColor,\n    antialias: APP_CONFIG.antialias,\n    autoAddToDocument: false,\n  });\n\n  application.add(ResizePlugin, {\n    resizeFunction: aspectResize(APP_CONFIG.width, APP_CONFIG.height, true),\n  });\n\n  application.add(ResourcePlugin);\n  application.add(KeyboardPlugin);\n\n  // Note: Using type assertion because Application.add's generic inference\n  // doesn't correctly handle ScreenPluginOptions\n  (application.add as (plugin: typeof ScreensPlugin, options: unknown) => void)(\n    ScreensPlugin,\n    {\n      main: { loadBeforeTransition: true },\n      overlay: { loadBeforeTransition: true },\n    }\n  );\n}\n\n/**\n * Mounts the application canvas to the DOM.\n *\n * @param application - The initialized Astro Application\n * @throws Error if the app container element is not found\n *\n * @example\n * await app.init();\n * mountToDOM(app);\n */\nfunction mountToDOM(application: Application): void {\n  const stage = application.get(StagePlugin);\n  const container = document.getElementById('app');\n\n  if (container === null) {\n    throw new Error('App container element not found');\n  }\n\n  container.appendChild(stage.view);\n}\n\n/**\n * Shows the initial screen and marks the game as ready.\n *\n * @param application - The initialized Astro Application\n * @returns Promise that resolves when the screen is shown\n *\n * @example\n * await showInitialScreen(app);\n */\nasync function showInitialScreen(application: Application): Promise<void> {\n  const screens = application.get(ScreensPlugin);\n  screens.main.add(GameScreen, undefined, 'game');\n  await screens.main.show('game' as 'empty');\n  markGameReady('game');\n}\n\n/**\n * Returns the current Application instance.\n *\n * Use this function to access the application after bootstrap has been called.\n * Returns null if bootstrap() has not been called yet.\n *\n * @returns The Application instance or null if not yet bootstrapped\n *\n * @example\n * import { getApp } from '@app';\n * import { ScreensPlugin } from '@play-co/astro';\n *\n * const app = getApp();\n * if (app) {\n *   const screens = app.get(ScreensPlugin);\n *   // Navigate to a different screen\n *   await screens.main.show('menu');\n * }\n *\n * @example\n * // Checking if app is ready\n * import { getApp } from '@app';\n *\n * function isAppReady(): boolean {\n *   return getApp() !== null;\n * }\n */\nexport function getApp(): Application | null {\n  return app;\n}\n","import { bootstrap } from '@app/bootstrap';\nimport { initTestHarness, isTestMode } from '@shared/debug';\nimport { createDebugConsole } from '@shared/debug/ui/debugConsole';\n\n// Initialize test harness early (before any errors can occur)\ninitTestHarness();\n\n// Create debug console in dev/test mode\nif (import.meta.env.DEV || isTestMode()) {\n  const debugConsole = createDebugConsole();\n  document.body.appendChild(debugConsole);\n}\n\nasync function main(): Promise<void> {\n  try {\n    // eslint-disable-next-line no-console\n    console.log('Starting application...');\n    await bootstrap();\n    // eslint-disable-next-line no-console\n    console.log('Application started successfully');\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error('Failed to initialize application:', error);\n    // Capture in test harness\n    if (window.__gameTest) {\n      window.__gameTest.captureError(\n        error instanceof Error ? error : new Error(String(error)),\n        'main'\n      );\n    }\n    // Display error on page\n    const appDiv = document.getElementById('app');\n    if (appDiv) {\n      appDiv.innerHTML = `<pre style=\"color: red; padding: 20px;\">${String(error)}\\n\\n${error instanceof Error ? (error.stack ?? '') : ''}</pre>`;\n    }\n  }\n}\n\nvoid main();\n"],"file":"index-BHAWUayI.js"}